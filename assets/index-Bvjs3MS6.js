var y4=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ASe=y4((qSe,oC)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var vD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function OU(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var t0={exports:{}},vg={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wD;function C4(){if(wD)return vg;wD=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,r,s){var a=null;if(s!==void 0&&(a=""+s),r.key!==void 0&&(a=""+r.key),"key"in r){s={};for(var u in r)u!=="key"&&(s[u]=r[u])}else s=r;return r=s.ref,{$$typeof:t,type:i,key:a,ref:r!==void 0?r:null,props:s}}return vg.Fragment=e,vg.jsx=n,vg.jsxs=n,vg}var yD;function S4(){return yD||(yD=1,t0.exports=C4()),t0.exports}var Mc=S4(),n0={exports:{}},ot={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CD;function b4(){if(CD)return ot;CD=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.iterator;function w(F){return F===null||typeof F!="object"?null:(F=p&&F[p]||F["@@iterator"],typeof F=="function"?F:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,_={};function E(F,C,R){this.props=F,this.context=C,this.refs=_,this.updater=R||y}E.prototype.isReactComponent={},E.prototype.setState=function(F,C){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,C,"setState")},E.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function H(){}H.prototype=E.prototype;function x(F,C,R){this.props=F,this.context=C,this.refs=_,this.updater=R||y}var D=x.prototype=new H;D.constructor=x,S(D,E.prototype),D.isPureReactComponent=!0;var $=Array.isArray,V={H:null,A:null,T:null,S:null},L=Object.prototype.hasOwnProperty;function U(F,C,R,T,A,k){return R=k.ref,{$$typeof:t,type:F,key:C,ref:R!==void 0?R:null,props:k}}function re(F,C){return U(F.type,C,void 0,void 0,void 0,F.props)}function se(F){return typeof F=="object"&&F!==null&&F.$$typeof===t}function Q(F){var C={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(R){return C[R]})}var de=/\/+/g;function me(F,C){return typeof F=="object"&&F!==null&&F.key!=null?Q(""+F.key):C.toString(36)}function _e(){}function Ee(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(_e,_e):(F.status="pending",F.then(function(C){F.status==="pending"&&(F.status="fulfilled",F.value=C)},function(C){F.status==="pending"&&(F.status="rejected",F.reason=C)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function Te(F,C,R,T,A){var k=typeof F;(k==="undefined"||k==="boolean")&&(F=null);var z=!1;if(F===null)z=!0;else switch(k){case"bigint":case"string":case"number":z=!0;break;case"object":switch(F.$$typeof){case t:case e:z=!0;break;case g:return z=F._init,Te(z(F._payload),C,R,T,A)}}if(z)return A=A(F),z=T===""?"."+me(F,0):T,$(A)?(R="",z!=null&&(R=z.replace(de,"$&/")+"/"),Te(A,C,R,"",function(be){return be})):A!=null&&(se(A)&&(A=re(A,R+(A.key==null||F&&F.key===A.key?"":(""+A.key).replace(de,"$&/")+"/")+z)),C.push(A)),1;z=0;var le=T===""?".":T+":";if($(F))for(var ae=0;ae<F.length;ae++)T=F[ae],k=le+me(T,ae),z+=Te(T,C,R,k,A);else if(ae=w(F),typeof ae=="function")for(F=ae.call(F),ae=0;!(T=F.next()).done;)T=T.value,k=le+me(T,ae++),z+=Te(T,C,R,k,A);else if(k==="object"){if(typeof F.then=="function")return Te(Ee(F),C,R,T,A);throw C=String(F),Error("Objects are not valid as a React child (found: "+(C==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":C)+"). If you meant to render a collection of children, use an array instead.")}return z}function ve(F,C,R){if(F==null)return F;var T=[],A=0;return Te(F,T,"","",function(k){return C.call(R,k,A++)}),T}function Ce(F){if(F._status===-1){var C=F._result;C=C(),C.then(function(R){(F._status===0||F._status===-1)&&(F._status=1,F._result=R)},function(R){(F._status===0||F._status===-1)&&(F._status=2,F._result=R)}),F._status===-1&&(F._status=0,F._result=C)}if(F._status===1)return F._result.default;throw F._result}var Re=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var C=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(C))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)};function qe(){}return ot.Children={map:ve,forEach:function(F,C,R){ve(F,function(){C.apply(this,arguments)},R)},count:function(F){var C=0;return ve(F,function(){C++}),C},toArray:function(F){return ve(F,function(C){return C})||[]},only:function(F){if(!se(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},ot.Component=E,ot.Fragment=n,ot.Profiler=r,ot.PureComponent=x,ot.StrictMode=i,ot.Suspense=h,ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=V,ot.act=function(){throw Error("act(...) is not supported in production builds of React.")},ot.cache=function(F){return function(){return F.apply(null,arguments)}},ot.cloneElement=function(F,C,R){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var T=S({},F.props),A=F.key,k=void 0;if(C!=null)for(z in C.ref!==void 0&&(k=void 0),C.key!==void 0&&(A=""+C.key),C)!L.call(C,z)||z==="key"||z==="__self"||z==="__source"||z==="ref"&&C.ref===void 0||(T[z]=C[z]);var z=arguments.length-2;if(z===1)T.children=R;else if(1<z){for(var le=Array(z),ae=0;ae<z;ae++)le[ae]=arguments[ae+2];T.children=le}return U(F.type,A,void 0,void 0,k,T)},ot.createContext=function(F){return F={$$typeof:a,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:s,_context:F},F},ot.createElement=function(F,C,R){var T,A={},k=null;if(C!=null)for(T in C.key!==void 0&&(k=""+C.key),C)L.call(C,T)&&T!=="key"&&T!=="__self"&&T!=="__source"&&(A[T]=C[T]);var z=arguments.length-2;if(z===1)A.children=R;else if(1<z){for(var le=Array(z),ae=0;ae<z;ae++)le[ae]=arguments[ae+2];A.children=le}if(F&&F.defaultProps)for(T in z=F.defaultProps,z)A[T]===void 0&&(A[T]=z[T]);return U(F,k,void 0,void 0,null,A)},ot.createRef=function(){return{current:null}},ot.forwardRef=function(F){return{$$typeof:u,render:F}},ot.isValidElement=se,ot.lazy=function(F){return{$$typeof:g,_payload:{_status:-1,_result:F},_init:Ce}},ot.memo=function(F,C){return{$$typeof:d,type:F,compare:C===void 0?null:C}},ot.startTransition=function(F){var C=V.T,R={};V.T=R;try{var T=F(),A=V.S;A!==null&&A(R,T),typeof T=="object"&&T!==null&&typeof T.then=="function"&&T.then(qe,Re)}catch(k){Re(k)}finally{V.T=C}},ot.unstable_useCacheRefresh=function(){return V.H.useCacheRefresh()},ot.use=function(F){return V.H.use(F)},ot.useActionState=function(F,C,R){return V.H.useActionState(F,C,R)},ot.useCallback=function(F,C){return V.H.useCallback(F,C)},ot.useContext=function(F){return V.H.useContext(F)},ot.useDebugValue=function(){},ot.useDeferredValue=function(F,C){return V.H.useDeferredValue(F,C)},ot.useEffect=function(F,C){return V.H.useEffect(F,C)},ot.useId=function(){return V.H.useId()},ot.useImperativeHandle=function(F,C,R){return V.H.useImperativeHandle(F,C,R)},ot.useInsertionEffect=function(F,C){return V.H.useInsertionEffect(F,C)},ot.useLayoutEffect=function(F,C){return V.H.useLayoutEffect(F,C)},ot.useMemo=function(F,C){return V.H.useMemo(F,C)},ot.useOptimistic=function(F,C){return V.H.useOptimistic(F,C)},ot.useReducer=function(F,C,R){return V.H.useReducer(F,C,R)},ot.useRef=function(F){return V.H.useRef(F)},ot.useState=function(F){return V.H.useState(F)},ot.useSyncExternalStore=function(F,C,R){return V.H.useSyncExternalStore(F,C,R)},ot.useTransition=function(){return V.H.useTransition()},ot.version="19.0.0",ot}var SD;function rO(){return SD||(SD=1,n0.exports=b4()),n0.exports}var Xe=rO();const ci=OU(Xe);var i0={exports:{}},wg={},r0={exports:{}},s0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bD;function R4(){return bD||(bD=1,function(t){function e(ve,Ce){var Re=ve.length;ve.push(Ce);e:for(;0<Re;){var qe=Re-1>>>1,F=ve[qe];if(0<r(F,Ce))ve[qe]=Ce,ve[Re]=F,Re=qe;else break e}}function n(ve){return ve.length===0?null:ve[0]}function i(ve){if(ve.length===0)return null;var Ce=ve[0],Re=ve.pop();if(Re!==Ce){ve[0]=Re;e:for(var qe=0,F=ve.length,C=F>>>1;qe<C;){var R=2*(qe+1)-1,T=ve[R],A=R+1,k=ve[A];if(0>r(T,Re))A<F&&0>r(k,T)?(ve[qe]=k,ve[A]=Re,qe=A):(ve[qe]=T,ve[R]=Re,qe=R);else if(A<F&&0>r(k,Re))ve[qe]=k,ve[A]=Re,qe=A;else break e}}return Ce}function r(ve,Ce){var Re=ve.sortIndex-Ce.sortIndex;return Re!==0?Re:ve.id-Ce.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var h=[],d=[],g=1,p=null,w=3,y=!1,S=!1,_=!1,E=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function D(ve){for(var Ce=n(d);Ce!==null;){if(Ce.callback===null)i(d);else if(Ce.startTime<=ve)i(d),Ce.sortIndex=Ce.expirationTime,e(h,Ce);else break;Ce=n(d)}}function $(ve){if(_=!1,D(ve),!S)if(n(h)!==null)S=!0,Ee();else{var Ce=n(d);Ce!==null&&Te($,Ce.startTime-ve)}}var V=!1,L=-1,U=5,re=-1;function se(){return!(t.unstable_now()-re<U)}function Q(){if(V){var ve=t.unstable_now();re=ve;var Ce=!0;try{e:{S=!1,_&&(_=!1,H(L),L=-1),y=!0;var Re=w;try{t:{for(D(ve),p=n(h);p!==null&&!(p.expirationTime>ve&&se());){var qe=p.callback;if(typeof qe=="function"){p.callback=null,w=p.priorityLevel;var F=qe(p.expirationTime<=ve);if(ve=t.unstable_now(),typeof F=="function"){p.callback=F,D(ve),Ce=!0;break t}p===n(h)&&i(h),D(ve)}else i(h);p=n(h)}if(p!==null)Ce=!0;else{var C=n(d);C!==null&&Te($,C.startTime-ve),Ce=!1}}break e}finally{p=null,w=Re,y=!1}Ce=void 0}}finally{Ce?de():V=!1}}}var de;if(typeof x=="function")de=function(){x(Q)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,_e=me.port2;me.port1.onmessage=Q,de=function(){_e.postMessage(null)}}else de=function(){E(Q,0)};function Ee(){V||(V=!0,de())}function Te(ve,Ce){L=E(function(){ve(t.unstable_now())},Ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ve){ve.callback=null},t.unstable_continueExecution=function(){S||y||(S=!0,Ee())},t.unstable_forceFrameRate=function(ve){0>ve||125<ve?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<ve?Math.floor(1e3/ve):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return n(h)},t.unstable_next=function(ve){switch(w){case 1:case 2:case 3:var Ce=3;break;default:Ce=w}var Re=w;w=Ce;try{return ve()}finally{w=Re}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ve,Ce){switch(ve){case 1:case 2:case 3:case 4:case 5:break;default:ve=3}var Re=w;w=ve;try{return Ce()}finally{w=Re}},t.unstable_scheduleCallback=function(ve,Ce,Re){var qe=t.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?qe+Re:qe):Re=qe,ve){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=Re+F,ve={id:g++,callback:Ce,priorityLevel:ve,startTime:Re,expirationTime:F,sortIndex:-1},Re>qe?(ve.sortIndex=Re,e(d,ve),n(h)===null&&ve===n(d)&&(_?(H(L),L=-1):_=!0,Te($,Re-qe))):(ve.sortIndex=F,e(h,ve),S||y||(S=!0,Ee())),ve},t.unstable_shouldYield=se,t.unstable_wrapCallback=function(ve){var Ce=w;return function(){var Re=w;w=Ce;try{return ve.apply(this,arguments)}finally{w=Re}}}}(s0)),s0}var RD;function E4(){return RD||(RD=1,r0.exports=R4()),r0.exports}var o0={exports:{}},Hi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ED;function T4(){if(ED)return Hi;ED=1;var t=rO();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(h,d,g){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:p==null?null:""+p,children:h,containerInfo:d,implementation:g}}var a=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Hi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Hi.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(h,d,null,g)},Hi.flushSync=function(h){var d=a.T,g=i.p;try{if(a.T=null,i.p=2,h)return h()}finally{a.T=d,i.p=g,i.d.f()}},Hi.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(h,d))},Hi.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},Hi.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,p=u(g,d.crossOrigin),w=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?i.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:w,fetchPriority:y}):g==="script"&&i.d.X(h,{crossOrigin:p,integrity:w,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Hi.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=u(d.as,d.crossOrigin);i.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(h)},Hi.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,p=u(g,d.crossOrigin);i.d.L(h,g,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Hi.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=u(d.as,d.crossOrigin);i.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(h)},Hi.requestFormReset=function(h){i.d.r(h)},Hi.unstable_batchedUpdates=function(h,d){return h(d)},Hi.useFormState=function(h,d,g){return a.H.useFormState(h,d,g)},Hi.useFormStatus=function(){return a.H.useHostTransitionStatus()},Hi.version="19.0.0",Hi}var TD;function AU(){if(TD)return o0.exports;TD=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),o0.exports=T4(),o0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _D;function _4(){if(_D)return wg;_D=1;var t=E4(),e=rO(),n=AU();function i(o){var l="https://react.dev/errors/"+o;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)l+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}var s=Symbol.for("react.element"),a=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),y=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),D=Symbol.for("react.offscreen"),$=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function L(o){return o===null||typeof o!="object"?null:(o=V&&o[V]||o["@@iterator"],typeof o=="function"?o:null)}var U=Symbol.for("react.client.reference");function re(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===U?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case h:return"Fragment";case u:return"Portal";case g:return"Profiler";case d:return"StrictMode";case _:return"Suspense";case E:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case y:return(o.displayName||"Context")+".Provider";case w:return(o._context.displayName||"Context")+".Consumer";case S:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case H:return l=o.displayName||null,l!==null?l:re(o.type)||"Memo";case x:l=o._payload,o=o._init;try{return re(o(l))}catch{}}return null}var se=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=Object.assign,de,me;function _e(o){if(de===void 0)try{throw Error()}catch(c){var l=c.stack.trim().match(/\n( *(at )?)/);de=l&&l[1]||"",me=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+de+o+me}var Ee=!1;function Te(o,l){if(!o||Ee)return"";Ee=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(l){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(ue){var oe=ue}Reflect.construct(o,[],we)}else{try{we.call()}catch(ue){oe=ue}o.call(we.prototype)}}else{try{throw Error()}catch(ue){oe=ue}(we=o())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(ue){if(ue&&oe&&typeof ue.stack=="string")return[ue.stack,oe.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=f.DetermineComponentFrameRoot(),b=v[0],P=v[1];if(b&&P){var N=b.split(`
`),K=P.split(`
`);for(m=f=0;f<N.length&&!N[f].includes("DetermineComponentFrameRoot");)f++;for(;m<K.length&&!K[m].includes("DetermineComponentFrameRoot");)m++;if(f===N.length||m===K.length)for(f=N.length-1,m=K.length-1;1<=f&&0<=m&&N[f]!==K[m];)m--;for(;1<=f&&0<=m;f--,m--)if(N[f]!==K[m]){if(f!==1||m!==1)do if(f--,m--,0>m||N[f]!==K[m]){var he=`
`+N[f].replace(" at new "," at ");return o.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",o.displayName)),he}while(1<=f&&0<=m);break}}}finally{Ee=!1,Error.prepareStackTrace=c}return(c=o?o.displayName||o.name:"")?_e(c):""}function ve(o){switch(o.tag){case 26:case 27:case 5:return _e(o.type);case 16:return _e("Lazy");case 13:return _e("Suspense");case 19:return _e("SuspenseList");case 0:case 15:return o=Te(o.type,!1),o;case 11:return o=Te(o.type.render,!1),o;case 1:return o=Te(o.type,!0),o;default:return""}}function Ce(o){try{var l="";do l+=ve(o),o=o.return;while(o);return l}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function Re(o){var l=o,c=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,(l.flags&4098)!==0&&(c=l.return),o=l.return;while(o)}return l.tag===3?c:null}function qe(o){if(o.tag===13){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function F(o){if(Re(o)!==o)throw Error(i(188))}function C(o){var l=o.alternate;if(!l){if(l=Re(o),l===null)throw Error(i(188));return l!==o?null:o}for(var c=o,f=l;;){var m=c.return;if(m===null)break;var v=m.alternate;if(v===null){if(f=m.return,f!==null){c=f;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===c)return F(m),o;if(v===f)return F(m),l;v=v.sibling}throw Error(i(188))}if(c.return!==f.return)c=m,f=v;else{for(var b=!1,P=m.child;P;){if(P===c){b=!0,c=m,f=v;break}if(P===f){b=!0,f=m,c=v;break}P=P.sibling}if(!b){for(P=v.child;P;){if(P===c){b=!0,c=v,f=m;break}if(P===f){b=!0,f=v,c=m;break}P=P.sibling}if(!b)throw Error(i(189))}}if(c.alternate!==f)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?o:l}function R(o){var l=o.tag;if(l===5||l===26||l===27||l===6)return o;for(o=o.child;o!==null;){if(l=R(o),l!==null)return l;o=o.sibling}return null}var T=Array.isArray,A=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,k={pending:!1,data:null,method:null,action:null},z=[],le=-1;function ae(o){return{current:o}}function be(o){0>le||(o.current=z[le],z[le]=null,le--)}function M(o,l){le++,z[le]=o.current,o.current=l}var O=ae(null),I=ae(null),q=ae(null),j=ae(null);function Z(o,l){switch(M(q,l),M(I,o),M(O,null),o=l.nodeType,o){case 9:case 11:l=(l=l.documentElement)&&(l=l.namespaceURI)?YN(l):0;break;default:if(o=o===8?l.parentNode:l,l=o.tagName,o=o.namespaceURI)o=YN(o),l=GN(o,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}be(O),M(O,l)}function ne(){be(O),be(I),be(q)}function B(o){o.memoizedState!==null&&M(j,o);var l=O.current,c=GN(l,o.type);l!==c&&(M(I,o),M(O,c))}function X(o){I.current===o&&(be(O),be(I)),j.current===o&&(be(j),dg._currentValue=k)}var J=Object.prototype.hasOwnProperty,ee=t.unstable_scheduleCallback,ce=t.unstable_cancelCallback,xe=t.unstable_shouldYield,Ne=t.unstable_requestPaint,Fe=t.unstable_now,st=t.unstable_getCurrentPriorityLevel,ft=t.unstable_ImmediatePriority,Je=t.unstable_UserBlockingPriority,rt=t.unstable_NormalPriority,dn=t.unstable_LowPriority,ir=t.unstable_IdlePriority,jr=t.log,qn=t.unstable_setDisableYieldValue,tn=null,Ct=null;function Zt(o){if(Ct&&typeof Ct.onCommitFiberRoot=="function")try{Ct.onCommitFiberRoot(tn,o,void 0,(o.current.flags&128)===128)}catch{}}function gt(o){if(typeof jr=="function"&&qn(o),Ct&&typeof Ct.setStrictMode=="function")try{Ct.setStrictMode(tn,o)}catch{}}var Ke=Math.clz32?Math.clz32:lh,ah=Math.log,ea=Math.LN2;function lh(o){return o>>>=0,o===0?32:31-(ah(o)/ea|0)|0}var uh=128,ao=4194304;function ta(o){var l=o&42;if(l!==0)return l;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function ch(o,l){var c=o.pendingLanes;if(c===0)return 0;var f=0,m=o.suspendedLanes,v=o.pingedLanes,b=o.warmLanes;o=o.finishedLanes!==0;var P=c&134217727;return P!==0?(c=P&~m,c!==0?f=ta(c):(v&=P,v!==0?f=ta(v):o||(b=P&~b,b!==0&&(f=ta(b))))):(P=c&~m,P!==0?f=ta(P):v!==0?f=ta(v):o||(b=c&~b,b!==0&&(f=ta(b)))),f===0?0:l!==0&&l!==f&&(l&m)===0&&(m=f&-f,b=l&-l,m>=b||m===32&&(b&4194176)!==0)?l:f}function fn(o,l){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&l)===0}function ul(o,l){switch(o){case 1:case 2:case 4:case 8:return l+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wp(){var o=uh;return uh<<=1,(uh&4194176)===0&&(uh=128),o}function Ef(){var o=ao;return ao<<=1,(ao&62914560)===0&&(ao=4194304),o}function Su(o){for(var l=[],c=0;31>c;c++)l.push(o);return l}function cl(o,l){o.pendingLanes|=l,l!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function Up(o,l,c,f,m,v){var b=o.pendingLanes;o.pendingLanes=c,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=c,o.entangledLanes&=c,o.errorRecoveryDisabledLanes&=c,o.shellSuspendCounter=0;var P=o.entanglements,N=o.expirationTimes,K=o.hiddenUpdates;for(c=b&~c;0<c;){var he=31-Ke(c),we=1<<he;P[he]=0,N[he]=-1;var oe=K[he];if(oe!==null)for(K[he]=null,he=0;he<oe.length;he++){var ue=oe[he];ue!==null&&(ue.lane&=-536870913)}c&=~we}f!==0&&jp(o,f,0),v!==0&&m===0&&o.tag!==0&&(o.suspendedLanes|=v&~(b&~l))}function jp(o,l,c){o.pendingLanes|=l,o.suspendedLanes&=~l;var f=31-Ke(l);o.entangledLanes|=l,o.entanglements[f]=o.entanglements[f]|1073741824|c&4194218}function br(o,l){var c=o.entangledLanes|=l;for(o=o.entanglements;c;){var f=31-Ke(c),m=1<<f;m&l|o[f]&l&&(o[f]|=l),c&=~m}}function bu(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function Tf(){var o=A.p;return o!==0?o:(o=window.event,o===void 0?32:hD(o.type))}function zp(o,l){var c=A.p;try{return A.p=o,l()}finally{A.p=c}}var zr=Math.random().toString(36).slice(2),ri="__reactFiber$"+zr,gn="__reactProps$"+zr,na="__reactContainer$"+zr,hh="__reactEvents$"+zr,Yp="__reactListeners$"+zr,Gp="__reactHandles$"+zr,qp="__reactResources$"+zr,Ve="__reactMarker$"+zr;function Y(o){delete o[ri],delete o[gn],delete o[hh],delete o[Yp],delete o[Gp]}function ye(o){var l=o[ri];if(l)return l;for(var c=o.parentNode;c;){if(l=c[na]||c[ri]){if(c=l.alternate,l.child!==null||c!==null&&c.child!==null)for(o=XN(o);o!==null;){if(c=o[ri])return c;o=XN(o)}return l}o=c,c=o.parentNode}return null}function He(o){if(o=o[ri]||o[na]){var l=o.tag;if(l===5||l===6||l===13||l===26||l===27||l===3)return o}return null}function Ft(o){var l=o.tag;if(l===5||l===26||l===27||l===6)return o.stateNode;throw Error(i(33))}function wn(o){var l=o[qp];return l||(l=o[qp]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function St(o){o[Ve]=!0}var Si=new Set,Rr={};function Er(o,l){An(o,l),An(o+"Capture",l)}function An(o,l){for(Rr[o]=l,o=0;o<l.length;o++)Si.add(l[o])}var Yr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Kp=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),GH={},qH={};function fq(o){return J.call(qH,o)?!0:J.call(GH,o)?!1:Kp.test(o)?qH[o]=!0:(GH[o]=!0,!1)}function Xp(o,l,c){if(fq(l))if(c===null)o.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":o.removeAttribute(l);return;case"boolean":var f=l.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){o.removeAttribute(l);return}}o.setAttribute(l,""+c)}}function Zp(o,l,c){if(c===null)o.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(l);return}o.setAttribute(l,""+c)}}function ia(o,l,c,f){if(f===null)o.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(c);return}o.setAttributeNS(l,c,""+f)}}function Gr(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function KH(o){var l=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function gq(o){var l=KH(o)?"checked":"value",c=Object.getOwnPropertyDescriptor(o.constructor.prototype,l),f=""+o[l];if(!o.hasOwnProperty(l)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,v=c.set;return Object.defineProperty(o,l,{configurable:!0,get:function(){return m.call(this)},set:function(b){f=""+b,v.call(this,b)}}),Object.defineProperty(o,l,{enumerable:c.enumerable}),{getValue:function(){return f},setValue:function(b){f=""+b},stopTracking:function(){o._valueTracker=null,delete o[l]}}}}function Qp(o){o._valueTracker||(o._valueTracker=gq(o))}function XH(o){if(!o)return!1;var l=o._valueTracker;if(!l)return!0;var c=l.getValue(),f="";return o&&(f=KH(o)?o.checked?"true":"false":o.value),o=f,o!==c?(l.setValue(o),!0):!1}function Jp(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var mq=/[\n"\\]/g;function qr(o){return o.replace(mq,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function JS(o,l,c,f,m,v,b,P){o.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?o.type=b:o.removeAttribute("type"),l!=null?b==="number"?(l===0&&o.value===""||o.value!=l)&&(o.value=""+Gr(l)):o.value!==""+Gr(l)&&(o.value=""+Gr(l)):b!=="submit"&&b!=="reset"||o.removeAttribute("value"),l!=null?eb(o,b,Gr(l)):c!=null?eb(o,b,Gr(c)):f!=null&&o.removeAttribute("value"),m==null&&v!=null&&(o.defaultChecked=!!v),m!=null&&(o.checked=m&&typeof m!="function"&&typeof m!="symbol"),P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?o.name=""+Gr(P):o.removeAttribute("name")}function ZH(o,l,c,f,m,v,b,P){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(o.type=v),l!=null||c!=null){if(!(v!=="submit"&&v!=="reset"||l!=null))return;c=c!=null?""+Gr(c):"",l=l!=null?""+Gr(l):c,P||l===o.value||(o.value=l),o.defaultValue=l}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,o.checked=P?o.checked:!!f,o.defaultChecked=!!f,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(o.name=b)}function eb(o,l,c){l==="number"&&Jp(o.ownerDocument)===o||o.defaultValue===""+c||(o.defaultValue=""+c)}function dh(o,l,c,f){if(o=o.options,l){l={};for(var m=0;m<c.length;m++)l["$"+c[m]]=!0;for(c=0;c<o.length;c++)m=l.hasOwnProperty("$"+o[c].value),o[c].selected!==m&&(o[c].selected=m),m&&f&&(o[c].defaultSelected=!0)}else{for(c=""+Gr(c),l=null,m=0;m<o.length;m++){if(o[m].value===c){o[m].selected=!0,f&&(o[m].defaultSelected=!0);return}l!==null||o[m].disabled||(l=o[m])}l!==null&&(l.selected=!0)}}function QH(o,l,c){if(l!=null&&(l=""+Gr(l),l!==o.value&&(o.value=l),c==null)){o.defaultValue!==l&&(o.defaultValue=l);return}o.defaultValue=c!=null?""+Gr(c):""}function JH(o,l,c,f){if(l==null){if(f!=null){if(c!=null)throw Error(i(92));if(T(f)){if(1<f.length)throw Error(i(93));f=f[0]}c=f}c==null&&(c=""),l=c}c=Gr(l),o.defaultValue=c,f=o.textContent,f===c&&f!==""&&f!==null&&(o.value=f)}function fh(o,l){if(l){var c=o.firstChild;if(c&&c===o.lastChild&&c.nodeType===3){c.nodeValue=l;return}}o.textContent=l}var pq=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function eP(o,l,c){var f=l.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?o.setProperty(l,""):l==="float"?o.cssFloat="":o[l]="":f?o.setProperty(l,c):typeof c!="number"||c===0||pq.has(l)?l==="float"?o.cssFloat=c:o[l]=(""+c).trim():o[l]=c+"px"}function tP(o,l,c){if(l!=null&&typeof l!="object")throw Error(i(62));if(o=o.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||l!=null&&l.hasOwnProperty(f)||(f.indexOf("--")===0?o.setProperty(f,""):f==="float"?o.cssFloat="":o[f]="");for(var m in l)f=l[m],l.hasOwnProperty(m)&&c[m]!==f&&eP(o,m,f)}else for(var v in l)l.hasOwnProperty(v)&&eP(o,v,l[v])}function tb(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vq=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wq=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ev(o){return wq.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var nb=null;function ib(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var gh=null,mh=null;function nP(o){var l=He(o);if(l&&(o=l.stateNode)){var c=o[gn]||null;e:switch(o=l.stateNode,l.type){case"input":if(JS(o,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),l=c.name,c.type==="radio"&&l!=null){for(c=o;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+qr(""+l)+'"][type="radio"]'),l=0;l<c.length;l++){var f=c[l];if(f!==o&&f.form===o.form){var m=f[gn]||null;if(!m)throw Error(i(90));JS(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(l=0;l<c.length;l++)f=c[l],f.form===o.form&&XH(f)}break e;case"textarea":QH(o,c.value,c.defaultValue);break e;case"select":l=c.value,l!=null&&dh(o,!!c.multiple,l,!1)}}}var rb=!1;function iP(o,l,c){if(rb)return o(l,c);rb=!0;try{var f=o(l);return f}finally{if(rb=!1,(gh!==null||mh!==null)&&(kv(),gh&&(l=gh,o=mh,mh=gh=null,nP(l),o)))for(l=0;l<o.length;l++)nP(o[l])}}function _f(o,l){var c=o.stateNode;if(c===null)return null;var f=c[gn]||null;if(f===null)return null;c=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(o=o.type,f=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!f;break e;default:o=!1}if(o)return null;if(c&&typeof c!="function")throw Error(i(231,l,typeof c));return c}var sb=!1;if(Yr)try{var Mf={};Object.defineProperty(Mf,"passive",{get:function(){sb=!0}}),window.addEventListener("test",Mf,Mf),window.removeEventListener("test",Mf,Mf)}catch{sb=!1}var hl=null,ob=null,tv=null;function rP(){if(tv)return tv;var o,l=ob,c=l.length,f,m="value"in hl?hl.value:hl.textContent,v=m.length;for(o=0;o<c&&l[o]===m[o];o++);var b=c-o;for(f=1;f<=b&&l[c-f]===m[v-f];f++);return tv=m.slice(o,1<f?1-f:void 0)}function nv(o){var l=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&l===13&&(o=13)):o=l,o===10&&(o=13),32<=o||o===13?o:0}function iv(){return!0}function sP(){return!1}function rr(o){function l(c,f,m,v,b){this._reactName=c,this._targetInst=m,this.type=f,this.nativeEvent=v,this.target=b,this.currentTarget=null;for(var P in o)o.hasOwnProperty(P)&&(c=o[P],this[P]=c?c(v):v[P]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?iv:sP,this.isPropagationStopped=sP,this}return Q(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=iv)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=iv)},persist:function(){},isPersistent:iv}),l}var Ru={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rv=rr(Ru),Of=Q({},Ru,{view:0,detail:0}),yq=rr(Of),ab,lb,Af,sv=Q({},Of,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cb,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Af&&(Af&&o.type==="mousemove"?(ab=o.screenX-Af.screenX,lb=o.screenY-Af.screenY):lb=ab=0,Af=o),ab)},movementY:function(o){return"movementY"in o?o.movementY:lb}}),oP=rr(sv),Cq=Q({},sv,{dataTransfer:0}),Sq=rr(Cq),bq=Q({},Of,{relatedTarget:0}),ub=rr(bq),Rq=Q({},Ru,{animationName:0,elapsedTime:0,pseudoElement:0}),Eq=rr(Rq),Tq=Q({},Ru,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),_q=rr(Tq),Mq=Q({},Ru,{data:0}),aP=rr(Mq),Oq={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Aq={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xq={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hq(o){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(o):(o=xq[o])?!!l[o]:!1}function cb(){return Hq}var Pq=Q({},Of,{key:function(o){if(o.key){var l=Oq[o.key]||o.key;if(l!=="Unidentified")return l}return o.type==="keypress"?(o=nv(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Aq[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cb,charCode:function(o){return o.type==="keypress"?nv(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?nv(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Iq=rr(Pq),Nq=Q({},sv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lP=rr(Nq),Dq=Q({},Of,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cb}),Lq=rr(Dq),kq=Q({},Ru,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vq=rr(kq),$q=Q({},sv,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Fq=rr($q),Bq=Q({},Ru,{newState:0,oldState:0}),Wq=rr(Bq),Uq=[9,13,27,32],hb=Yr&&"CompositionEvent"in window,xf=null;Yr&&"documentMode"in document&&(xf=document.documentMode);var jq=Yr&&"TextEvent"in window&&!xf,uP=Yr&&(!hb||xf&&8<xf&&11>=xf),cP=" ",hP=!1;function dP(o,l){switch(o){case"keyup":return Uq.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fP(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ph=!1;function zq(o,l){switch(o){case"compositionend":return fP(l);case"keypress":return l.which!==32?null:(hP=!0,cP);case"textInput":return o=l.data,o===cP&&hP?null:o;default:return null}}function Yq(o,l){if(ph)return o==="compositionend"||!hb&&dP(o,l)?(o=rP(),tv=ob=hl=null,ph=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return uP&&l.locale!=="ko"?null:l.data;default:return null}}var Gq={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gP(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l==="input"?!!Gq[o.type]:l==="textarea"}function mP(o,l,c,f){gh?mh?mh.push(f):mh=[f]:gh=f,l=Wv(l,"onChange"),0<l.length&&(c=new rv("onChange","change",null,c,f),o.push({event:c,listeners:l}))}var Hf=null,Pf=null;function qq(o){BN(o,0)}function ov(o){var l=Ft(o);if(XH(l))return o}function pP(o,l){if(o==="change")return l}var vP=!1;if(Yr){var db;if(Yr){var fb="oninput"in document;if(!fb){var wP=document.createElement("div");wP.setAttribute("oninput","return;"),fb=typeof wP.oninput=="function"}db=fb}else db=!1;vP=db&&(!document.documentMode||9<document.documentMode)}function yP(){Hf&&(Hf.detachEvent("onpropertychange",CP),Pf=Hf=null)}function CP(o){if(o.propertyName==="value"&&ov(Pf)){var l=[];mP(l,Pf,o,ib(o)),iP(qq,l)}}function Kq(o,l,c){o==="focusin"?(yP(),Hf=l,Pf=c,Hf.attachEvent("onpropertychange",CP)):o==="focusout"&&yP()}function Xq(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return ov(Pf)}function Zq(o,l){if(o==="click")return ov(l)}function Qq(o,l){if(o==="input"||o==="change")return ov(l)}function Jq(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var Tr=typeof Object.is=="function"?Object.is:Jq;function If(o,l){if(Tr(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var c=Object.keys(o),f=Object.keys(l);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var m=c[f];if(!J.call(l,m)||!Tr(o[m],l[m]))return!1}return!0}function SP(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function bP(o,l){var c=SP(o);o=0;for(var f;c;){if(c.nodeType===3){if(f=o+c.textContent.length,o<=l&&f>=l)return{node:c,offset:l-o};o=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=SP(c)}}function RP(o,l){return o&&l?o===l?!0:o&&o.nodeType===3?!1:l&&l.nodeType===3?RP(o,l.parentNode):"contains"in o?o.contains(l):o.compareDocumentPosition?!!(o.compareDocumentPosition(l)&16):!1:!1}function EP(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var l=Jp(o.document);l instanceof o.HTMLIFrameElement;){try{var c=typeof l.contentWindow.location.href=="string"}catch{c=!1}if(c)o=l.contentWindow;else break;l=Jp(o.document)}return l}function gb(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l&&(l==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||l==="textarea"||o.contentEditable==="true")}function e3(o,l){var c=EP(l);l=o.focusedElem;var f=o.selectionRange;if(c!==l&&l&&l.ownerDocument&&RP(l.ownerDocument.documentElement,l)){if(f!==null&&gb(l)){if(o=f.start,c=f.end,c===void 0&&(c=o),"selectionStart"in l)l.selectionStart=o,l.selectionEnd=Math.min(c,l.value.length);else if(c=(o=l.ownerDocument||document)&&o.defaultView||window,c.getSelection){c=c.getSelection();var m=l.textContent.length,v=Math.min(f.start,m);f=f.end===void 0?v:Math.min(f.end,m),!c.extend&&v>f&&(m=f,f=v,v=m),m=bP(l,v);var b=bP(l,f);m&&b&&(c.rangeCount!==1||c.anchorNode!==m.node||c.anchorOffset!==m.offset||c.focusNode!==b.node||c.focusOffset!==b.offset)&&(o=o.createRange(),o.setStart(m.node,m.offset),c.removeAllRanges(),v>f?(c.addRange(o),c.extend(b.node,b.offset)):(o.setEnd(b.node,b.offset),c.addRange(o)))}}for(o=[],c=l;c=c.parentNode;)c.nodeType===1&&o.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<o.length;l++)c=o[l],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var t3=Yr&&"documentMode"in document&&11>=document.documentMode,vh=null,mb=null,Nf=null,pb=!1;function TP(o,l,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;pb||vh==null||vh!==Jp(f)||(f=vh,"selectionStart"in f&&gb(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Nf&&If(Nf,f)||(Nf=f,f=Wv(mb,"onSelect"),0<f.length&&(l=new rv("onSelect","select",null,l,c),o.push({event:l,listeners:f}),l.target=vh)))}function Eu(o,l){var c={};return c[o.toLowerCase()]=l.toLowerCase(),c["Webkit"+o]="webkit"+l,c["Moz"+o]="moz"+l,c}var wh={animationend:Eu("Animation","AnimationEnd"),animationiteration:Eu("Animation","AnimationIteration"),animationstart:Eu("Animation","AnimationStart"),transitionrun:Eu("Transition","TransitionRun"),transitionstart:Eu("Transition","TransitionStart"),transitioncancel:Eu("Transition","TransitionCancel"),transitionend:Eu("Transition","TransitionEnd")},vb={},_P={};Yr&&(_P=document.createElement("div").style,"AnimationEvent"in window||(delete wh.animationend.animation,delete wh.animationiteration.animation,delete wh.animationstart.animation),"TransitionEvent"in window||delete wh.transitionend.transition);function Tu(o){if(vb[o])return vb[o];if(!wh[o])return o;var l=wh[o],c;for(c in l)if(l.hasOwnProperty(c)&&c in _P)return vb[o]=l[c];return o}var MP=Tu("animationend"),OP=Tu("animationiteration"),AP=Tu("animationstart"),n3=Tu("transitionrun"),i3=Tu("transitionstart"),r3=Tu("transitioncancel"),xP=Tu("transitionend"),HP=new Map,PP="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Ms(o,l){HP.set(o,l),Er(l,[o])}var Kr=[],yh=0,wb=0;function av(){for(var o=yh,l=wb=yh=0;l<o;){var c=Kr[l];Kr[l++]=null;var f=Kr[l];Kr[l++]=null;var m=Kr[l];Kr[l++]=null;var v=Kr[l];if(Kr[l++]=null,f!==null&&m!==null){var b=f.pending;b===null?m.next=m:(m.next=b.next,b.next=m),f.pending=m}v!==0&&IP(c,m,v)}}function lv(o,l,c,f){Kr[yh++]=o,Kr[yh++]=l,Kr[yh++]=c,Kr[yh++]=f,wb|=f,o.lanes|=f,o=o.alternate,o!==null&&(o.lanes|=f)}function yb(o,l,c,f){return lv(o,l,c,f),uv(o)}function dl(o,l){return lv(o,null,null,l),uv(o)}function IP(o,l,c){o.lanes|=c;var f=o.alternate;f!==null&&(f.lanes|=c);for(var m=!1,v=o.return;v!==null;)v.childLanes|=c,f=v.alternate,f!==null&&(f.childLanes|=c),v.tag===22&&(o=v.stateNode,o===null||o._visibility&1||(m=!0)),o=v,v=v.return;m&&l!==null&&o.tag===3&&(v=o.stateNode,m=31-Ke(c),v=v.hiddenUpdates,o=v[m],o===null?v[m]=[l]:o.push(l),l.lane=c|536870912)}function uv(o){if(50<sg)throw sg=0,TR=null,Error(i(185));for(var l=o.return;l!==null;)o=l,l=o.return;return o.tag===3?o.stateNode:null}var Ch={},NP=new WeakMap;function Xr(o,l){if(typeof o=="object"&&o!==null){var c=NP.get(o);return c!==void 0?c:(l={value:o,source:l,stack:Ce(l)},NP.set(o,l),l)}return{value:o,source:l,stack:Ce(l)}}var Sh=[],bh=0,cv=null,hv=0,Zr=[],Qr=0,_u=null,ra=1,sa="";function Mu(o,l){Sh[bh++]=hv,Sh[bh++]=cv,cv=o,hv=l}function DP(o,l,c){Zr[Qr++]=ra,Zr[Qr++]=sa,Zr[Qr++]=_u,_u=o;var f=ra;o=sa;var m=32-Ke(f)-1;f&=~(1<<m),c+=1;var v=32-Ke(l)+m;if(30<v){var b=m-m%5;v=(f&(1<<b)-1).toString(32),f>>=b,m-=b,ra=1<<32-Ke(l)+m|c<<m|f,sa=v+o}else ra=1<<v|c<<m|f,sa=o}function Cb(o){o.return!==null&&(Mu(o,1),DP(o,1,0))}function Sb(o){for(;o===cv;)cv=Sh[--bh],Sh[bh]=null,hv=Sh[--bh],Sh[bh]=null;for(;o===_u;)_u=Zr[--Qr],Zr[Qr]=null,sa=Zr[--Qr],Zr[Qr]=null,ra=Zr[--Qr],Zr[Qr]=null}var Bi=null,bi=null,Pt=!1,Os=null,lo=!1,bb=Error(i(519));function Ou(o){var l=Error(i(418,""));throw kf(Xr(l,o)),bb}function LP(o){var l=o.stateNode,c=o.type,f=o.memoizedProps;switch(l[ri]=o,l[gn]=f,c){case"dialog":Tt("cancel",l),Tt("close",l);break;case"iframe":case"object":case"embed":Tt("load",l);break;case"video":case"audio":for(c=0;c<ag.length;c++)Tt(ag[c],l);break;case"source":Tt("error",l);break;case"img":case"image":case"link":Tt("error",l),Tt("load",l);break;case"details":Tt("toggle",l);break;case"input":Tt("invalid",l),ZH(l,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),Qp(l);break;case"select":Tt("invalid",l);break;case"textarea":Tt("invalid",l),JH(l,f.value,f.defaultValue,f.children),Qp(l)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||l.textContent===""+c||f.suppressHydrationWarning===!0||zN(l.textContent,c)?(f.popover!=null&&(Tt("beforetoggle",l),Tt("toggle",l)),f.onScroll!=null&&Tt("scroll",l),f.onScrollEnd!=null&&Tt("scrollend",l),f.onClick!=null&&(l.onclick=Uv),l=!0):l=!1,l||Ou(o)}function kP(o){for(Bi=o.return;Bi;)switch(Bi.tag){case 3:case 27:lo=!0;return;case 5:case 13:lo=!1;return;default:Bi=Bi.return}}function Df(o){if(o!==Bi)return!1;if(!Pt)return kP(o),Pt=!0,!1;var l=!1,c;if((c=o.tag!==3&&o.tag!==27)&&((c=o.tag===5)&&(c=o.type,c=!(c!=="form"&&c!=="button")||WR(o.type,o.memoizedProps)),c=!c),c&&(l=!0),l&&bi&&Ou(o),kP(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(i(317));e:{for(o=o.nextSibling,l=0;o;){if(o.nodeType===8)if(c=o.data,c==="/$"){if(l===0){bi=xs(o.nextSibling);break e}l--}else c!=="$"&&c!=="$!"&&c!=="$?"||l++;o=o.nextSibling}bi=null}}else bi=Bi?xs(o.stateNode.nextSibling):null;return!0}function Lf(){bi=Bi=null,Pt=!1}function kf(o){Os===null?Os=[o]:Os.push(o)}var Vf=Error(i(460)),VP=Error(i(474)),Rb={then:function(){}};function $P(o){return o=o.status,o==="fulfilled"||o==="rejected"}function dv(){}function FP(o,l,c){switch(c=o[c],c===void 0?o.push(l):c!==l&&(l.then(dv,dv),l=c),l.status){case"fulfilled":return l.value;case"rejected":throw o=l.reason,o===Vf?Error(i(483)):o;default:if(typeof l.status=="string")l.then(dv,dv);else{if(o=nn,o!==null&&100<o.shellSuspendCounter)throw Error(i(482));o=l,o.status="pending",o.then(function(f){if(l.status==="pending"){var m=l;m.status="fulfilled",m.value=f}},function(f){if(l.status==="pending"){var m=l;m.status="rejected",m.reason=f}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw o=l.reason,o===Vf?Error(i(483)):o}throw $f=l,Vf}}var $f=null;function BP(){if($f===null)throw Error(i(459));var o=$f;return $f=null,o}var Rh=null,Ff=0;function fv(o){var l=Ff;return Ff+=1,Rh===null&&(Rh=[]),FP(Rh,o,l)}function Bf(o,l){l=l.props.ref,o.ref=l!==void 0?l:null}function gv(o,l){throw l.$$typeof===s?Error(i(525)):(o=Object.prototype.toString.call(l),Error(i(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o)))}function WP(o){var l=o._init;return l(o._payload)}function UP(o){function l(te,G){if(o){var ie=te.deletions;ie===null?(te.deletions=[G],te.flags|=16):ie.push(G)}}function c(te,G){if(!o)return null;for(;G!==null;)l(te,G),G=G.sibling;return null}function f(te){for(var G=new Map;te!==null;)te.key!==null?G.set(te.key,te):G.set(te.index,te),te=te.sibling;return G}function m(te,G){return te=El(te,G),te.index=0,te.sibling=null,te}function v(te,G,ie){return te.index=ie,o?(ie=te.alternate,ie!==null?(ie=ie.index,ie<G?(te.flags|=33554434,G):ie):(te.flags|=33554434,G)):(te.flags|=1048576,G)}function b(te){return o&&te.alternate===null&&(te.flags|=33554434),te}function P(te,G,ie,ge){return G===null||G.tag!==6?(G=vR(ie,te.mode,ge),G.return=te,G):(G=m(G,ie),G.return=te,G)}function N(te,G,ie,ge){var Le=ie.type;return Le===h?he(te,G,ie.props.children,ge,ie.key):G!==null&&(G.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===x&&WP(Le)===G.type)?(G=m(G,ie.props),Bf(G,ie),G.return=te,G):(G=Pv(ie.type,ie.key,ie.props,null,te.mode,ge),Bf(G,ie),G.return=te,G)}function K(te,G,ie,ge){return G===null||G.tag!==4||G.stateNode.containerInfo!==ie.containerInfo||G.stateNode.implementation!==ie.implementation?(G=wR(ie,te.mode,ge),G.return=te,G):(G=m(G,ie.children||[]),G.return=te,G)}function he(te,G,ie,ge,Le){return G===null||G.tag!==7?(G=Vu(ie,te.mode,ge,Le),G.return=te,G):(G=m(G,ie),G.return=te,G)}function we(te,G,ie){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=vR(""+G,te.mode,ie),G.return=te,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case a:return ie=Pv(G.type,G.key,G.props,null,te.mode,ie),Bf(ie,G),ie.return=te,ie;case u:return G=wR(G,te.mode,ie),G.return=te,G;case x:var ge=G._init;return G=ge(G._payload),we(te,G,ie)}if(T(G)||L(G))return G=Vu(G,te.mode,ie,null),G.return=te,G;if(typeof G.then=="function")return we(te,fv(G),ie);if(G.$$typeof===y)return we(te,Av(te,G),ie);gv(te,G)}return null}function oe(te,G,ie,ge){var Le=G!==null?G.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Le!==null?null:P(te,G,""+ie,ge);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case a:return ie.key===Le?N(te,G,ie,ge):null;case u:return ie.key===Le?K(te,G,ie,ge):null;case x:return Le=ie._init,ie=Le(ie._payload),oe(te,G,ie,ge)}if(T(ie)||L(ie))return Le!==null?null:he(te,G,ie,ge,null);if(typeof ie.then=="function")return oe(te,G,fv(ie),ge);if(ie.$$typeof===y)return oe(te,G,Av(te,ie),ge);gv(te,ie)}return null}function ue(te,G,ie,ge,Le){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return te=te.get(ie)||null,P(G,te,""+ge,Le);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case a:return te=te.get(ge.key===null?ie:ge.key)||null,N(G,te,ge,Le);case u:return te=te.get(ge.key===null?ie:ge.key)||null,K(G,te,ge,Le);case x:var vt=ge._init;return ge=vt(ge._payload),ue(te,G,ie,ge,Le)}if(T(ge)||L(ge))return te=te.get(ie)||null,he(G,te,ge,Le,null);if(typeof ge.then=="function")return ue(te,G,ie,fv(ge),Le);if(ge.$$typeof===y)return ue(te,G,ie,Av(G,ge),Le);gv(G,ge)}return null}function Be(te,G,ie,ge){for(var Le=null,vt=null,Ue=G,Ze=G=0,mi=null;Ue!==null&&Ze<ie.length;Ze++){Ue.index>Ze?(mi=Ue,Ue=null):mi=Ue.sibling;var It=oe(te,Ue,ie[Ze],ge);if(It===null){Ue===null&&(Ue=mi);break}o&&Ue&&It.alternate===null&&l(te,Ue),G=v(It,G,Ze),vt===null?Le=It:vt.sibling=It,vt=It,Ue=mi}if(Ze===ie.length)return c(te,Ue),Pt&&Mu(te,Ze),Le;if(Ue===null){for(;Ze<ie.length;Ze++)Ue=we(te,ie[Ze],ge),Ue!==null&&(G=v(Ue,G,Ze),vt===null?Le=Ue:vt.sibling=Ue,vt=Ue);return Pt&&Mu(te,Ze),Le}for(Ue=f(Ue);Ze<ie.length;Ze++)mi=ue(Ue,te,Ze,ie[Ze],ge),mi!==null&&(o&&mi.alternate!==null&&Ue.delete(mi.key===null?Ze:mi.key),G=v(mi,G,Ze),vt===null?Le=mi:vt.sibling=mi,vt=mi);return o&&Ue.forEach(function(Hl){return l(te,Hl)}),Pt&&Mu(te,Ze),Le}function tt(te,G,ie,ge){if(ie==null)throw Error(i(151));for(var Le=null,vt=null,Ue=G,Ze=G=0,mi=null,It=ie.next();Ue!==null&&!It.done;Ze++,It=ie.next()){Ue.index>Ze?(mi=Ue,Ue=null):mi=Ue.sibling;var Hl=oe(te,Ue,It.value,ge);if(Hl===null){Ue===null&&(Ue=mi);break}o&&Ue&&Hl.alternate===null&&l(te,Ue),G=v(Hl,G,Ze),vt===null?Le=Hl:vt.sibling=Hl,vt=Hl,Ue=mi}if(It.done)return c(te,Ue),Pt&&Mu(te,Ze),Le;if(Ue===null){for(;!It.done;Ze++,It=ie.next())It=we(te,It.value,ge),It!==null&&(G=v(It,G,Ze),vt===null?Le=It:vt.sibling=It,vt=It);return Pt&&Mu(te,Ze),Le}for(Ue=f(Ue);!It.done;Ze++,It=ie.next())It=ue(Ue,te,Ze,It.value,ge),It!==null&&(o&&It.alternate!==null&&Ue.delete(It.key===null?Ze:It.key),G=v(It,G,Ze),vt===null?Le=It:vt.sibling=It,vt=It);return o&&Ue.forEach(function(w4){return l(te,w4)}),Pt&&Mu(te,Ze),Le}function Pn(te,G,ie,ge){if(typeof ie=="object"&&ie!==null&&ie.type===h&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case a:e:{for(var Le=ie.key;G!==null;){if(G.key===Le){if(Le=ie.type,Le===h){if(G.tag===7){c(te,G.sibling),ge=m(G,ie.props.children),ge.return=te,te=ge;break e}}else if(G.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===x&&WP(Le)===G.type){c(te,G.sibling),ge=m(G,ie.props),Bf(ge,ie),ge.return=te,te=ge;break e}c(te,G);break}else l(te,G);G=G.sibling}ie.type===h?(ge=Vu(ie.props.children,te.mode,ge,ie.key),ge.return=te,te=ge):(ge=Pv(ie.type,ie.key,ie.props,null,te.mode,ge),Bf(ge,ie),ge.return=te,te=ge)}return b(te);case u:e:{for(Le=ie.key;G!==null;){if(G.key===Le)if(G.tag===4&&G.stateNode.containerInfo===ie.containerInfo&&G.stateNode.implementation===ie.implementation){c(te,G.sibling),ge=m(G,ie.children||[]),ge.return=te,te=ge;break e}else{c(te,G);break}else l(te,G);G=G.sibling}ge=wR(ie,te.mode,ge),ge.return=te,te=ge}return b(te);case x:return Le=ie._init,ie=Le(ie._payload),Pn(te,G,ie,ge)}if(T(ie))return Be(te,G,ie,ge);if(L(ie)){if(Le=L(ie),typeof Le!="function")throw Error(i(150));return ie=Le.call(ie),tt(te,G,ie,ge)}if(typeof ie.then=="function")return Pn(te,G,fv(ie),ge);if(ie.$$typeof===y)return Pn(te,G,Av(te,ie),ge);gv(te,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,G!==null&&G.tag===6?(c(te,G.sibling),ge=m(G,ie),ge.return=te,te=ge):(c(te,G),ge=vR(ie,te.mode,ge),ge.return=te,te=ge),b(te)):c(te,G)}return function(te,G,ie,ge){try{Ff=0;var Le=Pn(te,G,ie,ge);return Rh=null,Le}catch(Ue){if(Ue===Vf)throw Ue;var vt=ns(29,Ue,null,te.mode);return vt.lanes=ge,vt.return=te,vt}finally{}}}var Au=UP(!0),jP=UP(!1),Eh=ae(null),mv=ae(0);function zP(o,l){o=pa,M(mv,o),M(Eh,l),pa=o|l.baseLanes}function Eb(){M(mv,pa),M(Eh,Eh.current)}function Tb(){pa=mv.current,be(Eh),be(mv)}var Jr=ae(null),uo=null;function fl(o){var l=o.alternate;M(si,si.current&1),M(Jr,o),uo===null&&(l===null||Eh.current!==null||l.memoizedState!==null)&&(uo=o)}function YP(o){if(o.tag===22){if(M(si,si.current),M(Jr,o),uo===null){var l=o.alternate;l!==null&&l.memoizedState!==null&&(uo=o)}}else gl()}function gl(){M(si,si.current),M(Jr,Jr.current)}function oa(o){be(Jr),uo===o&&(uo=null),be(si)}var si=ae(0);function pv(o){for(var l=o;l!==null;){if(l.tag===13){var c=l.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var s3=typeof AbortController<"u"?AbortController:function(){var o=[],l=this.signal={aborted:!1,addEventListener:function(c,f){o.push(f)}};this.abort=function(){l.aborted=!0,o.forEach(function(c){return c()})}},o3=t.unstable_scheduleCallback,a3=t.unstable_NormalPriority,oi={$$typeof:y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function _b(){return{controller:new s3,data:new Map,refCount:0}}function Wf(o){o.refCount--,o.refCount===0&&o3(a3,function(){o.controller.abort()})}var Uf=null,Mb=0,Th=0,_h=null;function l3(o,l){if(Uf===null){var c=Uf=[];Mb=0,Th=IR(),_h={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Mb++,l.then(GP,GP),l}function GP(){if(--Mb===0&&Uf!==null){_h!==null&&(_h.status="fulfilled");var o=Uf;Uf=null,Th=0,_h=null;for(var l=0;l<o.length;l++)(0,o[l])()}}function u3(o,l){var c=[],f={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return o.then(function(){f.status="fulfilled",f.value=l;for(var m=0;m<c.length;m++)(0,c[m])(l)},function(m){for(f.status="rejected",f.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),f}var qP=se.S;se.S=function(o,l){typeof l=="object"&&l!==null&&typeof l.then=="function"&&l3(o,l),qP!==null&&qP(o,l)};var xu=ae(null);function Ob(){var o=xu.current;return o!==null?o:nn.pooledCache}function vv(o,l){l===null?M(xu,xu.current):M(xu,l.pool)}function KP(){var o=Ob();return o===null?null:{parent:oi._currentValue,pool:o}}var ml=0,mt=null,Gt=null,Kn=null,wv=!1,Mh=!1,Hu=!1,yv=0,jf=0,Oh=null,c3=0;function Bn(){throw Error(i(321))}function Ab(o,l){if(l===null)return!1;for(var c=0;c<l.length&&c<o.length;c++)if(!Tr(o[c],l[c]))return!1;return!0}function xb(o,l,c,f,m,v){return ml=v,mt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,se.H=o===null||o.memoizedState===null?Pu:pl,Hu=!1,v=c(f,m),Hu=!1,Mh&&(v=ZP(l,c,f,m)),XP(o),v}function XP(o){se.H=co;var l=Gt!==null&&Gt.next!==null;if(ml=0,Kn=Gt=mt=null,wv=!1,jf=0,Oh=null,l)throw Error(i(300));o===null||fi||(o=o.dependencies,o!==null&&Ov(o)&&(fi=!0))}function ZP(o,l,c,f){mt=o;var m=0;do{if(Mh&&(Oh=null),jf=0,Mh=!1,25<=m)throw Error(i(301));if(m+=1,Kn=Gt=null,o.updateQueue!=null){var v=o.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}se.H=Iu,v=l(c,f)}while(Mh);return v}function h3(){var o=se.H,l=o.useState()[0];return l=typeof l.then=="function"?zf(l):l,o=o.useState()[0],(Gt!==null?Gt.memoizedState:null)!==o&&(mt.flags|=1024),l}function Hb(){var o=yv!==0;return yv=0,o}function Pb(o,l,c){l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~c}function Ib(o){if(wv){for(o=o.memoizedState;o!==null;){var l=o.queue;l!==null&&(l.pending=null),o=o.next}wv=!1}ml=0,Kn=Gt=mt=null,Mh=!1,jf=yv=0,Oh=null}function sr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kn===null?mt.memoizedState=Kn=o:Kn=Kn.next=o,Kn}function Xn(){if(Gt===null){var o=mt.alternate;o=o!==null?o.memoizedState:null}else o=Gt.next;var l=Kn===null?mt.memoizedState:Kn.next;if(l!==null)Kn=l,Gt=o;else{if(o===null)throw mt.alternate===null?Error(i(467)):Error(i(310));Gt=o,o={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Kn===null?mt.memoizedState=Kn=o:Kn=Kn.next=o}return Kn}var Cv;Cv=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function zf(o){var l=jf;return jf+=1,Oh===null&&(Oh=[]),o=FP(Oh,o,l),l=mt,(Kn===null?l.memoizedState:Kn.next)===null&&(l=l.alternate,se.H=l===null||l.memoizedState===null?Pu:pl),o}function Sv(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return zf(o);if(o.$$typeof===y)return xi(o)}throw Error(i(438,String(o)))}function Nb(o){var l=null,c=mt.updateQueue;if(c!==null&&(l=c.memoCache),l==null){var f=mt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(l={data:f.data.map(function(m){return m.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),c===null&&(c=Cv(),mt.updateQueue=c),c.memoCache=l,c=l.data[l.index],c===void 0)for(c=l.data[l.index]=Array(o),f=0;f<o;f++)c[f]=$;return l.index++,c}function aa(o,l){return typeof l=="function"?l(o):l}function bv(o){var l=Xn();return Db(l,Gt,o)}function Db(o,l,c){var f=o.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=c;var m=o.baseQueue,v=f.pending;if(v!==null){if(m!==null){var b=m.next;m.next=v.next,v.next=b}l.baseQueue=m=v,f.pending=null}if(v=o.baseState,m===null)o.memoizedState=v;else{l=m.next;var P=b=null,N=null,K=l,he=!1;do{var we=K.lane&-536870913;if(we!==K.lane?(Mt&we)===we:(ml&we)===we){var oe=K.revertLane;if(oe===0)N!==null&&(N=N.next={lane:0,revertLane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),we===Th&&(he=!0);else if((ml&oe)===oe){K=K.next,oe===Th&&(he=!0);continue}else we={lane:0,revertLane:K.revertLane,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},N===null?(P=N=we,b=v):N=N.next=we,mt.lanes|=oe,Tl|=oe;we=K.action,Hu&&c(v,we),v=K.hasEagerState?K.eagerState:c(v,we)}else oe={lane:we,revertLane:K.revertLane,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},N===null?(P=N=oe,b=v):N=N.next=oe,mt.lanes|=we,Tl|=we;K=K.next}while(K!==null&&K!==l);if(N===null?b=v:N.next=P,!Tr(v,o.memoizedState)&&(fi=!0,he&&(c=_h,c!==null)))throw c;o.memoizedState=v,o.baseState=b,o.baseQueue=N,f.lastRenderedState=v}return m===null&&(f.lanes=0),[o.memoizedState,f.dispatch]}function Lb(o){var l=Xn(),c=l.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=c.dispatch,m=c.pending,v=l.memoizedState;if(m!==null){c.pending=null;var b=m=m.next;do v=o(v,b.action),b=b.next;while(b!==m);Tr(v,l.memoizedState)||(fi=!0),l.memoizedState=v,l.baseQueue===null&&(l.baseState=v),c.lastRenderedState=v}return[v,f]}function QP(o,l,c){var f=mt,m=Xn(),v=Pt;if(v){if(c===void 0)throw Error(i(407));c=c()}else c=l();var b=!Tr((Gt||m).memoizedState,c);if(b&&(m.memoizedState=c,fi=!0),m=m.queue,$b(tI.bind(null,f,m,o),[o]),m.getSnapshot!==l||b||Kn!==null&&Kn.memoizedState.tag&1){if(f.flags|=2048,Ah(9,eI.bind(null,f,m,c,l),{destroy:void 0},null),nn===null)throw Error(i(349));v||(ml&60)!==0||JP(f,l,c)}return c}function JP(o,l,c){o.flags|=16384,o={getSnapshot:l,value:c},l=mt.updateQueue,l===null?(l=Cv(),mt.updateQueue=l,l.stores=[o]):(c=l.stores,c===null?l.stores=[o]:c.push(o))}function eI(o,l,c,f){l.value=c,l.getSnapshot=f,nI(l)&&iI(o)}function tI(o,l,c){return c(function(){nI(l)&&iI(o)})}function nI(o){var l=o.getSnapshot;o=o.value;try{var c=l();return!Tr(o,c)}catch{return!0}}function iI(o){var l=dl(o,2);l!==null&&Wi(l,o,2)}function kb(o){var l=sr();if(typeof o=="function"){var c=o;if(o=c(),Hu){gt(!0);try{c()}finally{gt(!1)}}}return l.memoizedState=l.baseState=o,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:aa,lastRenderedState:o},l}function rI(o,l,c,f){return o.baseState=c,Db(o,Gt,typeof f=="function"?f:aa)}function d3(o,l,c,f,m){if(Tv(o))throw Error(i(485));if(o=l.action,o!==null){var v={payload:m,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){v.listeners.push(b)}};se.T!==null?c(!0):v.isTransition=!1,f(v),c=l.pending,c===null?(v.next=l.pending=v,sI(l,v)):(v.next=c.next,l.pending=c.next=v)}}function sI(o,l){var c=l.action,f=l.payload,m=o.state;if(l.isTransition){var v=se.T,b={};se.T=b;try{var P=c(m,f),N=se.S;N!==null&&N(b,P),oI(o,l,P)}catch(K){Vb(o,l,K)}finally{se.T=v}}else try{v=c(m,f),oI(o,l,v)}catch(K){Vb(o,l,K)}}function oI(o,l,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){aI(o,l,f)},function(f){return Vb(o,l,f)}):aI(o,l,c)}function aI(o,l,c){l.status="fulfilled",l.value=c,lI(l),o.state=c,l=o.pending,l!==null&&(c=l.next,c===l?o.pending=null:(c=c.next,l.next=c,sI(o,c)))}function Vb(o,l,c){var f=o.pending;if(o.pending=null,f!==null){f=f.next;do l.status="rejected",l.reason=c,lI(l),l=l.next;while(l!==f)}o.action=null}function lI(o){o=o.listeners;for(var l=0;l<o.length;l++)(0,o[l])()}function uI(o,l){return l}function cI(o,l){if(Pt){var c=nn.formState;if(c!==null){e:{var f=mt;if(Pt){if(bi){t:{for(var m=bi,v=lo;m.nodeType!==8;){if(!v){m=null;break t}if(m=xs(m.nextSibling),m===null){m=null;break t}}v=m.data,m=v==="F!"||v==="F"?m:null}if(m){bi=xs(m.nextSibling),f=m.data==="F!";break e}}Ou(f)}f=!1}f&&(l=c[0])}}return c=sr(),c.memoizedState=c.baseState=l,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:uI,lastRenderedState:l},c.queue=f,c=OI.bind(null,mt,f),f.dispatch=c,f=kb(!1),v=jb.bind(null,mt,!1,f.queue),f=sr(),m={state:l,dispatch:null,action:o,pending:null},f.queue=m,c=d3.bind(null,mt,m,v,c),m.dispatch=c,f.memoizedState=o,[l,c,!1]}function hI(o){var l=Xn();return dI(l,Gt,o)}function dI(o,l,c){l=Db(o,l,uI)[0],o=bv(aa)[0],l=typeof l=="object"&&l!==null&&typeof l.then=="function"?zf(l):l;var f=Xn(),m=f.queue,v=m.dispatch;return c!==f.memoizedState&&(mt.flags|=2048,Ah(9,f3.bind(null,m,c),{destroy:void 0},null)),[l,v,o]}function f3(o,l){o.action=l}function fI(o){var l=Xn(),c=Gt;if(c!==null)return dI(l,c,o);Xn(),l=l.memoizedState,c=Xn();var f=c.queue.dispatch;return c.memoizedState=o,[l,f,!1]}function Ah(o,l,c,f){return o={tag:o,create:l,inst:c,deps:f,next:null},l=mt.updateQueue,l===null&&(l=Cv(),mt.updateQueue=l),c=l.lastEffect,c===null?l.lastEffect=o.next=o:(f=c.next,c.next=o,o.next=f,l.lastEffect=o),o}function gI(){return Xn().memoizedState}function Rv(o,l,c,f){var m=sr();mt.flags|=o,m.memoizedState=Ah(1|l,c,{destroy:void 0},f===void 0?null:f)}function Ev(o,l,c,f){var m=Xn();f=f===void 0?null:f;var v=m.memoizedState.inst;Gt!==null&&f!==null&&Ab(f,Gt.memoizedState.deps)?m.memoizedState=Ah(l,c,v,f):(mt.flags|=o,m.memoizedState=Ah(1|l,c,v,f))}function mI(o,l){Rv(8390656,8,o,l)}function $b(o,l){Ev(2048,8,o,l)}function pI(o,l){return Ev(4,2,o,l)}function vI(o,l){return Ev(4,4,o,l)}function wI(o,l){if(typeof l=="function"){o=o();var c=l(o);return function(){typeof c=="function"?c():l(null)}}if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function yI(o,l,c){c=c!=null?c.concat([o]):null,Ev(4,4,wI.bind(null,l,o),c)}function Fb(){}function CI(o,l){var c=Xn();l=l===void 0?null:l;var f=c.memoizedState;return l!==null&&Ab(l,f[1])?f[0]:(c.memoizedState=[o,l],o)}function SI(o,l){var c=Xn();l=l===void 0?null:l;var f=c.memoizedState;if(l!==null&&Ab(l,f[1]))return f[0];if(f=o(),Hu){gt(!0);try{o()}finally{gt(!1)}}return c.memoizedState=[f,l],f}function Bb(o,l,c){return c===void 0||(ml&1073741824)!==0?o.memoizedState=l:(o.memoizedState=c,o=RN(),mt.lanes|=o,Tl|=o,c)}function bI(o,l,c,f){return Tr(c,l)?c:Eh.current!==null?(o=Bb(o,c,f),Tr(o,l)||(fi=!0),o):(ml&42)===0?(fi=!0,o.memoizedState=c):(o=RN(),mt.lanes|=o,Tl|=o,l)}function RI(o,l,c,f,m){var v=A.p;A.p=v!==0&&8>v?v:8;var b=se.T,P={};se.T=P,jb(o,!1,l,c);try{var N=m(),K=se.S;if(K!==null&&K(P,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var he=u3(N,f);Yf(o,l,he,Ar(o))}else Yf(o,l,f,Ar(o))}catch(we){Yf(o,l,{then:function(){},status:"rejected",reason:we},Ar())}finally{A.p=v,se.T=b}}function g3(){}function Wb(o,l,c,f){if(o.tag!==5)throw Error(i(476));var m=EI(o).queue;RI(o,m,l,k,c===null?g3:function(){return TI(o),c(f)})}function EI(o){var l=o.memoizedState;if(l!==null)return l;l={memoizedState:k,baseState:k,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:aa,lastRenderedState:k},next:null};var c={};return l.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:aa,lastRenderedState:c},next:null},o.memoizedState=l,o=o.alternate,o!==null&&(o.memoizedState=l),l}function TI(o){var l=EI(o).next.queue;Yf(o,l,{},Ar())}function Ub(){return xi(dg)}function _I(){return Xn().memoizedState}function MI(){return Xn().memoizedState}function m3(o){for(var l=o.return;l!==null;){switch(l.tag){case 24:case 3:var c=Ar();o=yl(c);var f=Cl(l,o,c);f!==null&&(Wi(f,l,c),Kf(f,l,c)),l={cache:_b()},o.payload=l;return}l=l.return}}function p3(o,l,c){var f=Ar();c={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Tv(o)?AI(l,c):(c=yb(o,l,c,f),c!==null&&(Wi(c,o,f),xI(c,l,f)))}function OI(o,l,c){var f=Ar();Yf(o,l,c,f)}function Yf(o,l,c,f){var m={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Tv(o))AI(l,m);else{var v=o.alternate;if(o.lanes===0&&(v===null||v.lanes===0)&&(v=l.lastRenderedReducer,v!==null))try{var b=l.lastRenderedState,P=v(b,c);if(m.hasEagerState=!0,m.eagerState=P,Tr(P,b))return lv(o,l,m,0),nn===null&&av(),!1}catch{}finally{}if(c=yb(o,l,m,f),c!==null)return Wi(c,o,f),xI(c,l,f),!0}return!1}function jb(o,l,c,f){if(f={lane:2,revertLane:IR(),action:f,hasEagerState:!1,eagerState:null,next:null},Tv(o)){if(l)throw Error(i(479))}else l=yb(o,c,f,2),l!==null&&Wi(l,o,2)}function Tv(o){var l=o.alternate;return o===mt||l!==null&&l===mt}function AI(o,l){Mh=wv=!0;var c=o.pending;c===null?l.next=l:(l.next=c.next,c.next=l),o.pending=l}function xI(o,l,c){if((c&4194176)!==0){var f=l.lanes;f&=o.pendingLanes,c|=f,l.lanes=c,br(o,c)}}var co={readContext:xi,use:Sv,useCallback:Bn,useContext:Bn,useEffect:Bn,useImperativeHandle:Bn,useLayoutEffect:Bn,useInsertionEffect:Bn,useMemo:Bn,useReducer:Bn,useRef:Bn,useState:Bn,useDebugValue:Bn,useDeferredValue:Bn,useTransition:Bn,useSyncExternalStore:Bn,useId:Bn};co.useCacheRefresh=Bn,co.useMemoCache=Bn,co.useHostTransitionStatus=Bn,co.useFormState=Bn,co.useActionState=Bn,co.useOptimistic=Bn;var Pu={readContext:xi,use:Sv,useCallback:function(o,l){return sr().memoizedState=[o,l===void 0?null:l],o},useContext:xi,useEffect:mI,useImperativeHandle:function(o,l,c){c=c!=null?c.concat([o]):null,Rv(4194308,4,wI.bind(null,l,o),c)},useLayoutEffect:function(o,l){return Rv(4194308,4,o,l)},useInsertionEffect:function(o,l){Rv(4,2,o,l)},useMemo:function(o,l){var c=sr();l=l===void 0?null:l;var f=o();if(Hu){gt(!0);try{o()}finally{gt(!1)}}return c.memoizedState=[f,l],f},useReducer:function(o,l,c){var f=sr();if(c!==void 0){var m=c(l);if(Hu){gt(!0);try{c(l)}finally{gt(!1)}}}else m=l;return f.memoizedState=f.baseState=m,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:m},f.queue=o,o=o.dispatch=p3.bind(null,mt,o),[f.memoizedState,o]},useRef:function(o){var l=sr();return o={current:o},l.memoizedState=o},useState:function(o){o=kb(o);var l=o.queue,c=OI.bind(null,mt,l);return l.dispatch=c,[o.memoizedState,c]},useDebugValue:Fb,useDeferredValue:function(o,l){var c=sr();return Bb(c,o,l)},useTransition:function(){var o=kb(!1);return o=RI.bind(null,mt,o.queue,!0,!1),sr().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,l,c){var f=mt,m=sr();if(Pt){if(c===void 0)throw Error(i(407));c=c()}else{if(c=l(),nn===null)throw Error(i(349));(Mt&60)!==0||JP(f,l,c)}m.memoizedState=c;var v={value:c,getSnapshot:l};return m.queue=v,mI(tI.bind(null,f,v,o),[o]),f.flags|=2048,Ah(9,eI.bind(null,f,v,c,l),{destroy:void 0},null),c},useId:function(){var o=sr(),l=nn.identifierPrefix;if(Pt){var c=sa,f=ra;c=(f&~(1<<32-Ke(f)-1)).toString(32)+c,l=":"+l+"R"+c,c=yv++,0<c&&(l+="H"+c.toString(32)),l+=":"}else c=c3++,l=":"+l+"r"+c.toString(32)+":";return o.memoizedState=l},useCacheRefresh:function(){return sr().memoizedState=m3.bind(null,mt)}};Pu.useMemoCache=Nb,Pu.useHostTransitionStatus=Ub,Pu.useFormState=cI,Pu.useActionState=cI,Pu.useOptimistic=function(o){var l=sr();l.memoizedState=l.baseState=o;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=c,l=jb.bind(null,mt,!0,c),c.dispatch=l,[o,l]};var pl={readContext:xi,use:Sv,useCallback:CI,useContext:xi,useEffect:$b,useImperativeHandle:yI,useInsertionEffect:pI,useLayoutEffect:vI,useMemo:SI,useReducer:bv,useRef:gI,useState:function(){return bv(aa)},useDebugValue:Fb,useDeferredValue:function(o,l){var c=Xn();return bI(c,Gt.memoizedState,o,l)},useTransition:function(){var o=bv(aa)[0],l=Xn().memoizedState;return[typeof o=="boolean"?o:zf(o),l]},useSyncExternalStore:QP,useId:_I};pl.useCacheRefresh=MI,pl.useMemoCache=Nb,pl.useHostTransitionStatus=Ub,pl.useFormState=hI,pl.useActionState=hI,pl.useOptimistic=function(o,l){var c=Xn();return rI(c,Gt,o,l)};var Iu={readContext:xi,use:Sv,useCallback:CI,useContext:xi,useEffect:$b,useImperativeHandle:yI,useInsertionEffect:pI,useLayoutEffect:vI,useMemo:SI,useReducer:Lb,useRef:gI,useState:function(){return Lb(aa)},useDebugValue:Fb,useDeferredValue:function(o,l){var c=Xn();return Gt===null?Bb(c,o,l):bI(c,Gt.memoizedState,o,l)},useTransition:function(){var o=Lb(aa)[0],l=Xn().memoizedState;return[typeof o=="boolean"?o:zf(o),l]},useSyncExternalStore:QP,useId:_I};Iu.useCacheRefresh=MI,Iu.useMemoCache=Nb,Iu.useHostTransitionStatus=Ub,Iu.useFormState=fI,Iu.useActionState=fI,Iu.useOptimistic=function(o,l){var c=Xn();return Gt!==null?rI(c,Gt,o,l):(c.baseState=o,[o,c.queue.dispatch])};function zb(o,l,c,f){l=o.memoizedState,c=c(f,l),c=c==null?l:Q({},l,c),o.memoizedState=c,o.lanes===0&&(o.updateQueue.baseState=c)}var Yb={isMounted:function(o){return(o=o._reactInternals)?Re(o)===o:!1},enqueueSetState:function(o,l,c){o=o._reactInternals;var f=Ar(),m=yl(f);m.payload=l,c!=null&&(m.callback=c),l=Cl(o,m,f),l!==null&&(Wi(l,o,f),Kf(l,o,f))},enqueueReplaceState:function(o,l,c){o=o._reactInternals;var f=Ar(),m=yl(f);m.tag=1,m.payload=l,c!=null&&(m.callback=c),l=Cl(o,m,f),l!==null&&(Wi(l,o,f),Kf(l,o,f))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var c=Ar(),f=yl(c);f.tag=2,l!=null&&(f.callback=l),l=Cl(o,f,c),l!==null&&(Wi(l,o,c),Kf(l,o,c))}};function HI(o,l,c,f,m,v,b){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(f,v,b):l.prototype&&l.prototype.isPureReactComponent?!If(c,f)||!If(m,v):!0}function PI(o,l,c,f){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(c,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(c,f),l.state!==o&&Yb.enqueueReplaceState(l,l.state,null)}function Nu(o,l){var c=l;if("ref"in l){c={};for(var f in l)f!=="ref"&&(c[f]=l[f])}if(o=o.defaultProps){c===l&&(c=Q({},c));for(var m in o)c[m]===void 0&&(c[m]=o[m])}return c}var _v=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function II(o){_v(o)}function NI(o){console.error(o)}function DI(o){_v(o)}function Mv(o,l){try{var c=o.onUncaughtError;c(l.value,{componentStack:l.stack})}catch(f){setTimeout(function(){throw f})}}function LI(o,l,c){try{var f=o.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Gb(o,l,c){return c=yl(c),c.tag=3,c.payload={element:null},c.callback=function(){Mv(o,l)},c}function kI(o){return o=yl(o),o.tag=3,o}function VI(o,l,c,f){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var v=f.value;o.payload=function(){return m(v)},o.callback=function(){LI(l,c,f)}}var b=c.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(o.callback=function(){LI(l,c,f),typeof m!="function"&&(_l===null?_l=new Set([this]):_l.add(this));var P=f.stack;this.componentDidCatch(f.value,{componentStack:P!==null?P:""})})}function v3(o,l,c,f,m){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(l=c.alternate,l!==null&&qf(l,c,m,!0),c=Jr.current,c!==null){switch(c.tag){case 13:return uo===null?OR():c.alternate===null&&Hn===0&&(Hn=3),c.flags&=-257,c.flags|=65536,c.lanes=m,f===Rb?c.flags|=16384:(l=c.updateQueue,l===null?c.updateQueue=new Set([f]):l.add(f),xR(o,f,m)),!1;case 22:return c.flags|=65536,f===Rb?c.flags|=16384:(l=c.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=l):(c=l.retryQueue,c===null?l.retryQueue=new Set([f]):c.add(f)),xR(o,f,m)),!1}throw Error(i(435,c.tag))}return xR(o,f,m),OR(),!1}if(Pt)return l=Jr.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=m,f!==bb&&(o=Error(i(422),{cause:f}),kf(Xr(o,c)))):(f!==bb&&(l=Error(i(423),{cause:f}),kf(Xr(l,c))),o=o.current.alternate,o.flags|=65536,m&=-m,o.lanes|=m,f=Xr(f,c),m=Gb(o.stateNode,f,m),lR(o,m),Hn!==4&&(Hn=2)),!1;var v=Error(i(520),{cause:f});if(v=Xr(v,c),ig===null?ig=[v]:ig.push(v),Hn!==4&&(Hn=2),l===null)return!0;f=Xr(f,c),c=l;do{switch(c.tag){case 3:return c.flags|=65536,o=m&-m,c.lanes|=o,o=Gb(c.stateNode,f,o),lR(c,o),!1;case 1:if(l=c.type,v=c.stateNode,(c.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(_l===null||!_l.has(v))))return c.flags|=65536,m&=-m,c.lanes|=m,m=kI(m),VI(m,o,c,f),lR(c,m),!1}c=c.return}while(c!==null);return!1}var $I=Error(i(461)),fi=!1;function Ri(o,l,c,f){l.child=o===null?jP(l,null,c,f):Au(l,o.child,c,f)}function FI(o,l,c,f,m){c=c.render;var v=l.ref;if("ref"in f){var b={};for(var P in f)P!=="ref"&&(b[P]=f[P])}else b=f;return Lu(l),f=xb(o,l,c,b,v,m),P=Hb(),o!==null&&!fi?(Pb(o,l,m),la(o,l,m)):(Pt&&P&&Cb(l),l.flags|=1,Ri(o,l,f,m),l.child)}function BI(o,l,c,f,m){if(o===null){var v=c.type;return typeof v=="function"&&!pR(v)&&v.defaultProps===void 0&&c.compare===null?(l.tag=15,l.type=v,WI(o,l,v,f,m)):(o=Pv(c.type,null,f,l,l.mode,m),o.ref=l.ref,o.return=l,l.child=o)}if(v=o.child,!nR(o,m)){var b=v.memoizedProps;if(c=c.compare,c=c!==null?c:If,c(b,f)&&o.ref===l.ref)return la(o,l,m)}return l.flags|=1,o=El(v,f),o.ref=l.ref,o.return=l,l.child=o}function WI(o,l,c,f,m){if(o!==null){var v=o.memoizedProps;if(If(v,f)&&o.ref===l.ref)if(fi=!1,l.pendingProps=f=v,nR(o,m))(o.flags&131072)!==0&&(fi=!0);else return l.lanes=o.lanes,la(o,l,m)}return qb(o,l,c,f,m)}function UI(o,l,c){var f=l.pendingProps,m=f.children,v=(l.stateNode._pendingVisibility&2)!==0,b=o!==null?o.memoizedState:null;if(Gf(o,l),f.mode==="hidden"||v){if((l.flags&128)!==0){if(f=b!==null?b.baseLanes|c:c,o!==null){for(m=l.child=o.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;l.childLanes=v&~f}else l.childLanes=0,l.child=null;return jI(o,l,f,c)}if((c&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},o!==null&&vv(l,b!==null?b.cachePool:null),b!==null?zP(l,b):Eb(),YP(l);else return l.lanes=l.childLanes=536870912,jI(o,l,b!==null?b.baseLanes|c:c,c)}else b!==null?(vv(l,b.cachePool),zP(l,b),gl(),l.memoizedState=null):(o!==null&&vv(l,null),Eb(),gl());return Ri(o,l,m,c),l.child}function jI(o,l,c,f){var m=Ob();return m=m===null?null:{parent:oi._currentValue,pool:m},l.memoizedState={baseLanes:c,cachePool:m},o!==null&&vv(l,null),Eb(),YP(l),o!==null&&qf(o,l,f,!0),null}function Gf(o,l){var c=l.ref;if(c===null)o!==null&&o.ref!==null&&(l.flags|=2097664);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(o===null||o.ref!==c)&&(l.flags|=2097664)}}function qb(o,l,c,f,m){return Lu(l),c=xb(o,l,c,f,void 0,m),f=Hb(),o!==null&&!fi?(Pb(o,l,m),la(o,l,m)):(Pt&&f&&Cb(l),l.flags|=1,Ri(o,l,c,m),l.child)}function zI(o,l,c,f,m,v){return Lu(l),l.updateQueue=null,c=ZP(l,f,c,m),XP(o),f=Hb(),o!==null&&!fi?(Pb(o,l,v),la(o,l,v)):(Pt&&f&&Cb(l),l.flags|=1,Ri(o,l,c,v),l.child)}function YI(o,l,c,f,m){if(Lu(l),l.stateNode===null){var v=Ch,b=c.contextType;typeof b=="object"&&b!==null&&(v=xi(b)),v=new c(f,v),l.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Yb,l.stateNode=v,v._reactInternals=l,v=l.stateNode,v.props=f,v.state=l.memoizedState,v.refs={},oR(l),b=c.contextType,v.context=typeof b=="object"&&b!==null?xi(b):Ch,v.state=l.memoizedState,b=c.getDerivedStateFromProps,typeof b=="function"&&(zb(l,c,b,f),v.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(b=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),b!==v.state&&Yb.enqueueReplaceState(v,v.state,null),Zf(l,f,v,m),Xf(),v.state=l.memoizedState),typeof v.componentDidMount=="function"&&(l.flags|=4194308),f=!0}else if(o===null){v=l.stateNode;var P=l.memoizedProps,N=Nu(c,P);v.props=N;var K=v.context,he=c.contextType;b=Ch,typeof he=="object"&&he!==null&&(b=xi(he));var we=c.getDerivedStateFromProps;he=typeof we=="function"||typeof v.getSnapshotBeforeUpdate=="function",P=l.pendingProps!==P,he||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(P||K!==b)&&PI(l,v,f,b),wl=!1;var oe=l.memoizedState;v.state=oe,Zf(l,f,v,m),Xf(),K=l.memoizedState,P||oe!==K||wl?(typeof we=="function"&&(zb(l,c,we,f),K=l.memoizedState),(N=wl||HI(l,c,N,f,oe,K,b))?(he||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(l.flags|=4194308)):(typeof v.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=K),v.props=f,v.state=K,v.context=b,f=N):(typeof v.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{v=l.stateNode,aR(o,l),b=l.memoizedProps,he=Nu(c,b),v.props=he,we=l.pendingProps,oe=v.context,K=c.contextType,N=Ch,typeof K=="object"&&K!==null&&(N=xi(K)),P=c.getDerivedStateFromProps,(K=typeof P=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(b!==we||oe!==N)&&PI(l,v,f,N),wl=!1,oe=l.memoizedState,v.state=oe,Zf(l,f,v,m),Xf();var ue=l.memoizedState;b!==we||oe!==ue||wl||o!==null&&o.dependencies!==null&&Ov(o.dependencies)?(typeof P=="function"&&(zb(l,c,P,f),ue=l.memoizedState),(he=wl||HI(l,c,he,f,oe,ue,N)||o!==null&&o.dependencies!==null&&Ov(o.dependencies))?(K||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(f,ue,N),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(f,ue,N)),typeof v.componentDidUpdate=="function"&&(l.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof v.componentDidUpdate!="function"||b===o.memoizedProps&&oe===o.memoizedState||(l.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===o.memoizedProps&&oe===o.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=ue),v.props=f,v.state=ue,v.context=N,f=he):(typeof v.componentDidUpdate!="function"||b===o.memoizedProps&&oe===o.memoizedState||(l.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===o.memoizedProps&&oe===o.memoizedState||(l.flags|=1024),f=!1)}return v=f,Gf(o,l),f=(l.flags&128)!==0,v||f?(v=l.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:v.render(),l.flags|=1,o!==null&&f?(l.child=Au(l,o.child,null,m),l.child=Au(l,null,c,m)):Ri(o,l,c,m),l.memoizedState=v.state,o=l.child):o=la(o,l,m),o}function GI(o,l,c,f){return Lf(),l.flags|=256,Ri(o,l,c,f),l.child}var Kb={dehydrated:null,treeContext:null,retryLane:0};function Xb(o){return{baseLanes:o,cachePool:KP()}}function Zb(o,l,c){return o=o!==null?o.childLanes&~c:0,l&&(o|=is),o}function qI(o,l,c){var f=l.pendingProps,m=!1,v=(l.flags&128)!==0,b;if((b=v)||(b=o!==null&&o.memoizedState===null?!1:(si.current&2)!==0),b&&(m=!0,l.flags&=-129),b=(l.flags&32)!==0,l.flags&=-33,o===null){if(Pt){if(m?fl(l):gl(),Pt){var P=bi,N;if(N=P){e:{for(N=P,P=lo;N.nodeType!==8;){if(!P){P=null;break e}if(N=xs(N.nextSibling),N===null){P=null;break e}}P=N}P!==null?(l.memoizedState={dehydrated:P,treeContext:_u!==null?{id:ra,overflow:sa}:null,retryLane:536870912},N=ns(18,null,null,0),N.stateNode=P,N.return=l,l.child=N,Bi=l,bi=null,N=!0):N=!1}N||Ou(l)}if(P=l.memoizedState,P!==null&&(P=P.dehydrated,P!==null))return P.data==="$!"?l.lanes=16:l.lanes=536870912,null;oa(l)}return P=f.children,f=f.fallback,m?(gl(),m=l.mode,P=Jb({mode:"hidden",children:P},m),f=Vu(f,m,c,null),P.return=l,f.return=l,P.sibling=f,l.child=P,m=l.child,m.memoizedState=Xb(c),m.childLanes=Zb(o,b,c),l.memoizedState=Kb,f):(fl(l),Qb(l,P))}if(N=o.memoizedState,N!==null&&(P=N.dehydrated,P!==null)){if(v)l.flags&256?(fl(l),l.flags&=-257,l=eR(o,l,c)):l.memoizedState!==null?(gl(),l.child=o.child,l.flags|=128,l=null):(gl(),m=f.fallback,P=l.mode,f=Jb({mode:"visible",children:f.children},P),m=Vu(m,P,c,null),m.flags|=2,f.return=l,m.return=l,f.sibling=m,l.child=f,Au(l,o.child,null,c),f=l.child,f.memoizedState=Xb(c),f.childLanes=Zb(o,b,c),l.memoizedState=Kb,l=m);else if(fl(l),P.data==="$!"){if(b=P.nextSibling&&P.nextSibling.dataset,b)var K=b.dgst;b=K,f=Error(i(419)),f.stack="",f.digest=b,kf({value:f,source:null,stack:null}),l=eR(o,l,c)}else if(fi||qf(o,l,c,!1),b=(c&o.childLanes)!==0,fi||b){if(b=nn,b!==null){if(f=c&-c,(f&42)!==0)f=1;else switch(f){case 2:f=1;break;case 8:f=4;break;case 32:f=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:f=64;break;case 268435456:f=134217728;break;default:f=0}if(f=(f&(b.suspendedLanes|c))!==0?0:f,f!==0&&f!==N.retryLane)throw N.retryLane=f,dl(o,f),Wi(b,o,f),$I}P.data==="$?"||OR(),l=eR(o,l,c)}else P.data==="$?"?(l.flags|=128,l.child=o.child,l=P3.bind(null,o),P._reactRetry=l,l=null):(o=N.treeContext,bi=xs(P.nextSibling),Bi=l,Pt=!0,Os=null,lo=!1,o!==null&&(Zr[Qr++]=ra,Zr[Qr++]=sa,Zr[Qr++]=_u,ra=o.id,sa=o.overflow,_u=l),l=Qb(l,f.children),l.flags|=4096);return l}return m?(gl(),m=f.fallback,P=l.mode,N=o.child,K=N.sibling,f=El(N,{mode:"hidden",children:f.children}),f.subtreeFlags=N.subtreeFlags&31457280,K!==null?m=El(K,m):(m=Vu(m,P,c,null),m.flags|=2),m.return=l,f.return=l,f.sibling=m,l.child=f,f=m,m=l.child,P=o.child.memoizedState,P===null?P=Xb(c):(N=P.cachePool,N!==null?(K=oi._currentValue,N=N.parent!==K?{parent:K,pool:K}:N):N=KP(),P={baseLanes:P.baseLanes|c,cachePool:N}),m.memoizedState=P,m.childLanes=Zb(o,b,c),l.memoizedState=Kb,f):(fl(l),c=o.child,o=c.sibling,c=El(c,{mode:"visible",children:f.children}),c.return=l,c.sibling=null,o!==null&&(b=l.deletions,b===null?(l.deletions=[o],l.flags|=16):b.push(o)),l.child=c,l.memoizedState=null,c)}function Qb(o,l){return l=Jb({mode:"visible",children:l},o.mode),l.return=o,o.child=l}function Jb(o,l){return CN(o,l,0,null)}function eR(o,l,c){return Au(l,o.child,null,c),o=Qb(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function KI(o,l,c){o.lanes|=l;var f=o.alternate;f!==null&&(f.lanes|=l),rR(o.return,l,c)}function tR(o,l,c,f,m){var v=o.memoizedState;v===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:m}:(v.isBackwards=l,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=c,v.tailMode=m)}function XI(o,l,c){var f=l.pendingProps,m=f.revealOrder,v=f.tail;if(Ri(o,l,f.children,c),f=si.current,(f&2)!==0)f=f&1|2,l.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&KI(o,c,l);else if(o.tag===19)KI(o,c,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break e;for(;o.sibling===null;){if(o.return===null||o.return===l)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}f&=1}switch(M(si,f),m){case"forwards":for(c=l.child,m=null;c!==null;)o=c.alternate,o!==null&&pv(o)===null&&(m=c),c=c.sibling;c=m,c===null?(m=l.child,l.child=null):(m=c.sibling,c.sibling=null),tR(l,!1,m,c,v);break;case"backwards":for(c=null,m=l.child,l.child=null;m!==null;){if(o=m.alternate,o!==null&&pv(o)===null){l.child=m;break}o=m.sibling,m.sibling=c,c=m,m=o}tR(l,!0,c,null,v);break;case"together":tR(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function la(o,l,c){if(o!==null&&(l.dependencies=o.dependencies),Tl|=l.lanes,(c&l.childLanes)===0)if(o!==null){if(qf(o,l,c,!1),(c&l.childLanes)===0)return null}else return null;if(o!==null&&l.child!==o.child)throw Error(i(153));if(l.child!==null){for(o=l.child,c=El(o,o.pendingProps),l.child=c,c.return=l;o.sibling!==null;)o=o.sibling,c=c.sibling=El(o,o.pendingProps),c.return=l;c.sibling=null}return l.child}function nR(o,l){return(o.lanes&l)!==0?!0:(o=o.dependencies,!!(o!==null&&Ov(o)))}function w3(o,l,c){switch(l.tag){case 3:Z(l,l.stateNode.containerInfo),vl(l,oi,o.memoizedState.cache),Lf();break;case 27:case 5:B(l);break;case 4:Z(l,l.stateNode.containerInfo);break;case 10:vl(l,l.type,l.memoizedProps.value);break;case 13:var f=l.memoizedState;if(f!==null)return f.dehydrated!==null?(fl(l),l.flags|=128,null):(c&l.child.childLanes)!==0?qI(o,l,c):(fl(l),o=la(o,l,c),o!==null?o.sibling:null);fl(l);break;case 19:var m=(o.flags&128)!==0;if(f=(c&l.childLanes)!==0,f||(qf(o,l,c,!1),f=(c&l.childLanes)!==0),m){if(f)return XI(o,l,c);l.flags|=128}if(m=l.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),M(si,si.current),f)break;return null;case 22:case 23:return l.lanes=0,UI(o,l,c);case 24:vl(l,oi,o.memoizedState.cache)}return la(o,l,c)}function ZI(o,l,c){if(o!==null)if(o.memoizedProps!==l.pendingProps)fi=!0;else{if(!nR(o,c)&&(l.flags&128)===0)return fi=!1,w3(o,l,c);fi=(o.flags&131072)!==0}else fi=!1,Pt&&(l.flags&1048576)!==0&&DP(l,hv,l.index);switch(l.lanes=0,l.tag){case 16:e:{o=l.pendingProps;var f=l.elementType,m=f._init;if(f=m(f._payload),l.type=f,typeof f=="function")pR(f)?(o=Nu(f,o),l.tag=1,l=YI(null,l,f,o,c)):(l.tag=0,l=qb(null,l,f,o,c));else{if(f!=null){if(m=f.$$typeof,m===S){l.tag=11,l=FI(null,l,f,o,c);break e}else if(m===H){l.tag=14,l=BI(null,l,f,o,c);break e}}throw l=re(f)||f,Error(i(306,l,""))}}return l;case 0:return qb(o,l,l.type,l.pendingProps,c);case 1:return f=l.type,m=Nu(f,l.pendingProps),YI(o,l,f,m,c);case 3:e:{if(Z(l,l.stateNode.containerInfo),o===null)throw Error(i(387));var v=l.pendingProps;m=l.memoizedState,f=m.element,aR(o,l),Zf(l,v,null,c);var b=l.memoizedState;if(v=b.cache,vl(l,oi,v),v!==m.cache&&sR(l,[oi],c,!0),Xf(),v=b.element,m.isDehydrated)if(m={element:v,isDehydrated:!1,cache:b.cache},l.updateQueue.baseState=m,l.memoizedState=m,l.flags&256){l=GI(o,l,v,c);break e}else if(v!==f){f=Xr(Error(i(424)),l),kf(f),l=GI(o,l,v,c);break e}else for(bi=xs(l.stateNode.containerInfo.firstChild),Bi=l,Pt=!0,Os=null,lo=!0,c=jP(l,null,v,c),l.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Lf(),v===f){l=la(o,l,c);break e}Ri(o,l,v,c)}l=l.child}return l;case 26:return Gf(o,l),o===null?(c=eD(l.type,null,l.pendingProps,null))?l.memoizedState=c:Pt||(c=l.type,o=l.pendingProps,f=jv(q.current).createElement(c),f[ri]=l,f[gn]=o,Ei(f,c,o),St(f),l.stateNode=f):l.memoizedState=eD(l.type,o.memoizedProps,l.pendingProps,o.memoizedState),null;case 27:return B(l),o===null&&Pt&&(f=l.stateNode=ZN(l.type,l.pendingProps,q.current),Bi=l,lo=!0,bi=xs(f.firstChild)),f=l.pendingProps.children,o!==null||Pt?Ri(o,l,f,c):l.child=Au(l,null,f,c),Gf(o,l),l.child;case 5:return o===null&&Pt&&((m=f=bi)&&(f=q3(f,l.type,l.pendingProps,lo),f!==null?(l.stateNode=f,Bi=l,bi=xs(f.firstChild),lo=!1,m=!0):m=!1),m||Ou(l)),B(l),m=l.type,v=l.pendingProps,b=o!==null?o.memoizedProps:null,f=v.children,WR(m,v)?f=null:b!==null&&WR(m,b)&&(l.flags|=32),l.memoizedState!==null&&(m=xb(o,l,h3,null,null,c),dg._currentValue=m),Gf(o,l),Ri(o,l,f,c),l.child;case 6:return o===null&&Pt&&((o=c=bi)&&(c=K3(c,l.pendingProps,lo),c!==null?(l.stateNode=c,Bi=l,bi=null,o=!0):o=!1),o||Ou(l)),null;case 13:return qI(o,l,c);case 4:return Z(l,l.stateNode.containerInfo),f=l.pendingProps,o===null?l.child=Au(l,null,f,c):Ri(o,l,f,c),l.child;case 11:return FI(o,l,l.type,l.pendingProps,c);case 7:return Ri(o,l,l.pendingProps,c),l.child;case 8:return Ri(o,l,l.pendingProps.children,c),l.child;case 12:return Ri(o,l,l.pendingProps.children,c),l.child;case 10:return f=l.pendingProps,vl(l,l.type,f.value),Ri(o,l,f.children,c),l.child;case 9:return m=l.type._context,f=l.pendingProps.children,Lu(l),m=xi(m),f=f(m),l.flags|=1,Ri(o,l,f,c),l.child;case 14:return BI(o,l,l.type,l.pendingProps,c);case 15:return WI(o,l,l.type,l.pendingProps,c);case 19:return XI(o,l,c);case 22:return UI(o,l,c);case 24:return Lu(l),f=xi(oi),o===null?(m=Ob(),m===null&&(m=nn,v=_b(),m.pooledCache=v,v.refCount++,v!==null&&(m.pooledCacheLanes|=c),m=v),l.memoizedState={parent:f,cache:m},oR(l),vl(l,oi,m)):((o.lanes&c)!==0&&(aR(o,l),Zf(l,null,null,c),Xf()),m=o.memoizedState,v=l.memoizedState,m.parent!==f?(m={parent:f,cache:f},l.memoizedState=m,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=m),vl(l,oi,f)):(f=v.cache,vl(l,oi,f),f!==m.cache&&sR(l,[oi],c,!0))),Ri(o,l,l.pendingProps.children,c),l.child;case 29:throw l.pendingProps}throw Error(i(156,l.tag))}var iR=ae(null),Du=null,ua=null;function vl(o,l,c){M(iR,l._currentValue),l._currentValue=c}function ca(o){o._currentValue=iR.current,be(iR)}function rR(o,l,c){for(;o!==null;){var f=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),o===c)break;o=o.return}}function sR(o,l,c,f){var m=o.child;for(m!==null&&(m.return=o);m!==null;){var v=m.dependencies;if(v!==null){var b=m.child;v=v.firstContext;e:for(;v!==null;){var P=v;v=m;for(var N=0;N<l.length;N++)if(P.context===l[N]){v.lanes|=c,P=v.alternate,P!==null&&(P.lanes|=c),rR(v.return,c,o),f||(b=null);break e}v=P.next}}else if(m.tag===18){if(b=m.return,b===null)throw Error(i(341));b.lanes|=c,v=b.alternate,v!==null&&(v.lanes|=c),rR(b,c,o),b=null}else b=m.child;if(b!==null)b.return=m;else for(b=m;b!==null;){if(b===o){b=null;break}if(m=b.sibling,m!==null){m.return=b.return,b=m;break}b=b.return}m=b}}function qf(o,l,c,f){o=null;for(var m=l,v=!1;m!==null;){if(!v){if((m.flags&524288)!==0)v=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var b=m.alternate;if(b===null)throw Error(i(387));if(b=b.memoizedProps,b!==null){var P=m.type;Tr(m.pendingProps.value,b.value)||(o!==null?o.push(P):o=[P])}}else if(m===j.current){if(b=m.alternate,b===null)throw Error(i(387));b.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(o!==null?o.push(dg):o=[dg])}m=m.return}o!==null&&sR(l,o,c,f),l.flags|=262144}function Ov(o){for(o=o.firstContext;o!==null;){if(!Tr(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Lu(o){Du=o,ua=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function xi(o){return QI(Du,o)}function Av(o,l){return Du===null&&Lu(o),QI(o,l)}function QI(o,l){var c=l._currentValue;if(l={context:l,memoizedValue:c,next:null},ua===null){if(o===null)throw Error(i(308));ua=l,o.dependencies={lanes:0,firstContext:l},o.flags|=524288}else ua=ua.next=l;return c}var wl=!1;function oR(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function aR(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function yl(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function Cl(o,l,c){var f=o.updateQueue;if(f===null)return null;if(f=f.shared,(Cn&2)!==0){var m=f.pending;return m===null?l.next=l:(l.next=m.next,m.next=l),f.pending=l,l=uv(o),IP(o,null,c),l}return lv(o,f,l,c),uv(o)}function Kf(o,l,c){if(l=l.updateQueue,l!==null&&(l=l.shared,(c&4194176)!==0)){var f=l.lanes;f&=o.pendingLanes,c|=f,l.lanes=c,br(o,c)}}function lR(o,l){var c=o.updateQueue,f=o.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var m=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var b={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};v===null?m=v=b:v=v.next=b,c=c.next}while(c!==null);v===null?m=v=l:v=v.next=l}else m=v=l;c={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:f.shared,callbacks:f.callbacks},o.updateQueue=c;return}o=c.lastBaseUpdate,o===null?c.firstBaseUpdate=l:o.next=l,c.lastBaseUpdate=l}var uR=!1;function Xf(){if(uR){var o=_h;if(o!==null)throw o}}function Zf(o,l,c,f){uR=!1;var m=o.updateQueue;wl=!1;var v=m.firstBaseUpdate,b=m.lastBaseUpdate,P=m.shared.pending;if(P!==null){m.shared.pending=null;var N=P,K=N.next;N.next=null,b===null?v=K:b.next=K,b=N;var he=o.alternate;he!==null&&(he=he.updateQueue,P=he.lastBaseUpdate,P!==b&&(P===null?he.firstBaseUpdate=K:P.next=K,he.lastBaseUpdate=N))}if(v!==null){var we=m.baseState;b=0,he=K=N=null,P=v;do{var oe=P.lane&-536870913,ue=oe!==P.lane;if(ue?(Mt&oe)===oe:(f&oe)===oe){oe!==0&&oe===Th&&(uR=!0),he!==null&&(he=he.next={lane:0,tag:P.tag,payload:P.payload,callback:null,next:null});e:{var Be=o,tt=P;oe=l;var Pn=c;switch(tt.tag){case 1:if(Be=tt.payload,typeof Be=="function"){we=Be.call(Pn,we,oe);break e}we=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=tt.payload,oe=typeof Be=="function"?Be.call(Pn,we,oe):Be,oe==null)break e;we=Q({},we,oe);break e;case 2:wl=!0}}oe=P.callback,oe!==null&&(o.flags|=64,ue&&(o.flags|=8192),ue=m.callbacks,ue===null?m.callbacks=[oe]:ue.push(oe))}else ue={lane:oe,tag:P.tag,payload:P.payload,callback:P.callback,next:null},he===null?(K=he=ue,N=we):he=he.next=ue,b|=oe;if(P=P.next,P===null){if(P=m.shared.pending,P===null)break;ue=P,P=ue.next,ue.next=null,m.lastBaseUpdate=ue,m.shared.pending=null}}while(!0);he===null&&(N=we),m.baseState=N,m.firstBaseUpdate=K,m.lastBaseUpdate=he,v===null&&(m.shared.lanes=0),Tl|=b,o.lanes=b,o.memoizedState=we}}function JI(o,l){if(typeof o!="function")throw Error(i(191,o));o.call(l)}function eN(o,l){var c=o.callbacks;if(c!==null)for(o.callbacks=null,o=0;o<c.length;o++)JI(c[o],l)}function Qf(o,l){try{var c=l.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&o)===o){f=void 0;var v=c.create,b=c.inst;f=v(),b.destroy=f}c=c.next}while(c!==m)}}catch(P){Qt(l,l.return,P)}}function Sl(o,l,c){try{var f=l.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var v=m.next;f=v;do{if((f.tag&o)===o){var b=f.inst,P=b.destroy;if(P!==void 0){b.destroy=void 0,m=l;var N=c;try{P()}catch(K){Qt(m,N,K)}}}f=f.next}while(f!==v)}}catch(K){Qt(l,l.return,K)}}function tN(o){var l=o.updateQueue;if(l!==null){var c=o.stateNode;try{eN(l,c)}catch(f){Qt(o,o.return,f)}}}function nN(o,l,c){c.props=Nu(o.type,o.memoizedProps),c.state=o.memoizedState;try{c.componentWillUnmount()}catch(f){Qt(o,l,f)}}function ku(o,l){try{var c=o.ref;if(c!==null){var f=o.stateNode;switch(o.tag){case 26:case 27:case 5:var m=f;break;default:m=f}typeof c=="function"?o.refCleanup=c(m):c.current=m}}catch(v){Qt(o,l,v)}}function _r(o,l){var c=o.ref,f=o.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(m){Qt(o,l,m)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){Qt(o,l,m)}else c.current=null}function iN(o){var l=o.type,c=o.memoizedProps,f=o.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(m){Qt(o,o.return,m)}}function rN(o,l,c){try{var f=o.stateNode;U3(f,o.type,c,l),f[gn]=l}catch(m){Qt(o,o.return,m)}}function sN(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27||o.tag===4}function cR(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||sN(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==27&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function hR(o,l,c){var f=o.tag;if(f===5||f===6)o=o.stateNode,l?c.nodeType===8?c.parentNode.insertBefore(o,l):c.insertBefore(o,l):(c.nodeType===8?(l=c.parentNode,l.insertBefore(o,c)):(l=c,l.appendChild(o)),c=c._reactRootContainer,c!=null||l.onclick!==null||(l.onclick=Uv));else if(f!==4&&f!==27&&(o=o.child,o!==null))for(hR(o,l,c),o=o.sibling;o!==null;)hR(o,l,c),o=o.sibling}function xv(o,l,c){var f=o.tag;if(f===5||f===6)o=o.stateNode,l?c.insertBefore(o,l):c.appendChild(o);else if(f!==4&&f!==27&&(o=o.child,o!==null))for(xv(o,l,c),o=o.sibling;o!==null;)xv(o,l,c),o=o.sibling}var ha=!1,xn=!1,dR=!1,oN=typeof WeakSet=="function"?WeakSet:Set,gi=null,aN=!1;function y3(o,l){if(o=o.containerInfo,FR=Xv,o=EP(o),gb(o)){if("selectionStart"in o)var c={start:o.selectionStart,end:o.selectionEnd};else e:{c=(c=o.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var m=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var b=0,P=-1,N=-1,K=0,he=0,we=o,oe=null;t:for(;;){for(var ue;we!==c||m!==0&&we.nodeType!==3||(P=b+m),we!==v||f!==0&&we.nodeType!==3||(N=b+f),we.nodeType===3&&(b+=we.nodeValue.length),(ue=we.firstChild)!==null;)oe=we,we=ue;for(;;){if(we===o)break t;if(oe===c&&++K===m&&(P=b),oe===v&&++he===f&&(N=b),(ue=we.nextSibling)!==null)break;we=oe,oe=we.parentNode}we=ue}c=P===-1||N===-1?null:{start:P,end:N}}else c=null}c=c||{start:0,end:0}}else c=null;for(BR={focusedElem:o,selectionRange:c},Xv=!1,gi=l;gi!==null;)if(l=gi,o=l.child,(l.subtreeFlags&1028)!==0&&o!==null)o.return=l,gi=o;else for(;gi!==null;){switch(l=gi,v=l.alternate,o=l.flags,l.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&v!==null){o=void 0,c=l,m=v.memoizedProps,v=v.memoizedState,f=c.stateNode;try{var Be=Nu(c.type,m,c.elementType===c.type);o=f.getSnapshotBeforeUpdate(Be,v),f.__reactInternalSnapshotBeforeUpdate=o}catch(tt){Qt(c,c.return,tt)}}break;case 3:if((o&1024)!==0){if(o=l.stateNode.containerInfo,c=o.nodeType,c===9)zR(o);else if(c===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":zR(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(i(163))}if(o=l.sibling,o!==null){o.return=l.return,gi=o;break}gi=l.return}return Be=aN,aN=!1,Be}function lN(o,l,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:fa(o,c),f&4&&Qf(5,c);break;case 1:if(fa(o,c),f&4)if(o=c.stateNode,l===null)try{o.componentDidMount()}catch(P){Qt(c,c.return,P)}else{var m=Nu(c.type,l.memoizedProps);l=l.memoizedState;try{o.componentDidUpdate(m,l,o.__reactInternalSnapshotBeforeUpdate)}catch(P){Qt(c,c.return,P)}}f&64&&tN(c),f&512&&ku(c,c.return);break;case 3:if(fa(o,c),f&64&&(f=c.updateQueue,f!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{eN(f,o)}catch(P){Qt(c,c.return,P)}}break;case 26:fa(o,c),f&512&&ku(c,c.return);break;case 27:case 5:fa(o,c),l===null&&f&4&&iN(c),f&512&&ku(c,c.return);break;case 12:fa(o,c);break;case 13:fa(o,c),f&4&&hN(o,c);break;case 22:if(m=c.memoizedState!==null||ha,!m){l=l!==null&&l.memoizedState!==null||xn;var v=ha,b=xn;ha=m,(xn=l)&&!b?bl(o,c,(c.subtreeFlags&8772)!==0):fa(o,c),ha=v,xn=b}f&512&&(c.memoizedProps.mode==="manual"?ku(c,c.return):_r(c,c.return));break;default:fa(o,c)}}function uN(o){var l=o.alternate;l!==null&&(o.alternate=null,uN(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&Y(l)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var Zn=null,Mr=!1;function da(o,l,c){for(c=c.child;c!==null;)cN(o,l,c),c=c.sibling}function cN(o,l,c){if(Ct&&typeof Ct.onCommitFiberUnmount=="function")try{Ct.onCommitFiberUnmount(tn,c)}catch{}switch(c.tag){case 26:xn||_r(c,l),da(o,l,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:xn||_r(c,l);var f=Zn,m=Mr;for(Zn=c.stateNode,da(o,l,c),c=c.stateNode,l=c.attributes;l.length;)c.removeAttributeNode(l[0]);Y(c),Zn=f,Mr=m;break;case 5:xn||_r(c,l);case 6:m=Zn;var v=Mr;if(Zn=null,da(o,l,c),Zn=m,Mr=v,Zn!==null)if(Mr)try{o=Zn,f=c.stateNode,o.nodeType===8?o.parentNode.removeChild(f):o.removeChild(f)}catch(b){Qt(c,l,b)}else try{Zn.removeChild(c.stateNode)}catch(b){Qt(c,l,b)}break;case 18:Zn!==null&&(Mr?(l=Zn,c=c.stateNode,l.nodeType===8?jR(l.parentNode,c):l.nodeType===1&&jR(l,c),pg(l)):jR(Zn,c.stateNode));break;case 4:f=Zn,m=Mr,Zn=c.stateNode.containerInfo,Mr=!0,da(o,l,c),Zn=f,Mr=m;break;case 0:case 11:case 14:case 15:xn||Sl(2,c,l),xn||Sl(4,c,l),da(o,l,c);break;case 1:xn||(_r(c,l),f=c.stateNode,typeof f.componentWillUnmount=="function"&&nN(c,l,f)),da(o,l,c);break;case 21:da(o,l,c);break;case 22:xn||_r(c,l),xn=(f=xn)||c.memoizedState!==null,da(o,l,c),xn=f;break;default:da(o,l,c)}}function hN(o,l){if(l.memoizedState===null&&(o=l.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{pg(o)}catch(c){Qt(l,l.return,c)}}function C3(o){switch(o.tag){case 13:case 19:var l=o.stateNode;return l===null&&(l=o.stateNode=new oN),l;case 22:return o=o.stateNode,l=o._retryCache,l===null&&(l=o._retryCache=new oN),l;default:throw Error(i(435,o.tag))}}function fR(o,l){var c=C3(o);l.forEach(function(f){var m=I3.bind(null,o,f);c.has(f)||(c.add(f),f.then(m,m))})}function es(o,l){var c=l.deletions;if(c!==null)for(var f=0;f<c.length;f++){var m=c[f],v=o,b=l,P=b;e:for(;P!==null;){switch(P.tag){case 27:case 5:Zn=P.stateNode,Mr=!1;break e;case 3:Zn=P.stateNode.containerInfo,Mr=!0;break e;case 4:Zn=P.stateNode.containerInfo,Mr=!0;break e}P=P.return}if(Zn===null)throw Error(i(160));cN(v,b,m),Zn=null,Mr=!1,v=m.alternate,v!==null&&(v.return=null),m.return=null}if(l.subtreeFlags&13878)for(l=l.child;l!==null;)dN(l,o),l=l.sibling}var As=null;function dN(o,l){var c=o.alternate,f=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:es(l,o),ts(o),f&4&&(Sl(3,o,o.return),Qf(3,o),Sl(5,o,o.return));break;case 1:es(l,o),ts(o),f&512&&(xn||c===null||_r(c,c.return)),f&64&&ha&&(o=o.updateQueue,o!==null&&(f=o.callbacks,f!==null&&(c=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var m=As;if(es(l,o),ts(o),f&512&&(xn||c===null||_r(c,c.return)),f&4){var v=c!==null?c.memoizedState:null;if(f=o.memoizedState,c===null)if(f===null)if(o.stateNode===null){e:{f=o.type,c=o.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":v=m.getElementsByTagName("title")[0],(!v||v[Ve]||v[ri]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=m.createElement(f),m.head.insertBefore(v,m.querySelector("head > title"))),Ei(v,f,c),v[ri]=o,St(v),f=v;break e;case"link":var b=iD("link","href",m).get(f+(c.href||""));if(b){for(var P=0;P<b.length;P++)if(v=b[P],v.getAttribute("href")===(c.href==null?null:c.href)&&v.getAttribute("rel")===(c.rel==null?null:c.rel)&&v.getAttribute("title")===(c.title==null?null:c.title)&&v.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){b.splice(P,1);break t}}v=m.createElement(f),Ei(v,f,c),m.head.appendChild(v);break;case"meta":if(b=iD("meta","content",m).get(f+(c.content||""))){for(P=0;P<b.length;P++)if(v=b[P],v.getAttribute("content")===(c.content==null?null:""+c.content)&&v.getAttribute("name")===(c.name==null?null:c.name)&&v.getAttribute("property")===(c.property==null?null:c.property)&&v.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&v.getAttribute("charset")===(c.charSet==null?null:c.charSet)){b.splice(P,1);break t}}v=m.createElement(f),Ei(v,f,c),m.head.appendChild(v);break;default:throw Error(i(468,f))}v[ri]=o,St(v),f=v}o.stateNode=f}else rD(m,o.type,o.stateNode);else o.stateNode=nD(m,f,o.memoizedProps);else v!==f?(v===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):v.count--,f===null?rD(m,o.type,o.stateNode):nD(m,f,o.memoizedProps)):f===null&&o.stateNode!==null&&rN(o,o.memoizedProps,c.memoizedProps)}break;case 27:if(f&4&&o.alternate===null){m=o.stateNode,v=o.memoizedProps;try{for(var N=m.firstChild;N;){var K=N.nextSibling,he=N.nodeName;N[Ve]||he==="HEAD"||he==="BODY"||he==="SCRIPT"||he==="STYLE"||he==="LINK"&&N.rel.toLowerCase()==="stylesheet"||m.removeChild(N),N=K}for(var we=o.type,oe=m.attributes;oe.length;)m.removeAttributeNode(oe[0]);Ei(m,we,v),m[ri]=o,m[gn]=v}catch(Be){Qt(o,o.return,Be)}}case 5:if(es(l,o),ts(o),f&512&&(xn||c===null||_r(c,c.return)),o.flags&32){m=o.stateNode;try{fh(m,"")}catch(Be){Qt(o,o.return,Be)}}f&4&&o.stateNode!=null&&(m=o.memoizedProps,rN(o,m,c!==null?c.memoizedProps:m)),f&1024&&(dR=!0);break;case 6:if(es(l,o),ts(o),f&4){if(o.stateNode===null)throw Error(i(162));f=o.memoizedProps,c=o.stateNode;try{c.nodeValue=f}catch(Be){Qt(o,o.return,Be)}}break;case 3:if(Gv=null,m=As,As=zv(l.containerInfo),es(l,o),As=m,ts(o),f&4&&c!==null&&c.memoizedState.isDehydrated)try{pg(l.containerInfo)}catch(Be){Qt(o,o.return,Be)}dR&&(dR=!1,fN(o));break;case 4:f=As,As=zv(o.stateNode.containerInfo),es(l,o),ts(o),As=f;break;case 12:es(l,o),ts(o);break;case 13:es(l,o),ts(o),o.child.flags&8192&&o.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(bR=Fe()),f&4&&(f=o.updateQueue,f!==null&&(o.updateQueue=null,fR(o,f)));break;case 22:if(f&512&&(xn||c===null||_r(c,c.return)),N=o.memoizedState!==null,K=c!==null&&c.memoizedState!==null,he=ha,we=xn,ha=he||N,xn=we||K,es(l,o),xn=we,ha=he,ts(o),l=o.stateNode,l._current=o,l._visibility&=-3,l._visibility|=l._pendingVisibility&2,f&8192&&(l._visibility=N?l._visibility&-2:l._visibility|1,N&&(l=ha||xn,c===null||K||l||xh(o)),o.memoizedProps===null||o.memoizedProps.mode!=="manual"))e:for(c=null,l=o;;){if(l.tag===5||l.tag===26||l.tag===27){if(c===null){K=c=l;try{if(m=K.stateNode,N)v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{b=K.stateNode,P=K.memoizedProps.style;var ue=P!=null&&P.hasOwnProperty("display")?P.display:null;b.style.display=ue==null||typeof ue=="boolean"?"":(""+ue).trim()}}catch(Be){Qt(K,K.return,Be)}}}else if(l.tag===6){if(c===null){K=l;try{K.stateNode.nodeValue=N?"":K.memoizedProps}catch(Be){Qt(K,K.return,Be)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===o)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break e;for(;l.sibling===null;){if(l.return===null||l.return===o)break e;c===l&&(c=null),l=l.return}c===l&&(c=null),l.sibling.return=l.return,l=l.sibling}f&4&&(f=o.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,fR(o,c))));break;case 19:es(l,o),ts(o),f&4&&(f=o.updateQueue,f!==null&&(o.updateQueue=null,fR(o,f)));break;case 21:break;default:es(l,o),ts(o)}}function ts(o){var l=o.flags;if(l&2){try{if(o.tag!==27){e:{for(var c=o.return;c!==null;){if(sN(c)){var f=c;break e}c=c.return}throw Error(i(160))}switch(f.tag){case 27:var m=f.stateNode,v=cR(o);xv(o,v,m);break;case 5:var b=f.stateNode;f.flags&32&&(fh(b,""),f.flags&=-33);var P=cR(o);xv(o,P,b);break;case 3:case 4:var N=f.stateNode.containerInfo,K=cR(o);hR(o,K,N);break;default:throw Error(i(161))}}}catch(he){Qt(o,o.return,he)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function fN(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var l=o;fN(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),o=o.sibling}}function fa(o,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)lN(o,l.alternate,l),l=l.sibling}function xh(o){for(o=o.child;o!==null;){var l=o;switch(l.tag){case 0:case 11:case 14:case 15:Sl(4,l,l.return),xh(l);break;case 1:_r(l,l.return);var c=l.stateNode;typeof c.componentWillUnmount=="function"&&nN(l,l.return,c),xh(l);break;case 26:case 27:case 5:_r(l,l.return),xh(l);break;case 22:_r(l,l.return),l.memoizedState===null&&xh(l);break;default:xh(l)}o=o.sibling}}function bl(o,l,c){for(c=c&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var f=l.alternate,m=o,v=l,b=v.flags;switch(v.tag){case 0:case 11:case 15:bl(m,v,c),Qf(4,v);break;case 1:if(bl(m,v,c),f=v,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(K){Qt(f,f.return,K)}if(f=v,m=f.updateQueue,m!==null){var P=f.stateNode;try{var N=m.shared.hiddenCallbacks;if(N!==null)for(m.shared.hiddenCallbacks=null,m=0;m<N.length;m++)JI(N[m],P)}catch(K){Qt(f,f.return,K)}}c&&b&64&&tN(v),ku(v,v.return);break;case 26:case 27:case 5:bl(m,v,c),c&&f===null&&b&4&&iN(v),ku(v,v.return);break;case 12:bl(m,v,c);break;case 13:bl(m,v,c),c&&b&4&&hN(m,v);break;case 22:v.memoizedState===null&&bl(m,v,c),ku(v,v.return);break;default:bl(m,v,c)}l=l.sibling}}function gR(o,l){var c=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(c=o.memoizedState.cachePool.pool),o=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(o=l.memoizedState.cachePool.pool),o!==c&&(o!=null&&o.refCount++,c!=null&&Wf(c))}function mR(o,l){o=null,l.alternate!==null&&(o=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==o&&(l.refCount++,o!=null&&Wf(o))}function Rl(o,l,c,f){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)gN(o,l,c,f),l=l.sibling}function gN(o,l,c,f){var m=l.flags;switch(l.tag){case 0:case 11:case 15:Rl(o,l,c,f),m&2048&&Qf(9,l);break;case 3:Rl(o,l,c,f),m&2048&&(o=null,l.alternate!==null&&(o=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==o&&(l.refCount++,o!=null&&Wf(o)));break;case 12:if(m&2048){Rl(o,l,c,f),o=l.stateNode;try{var v=l.memoizedProps,b=v.id,P=v.onPostCommit;typeof P=="function"&&P(b,l.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(N){Qt(l,l.return,N)}}else Rl(o,l,c,f);break;case 23:break;case 22:v=l.stateNode,l.memoizedState!==null?v._visibility&4?Rl(o,l,c,f):Jf(o,l):v._visibility&4?Rl(o,l,c,f):(v._visibility|=4,Hh(o,l,c,f,(l.subtreeFlags&10256)!==0)),m&2048&&gR(l.alternate,l);break;case 24:Rl(o,l,c,f),m&2048&&mR(l.alternate,l);break;default:Rl(o,l,c,f)}}function Hh(o,l,c,f,m){for(m=m&&(l.subtreeFlags&10256)!==0,l=l.child;l!==null;){var v=o,b=l,P=c,N=f,K=b.flags;switch(b.tag){case 0:case 11:case 15:Hh(v,b,P,N,m),Qf(8,b);break;case 23:break;case 22:var he=b.stateNode;b.memoizedState!==null?he._visibility&4?Hh(v,b,P,N,m):Jf(v,b):(he._visibility|=4,Hh(v,b,P,N,m)),m&&K&2048&&gR(b.alternate,b);break;case 24:Hh(v,b,P,N,m),m&&K&2048&&mR(b.alternate,b);break;default:Hh(v,b,P,N,m)}l=l.sibling}}function Jf(o,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var c=o,f=l,m=f.flags;switch(f.tag){case 22:Jf(c,f),m&2048&&gR(f.alternate,f);break;case 24:Jf(c,f),m&2048&&mR(f.alternate,f);break;default:Jf(c,f)}l=l.sibling}}var eg=8192;function Ph(o){if(o.subtreeFlags&eg)for(o=o.child;o!==null;)mN(o),o=o.sibling}function mN(o){switch(o.tag){case 26:Ph(o),o.flags&eg&&o.memoizedState!==null&&l4(As,o.memoizedState,o.memoizedProps);break;case 5:Ph(o);break;case 3:case 4:var l=As;As=zv(o.stateNode.containerInfo),Ph(o),As=l;break;case 22:o.memoizedState===null&&(l=o.alternate,l!==null&&l.memoizedState!==null?(l=eg,eg=16777216,Ph(o),eg=l):Ph(o));break;default:Ph(o)}}function pN(o){var l=o.alternate;if(l!==null&&(o=l.child,o!==null)){l.child=null;do l=o.sibling,o.sibling=null,o=l;while(o!==null)}}function tg(o){var l=o.deletions;if((o.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];gi=f,wN(f,o)}pN(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)vN(o),o=o.sibling}function vN(o){switch(o.tag){case 0:case 11:case 15:tg(o),o.flags&2048&&Sl(9,o,o.return);break;case 3:tg(o);break;case 12:tg(o);break;case 22:var l=o.stateNode;o.memoizedState!==null&&l._visibility&4&&(o.return===null||o.return.tag!==13)?(l._visibility&=-5,Hv(o)):tg(o);break;default:tg(o)}}function Hv(o){var l=o.deletions;if((o.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];gi=f,wN(f,o)}pN(o)}for(o=o.child;o!==null;){switch(l=o,l.tag){case 0:case 11:case 15:Sl(8,l,l.return),Hv(l);break;case 22:c=l.stateNode,c._visibility&4&&(c._visibility&=-5,Hv(l));break;default:Hv(l)}o=o.sibling}}function wN(o,l){for(;gi!==null;){var c=gi;switch(c.tag){case 0:case 11:case 15:Sl(8,c,l);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Wf(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,gi=f;else e:for(c=o;gi!==null;){f=gi;var m=f.sibling,v=f.return;if(uN(f),f===c){gi=null;break e}if(m!==null){m.return=v,gi=m;break e}gi=v}}}function S3(o,l,c,f){this.tag=o,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ns(o,l,c,f){return new S3(o,l,c,f)}function pR(o){return o=o.prototype,!(!o||!o.isReactComponent)}function El(o,l){var c=o.alternate;return c===null?(c=ns(o.tag,l,o.key,o.mode),c.elementType=o.elementType,c.type=o.type,c.stateNode=o.stateNode,c.alternate=o,o.alternate=c):(c.pendingProps=l,c.type=o.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=o.flags&31457280,c.childLanes=o.childLanes,c.lanes=o.lanes,c.child=o.child,c.memoizedProps=o.memoizedProps,c.memoizedState=o.memoizedState,c.updateQueue=o.updateQueue,l=o.dependencies,c.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},c.sibling=o.sibling,c.index=o.index,c.ref=o.ref,c.refCleanup=o.refCleanup,c}function yN(o,l){o.flags&=31457282;var c=o.alternate;return c===null?(o.childLanes=0,o.lanes=l,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,l=c.dependencies,o.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),o}function Pv(o,l,c,f,m,v){var b=0;if(f=o,typeof o=="function")pR(o)&&(b=1);else if(typeof o=="string")b=o4(o,c,O.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case h:return Vu(c.children,m,v,l);case d:b=8,m|=24;break;case g:return o=ns(12,c,l,m|2),o.elementType=g,o.lanes=v,o;case _:return o=ns(13,c,l,m),o.elementType=_,o.lanes=v,o;case E:return o=ns(19,c,l,m),o.elementType=E,o.lanes=v,o;case D:return CN(c,m,v,l);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case p:case y:b=10;break e;case w:b=9;break e;case S:b=11;break e;case H:b=14;break e;case x:b=16,f=null;break e}b=29,c=Error(i(130,o===null?"null":typeof o,"")),f=null}return l=ns(b,c,l,m),l.elementType=o,l.type=f,l.lanes=v,l}function Vu(o,l,c,f){return o=ns(7,o,f,l),o.lanes=c,o}function CN(o,l,c,f){o=ns(22,o,f,l),o.elementType=D,o.lanes=c;var m={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var v=m._current;if(v===null)throw Error(i(456));if((m._pendingVisibility&2)===0){var b=dl(v,2);b!==null&&(m._pendingVisibility|=2,Wi(b,v,2))}},attach:function(){var v=m._current;if(v===null)throw Error(i(456));if((m._pendingVisibility&2)!==0){var b=dl(v,2);b!==null&&(m._pendingVisibility&=-3,Wi(b,v,2))}}};return o.stateNode=m,o}function vR(o,l,c){return o=ns(6,o,null,l),o.lanes=c,o}function wR(o,l,c){return l=ns(4,o.children!==null?o.children:[],o.key,l),l.lanes=c,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}function ga(o){o.flags|=4}function SN(o,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!sD(l)){if(l=Jr.current,l!==null&&((Mt&4194176)===Mt?uo!==null:(Mt&62914560)!==Mt&&(Mt&536870912)===0||l!==uo))throw $f=Rb,VP;o.flags|=8192}}function Iv(o,l){l!==null&&(o.flags|=4),o.flags&16384&&(l=o.tag!==22?Ef():536870912,o.lanes|=l,Nh|=l)}function ng(o,l){if(!Pt)switch(o.tailMode){case"hidden":l=o.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?o.tail=null:c.sibling=null;break;case"collapsed":c=o.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:f.sibling=null}}function yn(o){var l=o.alternate!==null&&o.alternate.child===o.child,c=0,f=0;if(l)for(var m=o.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags&31457280,f|=m.flags&31457280,m.return=o,m=m.sibling;else for(m=o.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=o,m=m.sibling;return o.subtreeFlags|=f,o.childLanes=c,l}function b3(o,l,c){var f=l.pendingProps;switch(Sb(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yn(l),null;case 1:return yn(l),null;case 3:return c=l.stateNode,f=null,o!==null&&(f=o.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),ca(oi),ne(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(o===null||o.child===null)&&(Df(l)?ga(l):o===null||o.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Os!==null&&(_R(Os),Os=null))),yn(l),null;case 26:return c=l.memoizedState,o===null?(ga(l),c!==null?(yn(l),SN(l,c)):(yn(l),l.flags&=-16777217)):c?c!==o.memoizedState?(ga(l),yn(l),SN(l,c)):(yn(l),l.flags&=-16777217):(o.memoizedProps!==f&&ga(l),yn(l),l.flags&=-16777217),null;case 27:X(l),c=q.current;var m=l.type;if(o!==null&&l.stateNode!=null)o.memoizedProps!==f&&ga(l);else{if(!f){if(l.stateNode===null)throw Error(i(166));return yn(l),null}o=O.current,Df(l)?LP(l):(o=ZN(m,f,c),l.stateNode=o,ga(l))}return yn(l),null;case 5:if(X(l),c=l.type,o!==null&&l.stateNode!=null)o.memoizedProps!==f&&ga(l);else{if(!f){if(l.stateNode===null)throw Error(i(166));return yn(l),null}if(o=O.current,Df(l))LP(l);else{switch(m=jv(q.current),o){case 1:o=m.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:o=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":o=m.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":o=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":o=m.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof f.is=="string"?m.createElement("select",{is:f.is}):m.createElement("select"),f.multiple?o.multiple=!0:f.size&&(o.size=f.size);break;default:o=typeof f.is=="string"?m.createElement(c,{is:f.is}):m.createElement(c)}}o[ri]=l,o[gn]=f;e:for(m=l.child;m!==null;){if(m.tag===5||m.tag===6)o.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===l)break e;for(;m.sibling===null;){if(m.return===null||m.return===l)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}l.stateNode=o;e:switch(Ei(o,c,f),c){case"button":case"input":case"select":case"textarea":o=!!f.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&ga(l)}}return yn(l),l.flags&=-16777217,null;case 6:if(o&&l.stateNode!=null)o.memoizedProps!==f&&ga(l);else{if(typeof f!="string"&&l.stateNode===null)throw Error(i(166));if(o=q.current,Df(l)){if(o=l.stateNode,c=l.memoizedProps,f=null,m=Bi,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}o[ri]=l,o=!!(o.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||zN(o.nodeValue,c)),o||Ou(l)}else o=jv(o).createTextNode(f),o[ri]=l,l.stateNode=o}return yn(l),null;case 13:if(f=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(m=Df(l),f!==null&&f.dehydrated!==null){if(o===null){if(!m)throw Error(i(318));if(m=l.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[ri]=l}else Lf(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;yn(l),m=!1}else Os!==null&&(_R(Os),Os=null),m=!0;if(!m)return l.flags&256?(oa(l),l):(oa(l),null)}if(oa(l),(l.flags&128)!==0)return l.lanes=c,l;if(c=f!==null,o=o!==null&&o.memoizedState!==null,c){f=l.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool);var v=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==m&&(f.flags|=2048)}return c!==o&&c&&(l.child.flags|=8192),Iv(l,l.updateQueue),yn(l),null;case 4:return ne(),o===null&&kR(l.stateNode.containerInfo),yn(l),null;case 10:return ca(l.type),yn(l),null;case 19:if(be(si),m=l.memoizedState,m===null)return yn(l),null;if(f=(l.flags&128)!==0,v=m.rendering,v===null)if(f)ng(m,!1);else{if(Hn!==0||o!==null&&(o.flags&128)!==0)for(o=l.child;o!==null;){if(v=pv(o),v!==null){for(l.flags|=128,ng(m,!1),o=v.updateQueue,l.updateQueue=o,Iv(l,o),l.subtreeFlags=0,o=c,c=l.child;c!==null;)yN(c,o),c=c.sibling;return M(si,si.current&1|2),l.child}o=o.sibling}m.tail!==null&&Fe()>Nv&&(l.flags|=128,f=!0,ng(m,!1),l.lanes=4194304)}else{if(!f)if(o=pv(v),o!==null){if(l.flags|=128,f=!0,o=o.updateQueue,l.updateQueue=o,Iv(l,o),ng(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!Pt)return yn(l),null}else 2*Fe()-m.renderingStartTime>Nv&&c!==536870912&&(l.flags|=128,f=!0,ng(m,!1),l.lanes=4194304);m.isBackwards?(v.sibling=l.child,l.child=v):(o=m.last,o!==null?o.sibling=v:l.child=v,m.last=v)}return m.tail!==null?(l=m.tail,m.rendering=l,m.tail=l.sibling,m.renderingStartTime=Fe(),l.sibling=null,o=si.current,M(si,f?o&1|2:o&1),l):(yn(l),null);case 22:case 23:return oa(l),Tb(),f=l.memoizedState!==null,o!==null?o.memoizedState!==null!==f&&(l.flags|=8192):f&&(l.flags|=8192),f?(c&536870912)!==0&&(l.flags&128)===0&&(yn(l),l.subtreeFlags&6&&(l.flags|=8192)):yn(l),c=l.updateQueue,c!==null&&Iv(l,c.retryQueue),c=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(c=o.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==c&&(l.flags|=2048),o!==null&&be(xu),null;case 24:return c=null,o!==null&&(c=o.memoizedState.cache),l.memoizedState.cache!==c&&(l.flags|=2048),ca(oi),yn(l),null;case 25:return null}throw Error(i(156,l.tag))}function R3(o,l){switch(Sb(l),l.tag){case 1:return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return ca(oi),ne(),o=l.flags,(o&65536)!==0&&(o&128)===0?(l.flags=o&-65537|128,l):null;case 26:case 27:case 5:return X(l),null;case 13:if(oa(l),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(i(340));Lf()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return be(si),null;case 4:return ne(),null;case 10:return ca(l.type),null;case 22:case 23:return oa(l),Tb(),o!==null&&be(xu),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 24:return ca(oi),null;case 25:return null;default:return null}}function bN(o,l){switch(Sb(l),l.tag){case 3:ca(oi),ne();break;case 26:case 27:case 5:X(l);break;case 4:ne();break;case 13:oa(l);break;case 19:be(si);break;case 10:ca(l.type);break;case 22:case 23:oa(l),Tb(),o!==null&&be(xu);break;case 24:ca(oi)}}var E3={getCacheForType:function(o){var l=xi(oi),c=l.data.get(o);return c===void 0&&(c=o(),l.data.set(o,c)),c}},T3=typeof WeakMap=="function"?WeakMap:Map,Cn=0,nn=null,wt=null,Mt=0,rn=0,Or=null,ma=!1,Ih=!1,yR=!1,pa=0,Hn=0,Tl=0,$u=0,CR=0,is=0,Nh=0,ig=null,ho=null,SR=!1,bR=0,Nv=1/0,Dv=null,_l=null,Lv=!1,Fu=null,rg=0,RR=0,ER=null,sg=0,TR=null;function Ar(){if((Cn&2)!==0&&Mt!==0)return Mt&-Mt;if(se.T!==null){var o=Th;return o!==0?o:IR()}return Tf()}function RN(){is===0&&(is=(Mt&536870912)===0||Pt?Wp():536870912);var o=Jr.current;return o!==null&&(o.flags|=32),is}function Wi(o,l,c){(o===nn&&rn===2||o.cancelPendingCommit!==null)&&(Dh(o,0),va(o,Mt,is,!1)),cl(o,c),((Cn&2)===0||o!==nn)&&(o===nn&&((Cn&2)===0&&($u|=c),Hn===4&&va(o,Mt,is,!1)),fo(o))}function EN(o,l,c){if((Cn&6)!==0)throw Error(i(327));var f=!c&&(l&60)===0&&(l&o.expiredLanes)===0||fn(o,l),m=f?O3(o,l):AR(o,l,!0),v=f;do{if(m===0){Ih&&!f&&va(o,l,0,!1);break}else if(m===6)va(o,l,0,!ma);else{if(c=o.current.alternate,v&&!_3(c)){m=AR(o,l,!1),v=!1;continue}if(m===2){if(v=l,o.errorRecoveryDisabledLanes&v)var b=0;else b=o.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){l=b;e:{var P=o;m=ig;var N=P.current.memoizedState.isDehydrated;if(N&&(Dh(P,b).flags|=256),b=AR(P,b,!1),b!==2){if(yR&&!N){P.errorRecoveryDisabledLanes|=v,$u|=v,m=4;break e}v=ho,ho=m,v!==null&&_R(v)}m=b}if(v=!1,m!==2)continue}}if(m===1){Dh(o,0),va(o,l,0,!0);break}e:{switch(f=o,m){case 0:case 1:throw Error(i(345));case 4:if((l&4194176)===l){va(f,l,is,!ma);break e}break;case 2:ho=null;break;case 3:case 5:break;default:throw Error(i(329))}if(f.finishedWork=c,f.finishedLanes=l,(l&62914560)===l&&(v=bR+300-Fe(),10<v)){if(va(f,l,is,!ma),ch(f,0)!==0)break e;f.timeoutHandle=qN(TN.bind(null,f,c,ho,Dv,SR,l,is,$u,Nh,ma,2,-0,0),v);break e}TN(f,c,ho,Dv,SR,l,is,$u,Nh,ma,0,-0,0)}}break}while(!0);fo(o)}function _R(o){ho===null?ho=o:ho.push.apply(ho,o)}function TN(o,l,c,f,m,v,b,P,N,K,he,we,oe){var ue=l.subtreeFlags;if((ue&8192||(ue&16785408)===16785408)&&(hg={stylesheets:null,count:0,unsuspend:a4},mN(l),l=u4(),l!==null)){o.cancelPendingCommit=l(PN.bind(null,o,c,f,m,b,P,N,1,we,oe)),va(o,v,b,!K);return}PN(o,c,f,m,b,P,N,he,we,oe)}function _3(o){for(var l=o;;){var c=l.tag;if((c===0||c===11||c===15)&&l.flags&16384&&(c=l.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var m=c[f],v=m.getSnapshot;m=m.value;try{if(!Tr(v(),m))return!1}catch{return!1}}if(c=l.child,l.subtreeFlags&16384&&c!==null)c.return=l,l=c;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function va(o,l,c,f){l&=~CR,l&=~$u,o.suspendedLanes|=l,o.pingedLanes&=~l,f&&(o.warmLanes|=l),f=o.expirationTimes;for(var m=l;0<m;){var v=31-Ke(m),b=1<<v;f[v]=-1,m&=~b}c!==0&&jp(o,c,l)}function kv(){return(Cn&6)===0?(og(0),!1):!0}function MR(){if(wt!==null){if(rn===0)var o=wt.return;else o=wt,ua=Du=null,Ib(o),Rh=null,Ff=0,o=wt;for(;o!==null;)bN(o.alternate,o),o=o.return;wt=null}}function Dh(o,l){o.finishedWork=null,o.finishedLanes=0;var c=o.timeoutHandle;c!==-1&&(o.timeoutHandle=-1,z3(c)),c=o.cancelPendingCommit,c!==null&&(o.cancelPendingCommit=null,c()),MR(),nn=o,wt=c=El(o.current,null),Mt=l,rn=0,Or=null,ma=!1,Ih=fn(o,l),yR=!1,Nh=is=CR=$u=Tl=Hn=0,ho=ig=null,SR=!1,(l&8)!==0&&(l|=l&32);var f=o.entangledLanes;if(f!==0)for(o=o.entanglements,f&=l;0<f;){var m=31-Ke(f),v=1<<m;l|=o[m],f&=~v}return pa=l,av(),c}function _N(o,l){mt=null,se.H=co,l===Vf?(l=BP(),rn=3):l===VP?(l=BP(),rn=4):rn=l===$I?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Or=l,wt===null&&(Hn=1,Mv(o,Xr(l,o.current)))}function MN(){var o=se.H;return se.H=co,o===null?co:o}function ON(){var o=se.A;return se.A=E3,o}function OR(){Hn=4,ma||(Mt&4194176)!==Mt&&Jr.current!==null||(Ih=!0),(Tl&134217727)===0&&($u&134217727)===0||nn===null||va(nn,Mt,is,!1)}function AR(o,l,c){var f=Cn;Cn|=2;var m=MN(),v=ON();(nn!==o||Mt!==l)&&(Dv=null,Dh(o,l)),l=!1;var b=Hn;e:do try{if(rn!==0&&wt!==null){var P=wt,N=Or;switch(rn){case 8:MR(),b=6;break e;case 3:case 2:case 6:Jr.current===null&&(l=!0);var K=rn;if(rn=0,Or=null,Lh(o,P,N,K),c&&Ih){b=0;break e}break;default:K=rn,rn=0,Or=null,Lh(o,P,N,K)}}M3(),b=Hn;break}catch(he){_N(o,he)}while(!0);return l&&o.shellSuspendCounter++,ua=Du=null,Cn=f,se.H=m,se.A=v,wt===null&&(nn=null,Mt=0,av()),b}function M3(){for(;wt!==null;)AN(wt)}function O3(o,l){var c=Cn;Cn|=2;var f=MN(),m=ON();nn!==o||Mt!==l?(Dv=null,Nv=Fe()+500,Dh(o,l)):Ih=fn(o,l);e:do try{if(rn!==0&&wt!==null){l=wt;var v=Or;t:switch(rn){case 1:rn=0,Or=null,Lh(o,l,v,1);break;case 2:if($P(v)){rn=0,Or=null,xN(l);break}l=function(){rn===2&&nn===o&&(rn=7),fo(o)},v.then(l,l);break e;case 3:rn=7;break e;case 4:rn=5;break e;case 7:$P(v)?(rn=0,Or=null,xN(l)):(rn=0,Or=null,Lh(o,l,v,7));break;case 5:var b=null;switch(wt.tag){case 26:b=wt.memoizedState;case 5:case 27:var P=wt;if(!b||sD(b)){rn=0,Or=null;var N=P.sibling;if(N!==null)wt=N;else{var K=P.return;K!==null?(wt=K,Vv(K)):wt=null}break t}}rn=0,Or=null,Lh(o,l,v,5);break;case 6:rn=0,Or=null,Lh(o,l,v,6);break;case 8:MR(),Hn=6;break e;default:throw Error(i(462))}}A3();break}catch(he){_N(o,he)}while(!0);return ua=Du=null,se.H=f,se.A=m,Cn=c,wt!==null?0:(nn=null,Mt=0,av(),Hn)}function A3(){for(;wt!==null&&!xe();)AN(wt)}function AN(o){var l=ZI(o.alternate,o,pa);o.memoizedProps=o.pendingProps,l===null?Vv(o):wt=l}function xN(o){var l=o,c=l.alternate;switch(l.tag){case 15:case 0:l=zI(c,l,l.pendingProps,l.type,void 0,Mt);break;case 11:l=zI(c,l,l.pendingProps,l.type.render,l.ref,Mt);break;case 5:Ib(l);default:bN(c,l),l=wt=yN(l,pa),l=ZI(c,l,pa)}o.memoizedProps=o.pendingProps,l===null?Vv(o):wt=l}function Lh(o,l,c,f){ua=Du=null,Ib(l),Rh=null,Ff=0;var m=l.return;try{if(v3(o,m,l,c,Mt)){Hn=1,Mv(o,Xr(c,o.current)),wt=null;return}}catch(v){if(m!==null)throw wt=m,v;Hn=1,Mv(o,Xr(c,o.current)),wt=null;return}l.flags&32768?(Pt||f===1?o=!0:Ih||(Mt&536870912)!==0?o=!1:(ma=o=!0,(f===2||f===3||f===6)&&(f=Jr.current,f!==null&&f.tag===13&&(f.flags|=16384))),HN(l,o)):Vv(l)}function Vv(o){var l=o;do{if((l.flags&32768)!==0){HN(l,ma);return}o=l.return;var c=b3(l.alternate,l,pa);if(c!==null){wt=c;return}if(l=l.sibling,l!==null){wt=l;return}wt=l=o}while(l!==null);Hn===0&&(Hn=5)}function HN(o,l){do{var c=R3(o.alternate,o);if(c!==null){c.flags&=32767,wt=c;return}if(c=o.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!l&&(o=o.sibling,o!==null)){wt=o;return}wt=o=c}while(o!==null);Hn=6,wt=null}function PN(o,l,c,f,m,v,b,P,N,K){var he=se.T,we=A.p;try{A.p=2,se.T=null,x3(o,l,c,f,we,m,v,b,P,N,K)}finally{se.T=he,A.p=we}}function x3(o,l,c,f,m,v,b,P){do kh();while(Fu!==null);if((Cn&6)!==0)throw Error(i(327));var N=o.finishedWork;if(f=o.finishedLanes,N===null)return null;if(o.finishedWork=null,o.finishedLanes=0,N===o.current)throw Error(i(177));o.callbackNode=null,o.callbackPriority=0,o.cancelPendingCommit=null;var K=N.lanes|N.childLanes;if(K|=wb,Up(o,f,K,v,b,P),o===nn&&(wt=nn=null,Mt=0),(N.subtreeFlags&10256)===0&&(N.flags&10256)===0||Lv||(Lv=!0,RR=K,ER=c,N3(rt,function(){return kh(),null})),c=(N.flags&15990)!==0,(N.subtreeFlags&15990)!==0||c?(c=se.T,se.T=null,v=A.p,A.p=2,b=Cn,Cn|=4,y3(o,N),dN(N,o),e3(BR,o.containerInfo),Xv=!!FR,BR=FR=null,o.current=N,lN(o,N.alternate,N),Ne(),Cn=b,A.p=v,se.T=c):o.current=N,Lv?(Lv=!1,Fu=o,rg=f):IN(o,K),K=o.pendingLanes,K===0&&(_l=null),Zt(N.stateNode),fo(o),l!==null)for(m=o.onRecoverableError,N=0;N<l.length;N++)K=l[N],m(K.value,{componentStack:K.stack});return(rg&3)!==0&&kh(),K=o.pendingLanes,(f&4194218)!==0&&(K&42)!==0?o===TR?sg++:(sg=0,TR=o):sg=0,og(0),null}function IN(o,l){(o.pooledCacheLanes&=l)===0&&(l=o.pooledCache,l!=null&&(o.pooledCache=null,Wf(l)))}function kh(){if(Fu!==null){var o=Fu,l=RR;RR=0;var c=bu(rg),f=se.T,m=A.p;try{if(A.p=32>c?32:c,se.T=null,Fu===null)var v=!1;else{c=ER,ER=null;var b=Fu,P=rg;if(Fu=null,rg=0,(Cn&6)!==0)throw Error(i(331));var N=Cn;if(Cn|=4,vN(b.current),gN(b,b.current,P,c),Cn=N,og(0,!1),Ct&&typeof Ct.onPostCommitFiberRoot=="function")try{Ct.onPostCommitFiberRoot(tn,b)}catch{}v=!0}return v}finally{A.p=m,se.T=f,IN(o,l)}}return!1}function NN(o,l,c){l=Xr(c,l),l=Gb(o.stateNode,l,2),o=Cl(o,l,2),o!==null&&(cl(o,2),fo(o))}function Qt(o,l,c){if(o.tag===3)NN(o,o,c);else for(;l!==null;){if(l.tag===3){NN(l,o,c);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(_l===null||!_l.has(f))){o=Xr(c,o),c=kI(2),f=Cl(l,c,2),f!==null&&(VI(c,f,l,o),cl(f,2),fo(f));break}}l=l.return}}function xR(o,l,c){var f=o.pingCache;if(f===null){f=o.pingCache=new T3;var m=new Set;f.set(l,m)}else m=f.get(l),m===void 0&&(m=new Set,f.set(l,m));m.has(c)||(yR=!0,m.add(c),o=H3.bind(null,o,l,c),l.then(o,o))}function H3(o,l,c){var f=o.pingCache;f!==null&&f.delete(l),o.pingedLanes|=o.suspendedLanes&c,o.warmLanes&=~c,nn===o&&(Mt&c)===c&&(Hn===4||Hn===3&&(Mt&62914560)===Mt&&300>Fe()-bR?(Cn&2)===0&&Dh(o,0):CR|=c,Nh===Mt&&(Nh=0)),fo(o)}function DN(o,l){l===0&&(l=Ef()),o=dl(o,l),o!==null&&(cl(o,l),fo(o))}function P3(o){var l=o.memoizedState,c=0;l!==null&&(c=l.retryLane),DN(o,c)}function I3(o,l){var c=0;switch(o.tag){case 13:var f=o.stateNode,m=o.memoizedState;m!==null&&(c=m.retryLane);break;case 19:f=o.stateNode;break;case 22:f=o.stateNode._retryCache;break;default:throw Error(i(314))}f!==null&&f.delete(l),DN(o,c)}function N3(o,l){return ee(o,l)}var $v=null,Vh=null,HR=!1,Fv=!1,PR=!1,Bu=0;function fo(o){o!==Vh&&o.next===null&&(Vh===null?$v=Vh=o:Vh=Vh.next=o),Fv=!0,HR||(HR=!0,L3(D3))}function og(o,l){if(!PR&&Fv){PR=!0;do for(var c=!1,f=$v;f!==null;){if(o!==0){var m=f.pendingLanes;if(m===0)var v=0;else{var b=f.suspendedLanes,P=f.pingedLanes;v=(1<<31-Ke(42|o)+1)-1,v&=m&~(b&~P),v=v&201326677?v&201326677|1:v?v|2:0}v!==0&&(c=!0,VN(f,v))}else v=Mt,v=ch(f,f===nn?v:0),(v&3)===0||fn(f,v)||(c=!0,VN(f,v));f=f.next}while(c);PR=!1}}function D3(){Fv=HR=!1;var o=0;Bu!==0&&(j3()&&(o=Bu),Bu=0);for(var l=Fe(),c=null,f=$v;f!==null;){var m=f.next,v=LN(f,l);v===0?(f.next=null,c===null?$v=m:c.next=m,m===null&&(Vh=c)):(c=f,(o!==0||(v&3)!==0)&&(Fv=!0)),f=m}og(o)}function LN(o,l){for(var c=o.suspendedLanes,f=o.pingedLanes,m=o.expirationTimes,v=o.pendingLanes&-62914561;0<v;){var b=31-Ke(v),P=1<<b,N=m[b];N===-1?((P&c)===0||(P&f)!==0)&&(m[b]=ul(P,l)):N<=l&&(o.expiredLanes|=P),v&=~P}if(l=nn,c=Mt,c=ch(o,o===l?c:0),f=o.callbackNode,c===0||o===l&&rn===2||o.cancelPendingCommit!==null)return f!==null&&f!==null&&ce(f),o.callbackNode=null,o.callbackPriority=0;if((c&3)===0||fn(o,c)){if(l=c&-c,l===o.callbackPriority)return l;switch(f!==null&&ce(f),bu(c)){case 2:case 8:c=Je;break;case 32:c=rt;break;case 268435456:c=ir;break;default:c=rt}return f=kN.bind(null,o),c=ee(c,f),o.callbackPriority=l,o.callbackNode=c,l}return f!==null&&f!==null&&ce(f),o.callbackPriority=2,o.callbackNode=null,2}function kN(o,l){var c=o.callbackNode;if(kh()&&o.callbackNode!==c)return null;var f=Mt;return f=ch(o,o===nn?f:0),f===0?null:(EN(o,f,l),LN(o,Fe()),o.callbackNode!=null&&o.callbackNode===c?kN.bind(null,o):null)}function VN(o,l){if(kh())return null;EN(o,l,!0)}function L3(o){Y3(function(){(Cn&6)!==0?ee(ft,o):o()})}function IR(){return Bu===0&&(Bu=Wp()),Bu}function $N(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:ev(""+o)}function FN(o,l){var c=l.ownerDocument.createElement("input");return c.name=l.name,c.value=l.value,o.id&&c.setAttribute("form",o.id),l.parentNode.insertBefore(c,l),o=new FormData(o),c.parentNode.removeChild(c),o}function k3(o,l,c,f,m){if(l==="submit"&&c&&c.stateNode===m){var v=$N((m[gn]||null).action),b=f.submitter;b&&(l=(l=b[gn]||null)?$N(l.formAction):b.getAttribute("formAction"),l!==null&&(v=l,b=null));var P=new rv("action","action",null,f,m);o.push({event:P,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Bu!==0){var N=b?FN(m,b):new FormData(m);Wb(c,{pending:!0,data:N,method:m.method,action:v},null,N)}}else typeof v=="function"&&(P.preventDefault(),N=b?FN(m,b):new FormData(m),Wb(c,{pending:!0,data:N,method:m.method,action:v},v,N))},currentTarget:m}]})}}for(var NR=0;NR<PP.length;NR++){var DR=PP[NR],V3=DR.toLowerCase(),$3=DR[0].toUpperCase()+DR.slice(1);Ms(V3,"on"+$3)}Ms(MP,"onAnimationEnd"),Ms(OP,"onAnimationIteration"),Ms(AP,"onAnimationStart"),Ms("dblclick","onDoubleClick"),Ms("focusin","onFocus"),Ms("focusout","onBlur"),Ms(n3,"onTransitionRun"),Ms(i3,"onTransitionStart"),Ms(r3,"onTransitionCancel"),Ms(xP,"onTransitionEnd"),An("onMouseEnter",["mouseout","mouseover"]),An("onMouseLeave",["mouseout","mouseover"]),An("onPointerEnter",["pointerout","pointerover"]),An("onPointerLeave",["pointerout","pointerover"]),Er("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Er("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Er("onBeforeInput",["compositionend","keypress","textInput","paste"]),Er("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Er("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Er("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ag="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),F3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ag));function BN(o,l){l=(l&4)!==0;for(var c=0;c<o.length;c++){var f=o[c],m=f.event;f=f.listeners;e:{var v=void 0;if(l)for(var b=f.length-1;0<=b;b--){var P=f[b],N=P.instance,K=P.currentTarget;if(P=P.listener,N!==v&&m.isPropagationStopped())break e;v=P,m.currentTarget=K;try{v(m)}catch(he){_v(he)}m.currentTarget=null,v=N}else for(b=0;b<f.length;b++){if(P=f[b],N=P.instance,K=P.currentTarget,P=P.listener,N!==v&&m.isPropagationStopped())break e;v=P,m.currentTarget=K;try{v(m)}catch(he){_v(he)}m.currentTarget=null,v=N}}}}function Tt(o,l){var c=l[hh];c===void 0&&(c=l[hh]=new Set);var f=o+"__bubble";c.has(f)||(WN(l,o,2,!1),c.add(f))}function LR(o,l,c){var f=0;l&&(f|=4),WN(c,o,f,l)}var Bv="_reactListening"+Math.random().toString(36).slice(2);function kR(o){if(!o[Bv]){o[Bv]=!0,Si.forEach(function(c){c!=="selectionchange"&&(F3.has(c)||LR(c,!1,o),LR(c,!0,o))});var l=o.nodeType===9?o:o.ownerDocument;l===null||l[Bv]||(l[Bv]=!0,LR("selectionchange",!1,l))}}function WN(o,l,c,f){switch(hD(l)){case 2:var m=d4;break;case 8:m=f4;break;default:m=XR}c=m.bind(null,l,c,o),m=void 0,!sb||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(m=!0),f?m!==void 0?o.addEventListener(l,c,{capture:!0,passive:m}):o.addEventListener(l,c,!0):m!==void 0?o.addEventListener(l,c,{passive:m}):o.addEventListener(l,c,!1)}function VR(o,l,c,f,m){var v=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var b=f.tag;if(b===3||b===4){var P=f.stateNode.containerInfo;if(P===m||P.nodeType===8&&P.parentNode===m)break;if(b===4)for(b=f.return;b!==null;){var N=b.tag;if((N===3||N===4)&&(N=b.stateNode.containerInfo,N===m||N.nodeType===8&&N.parentNode===m))return;b=b.return}for(;P!==null;){if(b=ye(P),b===null)return;if(N=b.tag,N===5||N===6||N===26||N===27){f=v=b;continue e}P=P.parentNode}}f=f.return}iP(function(){var K=v,he=ib(c),we=[];e:{var oe=HP.get(o);if(oe!==void 0){var ue=rv,Be=o;switch(o){case"keypress":if(nv(c)===0)break e;case"keydown":case"keyup":ue=Iq;break;case"focusin":Be="focus",ue=ub;break;case"focusout":Be="blur",ue=ub;break;case"beforeblur":case"afterblur":ue=ub;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=oP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=Sq;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=Lq;break;case MP:case OP:case AP:ue=Eq;break;case xP:ue=Vq;break;case"scroll":case"scrollend":ue=yq;break;case"wheel":ue=Fq;break;case"copy":case"cut":case"paste":ue=_q;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=lP;break;case"toggle":case"beforetoggle":ue=Wq}var tt=(l&4)!==0,Pn=!tt&&(o==="scroll"||o==="scrollend"),te=tt?oe!==null?oe+"Capture":null:oe;tt=[];for(var G=K,ie;G!==null;){var ge=G;if(ie=ge.stateNode,ge=ge.tag,ge!==5&&ge!==26&&ge!==27||ie===null||te===null||(ge=_f(G,te),ge!=null&&tt.push(lg(G,ge,ie))),Pn)break;G=G.return}0<tt.length&&(oe=new ue(oe,Be,null,c,he),we.push({event:oe,listeners:tt}))}}if((l&7)===0){e:{if(oe=o==="mouseover"||o==="pointerover",ue=o==="mouseout"||o==="pointerout",oe&&c!==nb&&(Be=c.relatedTarget||c.fromElement)&&(ye(Be)||Be[na]))break e;if((ue||oe)&&(oe=he.window===he?he:(oe=he.ownerDocument)?oe.defaultView||oe.parentWindow:window,ue?(Be=c.relatedTarget||c.toElement,ue=K,Be=Be?ye(Be):null,Be!==null&&(Pn=Re(Be),tt=Be.tag,Be!==Pn||tt!==5&&tt!==27&&tt!==6)&&(Be=null)):(ue=null,Be=K),ue!==Be)){if(tt=oP,ge="onMouseLeave",te="onMouseEnter",G="mouse",(o==="pointerout"||o==="pointerover")&&(tt=lP,ge="onPointerLeave",te="onPointerEnter",G="pointer"),Pn=ue==null?oe:Ft(ue),ie=Be==null?oe:Ft(Be),oe=new tt(ge,G+"leave",ue,c,he),oe.target=Pn,oe.relatedTarget=ie,ge=null,ye(he)===K&&(tt=new tt(te,G+"enter",Be,c,he),tt.target=ie,tt.relatedTarget=Pn,ge=tt),Pn=ge,ue&&Be)t:{for(tt=ue,te=Be,G=0,ie=tt;ie;ie=$h(ie))G++;for(ie=0,ge=te;ge;ge=$h(ge))ie++;for(;0<G-ie;)tt=$h(tt),G--;for(;0<ie-G;)te=$h(te),ie--;for(;G--;){if(tt===te||te!==null&&tt===te.alternate)break t;tt=$h(tt),te=$h(te)}tt=null}else tt=null;ue!==null&&UN(we,oe,ue,tt,!1),Be!==null&&Pn!==null&&UN(we,Pn,Be,tt,!0)}}e:{if(oe=K?Ft(K):window,ue=oe.nodeName&&oe.nodeName.toLowerCase(),ue==="select"||ue==="input"&&oe.type==="file")var Le=pP;else if(gP(oe))if(vP)Le=Qq;else{Le=Xq;var vt=Kq}else ue=oe.nodeName,!ue||ue.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?K&&tb(K.elementType)&&(Le=pP):Le=Zq;if(Le&&(Le=Le(o,K))){mP(we,Le,c,he);break e}vt&&vt(o,oe,K),o==="focusout"&&K&&oe.type==="number"&&K.memoizedProps.value!=null&&eb(oe,"number",oe.value)}switch(vt=K?Ft(K):window,o){case"focusin":(gP(vt)||vt.contentEditable==="true")&&(vh=vt,mb=K,Nf=null);break;case"focusout":Nf=mb=vh=null;break;case"mousedown":pb=!0;break;case"contextmenu":case"mouseup":case"dragend":pb=!1,TP(we,c,he);break;case"selectionchange":if(t3)break;case"keydown":case"keyup":TP(we,c,he)}var Ue;if(hb)e:{switch(o){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else ph?dP(o,c)&&(Ze="onCompositionEnd"):o==="keydown"&&c.keyCode===229&&(Ze="onCompositionStart");Ze&&(uP&&c.locale!=="ko"&&(ph||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&ph&&(Ue=rP()):(hl=he,ob="value"in hl?hl.value:hl.textContent,ph=!0)),vt=Wv(K,Ze),0<vt.length&&(Ze=new aP(Ze,o,null,c,he),we.push({event:Ze,listeners:vt}),Ue?Ze.data=Ue:(Ue=fP(c),Ue!==null&&(Ze.data=Ue)))),(Ue=jq?zq(o,c):Yq(o,c))&&(Ze=Wv(K,"onBeforeInput"),0<Ze.length&&(vt=new aP("onBeforeInput","beforeinput",null,c,he),we.push({event:vt,listeners:Ze}),vt.data=Ue)),k3(we,o,K,c,he)}BN(we,l)})}function lg(o,l,c){return{instance:o,listener:l,currentTarget:c}}function Wv(o,l){for(var c=l+"Capture",f=[];o!==null;){var m=o,v=m.stateNode;m=m.tag,m!==5&&m!==26&&m!==27||v===null||(m=_f(o,c),m!=null&&f.unshift(lg(o,m,v)),m=_f(o,l),m!=null&&f.push(lg(o,m,v))),o=o.return}return f}function $h(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function UN(o,l,c,f,m){for(var v=l._reactName,b=[];c!==null&&c!==f;){var P=c,N=P.alternate,K=P.stateNode;if(P=P.tag,N!==null&&N===f)break;P!==5&&P!==26&&P!==27||K===null||(N=K,m?(K=_f(c,v),K!=null&&b.unshift(lg(c,K,N))):m||(K=_f(c,v),K!=null&&b.push(lg(c,K,N)))),c=c.return}b.length!==0&&o.push({event:l,listeners:b})}var B3=/\r\n?/g,W3=/\u0000|\uFFFD/g;function jN(o){return(typeof o=="string"?o:""+o).replace(B3,`
`).replace(W3,"")}function zN(o,l){return l=jN(l),jN(o)===l}function Uv(){}function qt(o,l,c,f,m,v){switch(c){case"children":typeof f=="string"?l==="body"||l==="textarea"&&f===""||fh(o,f):(typeof f=="number"||typeof f=="bigint")&&l!=="body"&&fh(o,""+f);break;case"className":Zp(o,"class",f);break;case"tabIndex":Zp(o,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Zp(o,c,f);break;case"style":tP(o,f,v);break;case"data":if(l!=="object"){Zp(o,"data",f);break}case"src":case"href":if(f===""&&(l!=="a"||c!=="href")){o.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){o.removeAttribute(c);break}f=ev(""+f),o.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){o.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(c==="formAction"?(l!=="input"&&qt(o,l,"name",m.name,m,null),qt(o,l,"formEncType",m.formEncType,m,null),qt(o,l,"formMethod",m.formMethod,m,null),qt(o,l,"formTarget",m.formTarget,m,null)):(qt(o,l,"encType",m.encType,m,null),qt(o,l,"method",m.method,m,null),qt(o,l,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){o.removeAttribute(c);break}f=ev(""+f),o.setAttribute(c,f);break;case"onClick":f!=null&&(o.onclick=Uv);break;case"onScroll":f!=null&&Tt("scroll",o);break;case"onScrollEnd":f!=null&&Tt("scrollend",o);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(i(60));o.innerHTML=c}}break;case"multiple":o.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":o.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){o.removeAttribute("xlink:href");break}c=ev(""+f),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?o.setAttribute(c,""+f):o.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?o.setAttribute(c,""):o.removeAttribute(c);break;case"capture":case"download":f===!0?o.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?o.setAttribute(c,f):o.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?o.setAttribute(c,f):o.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?o.removeAttribute(c):o.setAttribute(c,f);break;case"popover":Tt("beforetoggle",o),Tt("toggle",o),Xp(o,"popover",f);break;case"xlinkActuate":ia(o,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":ia(o,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":ia(o,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":ia(o,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":ia(o,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":ia(o,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":ia(o,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":ia(o,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":ia(o,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Xp(o,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=vq.get(c)||c,Xp(o,c,f))}}function $R(o,l,c,f,m,v){switch(c){case"style":tP(o,f,v);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(i(60));o.innerHTML=c}}break;case"children":typeof f=="string"?fh(o,f):(typeof f=="number"||typeof f=="bigint")&&fh(o,""+f);break;case"onScroll":f!=null&&Tt("scroll",o);break;case"onScrollEnd":f!=null&&Tt("scrollend",o);break;case"onClick":f!=null&&(o.onclick=Uv);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Rr.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),l=c.slice(2,m?c.length-7:void 0),v=o[gn]||null,v=v!=null?v[c]:null,typeof v=="function"&&o.removeEventListener(l,v,m),typeof f=="function")){typeof v!="function"&&v!==null&&(c in o?o[c]=null:o.hasAttribute(c)&&o.removeAttribute(c)),o.addEventListener(l,f,m);break e}c in o?o[c]=f:f===!0?o.setAttribute(c,""):Xp(o,c,f)}}}function Ei(o,l,c){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Tt("error",o),Tt("load",o);var f=!1,m=!1,v;for(v in c)if(c.hasOwnProperty(v)){var b=c[v];if(b!=null)switch(v){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:qt(o,l,v,b,c,null)}}m&&qt(o,l,"srcSet",c.srcSet,c,null),f&&qt(o,l,"src",c.src,c,null);return;case"input":Tt("invalid",o);var P=v=b=m=null,N=null,K=null;for(f in c)if(c.hasOwnProperty(f)){var he=c[f];if(he!=null)switch(f){case"name":m=he;break;case"type":b=he;break;case"checked":N=he;break;case"defaultChecked":K=he;break;case"value":v=he;break;case"defaultValue":P=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,l));break;default:qt(o,l,f,he,c,null)}}ZH(o,v,P,N,K,b,m,!1),Qp(o);return;case"select":Tt("invalid",o),f=b=v=null;for(m in c)if(c.hasOwnProperty(m)&&(P=c[m],P!=null))switch(m){case"value":v=P;break;case"defaultValue":b=P;break;case"multiple":f=P;default:qt(o,l,m,P,c,null)}l=v,c=b,o.multiple=!!f,l!=null?dh(o,!!f,l,!1):c!=null&&dh(o,!!f,c,!0);return;case"textarea":Tt("invalid",o),v=m=f=null;for(b in c)if(c.hasOwnProperty(b)&&(P=c[b],P!=null))switch(b){case"value":f=P;break;case"defaultValue":m=P;break;case"children":v=P;break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(i(91));break;default:qt(o,l,b,P,c,null)}JH(o,f,m,v),Qp(o);return;case"option":for(N in c)if(c.hasOwnProperty(N)&&(f=c[N],f!=null))switch(N){case"selected":o.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:qt(o,l,N,f,c,null)}return;case"dialog":Tt("cancel",o),Tt("close",o);break;case"iframe":case"object":Tt("load",o);break;case"video":case"audio":for(f=0;f<ag.length;f++)Tt(ag[f],o);break;case"image":Tt("error",o),Tt("load",o);break;case"details":Tt("toggle",o);break;case"embed":case"source":case"link":Tt("error",o),Tt("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(K in c)if(c.hasOwnProperty(K)&&(f=c[K],f!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:qt(o,l,K,f,c,null)}return;default:if(tb(l)){for(he in c)c.hasOwnProperty(he)&&(f=c[he],f!==void 0&&$R(o,l,he,f,c,void 0));return}}for(P in c)c.hasOwnProperty(P)&&(f=c[P],f!=null&&qt(o,l,P,f,c,null))}function U3(o,l,c,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,v=null,b=null,P=null,N=null,K=null,he=null;for(ue in c){var we=c[ue];if(c.hasOwnProperty(ue)&&we!=null)switch(ue){case"checked":break;case"value":break;case"defaultValue":N=we;default:f.hasOwnProperty(ue)||qt(o,l,ue,null,f,we)}}for(var oe in f){var ue=f[oe];if(we=c[oe],f.hasOwnProperty(oe)&&(ue!=null||we!=null))switch(oe){case"type":v=ue;break;case"name":m=ue;break;case"checked":K=ue;break;case"defaultChecked":he=ue;break;case"value":b=ue;break;case"defaultValue":P=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(i(137,l));break;default:ue!==we&&qt(o,l,oe,ue,f,we)}}JS(o,b,P,N,K,he,v,m);return;case"select":ue=b=P=oe=null;for(v in c)if(N=c[v],c.hasOwnProperty(v)&&N!=null)switch(v){case"value":break;case"multiple":ue=N;default:f.hasOwnProperty(v)||qt(o,l,v,null,f,N)}for(m in f)if(v=f[m],N=c[m],f.hasOwnProperty(m)&&(v!=null||N!=null))switch(m){case"value":oe=v;break;case"defaultValue":P=v;break;case"multiple":b=v;default:v!==N&&qt(o,l,m,v,f,N)}l=P,c=b,f=ue,oe!=null?dh(o,!!c,oe,!1):!!f!=!!c&&(l!=null?dh(o,!!c,l,!0):dh(o,!!c,c?[]:"",!1));return;case"textarea":ue=oe=null;for(P in c)if(m=c[P],c.hasOwnProperty(P)&&m!=null&&!f.hasOwnProperty(P))switch(P){case"value":break;case"children":break;default:qt(o,l,P,null,f,m)}for(b in f)if(m=f[b],v=c[b],f.hasOwnProperty(b)&&(m!=null||v!=null))switch(b){case"value":oe=m;break;case"defaultValue":ue=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==v&&qt(o,l,b,m,f,v)}QH(o,oe,ue);return;case"option":for(var Be in c)if(oe=c[Be],c.hasOwnProperty(Be)&&oe!=null&&!f.hasOwnProperty(Be))switch(Be){case"selected":o.selected=!1;break;default:qt(o,l,Be,null,f,oe)}for(N in f)if(oe=f[N],ue=c[N],f.hasOwnProperty(N)&&oe!==ue&&(oe!=null||ue!=null))switch(N){case"selected":o.selected=oe&&typeof oe!="function"&&typeof oe!="symbol";break;default:qt(o,l,N,oe,f,ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var tt in c)oe=c[tt],c.hasOwnProperty(tt)&&oe!=null&&!f.hasOwnProperty(tt)&&qt(o,l,tt,null,f,oe);for(K in f)if(oe=f[K],ue=c[K],f.hasOwnProperty(K)&&oe!==ue&&(oe!=null||ue!=null))switch(K){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,l));break;default:qt(o,l,K,oe,f,ue)}return;default:if(tb(l)){for(var Pn in c)oe=c[Pn],c.hasOwnProperty(Pn)&&oe!==void 0&&!f.hasOwnProperty(Pn)&&$R(o,l,Pn,void 0,f,oe);for(he in f)oe=f[he],ue=c[he],!f.hasOwnProperty(he)||oe===ue||oe===void 0&&ue===void 0||$R(o,l,he,oe,f,ue);return}}for(var te in c)oe=c[te],c.hasOwnProperty(te)&&oe!=null&&!f.hasOwnProperty(te)&&qt(o,l,te,null,f,oe);for(we in f)oe=f[we],ue=c[we],!f.hasOwnProperty(we)||oe===ue||oe==null&&ue==null||qt(o,l,we,oe,f,ue)}var FR=null,BR=null;function jv(o){return o.nodeType===9?o:o.ownerDocument}function YN(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function GN(o,l){if(o===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&l==="foreignObject"?0:o}function WR(o,l){return o==="textarea"||o==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var UR=null;function j3(){var o=window.event;return o&&o.type==="popstate"?o===UR?!1:(UR=o,!0):(UR=null,!1)}var qN=typeof setTimeout=="function"?setTimeout:void 0,z3=typeof clearTimeout=="function"?clearTimeout:void 0,KN=typeof Promise=="function"?Promise:void 0,Y3=typeof queueMicrotask=="function"?queueMicrotask:typeof KN<"u"?function(o){return KN.resolve(null).then(o).catch(G3)}:qN;function G3(o){setTimeout(function(){throw o})}function jR(o,l){var c=l,f=0;do{var m=c.nextSibling;if(o.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(f===0){o.removeChild(m),pg(l);return}f--}else c!=="$"&&c!=="$?"&&c!=="$!"||f++;c=m}while(c);pg(l)}function zR(o){var l=o.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var c=l;switch(l=l.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":zR(c),Y(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}o.removeChild(c)}}function q3(o,l,c,f){for(;o.nodeType===1;){var m=c;if(o.nodeName.toLowerCase()!==l.toLowerCase()){if(!f&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(f){if(!o[Ve])switch(l){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(v=o.getAttribute("rel"),v==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(v!==m.rel||o.getAttribute("href")!==(m.href==null?null:m.href)||o.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||o.getAttribute("title")!==(m.title==null?null:m.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(v=o.getAttribute("src"),(v!==(m.src==null?null:m.src)||o.getAttribute("type")!==(m.type==null?null:m.type)||o.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&v&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(l==="input"&&o.type==="hidden"){var v=m.name==null?null:""+m.name;if(m.type==="hidden"&&o.getAttribute("name")===v)return o}else return o;if(o=xs(o.nextSibling),o===null)break}return null}function K3(o,l,c){if(l==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!c||(o=xs(o.nextSibling),o===null))return null;return o}function xs(o){for(;o!=null;o=o.nextSibling){var l=o.nodeType;if(l===1||l===3)break;if(l===8){if(l=o.data,l==="$"||l==="$!"||l==="$?"||l==="F!"||l==="F")break;if(l==="/$")return null}}return o}function XN(o){o=o.previousSibling;for(var l=0;o;){if(o.nodeType===8){var c=o.data;if(c==="$"||c==="$!"||c==="$?"){if(l===0)return o;l--}else c==="/$"&&l++}o=o.previousSibling}return null}function ZN(o,l,c){switch(l=jv(c),o){case"html":if(o=l.documentElement,!o)throw Error(i(452));return o;case"head":if(o=l.head,!o)throw Error(i(453));return o;case"body":if(o=l.body,!o)throw Error(i(454));return o;default:throw Error(i(451))}}var rs=new Map,QN=new Set;function zv(o){return typeof o.getRootNode=="function"?o.getRootNode():o.ownerDocument}var wa=A.d;A.d={f:X3,r:Z3,D:Q3,C:J3,L:e4,m:t4,X:i4,S:n4,M:r4};function X3(){var o=wa.f(),l=kv();return o||l}function Z3(o){var l=He(o);l!==null&&l.tag===5&&l.type==="form"?TI(l):wa.r(o)}var Fh=typeof document>"u"?null:document;function JN(o,l,c){var f=Fh;if(f&&typeof l=="string"&&l){var m=qr(l);m='link[rel="'+o+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),QN.has(m)||(QN.add(m),o={rel:o,crossOrigin:c,href:l},f.querySelector(m)===null&&(l=f.createElement("link"),Ei(l,"link",o),St(l),f.head.appendChild(l)))}}function Q3(o){wa.D(o),JN("dns-prefetch",o,null)}function J3(o,l){wa.C(o,l),JN("preconnect",o,l)}function e4(o,l,c){wa.L(o,l,c);var f=Fh;if(f&&o&&l){var m='link[rel="preload"][as="'+qr(l)+'"]';l==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+qr(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+qr(c.imageSizes)+'"]')):m+='[href="'+qr(o)+'"]';var v=m;switch(l){case"style":v=Bh(o);break;case"script":v=Wh(o)}rs.has(v)||(o=Q({rel:"preload",href:l==="image"&&c&&c.imageSrcSet?void 0:o,as:l},c),rs.set(v,o),f.querySelector(m)!==null||l==="style"&&f.querySelector(ug(v))||l==="script"&&f.querySelector(cg(v))||(l=f.createElement("link"),Ei(l,"link",o),St(l),f.head.appendChild(l)))}}function t4(o,l){wa.m(o,l);var c=Fh;if(c&&o){var f=l&&typeof l.as=="string"?l.as:"script",m='link[rel="modulepreload"][as="'+qr(f)+'"][href="'+qr(o)+'"]',v=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Wh(o)}if(!rs.has(v)&&(o=Q({rel:"modulepreload",href:o},l),rs.set(v,o),c.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(cg(v)))return}f=c.createElement("link"),Ei(f,"link",o),St(f),c.head.appendChild(f)}}}function n4(o,l,c){wa.S(o,l,c);var f=Fh;if(f&&o){var m=wn(f).hoistableStyles,v=Bh(o);l=l||"default";var b=m.get(v);if(!b){var P={loading:0,preload:null};if(b=f.querySelector(ug(v)))P.loading=5;else{o=Q({rel:"stylesheet",href:o,"data-precedence":l},c),(c=rs.get(v))&&YR(o,c);var N=b=f.createElement("link");St(N),Ei(N,"link",o),N._p=new Promise(function(K,he){N.onload=K,N.onerror=he}),N.addEventListener("load",function(){P.loading|=1}),N.addEventListener("error",function(){P.loading|=2}),P.loading|=4,Yv(b,l,f)}b={type:"stylesheet",instance:b,count:1,state:P},m.set(v,b)}}}function i4(o,l){wa.X(o,l);var c=Fh;if(c&&o){var f=wn(c).hoistableScripts,m=Wh(o),v=f.get(m);v||(v=c.querySelector(cg(m)),v||(o=Q({src:o,async:!0},l),(l=rs.get(m))&&GR(o,l),v=c.createElement("script"),St(v),Ei(v,"link",o),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(m,v))}}function r4(o,l){wa.M(o,l);var c=Fh;if(c&&o){var f=wn(c).hoistableScripts,m=Wh(o),v=f.get(m);v||(v=c.querySelector(cg(m)),v||(o=Q({src:o,async:!0,type:"module"},l),(l=rs.get(m))&&GR(o,l),v=c.createElement("script"),St(v),Ei(v,"link",o),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(m,v))}}function eD(o,l,c,f){var m=(m=q.current)?zv(m):null;if(!m)throw Error(i(446));switch(o){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(l=Bh(c.href),c=wn(m).hoistableStyles,f=c.get(l),f||(f={type:"style",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){o=Bh(c.href);var v=wn(m).hoistableStyles,b=v.get(o);if(b||(m=m.ownerDocument||m,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(o,b),(v=m.querySelector(ug(o)))&&!v._p&&(b.instance=v,b.state.loading=5),rs.has(o)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},rs.set(o,c),v||s4(m,o,c,b.state))),l&&f===null)throw Error(i(528,""));return b}if(l&&f!==null)throw Error(i(529,""));return null;case"script":return l=c.async,c=c.src,typeof c=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Wh(c),c=wn(m).hoistableScripts,f=c.get(l),f||(f={type:"script",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,o))}}function Bh(o){return'href="'+qr(o)+'"'}function ug(o){return'link[rel="stylesheet"]['+o+"]"}function tD(o){return Q({},o,{"data-precedence":o.precedence,precedence:null})}function s4(o,l,c,f){o.querySelector('link[rel="preload"][as="style"]['+l+"]")?f.loading=1:(l=o.createElement("link"),f.preload=l,l.addEventListener("load",function(){return f.loading|=1}),l.addEventListener("error",function(){return f.loading|=2}),Ei(l,"link",c),St(l),o.head.appendChild(l))}function Wh(o){return'[src="'+qr(o)+'"]'}function cg(o){return"script[async]"+o}function nD(o,l,c){if(l.count++,l.instance===null)switch(l.type){case"style":var f=o.querySelector('style[data-href~="'+qr(c.href)+'"]');if(f)return l.instance=f,St(f),f;var m=Q({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(o.ownerDocument||o).createElement("style"),St(f),Ei(f,"style",m),Yv(f,c.precedence,o),l.instance=f;case"stylesheet":m=Bh(c.href);var v=o.querySelector(ug(m));if(v)return l.state.loading|=4,l.instance=v,St(v),v;f=tD(c),(m=rs.get(m))&&YR(f,m),v=(o.ownerDocument||o).createElement("link"),St(v);var b=v;return b._p=new Promise(function(P,N){b.onload=P,b.onerror=N}),Ei(v,"link",f),l.state.loading|=4,Yv(v,c.precedence,o),l.instance=v;case"script":return v=Wh(c.src),(m=o.querySelector(cg(v)))?(l.instance=m,St(m),m):(f=c,(m=rs.get(v))&&(f=Q({},c),GR(f,m)),o=o.ownerDocument||o,m=o.createElement("script"),St(m),Ei(m,"link",f),o.head.appendChild(m),l.instance=m);case"void":return null;default:throw Error(i(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(f=l.instance,l.state.loading|=4,Yv(f,c.precedence,o));return l.instance}function Yv(o,l,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,v=m,b=0;b<f.length;b++){var P=f[b];if(P.dataset.precedence===l)v=P;else if(v!==m)break}v?v.parentNode.insertBefore(o,v.nextSibling):(l=c.nodeType===9?c.head:c,l.insertBefore(o,l.firstChild))}function YR(o,l){o.crossOrigin==null&&(o.crossOrigin=l.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=l.referrerPolicy),o.title==null&&(o.title=l.title)}function GR(o,l){o.crossOrigin==null&&(o.crossOrigin=l.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=l.referrerPolicy),o.integrity==null&&(o.integrity=l.integrity)}var Gv=null;function iD(o,l,c){if(Gv===null){var f=new Map,m=Gv=new Map;m.set(c,f)}else m=Gv,f=m.get(c),f||(f=new Map,m.set(c,f));if(f.has(o))return f;for(f.set(o,null),c=c.getElementsByTagName(o),m=0;m<c.length;m++){var v=c[m];if(!(v[Ve]||v[ri]||o==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var b=v.getAttribute(l)||"";b=o+b;var P=f.get(b);P?P.push(v):f.set(b,[v])}}return f}function rD(o,l,c){o=o.ownerDocument||o,o.head.insertBefore(c,l==="title"?o.querySelector("head > title"):null)}function o4(o,l,c){if(c===1||l.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return o=l.disabled,typeof l.precedence=="string"&&o==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function sD(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var hg=null;function a4(){}function l4(o,l,c){if(hg===null)throw Error(i(475));var f=hg;if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var m=Bh(c.href),v=o.querySelector(ug(m));if(v){o=v._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(f.count++,f=qv.bind(f),o.then(f,f)),l.state.loading|=4,l.instance=v,St(v);return}v=o.ownerDocument||o,c=tD(c),(m=rs.get(m))&&YR(c,m),v=v.createElement("link"),St(v);var b=v;b._p=new Promise(function(P,N){b.onload=P,b.onerror=N}),Ei(v,"link",c),l.instance=v}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(l,o),(o=l.state.preload)&&(l.state.loading&3)===0&&(f.count++,l=qv.bind(f),o.addEventListener("load",l),o.addEventListener("error",l))}}function u4(){if(hg===null)throw Error(i(475));var o=hg;return o.stylesheets&&o.count===0&&qR(o,o.stylesheets),0<o.count?function(l){var c=setTimeout(function(){if(o.stylesheets&&qR(o,o.stylesheets),o.unsuspend){var f=o.unsuspend;o.unsuspend=null,f()}},6e4);return o.unsuspend=l,function(){o.unsuspend=null,clearTimeout(c)}}:null}function qv(){if(this.count--,this.count===0){if(this.stylesheets)qR(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Kv=null;function qR(o,l){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Kv=new Map,l.forEach(c4,o),Kv=null,qv.call(o))}function c4(o,l){if(!(l.state.loading&4)){var c=Kv.get(o);if(c)var f=c.get(null);else{c=new Map,Kv.set(o,c);for(var m=o.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<m.length;v++){var b=m[v];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(c.set(b.dataset.precedence,b),f=b)}f&&c.set(null,f)}m=l.instance,b=m.getAttribute("data-precedence"),v=c.get(b)||f,v===f&&c.set(null,m),c.set(b,m),this.count++,f=qv.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),v?v.parentNode.insertBefore(m,v.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(m,o.firstChild)),l.state.loading|=4}}var dg={$$typeof:y,Provider:null,Consumer:null,_currentValue:k,_currentValue2:k,_threadCount:0};function h4(o,l,c,f,m,v,b,P){this.tag=1,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Su(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Su(0),this.hiddenUpdates=Su(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=v,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function oD(o,l,c,f,m,v,b,P,N,K,he,we){return o=new h4(o,l,c,b,P,N,K,we),l=1,v===!0&&(l|=24),v=ns(3,null,null,l),o.current=v,v.stateNode=o,l=_b(),l.refCount++,o.pooledCache=l,l.refCount++,v.memoizedState={element:f,isDehydrated:c,cache:l},oR(v),o}function aD(o){return o?(o=Ch,o):Ch}function lD(o,l,c,f,m,v){m=aD(m),f.context===null?f.context=m:f.pendingContext=m,f=yl(l),f.payload={element:c},v=v===void 0?null:v,v!==null&&(f.callback=v),c=Cl(o,f,l),c!==null&&(Wi(c,o,l),Kf(c,o,l))}function uD(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var c=o.retryLane;o.retryLane=c!==0&&c<l?c:l}}function KR(o,l){uD(o,l),(o=o.alternate)&&uD(o,l)}function cD(o){if(o.tag===13){var l=dl(o,67108864);l!==null&&Wi(l,o,67108864),KR(o,67108864)}}var Xv=!0;function d4(o,l,c,f){var m=se.T;se.T=null;var v=A.p;try{A.p=2,XR(o,l,c,f)}finally{A.p=v,se.T=m}}function f4(o,l,c,f){var m=se.T;se.T=null;var v=A.p;try{A.p=8,XR(o,l,c,f)}finally{A.p=v,se.T=m}}function XR(o,l,c,f){if(Xv){var m=ZR(f);if(m===null)VR(o,l,f,Zv,c),dD(o,f);else if(m4(m,o,l,c,f))f.stopPropagation();else if(dD(o,f),l&4&&-1<g4.indexOf(o)){for(;m!==null;){var v=He(m);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var b=ta(v.pendingLanes);if(b!==0){var P=v;for(P.pendingLanes|=2,P.entangledLanes|=2;b;){var N=1<<31-Ke(b);P.entanglements[1]|=N,b&=~N}fo(v),(Cn&6)===0&&(Nv=Fe()+500,og(0))}}break;case 13:P=dl(v,2),P!==null&&Wi(P,v,2),kv(),KR(v,2)}if(v=ZR(f),v===null&&VR(o,l,f,Zv,c),v===m)break;m=v}m!==null&&f.stopPropagation()}else VR(o,l,f,null,c)}}function ZR(o){return o=ib(o),QR(o)}var Zv=null;function QR(o){if(Zv=null,o=ye(o),o!==null){var l=Re(o);if(l===null)o=null;else{var c=l.tag;if(c===13){if(o=qe(l),o!==null)return o;o=null}else if(c===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;o=null}else l!==o&&(o=null)}}return Zv=o,null}function hD(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(st()){case ft:return 2;case Je:return 8;case rt:case dn:return 32;case ir:return 268435456;default:return 32}default:return 32}}var JR=!1,Ml=null,Ol=null,Al=null,fg=new Map,gg=new Map,xl=[],g4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dD(o,l){switch(o){case"focusin":case"focusout":Ml=null;break;case"dragenter":case"dragleave":Ol=null;break;case"mouseover":case"mouseout":Al=null;break;case"pointerover":case"pointerout":fg.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":gg.delete(l.pointerId)}}function mg(o,l,c,f,m,v){return o===null||o.nativeEvent!==v?(o={blockedOn:l,domEventName:c,eventSystemFlags:f,nativeEvent:v,targetContainers:[m]},l!==null&&(l=He(l),l!==null&&cD(l)),o):(o.eventSystemFlags|=f,l=o.targetContainers,m!==null&&l.indexOf(m)===-1&&l.push(m),o)}function m4(o,l,c,f,m){switch(l){case"focusin":return Ml=mg(Ml,o,l,c,f,m),!0;case"dragenter":return Ol=mg(Ol,o,l,c,f,m),!0;case"mouseover":return Al=mg(Al,o,l,c,f,m),!0;case"pointerover":var v=m.pointerId;return fg.set(v,mg(fg.get(v)||null,o,l,c,f,m)),!0;case"gotpointercapture":return v=m.pointerId,gg.set(v,mg(gg.get(v)||null,o,l,c,f,m)),!0}return!1}function fD(o){var l=ye(o.target);if(l!==null){var c=Re(l);if(c!==null){if(l=c.tag,l===13){if(l=qe(c),l!==null){o.blockedOn=l,zp(o.priority,function(){if(c.tag===13){var f=Ar(),m=dl(c,f);m!==null&&Wi(m,c,f),KR(c,f)}});return}}else if(l===3&&c.stateNode.current.memoizedState.isDehydrated){o.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Qv(o){if(o.blockedOn!==null)return!1;for(var l=o.targetContainers;0<l.length;){var c=ZR(o.nativeEvent);if(c===null){c=o.nativeEvent;var f=new c.constructor(c.type,c);nb=f,c.target.dispatchEvent(f),nb=null}else return l=He(c),l!==null&&cD(l),o.blockedOn=c,!1;l.shift()}return!0}function gD(o,l,c){Qv(o)&&c.delete(l)}function p4(){JR=!1,Ml!==null&&Qv(Ml)&&(Ml=null),Ol!==null&&Qv(Ol)&&(Ol=null),Al!==null&&Qv(Al)&&(Al=null),fg.forEach(gD),gg.forEach(gD)}function Jv(o,l){o.blockedOn===l&&(o.blockedOn=null,JR||(JR=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,p4)))}var ew=null;function mD(o){ew!==o&&(ew=o,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){ew===o&&(ew=null);for(var l=0;l<o.length;l+=3){var c=o[l],f=o[l+1],m=o[l+2];if(typeof f!="function"){if(QR(f||c)===null)continue;break}var v=He(c);v!==null&&(o.splice(l,3),l-=3,Wb(v,{pending:!0,data:m,method:c.method,action:f},f,m))}}))}function pg(o){function l(N){return Jv(N,o)}Ml!==null&&Jv(Ml,o),Ol!==null&&Jv(Ol,o),Al!==null&&Jv(Al,o),fg.forEach(l),gg.forEach(l);for(var c=0;c<xl.length;c++){var f=xl[c];f.blockedOn===o&&(f.blockedOn=null)}for(;0<xl.length&&(c=xl[0],c.blockedOn===null);)fD(c),c.blockedOn===null&&xl.shift();if(c=(o.ownerDocument||o).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var m=c[f],v=c[f+1],b=m[gn]||null;if(typeof v=="function")b||mD(c);else if(b){var P=null;if(v&&v.hasAttribute("formAction")){if(m=v,b=v[gn]||null)P=b.formAction;else if(QR(m)!==null)continue}else P=b.action;typeof P=="function"?c[f+1]=P:(c.splice(f,3),f-=3),mD(c)}}}function e0(o){this._internalRoot=o}tw.prototype.render=e0.prototype.render=function(o){var l=this._internalRoot;if(l===null)throw Error(i(409));var c=l.current,f=Ar();lD(c,f,o,l,null,null)},tw.prototype.unmount=e0.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var l=o.containerInfo;o.tag===0&&kh(),lD(o.current,2,null,o,null,null),kv(),l[na]=null}};function tw(o){this._internalRoot=o}tw.prototype.unstable_scheduleHydration=function(o){if(o){var l=Tf();o={blockedOn:null,target:o,priority:l};for(var c=0;c<xl.length&&l!==0&&l<xl[c].priority;c++);xl.splice(c,0,o),c===0&&fD(o)}};var pD=e.version;if(pD!=="19.0.0")throw Error(i(527,pD,"19.0.0"));A.findDOMNode=function(o){var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(i(188)):(o=Object.keys(o).join(","),Error(i(268,o)));return o=C(l),o=o!==null?R(o):null,o=o===null?null:o.stateNode,o};var v4={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:se,findFiberByHostInstance:ye,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nw.isDisabled&&nw.supportsFiber)try{tn=nw.inject(v4),Ct=nw}catch{}}return wg.createRoot=function(o,l){if(!r(o))throw Error(i(299));var c=!1,f="",m=II,v=NI,b=DI,P=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(b=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(P=l.unstable_transitionCallbacks)),l=oD(o,1,!1,null,null,c,f,m,v,b,P,null),o[na]=l.current,kR(o.nodeType===8?o.parentNode:o),new e0(l)},wg.hydrateRoot=function(o,l,c){if(!r(o))throw Error(i(299));var f=!1,m="",v=II,b=NI,P=DI,N=null,K=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(v=c.onUncaughtError),c.onCaughtError!==void 0&&(b=c.onCaughtError),c.onRecoverableError!==void 0&&(P=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(N=c.unstable_transitionCallbacks),c.formState!==void 0&&(K=c.formState)),l=oD(o,1,!0,l,c??null,f,m,v,b,P,N,K),l.context=aD(null),c=l.current,f=Ar(),m=yl(f),m.callback=null,Cl(c,m,f),l.current.lanes=f,cl(l,f),fo(l),o[na]=l.current,kR(o),new tw(l)},wg.version="19.0.0",wg}var MD;function M4(){if(MD)return i0.exports;MD=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),i0.exports=_4(),i0.exports}var O4=M4(),A4=AU();const xU=OU(A4);var OD={},yg,AD;function di(){if(AD)return yg;AD=1;var t=function(e){return e&&e.Math===Math&&e};return yg=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof vD=="object"&&vD)||t(typeof yg=="object"&&yg)||function(){return this}()||Function("return this")(),yg}var a0={},l0,xD;function Oi(){return xD||(xD=1,l0=function(t){try{return!!t()}catch{return!0}}),l0}var u0,HD;function bs(){if(HD)return u0;HD=1;var t=Oi();return u0=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),u0}var c0,PD;function nS(){if(PD)return c0;PD=1;var t=Oi();return c0=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),c0}var h0,ID;function Fi(){if(ID)return h0;ID=1;var t=nS(),e=Function.prototype.call;return h0=t?e.bind(e):function(){return e.apply(e,arguments)},h0}var d0={},ND;function x4(){if(ND)return d0;ND=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return d0.f=n?function(r){var s=e(this,r);return!!s&&s.enumerable}:t,d0}var f0,DD;function iS(){return DD||(DD=1,f0=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),f0}var g0,LD;function Yn(){if(LD)return g0;LD=1;var t=nS(),e=Function.prototype,n=e.call,i=t&&e.bind.bind(n,n);return g0=t?i:function(r){return function(){return n.apply(r,arguments)}},g0}var m0,kD;function Jc(){if(kD)return m0;kD=1;var t=Yn(),e=t({}.toString),n=t("".slice);return m0=function(i){return n(e(i),8,-1)},m0}var p0,VD;function H4(){if(VD)return p0;VD=1;var t=Yn(),e=Oi(),n=Jc(),i=Object,r=t("".split);return p0=e(function(){return!i("z").propertyIsEnumerable(0)})?function(s){return n(s)==="String"?r(s,""):i(s)}:i,p0}var v0,$D;function rS(){return $D||($D=1,v0=function(t){return t==null}),v0}var w0,FD;function mp(){if(FD)return w0;FD=1;var t=rS(),e=TypeError;return w0=function(n){if(t(n))throw new e("Can't call method on "+n);return n},w0}var y0,BD;function pp(){if(BD)return y0;BD=1;var t=H4(),e=mp();return y0=function(n){return t(e(n))},y0}var C0,WD;function ni(){if(WD)return C0;WD=1;var t=typeof document=="object"&&document.all;return C0=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},C0}var S0,UD;function no(){if(UD)return S0;UD=1;var t=ni();return S0=function(e){return typeof e=="object"?e!==null:t(e)},S0}var b0,jD;function af(){if(jD)return b0;jD=1;var t=di(),e=ni(),n=function(i){return e(i)?i:void 0};return b0=function(i,r){return arguments.length<2?n(t[i]):t[i]&&t[i][r]},b0}var R0,zD;function vp(){if(zD)return R0;zD=1;var t=Yn();return R0=t({}.isPrototypeOf),R0}var E0,YD;function sS(){if(YD)return E0;YD=1;var t=di(),e=t.navigator,n=e&&e.userAgent;return E0=n?String(n):"",E0}var T0,GD;function P4(){if(GD)return T0;GD=1;var t=di(),e=sS(),n=t.process,i=t.Deno,r=n&&n.versions||i&&i.version,s=r&&r.v8,a,u;return s&&(a=s.split("."),u=a[0]>0&&a[0]<4?1:+(a[0]+a[1])),!u&&e&&(a=e.match(/Edge\/(\d+)/),(!a||a[1]>=74)&&(a=e.match(/Chrome\/(\d+)/),a&&(u=+a[1]))),T0=u,T0}var _0,qD;function sO(){if(qD)return _0;qD=1;var t=P4(),e=Oi(),n=di(),i=n.String;return _0=!!Object.getOwnPropertySymbols&&!e(function(){var r=Symbol("symbol detection");return!i(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&t&&t<41}),_0}var M0,KD;function HU(){if(KD)return M0;KD=1;var t=sO();return M0=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",M0}var O0,XD;function oO(){if(XD)return O0;XD=1;var t=af(),e=ni(),n=vp(),i=HU(),r=Object;return O0=i?function(s){return typeof s=="symbol"}:function(s){var a=t("Symbol");return e(a)&&n(a.prototype,r(s))},O0}var A0,ZD;function oS(){if(ZD)return A0;ZD=1;var t=String;return A0=function(e){try{return t(e)}catch{return"Object"}},A0}var x0,QD;function Cr(){if(QD)return x0;QD=1;var t=ni(),e=oS(),n=TypeError;return x0=function(i){if(t(i))return i;throw new n(e(i)+" is not a function")},x0}var H0,JD;function wp(){if(JD)return H0;JD=1;var t=Cr(),e=rS();return H0=function(n,i){var r=n[i];return e(r)?void 0:t(r)},H0}var P0,eL;function I4(){if(eL)return P0;eL=1;var t=Fi(),e=ni(),n=no(),i=TypeError;return P0=function(r,s){var a,u;if(s==="string"&&e(a=r.toString)&&!n(u=t(a,r))||e(a=r.valueOf)&&!n(u=t(a,r))||s!=="string"&&e(a=r.toString)&&!n(u=t(a,r)))return u;throw new i("Can't convert object to primitive value")},P0}var I0={exports:{}},N0,tL;function mu(){return tL||(tL=1,N0=!1),N0}var D0,nL;function aO(){if(nL)return D0;nL=1;var t=di(),e=Object.defineProperty;return D0=function(n,i){try{e(t,n,{value:i,configurable:!0,writable:!0})}catch{t[n]=i}return i},D0}var iL;function lO(){if(iL)return I0.exports;iL=1;var t=mu(),e=di(),n=aO(),i="__core-js_shared__",r=I0.exports=e[i]||n(i,{});return(r.versions||(r.versions=[])).push({version:"3.41.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"}),I0.exports}var L0,rL;function PU(){if(rL)return L0;rL=1;var t=lO();return L0=function(e,n){return t[e]||(t[e]=n||{})},L0}var k0,sL;function lf(){if(sL)return k0;sL=1;var t=mp(),e=Object;return k0=function(n){return e(t(n))},k0}var V0,oL;function Rs(){if(oL)return V0;oL=1;var t=Yn(),e=lf(),n=t({}.hasOwnProperty);return V0=Object.hasOwn||function(r,s){return n(e(r),s)},V0}var $0,aL;function IU(){if(aL)return $0;aL=1;var t=Yn(),e=0,n=Math.random(),i=t(1 .toString);return $0=function(r){return"Symbol("+(r===void 0?"":r)+")_"+i(++e+n,36)},$0}var F0,lL;function io(){if(lL)return F0;lL=1;var t=di(),e=PU(),n=Rs(),i=IU(),r=sO(),s=HU(),a=t.Symbol,u=e("wks"),h=s?a.for||a:a&&a.withoutSetter||i;return F0=function(d){return n(u,d)||(u[d]=r&&n(a,d)?a[d]:h("Symbol."+d)),u[d]},F0}var B0,uL;function N4(){if(uL)return B0;uL=1;var t=Fi(),e=no(),n=oO(),i=wp(),r=I4(),s=io(),a=TypeError,u=s("toPrimitive");return B0=function(h,d){if(!e(h)||n(h))return h;var g=i(h,u),p;if(g){if(d===void 0&&(d="default"),p=t(g,h,d),!e(p)||n(p))return p;throw new a("Can't convert object to primitive value")}return d===void 0&&(d="number"),r(h,d)},B0}var W0,cL;function NU(){if(cL)return W0;cL=1;var t=N4(),e=oO();return W0=function(n){var i=t(n,"string");return e(i)?i:i+""},W0}var U0,hL;function uO(){if(hL)return U0;hL=1;var t=di(),e=no(),n=t.document,i=e(n)&&e(n.createElement);return U0=function(r){return i?n.createElement(r):{}},U0}var j0,dL;function DU(){if(dL)return j0;dL=1;var t=bs(),e=Oi(),n=uO();return j0=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),j0}var fL;function LU(){if(fL)return a0;fL=1;var t=bs(),e=Fi(),n=x4(),i=iS(),r=pp(),s=NU(),a=Rs(),u=DU(),h=Object.getOwnPropertyDescriptor;return a0.f=t?h:function(g,p){if(g=r(g),p=s(p),u)try{return h(g,p)}catch{}if(a(g,p))return i(!e(n.f,g,p),g[p])},a0}var z0={},Y0,gL;function kU(){if(gL)return Y0;gL=1;var t=bs(),e=Oi();return Y0=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Y0}var G0,mL;function ii(){if(mL)return G0;mL=1;var t=no(),e=String,n=TypeError;return G0=function(i){if(t(i))return i;throw new n(e(i)+" is not an object")},G0}var pL;function pu(){if(pL)return z0;pL=1;var t=bs(),e=DU(),n=kU(),i=ii(),r=NU(),s=TypeError,a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",g="writable";return z0.f=t?n?function(w,y,S){if(i(w),y=r(y),i(S),typeof w=="function"&&y==="prototype"&&"value"in S&&g in S&&!S[g]){var _=u(w,y);_&&_[g]&&(w[y]=S.value,S={configurable:d in S?S[d]:_[d],enumerable:h in S?S[h]:_[h],writable:!1})}return a(w,y,S)}:a:function(w,y,S){if(i(w),y=r(y),i(S),e)try{return a(w,y,S)}catch{}if("get"in S||"set"in S)throw new s("Accessors not supported");return"value"in S&&(w[y]=S.value),w},z0}var q0,vL;function uf(){if(vL)return q0;vL=1;var t=bs(),e=pu(),n=iS();return q0=t?function(i,r,s){return e.f(i,r,n(1,s))}:function(i,r,s){return i[r]=s,i},q0}var K0={exports:{}},X0,wL;function D4(){if(wL)return X0;wL=1;var t=bs(),e=Rs(),n=Function.prototype,i=t&&Object.getOwnPropertyDescriptor,r=e(n,"name"),s=r&&(function(){}).name==="something",a=r&&(!t||t&&i(n,"name").configurable);return X0={EXISTS:r,PROPER:s,CONFIGURABLE:a},X0}var Z0,yL;function L4(){if(yL)return Z0;yL=1;var t=Yn(),e=ni(),n=lO(),i=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(r){return i(r)}),Z0=n.inspectSource,Z0}var Q0,CL;function k4(){if(CL)return Q0;CL=1;var t=di(),e=ni(),n=t.WeakMap;return Q0=e(n)&&/native code/.test(String(n)),Q0}var J0,SL;function cO(){if(SL)return J0;SL=1;var t=PU(),e=IU(),n=t("keys");return J0=function(i){return n[i]||(n[i]=e(i))},J0}var eE,bL;function hO(){return bL||(bL=1,eE={}),eE}var tE,RL;function VU(){if(RL)return tE;RL=1;var t=k4(),e=di(),n=no(),i=uf(),r=Rs(),s=lO(),a=cO(),u=hO(),h="Object already initialized",d=e.TypeError,g=e.WeakMap,p,w,y,S=function(x){return y(x)?w(x):p(x,{})},_=function(x){return function(D){var $;if(!n(D)||($=w(D)).type!==x)throw new d("Incompatible receiver, "+x+" required");return $}};if(t||s.state){var E=s.state||(s.state=new g);E.get=E.get,E.has=E.has,E.set=E.set,p=function(x,D){if(E.has(x))throw new d(h);return D.facade=x,E.set(x,D),D},w=function(x){return E.get(x)||{}},y=function(x){return E.has(x)}}else{var H=a("state");u[H]=!0,p=function(x,D){if(r(x,H))throw new d(h);return D.facade=x,i(x,H,D),D},w=function(x){return r(x,H)?x[H]:{}},y=function(x){return r(x,H)}}return tE={set:p,get:w,has:y,enforce:S,getterFor:_},tE}var EL;function $U(){if(EL)return K0.exports;EL=1;var t=Yn(),e=Oi(),n=ni(),i=Rs(),r=bs(),s=D4().CONFIGURABLE,a=L4(),u=VU(),h=u.enforce,d=u.get,g=String,p=Object.defineProperty,w=t("".slice),y=t("".replace),S=t([].join),_=r&&!e(function(){return p(function(){},"length",{value:8}).length!==8}),E=String(String).split("String"),H=K0.exports=function(x,D,$){w(g(D),0,7)==="Symbol("&&(D="["+y(g(D),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),$&&$.getter&&(D="get "+D),$&&$.setter&&(D="set "+D),(!i(x,"name")||s&&x.name!==D)&&(r?p(x,"name",{value:D,configurable:!0}):x.name=D),_&&$&&i($,"arity")&&x.length!==$.arity&&p(x,"length",{value:$.arity});try{$&&i($,"constructor")&&$.constructor?r&&p(x,"prototype",{writable:!1}):x.prototype&&(x.prototype=void 0)}catch{}var V=h(x);return i(V,"source")||(V.source=S(E,typeof D=="string"?D:"")),x};return Function.prototype.toString=H(function(){return n(this)&&d(this).source||a(this)},"toString"),K0.exports}var nE,TL;function dO(){if(TL)return nE;TL=1;var t=ni(),e=pu(),n=$U(),i=aO();return nE=function(r,s,a,u){u||(u={});var h=u.enumerable,d=u.name!==void 0?u.name:s;if(t(a)&&n(a,d,u),u.global)h?r[s]=a:i(s,a);else{try{u.unsafe?r[s]&&(h=!0):delete r[s]}catch{}h?r[s]=a:e.f(r,s,{value:a,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return r},nE}var iE={},rE,_L;function V4(){if(_L)return rE;_L=1;var t=Math.ceil,e=Math.floor;return rE=Math.trunc||function(i){var r=+i;return(r>0?e:t)(r)},rE}var sE,ML;function yp(){if(ML)return sE;ML=1;var t=V4();return sE=function(e){var n=+e;return n!==n||n===0?0:t(n)},sE}var oE,OL;function $4(){if(OL)return oE;OL=1;var t=yp(),e=Math.max,n=Math.min;return oE=function(i,r){var s=t(i);return s<0?e(s+r,0):n(s,r)},oE}var aE,AL;function F4(){if(AL)return aE;AL=1;var t=yp(),e=Math.min;return aE=function(n){var i=t(n);return i>0?e(i,9007199254740991):0},aE}var lE,xL;function cf(){if(xL)return lE;xL=1;var t=F4();return lE=function(e){return t(e.length)},lE}var uE,HL;function B4(){if(HL)return uE;HL=1;var t=pp(),e=$4(),n=cf(),i=function(r){return function(s,a,u){var h=t(s),d=n(h);if(d===0)return!r&&-1;var g=e(u,d),p;if(r&&a!==a){for(;d>g;)if(p=h[g++],p!==p)return!0}else for(;d>g;g++)if((r||g in h)&&h[g]===a)return r||g||0;return!r&&-1}};return uE={includes:i(!0),indexOf:i(!1)},uE}var cE,PL;function FU(){if(PL)return cE;PL=1;var t=Yn(),e=Rs(),n=pp(),i=B4().indexOf,r=hO(),s=t([].push);return cE=function(a,u){var h=n(a),d=0,g=[],p;for(p in h)!e(r,p)&&e(h,p)&&s(g,p);for(;u.length>d;)e(h,p=u[d++])&&(~i(g,p)||s(g,p));return g},cE}var hE,IL;function fO(){return IL||(IL=1,hE=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),hE}var NL;function W4(){if(NL)return iE;NL=1;var t=FU(),e=fO(),n=e.concat("length","prototype");return iE.f=Object.getOwnPropertyNames||function(r){return t(r,n)},iE}var dE={},DL;function U4(){return DL||(DL=1,dE.f=Object.getOwnPropertySymbols),dE}var fE,LL;function j4(){if(LL)return fE;LL=1;var t=af(),e=Yn(),n=W4(),i=U4(),r=ii(),s=e([].concat);return fE=t("Reflect","ownKeys")||function(u){var h=n.f(r(u)),d=i.f;return d?s(h,d(u)):h},fE}var gE,kL;function BU(){if(kL)return gE;kL=1;var t=Rs(),e=j4(),n=LU(),i=pu();return gE=function(r,s,a){for(var u=e(s),h=i.f,d=n.f,g=0;g<u.length;g++){var p=u[g];!t(r,p)&&!(a&&t(a,p))&&h(r,p,d(s,p))}},gE}var mE,VL;function z4(){if(VL)return mE;VL=1;var t=Oi(),e=ni(),n=/#|\.prototype\./,i=function(h,d){var g=s[r(h)];return g===u?!0:g===a?!1:e(d)?t(d):!!d},r=i.normalize=function(h){return String(h).replace(n,".").toLowerCase()},s=i.data={},a=i.NATIVE="N",u=i.POLYFILL="P";return mE=i,mE}var pE,$L;function en(){if($L)return pE;$L=1;var t=di(),e=LU().f,n=uf(),i=dO(),r=aO(),s=BU(),a=z4();return pE=function(u,h){var d=u.target,g=u.global,p=u.stat,w,y,S,_,E,H;if(g?y=t:p?y=t[d]||r(d,{}):y=t[d]&&t[d].prototype,y)for(S in h){if(E=h[S],u.dontCallGetSet?(H=e(y,S),_=H&&H.value):_=y[S],w=a(g?S:d+(p?".":"#")+S,u.forced),!w&&_!==void 0){if(typeof E==typeof _)continue;s(E,_)}(u.sham||_&&_.sham)&&n(E,"sham",!0),i(y,S,E,u)}},pE}var vE,FL;function aS(){if(FL)return vE;FL=1;var t=nS(),e=Function.prototype,n=e.apply,i=e.call;return vE=typeof Reflect=="object"&&Reflect.apply||(t?i.bind(n):function(){return i.apply(n,arguments)}),vE}var wE,BL;function WU(){if(BL)return wE;BL=1;var t=Yn(),e=Cr();return wE=function(n,i,r){try{return t(e(Object.getOwnPropertyDescriptor(n,i)[r]))}catch{}},wE}var yE,WL;function Y4(){if(WL)return yE;WL=1;var t=no();return yE=function(e){return t(e)||e===null},yE}var CE,UL;function G4(){if(UL)return CE;UL=1;var t=Y4(),e=String,n=TypeError;return CE=function(i){if(t(i))return i;throw new n("Can't set "+e(i)+" as a prototype")},CE}var SE,jL;function UU(){if(jL)return SE;jL=1;var t=WU(),e=no(),n=mp(),i=G4();return SE=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,s={},a;try{a=t(Object.prototype,"__proto__","set"),a(s,[]),r=s instanceof Array}catch{}return function(h,d){return n(h),i(d),e(h)&&(r?a(h,d):h.__proto__=d),h}}():void 0),SE}var bE,zL;function q4(){if(zL)return bE;zL=1;var t=pu().f;return bE=function(e,n,i){i in e||t(e,i,{configurable:!0,get:function(){return n[i]},set:function(r){n[i]=r}})},bE}var RE,YL;function K4(){if(YL)return RE;YL=1;var t=ni(),e=no(),n=UU();return RE=function(i,r,s){var a,u;return n&&t(a=r.constructor)&&a!==s&&e(u=a.prototype)&&u!==s.prototype&&n(i,u),i},RE}var EE,GL;function X4(){if(GL)return EE;GL=1;var t=io(),e=t("toStringTag"),n={};return n[e]="z",EE=String(n)==="[object z]",EE}var TE,qL;function jU(){if(qL)return TE;qL=1;var t=X4(),e=ni(),n=Jc(),i=io(),r=i("toStringTag"),s=Object,a=n(function(){return arguments}())==="Arguments",u=function(h,d){try{return h[d]}catch{}};return TE=t?n:function(h){var d,g,p;return h===void 0?"Undefined":h===null?"Null":typeof(g=u(d=s(h),r))=="string"?g:a?n(d):(p=n(d))==="Object"&&e(d.callee)?"Arguments":p},TE}var _E,KL;function lS(){if(KL)return _E;KL=1;var t=jU(),e=String;return _E=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},_E}var ME,XL;function Z4(){if(XL)return ME;XL=1;var t=lS();return ME=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},ME}var OE,ZL;function Q4(){if(ZL)return OE;ZL=1;var t=no(),e=uf();return OE=function(n,i){t(i)&&"cause"in i&&e(n,"cause",i.cause)},OE}var AE,QL;function J4(){if(QL)return AE;QL=1;var t=Yn(),e=Error,n=t("".replace),i=function(a){return String(new e(a).stack)}("zxcasd"),r=/\n\s*at [^:]*:[^\n]*/,s=r.test(i);return AE=function(a,u){if(s&&typeof a=="string"&&!e.prepareStackTrace)for(;u--;)a=n(a,r,"");return a},AE}var xE,JL;function eK(){if(JL)return xE;JL=1;var t=Oi(),e=iS();return xE=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),xE}var HE,ek;function tK(){if(ek)return HE;ek=1;var t=uf(),e=J4(),n=eK(),i=Error.captureStackTrace;return HE=function(r,s,a,u){n&&(i?i(r,s):t(r,"stack",e(a,u)))},HE}var PE,tk;function nK(){if(tk)return PE;tk=1;var t=af(),e=Rs(),n=uf(),i=vp(),r=UU(),s=BU(),a=q4(),u=K4(),h=Z4(),d=Q4(),g=tK(),p=bs(),w=mu();return PE=function(y,S,_,E){var H="stackTraceLimit",x=E?2:1,D=y.split("."),$=D[D.length-1],V=t.apply(null,D);if(V){var L=V.prototype;if(!w&&e(L,"cause")&&delete L.cause,!_)return V;var U=t("Error"),re=S(function(se,Q){var de=h(E?Q:se,void 0),me=E?new V(se):new V;return de!==void 0&&n(me,"message",de),g(me,re,me.stack,2),this&&i(L,this)&&u(me,this,re),arguments.length>x&&d(me,arguments[x]),me});if(re.prototype=L,$!=="Error"?r?r(re,U):s(re,U,{name:!0}):p&&H in V&&(a(re,V,H),a(re,V,"prepareStackTrace")),s(re,V),!w)try{L.name!==$&&n(L,"name",$),L.constructor=re}catch{}return re}},PE}var nk;function iK(){if(nk)return OD;nk=1;var t=en(),e=di(),n=aS(),i=nK(),r="WebAssembly",s=e[r],a=new Error("e",{cause:7}).cause!==7,u=function(d,g){var p={};p[d]=i(d,g,a),t({global:!0,constructor:!0,arity:1,forced:a},p)},h=function(d,g){if(s&&s[d]){var p={};p[d]=i(r+"."+d,g,a),t({target:r,stat:!0,constructor:!0,arity:1,forced:a},p)}};return u("Error",function(d){return function(p){return n(d,this,arguments)}}),u("EvalError",function(d){return function(p){return n(d,this,arguments)}}),u("RangeError",function(d){return function(p){return n(d,this,arguments)}}),u("ReferenceError",function(d){return function(p){return n(d,this,arguments)}}),u("SyntaxError",function(d){return function(p){return n(d,this,arguments)}}),u("TypeError",function(d){return function(p){return n(d,this,arguments)}}),u("URIError",function(d){return function(p){return n(d,this,arguments)}}),h("CompileError",function(d){return function(p){return n(d,this,arguments)}}),h("LinkError",function(d){return function(p){return n(d,this,arguments)}}),h("RuntimeError",function(d){return function(p){return n(d,this,arguments)}}),OD}iK();var ik={},IE,rk;function zU(){if(rk)return IE;rk=1;var t=Jc();return IE=Array.isArray||function(n){return t(n)==="Array"},IE}var NE,sk;function YU(){if(sk)return NE;sk=1;var t=bs(),e=zU(),n=TypeError,i=Object.getOwnPropertyDescriptor,r=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}}();return NE=r?function(s,a){if(e(s)&&!i(s,"length").writable)throw new n("Cannot set read only .length");return s.length=a}:function(s,a){return s.length=a},NE}var DE,ok;function GU(){if(ok)return DE;ok=1;var t=TypeError,e=9007199254740991;return DE=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},DE}var ak;function rK(){if(ak)return ik;ak=1;var t=en(),e=lf(),n=cf(),i=YU(),r=GU(),s=Oi(),a=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(d){return d instanceof TypeError}},h=a||!u();return t({target:"Array",proto:!0,arity:1,forced:h},{push:function(g){var p=e(this),w=n(p),y=arguments.length;r(w+y);for(var S=0;S<y;S++)p[w]=arguments[S],w++;return i(p,w),w}}),ik}rK();var lk={},LE,uk;function Ko(){if(uk)return LE;uk=1;var t=Yn(),e=Set.prototype;return LE={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},LE}var kE,ck;function eh(){if(ck)return kE;ck=1;var t=Ko().has;return kE=function(e){return t(e),e},kE}var VE,hk;function th(){if(hk)return VE;hk=1;var t=Fi();return VE=function(e,n,i){for(var r=i?e:e.iterator,s=e.next,a,u;!(a=t(s,r)).done;)if(u=n(a.value),u!==void 0)return u},VE}var $E,dk;function Cp(){if(dk)return $E;dk=1;var t=Yn(),e=th(),n=Ko(),i=n.Set,r=n.proto,s=t(r.forEach),a=t(r.keys),u=a(new i).next;return $E=function(h,d,g){return g?e({iterator:a(h),next:u},d):s(h,d)},$E}var FE,fk;function gO(){if(fk)return FE;fk=1;var t=Ko(),e=Cp(),n=t.Set,i=t.add;return FE=function(r){var s=new n;return e(r,function(a){i(s,a)}),s},FE}var BE,gk;function Sp(){if(gk)return BE;gk=1;var t=WU(),e=Ko();return BE=t(e.proto,"size","get")||function(n){return n.size},BE}var WE,mk;function Xo(){return mk||(mk=1,WE=function(t){return{iterator:t,next:t.next,done:!1}}),WE}var UE,pk;function nh(){if(pk)return UE;pk=1;var t=Cr(),e=ii(),n=Fi(),i=yp(),r=Xo(),s="Invalid size",a=RangeError,u=TypeError,h=Math.max,d=function(g,p){this.set=g,this.size=h(p,0),this.has=t(g.has),this.keys=t(g.keys)};return d.prototype={getIterator:function(){return r(e(n(this.keys,this.set)))},includes:function(g){return n(this.has,this.set,g)}},UE=function(g){e(g);var p=+g.size;if(p!==p)throw new u(s);var w=i(p);if(w<0)throw new a(s);return new d(g,w)},UE}var jE,vk;function sK(){if(vk)return jE;vk=1;var t=eh(),e=Ko(),n=gO(),i=Sp(),r=nh(),s=Cp(),a=th(),u=e.has,h=e.remove;return jE=function(g){var p=t(this),w=r(g),y=n(p);return i(p)<=w.size?s(p,function(S){w.includes(S)&&h(y,S)}):a(w.getIterator(),function(S){u(p,S)&&h(y,S)}),y},jE}var zE,wk;function ih(){if(wk)return zE;wk=1;var t=af(),e=function(i){return{size:i,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(i){return{size:i,has:function(){return!0},keys:function(){throw new Error("e")}}};return zE=function(i,r){var s=t("Set");try{new s()[i](e(0));try{return new s()[i](e(-1)),!1}catch{if(!r)return!0;try{return new s()[i](n(-1/0)),!1}catch{var a=new s;return a.add(1),a.add(2),r(a[i](n(1/0)))}}}catch{return!1}},zE}var yk;function oK(){if(yk)return lk;yk=1;var t=en(),e=sK(),n=ih(),i=!n("difference",function(r){return r.size===0});return t({target:"Set",proto:!0,real:!0,forced:i},{difference:e}),lk}oK();var Ck={},YE,Sk;function aK(){if(Sk)return YE;Sk=1;var t=eh(),e=Ko(),n=Sp(),i=nh(),r=Cp(),s=th(),a=e.Set,u=e.add,h=e.has;return YE=function(g){var p=t(this),w=i(g),y=new a;return n(p)>w.size?s(w.getIterator(),function(S){h(p,S)&&u(y,S)}):r(p,function(S){w.includes(S)&&u(y,S)}),y},YE}var bk;function lK(){if(bk)return Ck;bk=1;var t=en(),e=Oi(),n=aK(),i=ih(),r=!i("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:r},{intersection:n}),Ck}lK();var Rk={},GE,Ek;function hf(){if(Ek)return GE;Ek=1;var t=Fi(),e=ii(),n=wp();return GE=function(i,r,s){var a,u;e(i);try{if(a=n(i,"return"),!a){if(r==="throw")throw s;return s}a=t(a,i)}catch(h){u=!0,a=h}if(r==="throw")throw s;if(u)throw a;return e(a),s},GE}var qE,Tk;function uK(){if(Tk)return qE;Tk=1;var t=eh(),e=Ko().has,n=Sp(),i=nh(),r=Cp(),s=th(),a=hf();return qE=function(h){var d=t(this),g=i(h);if(n(d)<=g.size)return r(d,function(w){if(g.includes(w))return!1},!0)!==!1;var p=g.getIterator();return s(p,function(w){if(e(d,w))return a(p,"normal",!1)})!==!1},qE}var _k;function cK(){if(_k)return Rk;_k=1;var t=en(),e=uK(),n=ih(),i=!n("isDisjointFrom",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isDisjointFrom:e}),Rk}cK();var Mk={},KE,Ok;function hK(){if(Ok)return KE;Ok=1;var t=eh(),e=Sp(),n=Cp(),i=nh();return KE=function(s){var a=t(this),u=i(s);return e(a)>u.size?!1:n(a,function(h){if(!u.includes(h))return!1},!0)!==!1},KE}var Ak;function dK(){if(Ak)return Mk;Ak=1;var t=en(),e=hK(),n=ih(),i=!n("isSubsetOf",function(r){return r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSubsetOf:e}),Mk}dK();var xk={},XE,Hk;function fK(){if(Hk)return XE;Hk=1;var t=eh(),e=Ko().has,n=Sp(),i=nh(),r=th(),s=hf();return XE=function(u){var h=t(this),d=i(u);if(n(h)<d.size)return!1;var g=d.getIterator();return r(g,function(p){if(!e(h,p))return s(g,"normal",!1)})!==!1},XE}var Pk;function gK(){if(Pk)return xk;Pk=1;var t=en(),e=fK(),n=ih(),i=!n("isSupersetOf",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSupersetOf:e}),xk}gK();var Ik={},ZE,Nk;function mK(){if(Nk)return ZE;Nk=1;var t=eh(),e=Ko(),n=gO(),i=nh(),r=th(),s=e.add,a=e.has,u=e.remove;return ZE=function(d){var g=t(this),p=i(d).getIterator(),w=n(g);return r(p,function(y){a(g,y)?u(w,y):s(w,y)}),w},ZE}var Dk;function pK(){if(Dk)return Ik;Dk=1;var t=en(),e=mK(),n=ih();return t({target:"Set",proto:!0,real:!0,forced:!n("symmetricDifference")},{symmetricDifference:e}),Ik}pK();var Lk={},QE,kk;function vK(){if(kk)return QE;kk=1;var t=eh(),e=Ko().add,n=gO(),i=nh(),r=th();return QE=function(a){var u=t(this),h=i(a).getIterator(),d=n(u);return r(h,function(g){e(d,g)}),d},QE}var Vk;function wK(){if(Vk)return Lk;Vk=1;var t=en(),e=vK(),n=ih();return t({target:"Set",proto:!0,real:!0,forced:!n("union")},{union:e}),Lk}wK();var $k={},Fk={},JE,Bk;function yK(){if(Bk)return JE;Bk=1;var t=vp(),e=TypeError;return JE=function(n,i){if(t(i,n))return n;throw new e("Incorrect invocation")},JE}var eT,Wk;function CK(){if(Wk)return eT;Wk=1;var t=Oi();return eT=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),eT}var tT,Uk;function qU(){if(Uk)return tT;Uk=1;var t=Rs(),e=ni(),n=lf(),i=cO(),r=CK(),s=i("IE_PROTO"),a=Object,u=a.prototype;return tT=r?a.getPrototypeOf:function(h){var d=n(h);if(t(d,s))return d[s];var g=d.constructor;return e(g)&&d instanceof g?g.prototype:d instanceof a?u:null},tT}var nT,jk;function SK(){if(jk)return nT;jk=1;var t=$U(),e=pu();return nT=function(n,i,r){return r.get&&t(r.get,i,{getter:!0}),r.set&&t(r.set,i,{setter:!0}),e.f(n,i,r)},nT}var iT,zk;function KU(){if(zk)return iT;zk=1;var t=bs(),e=pu(),n=iS();return iT=function(i,r,s){t?e.f(i,r,n(0,s)):i[r]=s},iT}var rT={},sT,Yk;function bK(){if(Yk)return sT;Yk=1;var t=FU(),e=fO();return sT=Object.keys||function(i){return t(i,e)},sT}var Gk;function RK(){if(Gk)return rT;Gk=1;var t=bs(),e=kU(),n=pu(),i=ii(),r=pp(),s=bK();return rT.f=t&&!e?Object.defineProperties:function(u,h){i(u);for(var d=r(h),g=s(h),p=g.length,w=0,y;p>w;)n.f(u,y=g[w++],d[y]);return u},rT}var oT,qk;function XU(){if(qk)return oT;qk=1;var t=af();return oT=t("document","documentElement"),oT}var aT,Kk;function mO(){if(Kk)return aT;Kk=1;var t=ii(),e=RK(),n=fO(),i=hO(),r=XU(),s=uO(),a=cO(),u=">",h="<",d="prototype",g="script",p=a("IE_PROTO"),w=function(){},y=function(x){return h+g+u+x+h+"/"+g+u},S=function(x){x.write(y("")),x.close();var D=x.parentWindow.Object;return x=null,D},_=function(){var x=s("iframe"),D="java"+g+":",$;return x.style.display="none",r.appendChild(x),x.src=String(D),$=x.contentWindow.document,$.open(),$.write(y("document.F=Object")),$.close(),$.F},E,H=function(){try{E=new ActiveXObject("htmlfile")}catch{}H=typeof document<"u"?document.domain&&E?S(E):_():S(E);for(var x=n.length;x--;)delete H[d][n[x]];return H()};return i[p]=!0,aT=Object.create||function(D,$){var V;return D!==null?(w[d]=t(D),V=new w,w[d]=null,V[p]=D):V=H(),$===void 0?V:e.f(V,$)},aT}var lT,Xk;function ZU(){if(Xk)return lT;Xk=1;var t=Oi(),e=ni(),n=no(),i=mO(),r=qU(),s=dO(),a=io(),u=mu(),h=a("iterator"),d=!1,g,p,w;[].keys&&(w=[].keys(),"next"in w?(p=r(r(w)),p!==Object.prototype&&(g=p)):d=!0);var y=!n(g)||t(function(){var S={};return g[h].call(S)!==S});return y?g={}:u&&(g=i(g)),e(g[h])||s(g,h,function(){return this}),lT={IteratorPrototype:g,BUGGY_SAFARI_ITERATORS:d},lT}var Zk;function EK(){if(Zk)return Fk;Zk=1;var t=en(),e=di(),n=yK(),i=ii(),r=ni(),s=qU(),a=SK(),u=KU(),h=Oi(),d=Rs(),g=io(),p=ZU().IteratorPrototype,w=bs(),y=mu(),S="constructor",_="Iterator",E=g("toStringTag"),H=TypeError,x=e[_],D=y||!r(x)||x.prototype!==p||!h(function(){x({})}),$=function(){if(n(this,p),s(this)===p)throw new H("Abstract class Iterator not directly constructable")},V=function(L,U){w?a(p,L,{configurable:!0,get:function(){return U},set:function(re){if(i(this),this===p)throw new H("You can't redefine this property");d(this,L)?this[L]=re:u(this,L,re)}}):p[L]=U};return d(p,E)||V(E,_),(D||!d(p,S)||p[S]===Object)&&V(S,$),$.prototype=p,t({global:!0,constructor:!0,forced:D},{Iterator:$}),Fk}var Qk;function TK(){return Qk||(Qk=1,EK()),$k}TK();var Jk={},eV={},uT,tV;function _K(){if(tV)return uT;tV=1;var t=dO();return uT=function(e,n,i){for(var r in n)t(e,r,n[r],i);return e},uT}var cT,nV;function MK(){return nV||(nV=1,cT=function(t,e){return{value:t,done:e}}),cT}var hT,iV;function pO(){if(iV)return hT;iV=1;var t=Fi(),e=mO(),n=uf(),i=_K(),r=io(),s=VU(),a=wp(),u=ZU().IteratorPrototype,h=MK(),d=hf(),g=r("toStringTag"),p="IteratorHelper",w="WrapForValidIterator",y=s.set,S=function(H){var x=s.getterFor(H?w:p);return i(e(u),{next:function(){var $=x(this);if(H)return $.nextHandler();if($.done)return h(void 0,!0);try{var V=$.nextHandler();return $.returnHandlerResult?V:h(V,$.done)}catch(L){throw $.done=!0,L}},return:function(){var D=x(this),$=D.iterator;if(D.done=!0,H){var V=a($,"return");return V?t(V,$):h(void 0,!0)}if(D.inner)try{d(D.inner.iterator,"normal")}catch(L){return d($,"throw",L)}return $&&d($,"normal"),h(void 0,!0)}})},_=S(!0),E=S(!1);return n(E,g,"Iterator Helper"),hT=function(H,x,D){var $=function(L,U){U?(U.iterator=L.iterator,U.next=L.next):U=L,U.type=x?w:p,U.returnHandlerResult=!!D,U.nextHandler=H,U.counter=0,U.done=!1,y(this,U)};return $.prototype=x?_:E,$},hT}var dT,rV;function QU(){if(rV)return dT;rV=1;var t=ii(),e=hf();return dT=function(n,i,r,s){try{return s?i(t(r)[0],r[1]):i(r)}catch(a){e(n,"throw",a)}},dT}var sV;function OK(){if(sV)return eV;sV=1;var t=en(),e=Fi(),n=Cr(),i=ii(),r=Xo(),s=pO(),a=QU(),u=mu(),h=s(function(){for(var d=this.iterator,g=this.predicate,p=this.next,w,y,S;;){if(w=i(e(p,d)),y=this.done=!!w.done,y)return;if(S=w.value,a(d,g,[S,this.counter++],!0))return S}});return t({target:"Iterator",proto:!0,real:!0,forced:u},{filter:function(g){return i(this),n(g),new h(r(this),{predicate:g})}}),eV}var oV;function AK(){return oV||(oV=1,OK()),Jk}AK();var aV={},lV={},fT,uV;function xK(){if(uV)return fT;uV=1;var t=Jc(),e=Yn();return fT=function(n){if(t(n)==="Function")return e(n)},fT}var gT,cV;function JU(){if(cV)return gT;cV=1;var t=xK(),e=Cr(),n=nS(),i=t(t.bind);return gT=function(r,s){return e(r),s===void 0?r:n?i(r,s):function(){return r.apply(s,arguments)}},gT}var mT,hV;function ej(){return hV||(hV=1,mT={}),mT}var pT,dV;function HK(){if(dV)return pT;dV=1;var t=io(),e=ej(),n=t("iterator"),i=Array.prototype;return pT=function(r){return r!==void 0&&(e.Array===r||i[n]===r)},pT}var vT,fV;function vO(){if(fV)return vT;fV=1;var t=jU(),e=wp(),n=rS(),i=ej(),r=io(),s=r("iterator");return vT=function(a){if(!n(a))return e(a,s)||e(a,"@@iterator")||i[t(a)]},vT}var wT,gV;function PK(){if(gV)return wT;gV=1;var t=Fi(),e=Cr(),n=ii(),i=oS(),r=vO(),s=TypeError;return wT=function(a,u){var h=arguments.length<2?r(a):u;if(e(h))return n(t(h,a));throw new s(i(a)+" is not iterable")},wT}var yT,mV;function df(){if(mV)return yT;mV=1;var t=JU(),e=Fi(),n=ii(),i=oS(),r=HK(),s=cf(),a=vp(),u=PK(),h=vO(),d=hf(),g=TypeError,p=function(y,S){this.stopped=y,this.result=S},w=p.prototype;return yT=function(y,S,_){var E=_&&_.that,H=!!(_&&_.AS_ENTRIES),x=!!(_&&_.IS_RECORD),D=!!(_&&_.IS_ITERATOR),$=!!(_&&_.INTERRUPTED),V=t(S,E),L,U,re,se,Q,de,me,_e=function(Te){return L&&d(L,"normal",Te),new p(!0,Te)},Ee=function(Te){return H?(n(Te),$?V(Te[0],Te[1],_e):V(Te[0],Te[1])):$?V(Te,_e):V(Te)};if(x)L=y.iterator;else if(D)L=y;else{if(U=h(y),!U)throw new g(i(y)+" is not iterable");if(r(U)){for(re=0,se=s(y);se>re;re++)if(Q=Ee(y[re]),Q&&a(w,Q))return Q;return new p(!1)}L=u(y,U)}for(de=x?y.next:L.next;!(me=e(de,L)).done;){try{Q=Ee(me.value)}catch(Te){d(L,"throw",Te)}if(typeof Q=="object"&&Q&&a(w,Q))return Q}return new p(!1)},yT}var pV;function IK(){if(pV)return lV;pV=1;var t=en(),e=df(),n=Cr(),i=ii(),r=Xo();return t({target:"Iterator",proto:!0,real:!0},{forEach:function(a){i(this),n(a);var u=r(this),h=0;e(u,function(d){a(d,h++)},{IS_RECORD:!0})}}),lV}var vV;function NK(){return vV||(vV=1,IK()),aV}NK();var wV={},yV={},CT,CV;function DK(){if(CV)return CT;CV=1;var t=Fi(),e=Cr(),n=ii(),i=Xo(),r=pO(),s=QU(),a=r(function(){var u=this.iterator,h=n(t(this.next,u)),d=this.done=!!h.done;if(!d)return s(u,this.mapper,[h.value,this.counter++],!0)});return CT=function(h){return n(this),e(h),new a(i(this),{mapper:h})},CT}var SV;function LK(){if(SV)return yV;SV=1;var t=en(),e=DK(),n=mu();return t({target:"Iterator",proto:!0,real:!0,forced:n},{map:e}),yV}var bV;function kK(){return bV||(bV=1,LK()),wV}kK();var RV={},EV={},ST,TV;function wO(){if(TV)return ST;TV=1;var t=Yn();return ST=t([].slice),ST}var bT,_V;function tj(){if(_V)return bT;_V=1;var t=TypeError;return bT=function(e,n){if(e<n)throw new t("Not enough arguments");return e},bT}var RT,MV;function VK(){if(MV)return RT;MV=1;var t=sS();return RT=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),RT}var ET,OV;function nj(){if(OV)return ET;OV=1;var t=di(),e=sS(),n=Jc(),i=function(r){return e.slice(0,r.length)===r};return ET=function(){return i("Bun/")?"BUN":i("Cloudflare-Workers")?"CLOUDFLARE":i("Deno/")?"DENO":i("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),ET}var TT,AV;function $K(){if(AV)return TT;AV=1;var t=nj();return TT=t==="NODE",TT}var _T,xV;function ij(){if(xV)return _T;xV=1;var t=di(),e=aS(),n=JU(),i=ni(),r=Rs(),s=Oi(),a=XU(),u=wO(),h=uO(),d=tj(),g=VK(),p=$K(),w=t.setImmediate,y=t.clearImmediate,S=t.process,_=t.Dispatch,E=t.Function,H=t.MessageChannel,x=t.String,D=0,$={},V="onreadystatechange",L,U,re,se;s(function(){L=t.location});var Q=function(Ee){if(r($,Ee)){var Te=$[Ee];delete $[Ee],Te()}},de=function(Ee){return function(){Q(Ee)}},me=function(Ee){Q(Ee.data)},_e=function(Ee){t.postMessage(x(Ee),L.protocol+"//"+L.host)};return(!w||!y)&&(w=function(Te){d(arguments.length,1);var ve=i(Te)?Te:E(Te),Ce=u(arguments,1);return $[++D]=function(){e(ve,void 0,Ce)},U(D),D},y=function(Te){delete $[Te]},p?U=function(Ee){S.nextTick(de(Ee))}:_&&_.now?U=function(Ee){_.now(de(Ee))}:H&&!g?(re=new H,se=re.port2,re.port1.onmessage=me,U=n(se.postMessage,se)):t.addEventListener&&i(t.postMessage)&&!t.importScripts&&L&&L.protocol!=="file:"&&!s(_e)?(U=_e,t.addEventListener("message",me,!1)):V in h("script")?U=function(Ee){a.appendChild(h("script"))[V]=function(){a.removeChild(this),Q(Ee)}}:U=function(Ee){setTimeout(de(Ee),0)}),_T={set:w,clear:y},_T}var HV;function FK(){if(HV)return EV;HV=1;var t=en(),e=di(),n=ij().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),EV}var PV={},MT,IV;function BK(){if(IV)return MT;IV=1;var t=di(),e=aS(),n=ni(),i=nj(),r=sS(),s=wO(),a=tj(),u=t.Function,h=/MSIE .\./.test(r)||i==="BUN"&&function(){var d=t.Bun.version.split(".");return d.length<3||d[0]==="0"&&(d[1]<3||d[1]==="3"&&d[2]==="0")}();return MT=function(d,g){var p=g?2:1;return h?function(w,y){var S=a(arguments.length,1)>p,_=n(w)?w:u(w),E=S?s(arguments,p):[],H=S?function(){e(_,this,E)}:_;return g?d(H,y):d(H)}:d},MT}var NV;function WK(){if(NV)return PV;NV=1;var t=en(),e=di(),n=ij().set,i=BK(),r=e.setImmediate?i(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==r},{setImmediate:r}),PV}var DV;function UK(){return DV||(DV=1,FK(),WK()),RV}UK();/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:rj,setPrototypeOf:LV,isFrozen:jK,getPrototypeOf:zK,getOwnPropertyDescriptor:YK}=Object;let{freeze:Ji,seal:Ss,create:sj}=Object,{apply:i1,construct:r1}=typeof Reflect<"u"&&Reflect;Ji||(Ji=function(e){return e});Ss||(Ss=function(e){return e});i1||(i1=function(e,n,i){return e.apply(n,i)});r1||(r1=function(e,n){return new e(...n)});const iw=er(Array.prototype.forEach),GK=er(Array.prototype.lastIndexOf),kV=er(Array.prototype.pop),Cg=er(Array.prototype.push),qK=er(Array.prototype.splice),$y=er(String.prototype.toLowerCase),OT=er(String.prototype.toString),VV=er(String.prototype.match),Sg=er(String.prototype.replace),KK=er(String.prototype.indexOf),XK=er(String.prototype.trim),Bs=er(Object.prototype.hasOwnProperty),Ui=er(RegExp.prototype.test),bg=ZK(TypeError);function er(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i1(t,e,i)}}function ZK(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return r1(t,n)}}function yt(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$y;LV&&LV(t,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){const s=n(r);s!==r&&(jK(e)||(e[i]=s),r=s)}t[r]=!0}return t}function QK(t){for(let e=0;e<t.length;e++)Bs(t,e)||(t[e]=null);return t}function Oc(t){const e=sj(null);for(const[n,i]of rj(t))Bs(t,n)&&(Array.isArray(i)?e[n]=QK(i):i&&typeof i=="object"&&i.constructor===Object?e[n]=Oc(i):e[n]=i);return e}function Rg(t,e){for(;t!==null;){const i=YK(t,e);if(i){if(i.get)return er(i.get);if(typeof i.value=="function")return er(i.value)}t=zK(t)}function n(){return null}return n}const $V=Ji(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),AT=Ji(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),xT=Ji(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),JK=Ji(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),HT=Ji(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),e6=Ji(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),FV=Ji(["#text"]),BV=Ji(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),PT=Ji(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),WV=Ji(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),rw=Ji(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),t6=Ss(/\{\{[\w\W]*|[\w\W]*\}\}/gm),n6=Ss(/<%[\w\W]*|[\w\W]*%>/gm),i6=Ss(/\$\{[\w\W]*/gm),r6=Ss(/^data-[\-\w.\u00B7-\uFFFF]+$/),s6=Ss(/^aria-[\-\w]+$/),oj=Ss(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),o6=Ss(/^(?:\w+script|data):/i),a6=Ss(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),aj=Ss(/^html$/i),l6=Ss(/^[a-z][.\w]*(-[.\w]+)+$/i);var UV=Object.freeze({__proto__:null,ARIA_ATTR:s6,ATTR_WHITESPACE:a6,CUSTOM_ELEMENT:l6,DATA_ATTR:r6,DOCTYPE_NAME:aj,ERB_EXPR:n6,IS_ALLOWED_URI:oj,IS_SCRIPT_OR_DATA:o6,MUSTACHE_EXPR:t6,TMPLIT_EXPR:i6});const Eg={element:1,text:3,progressingInstruction:7,comment:8,document:9},u6=function(){return typeof window>"u"?null:window},c6=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const r="data-tt-policy-suffix";n&&n.hasAttribute(r)&&(i=n.getAttribute(r));const s="dompurify"+(i?"#"+i:"");try{return e.createPolicy(s,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},jV=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function lj(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u6();const e=Ve=>lj(Ve);if(e.version="3.2.4",e.removed=[],!t||!t.document||t.document.nodeType!==Eg.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const i=n,r=i.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:u,Element:h,NodeFilter:d,NamedNodeMap:g=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:p,DOMParser:w,trustedTypes:y}=t,S=h.prototype,_=Rg(S,"cloneNode"),E=Rg(S,"remove"),H=Rg(S,"nextSibling"),x=Rg(S,"childNodes"),D=Rg(S,"parentNode");if(typeof a=="function"){const Ve=n.createElement("template");Ve.content&&Ve.content.ownerDocument&&(n=Ve.content.ownerDocument)}let $,V="";const{implementation:L,createNodeIterator:U,createDocumentFragment:re,getElementsByTagName:se}=n,{importNode:Q}=i;let de=jV();e.isSupported=typeof rj=="function"&&typeof D=="function"&&L&&L.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:me,ERB_EXPR:_e,TMPLIT_EXPR:Ee,DATA_ATTR:Te,ARIA_ATTR:ve,IS_SCRIPT_OR_DATA:Ce,ATTR_WHITESPACE:Re,CUSTOM_ELEMENT:qe}=UV;let{IS_ALLOWED_URI:F}=UV,C=null;const R=yt({},[...$V,...AT,...xT,...HT,...FV]);let T=null;const A=yt({},[...BV,...PT,...WV,...rw]);let k=Object.seal(sj(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),z=null,le=null,ae=!0,be=!0,M=!1,O=!0,I=!1,q=!0,j=!1,Z=!1,ne=!1,B=!1,X=!1,J=!1,ee=!0,ce=!1;const xe="user-content-";let Ne=!0,Fe=!1,st={},ft=null;const Je=yt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let rt=null;const dn=yt({},["audio","video","img","source","image","track"]);let ir=null;const jr=yt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),qn="http://www.w3.org/1998/Math/MathML",tn="http://www.w3.org/2000/svg",Ct="http://www.w3.org/1999/xhtml";let Zt=Ct,gt=!1,Ke=null;const ah=yt({},[qn,tn,Ct],OT);let ea=yt({},["mi","mo","mn","ms","mtext"]),lh=yt({},["annotation-xml"]);const uh=yt({},["title","style","font","a","script"]);let ao=null;const ta=["application/xhtml+xml","text/html"],ch="text/html";let fn=null,ul=null;const Wp=n.createElement("form"),Ef=function(Y){return Y instanceof RegExp||Y instanceof Function},Su=function(){let Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ul&&ul===Y)){if((!Y||typeof Y!="object")&&(Y={}),Y=Oc(Y),ao=ta.indexOf(Y.PARSER_MEDIA_TYPE)===-1?ch:Y.PARSER_MEDIA_TYPE,fn=ao==="application/xhtml+xml"?OT:$y,C=Bs(Y,"ALLOWED_TAGS")?yt({},Y.ALLOWED_TAGS,fn):R,T=Bs(Y,"ALLOWED_ATTR")?yt({},Y.ALLOWED_ATTR,fn):A,Ke=Bs(Y,"ALLOWED_NAMESPACES")?yt({},Y.ALLOWED_NAMESPACES,OT):ah,ir=Bs(Y,"ADD_URI_SAFE_ATTR")?yt(Oc(jr),Y.ADD_URI_SAFE_ATTR,fn):jr,rt=Bs(Y,"ADD_DATA_URI_TAGS")?yt(Oc(dn),Y.ADD_DATA_URI_TAGS,fn):dn,ft=Bs(Y,"FORBID_CONTENTS")?yt({},Y.FORBID_CONTENTS,fn):Je,z=Bs(Y,"FORBID_TAGS")?yt({},Y.FORBID_TAGS,fn):{},le=Bs(Y,"FORBID_ATTR")?yt({},Y.FORBID_ATTR,fn):{},st=Bs(Y,"USE_PROFILES")?Y.USE_PROFILES:!1,ae=Y.ALLOW_ARIA_ATTR!==!1,be=Y.ALLOW_DATA_ATTR!==!1,M=Y.ALLOW_UNKNOWN_PROTOCOLS||!1,O=Y.ALLOW_SELF_CLOSE_IN_ATTR!==!1,I=Y.SAFE_FOR_TEMPLATES||!1,q=Y.SAFE_FOR_XML!==!1,j=Y.WHOLE_DOCUMENT||!1,B=Y.RETURN_DOM||!1,X=Y.RETURN_DOM_FRAGMENT||!1,J=Y.RETURN_TRUSTED_TYPE||!1,ne=Y.FORCE_BODY||!1,ee=Y.SANITIZE_DOM!==!1,ce=Y.SANITIZE_NAMED_PROPS||!1,Ne=Y.KEEP_CONTENT!==!1,Fe=Y.IN_PLACE||!1,F=Y.ALLOWED_URI_REGEXP||oj,Zt=Y.NAMESPACE||Ct,ea=Y.MATHML_TEXT_INTEGRATION_POINTS||ea,lh=Y.HTML_INTEGRATION_POINTS||lh,k=Y.CUSTOM_ELEMENT_HANDLING||{},Y.CUSTOM_ELEMENT_HANDLING&&Ef(Y.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(k.tagNameCheck=Y.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Y.CUSTOM_ELEMENT_HANDLING&&Ef(Y.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(k.attributeNameCheck=Y.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Y.CUSTOM_ELEMENT_HANDLING&&typeof Y.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(k.allowCustomizedBuiltInElements=Y.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),I&&(be=!1),X&&(B=!0),st&&(C=yt({},FV),T=[],st.html===!0&&(yt(C,$V),yt(T,BV)),st.svg===!0&&(yt(C,AT),yt(T,PT),yt(T,rw)),st.svgFilters===!0&&(yt(C,xT),yt(T,PT),yt(T,rw)),st.mathMl===!0&&(yt(C,HT),yt(T,WV),yt(T,rw))),Y.ADD_TAGS&&(C===R&&(C=Oc(C)),yt(C,Y.ADD_TAGS,fn)),Y.ADD_ATTR&&(T===A&&(T=Oc(T)),yt(T,Y.ADD_ATTR,fn)),Y.ADD_URI_SAFE_ATTR&&yt(ir,Y.ADD_URI_SAFE_ATTR,fn),Y.FORBID_CONTENTS&&(ft===Je&&(ft=Oc(ft)),yt(ft,Y.FORBID_CONTENTS,fn)),Ne&&(C["#text"]=!0),j&&yt(C,["html","head","body"]),C.table&&(yt(C,["tbody"]),delete z.tbody),Y.TRUSTED_TYPES_POLICY){if(typeof Y.TRUSTED_TYPES_POLICY.createHTML!="function")throw bg('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Y.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw bg('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');$=Y.TRUSTED_TYPES_POLICY,V=$.createHTML("")}else $===void 0&&($=c6(y,r)),$!==null&&typeof V=="string"&&(V=$.createHTML(""));Ji&&Ji(Y),ul=Y}},cl=yt({},[...AT,...xT,...JK]),Up=yt({},[...HT,...e6]),jp=function(Y){let ye=D(Y);(!ye||!ye.tagName)&&(ye={namespaceURI:Zt,tagName:"template"});const He=$y(Y.tagName),Ft=$y(ye.tagName);return Ke[Y.namespaceURI]?Y.namespaceURI===tn?ye.namespaceURI===Ct?He==="svg":ye.namespaceURI===qn?He==="svg"&&(Ft==="annotation-xml"||ea[Ft]):!!cl[He]:Y.namespaceURI===qn?ye.namespaceURI===Ct?He==="math":ye.namespaceURI===tn?He==="math"&&lh[Ft]:!!Up[He]:Y.namespaceURI===Ct?ye.namespaceURI===tn&&!lh[Ft]||ye.namespaceURI===qn&&!ea[Ft]?!1:!Up[He]&&(uh[He]||!cl[He]):!!(ao==="application/xhtml+xml"&&Ke[Y.namespaceURI]):!1},br=function(Y){Cg(e.removed,{element:Y});try{D(Y).removeChild(Y)}catch{E(Y)}},bu=function(Y,ye){try{Cg(e.removed,{attribute:ye.getAttributeNode(Y),from:ye})}catch{Cg(e.removed,{attribute:null,from:ye})}if(ye.removeAttribute(Y),Y==="is")if(B||X)try{br(ye)}catch{}else try{ye.setAttribute(Y,"")}catch{}},Tf=function(Y){let ye=null,He=null;if(ne)Y="<remove></remove>"+Y;else{const St=VV(Y,/^[\r\n\t ]+/);He=St&&St[0]}ao==="application/xhtml+xml"&&Zt===Ct&&(Y='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Y+"</body></html>");const Ft=$?$.createHTML(Y):Y;if(Zt===Ct)try{ye=new w().parseFromString(Ft,ao)}catch{}if(!ye||!ye.documentElement){ye=L.createDocument(Zt,"template",null);try{ye.documentElement.innerHTML=gt?V:Ft}catch{}}const wn=ye.body||ye.documentElement;return Y&&He&&wn.insertBefore(n.createTextNode(He),wn.childNodes[0]||null),Zt===Ct?se.call(ye,j?"html":"body")[0]:j?ye.documentElement:wn},zp=function(Y){return U.call(Y.ownerDocument||Y,Y,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},zr=function(Y){return Y instanceof p&&(typeof Y.nodeName!="string"||typeof Y.textContent!="string"||typeof Y.removeChild!="function"||!(Y.attributes instanceof g)||typeof Y.removeAttribute!="function"||typeof Y.setAttribute!="function"||typeof Y.namespaceURI!="string"||typeof Y.insertBefore!="function"||typeof Y.hasChildNodes!="function")},ri=function(Y){return typeof u=="function"&&Y instanceof u};function gn(Ve,Y,ye){iw(Ve,He=>{He.call(e,Y,ye,ul)})}const na=function(Y){let ye=null;if(gn(de.beforeSanitizeElements,Y,null),zr(Y))return br(Y),!0;const He=fn(Y.nodeName);if(gn(de.uponSanitizeElement,Y,{tagName:He,allowedTags:C}),Y.hasChildNodes()&&!ri(Y.firstElementChild)&&Ui(/<[/\w]/g,Y.innerHTML)&&Ui(/<[/\w]/g,Y.textContent)||Y.nodeType===Eg.progressingInstruction||q&&Y.nodeType===Eg.comment&&Ui(/<[/\w]/g,Y.data))return br(Y),!0;if(!C[He]||z[He]){if(!z[He]&&Yp(He)&&(k.tagNameCheck instanceof RegExp&&Ui(k.tagNameCheck,He)||k.tagNameCheck instanceof Function&&k.tagNameCheck(He)))return!1;if(Ne&&!ft[He]){const Ft=D(Y)||Y.parentNode,wn=x(Y)||Y.childNodes;if(wn&&Ft){const St=wn.length;for(let Si=St-1;Si>=0;--Si){const Rr=_(wn[Si],!0);Rr.__removalCount=(Y.__removalCount||0)+1,Ft.insertBefore(Rr,H(Y))}}}return br(Y),!0}return Y instanceof h&&!jp(Y)||(He==="noscript"||He==="noembed"||He==="noframes")&&Ui(/<\/no(script|embed|frames)/i,Y.innerHTML)?(br(Y),!0):(I&&Y.nodeType===Eg.text&&(ye=Y.textContent,iw([me,_e,Ee],Ft=>{ye=Sg(ye,Ft," ")}),Y.textContent!==ye&&(Cg(e.removed,{element:Y.cloneNode()}),Y.textContent=ye)),gn(de.afterSanitizeElements,Y,null),!1)},hh=function(Y,ye,He){if(ee&&(ye==="id"||ye==="name")&&(He in n||He in Wp))return!1;if(!(be&&!le[ye]&&Ui(Te,ye))){if(!(ae&&Ui(ve,ye))){if(!T[ye]||le[ye]){if(!(Yp(Y)&&(k.tagNameCheck instanceof RegExp&&Ui(k.tagNameCheck,Y)||k.tagNameCheck instanceof Function&&k.tagNameCheck(Y))&&(k.attributeNameCheck instanceof RegExp&&Ui(k.attributeNameCheck,ye)||k.attributeNameCheck instanceof Function&&k.attributeNameCheck(ye))||ye==="is"&&k.allowCustomizedBuiltInElements&&(k.tagNameCheck instanceof RegExp&&Ui(k.tagNameCheck,He)||k.tagNameCheck instanceof Function&&k.tagNameCheck(He))))return!1}else if(!ir[ye]){if(!Ui(F,Sg(He,Re,""))){if(!((ye==="src"||ye==="xlink:href"||ye==="href")&&Y!=="script"&&KK(He,"data:")===0&&rt[Y])){if(!(M&&!Ui(Ce,Sg(He,Re,"")))){if(He)return!1}}}}}}return!0},Yp=function(Y){return Y!=="annotation-xml"&&VV(Y,qe)},Gp=function(Y){gn(de.beforeSanitizeAttributes,Y,null);const{attributes:ye}=Y;if(!ye||zr(Y))return;const He={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:T,forceKeepAttr:void 0};let Ft=ye.length;for(;Ft--;){const wn=ye[Ft],{name:St,namespaceURI:Si,value:Rr}=wn,Er=fn(St);let An=St==="value"?Rr:XK(Rr);if(He.attrName=Er,He.attrValue=An,He.keepAttr=!0,He.forceKeepAttr=void 0,gn(de.uponSanitizeAttribute,Y,He),An=He.attrValue,ce&&(Er==="id"||Er==="name")&&(bu(St,Y),An=xe+An),q&&Ui(/((--!?|])>)|<\/(style|title)/i,An)){bu(St,Y);continue}if(He.forceKeepAttr||(bu(St,Y),!He.keepAttr))continue;if(!O&&Ui(/\/>/i,An)){bu(St,Y);continue}I&&iw([me,_e,Ee],Kp=>{An=Sg(An,Kp," ")});const Yr=fn(Y.nodeName);if(hh(Yr,Er,An)){if($&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!Si)switch(y.getAttributeType(Yr,Er)){case"TrustedHTML":{An=$.createHTML(An);break}case"TrustedScriptURL":{An=$.createScriptURL(An);break}}try{Si?Y.setAttributeNS(Si,St,An):Y.setAttribute(St,An),zr(Y)?br(Y):kV(e.removed)}catch{}}}gn(de.afterSanitizeAttributes,Y,null)},qp=function Ve(Y){let ye=null;const He=zp(Y);for(gn(de.beforeSanitizeShadowDOM,Y,null);ye=He.nextNode();)gn(de.uponSanitizeShadowNode,ye,null),na(ye),Gp(ye),ye.content instanceof s&&Ve(ye.content);gn(de.afterSanitizeShadowDOM,Y,null)};return e.sanitize=function(Ve){let Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ye=null,He=null,Ft=null,wn=null;if(gt=!Ve,gt&&(Ve="<!-->"),typeof Ve!="string"&&!ri(Ve))if(typeof Ve.toString=="function"){if(Ve=Ve.toString(),typeof Ve!="string")throw bg("dirty is not a string, aborting")}else throw bg("toString is not a function");if(!e.isSupported)return Ve;if(Z||Su(Y),e.removed=[],typeof Ve=="string"&&(Fe=!1),Fe){if(Ve.nodeName){const Rr=fn(Ve.nodeName);if(!C[Rr]||z[Rr])throw bg("root node is forbidden and cannot be sanitized in-place")}}else if(Ve instanceof u)ye=Tf("<!---->"),He=ye.ownerDocument.importNode(Ve,!0),He.nodeType===Eg.element&&He.nodeName==="BODY"||He.nodeName==="HTML"?ye=He:ye.appendChild(He);else{if(!B&&!I&&!j&&Ve.indexOf("<")===-1)return $&&J?$.createHTML(Ve):Ve;if(ye=Tf(Ve),!ye)return B?null:J?V:""}ye&&ne&&br(ye.firstChild);const St=zp(Fe?Ve:ye);for(;Ft=St.nextNode();)na(Ft),Gp(Ft),Ft.content instanceof s&&qp(Ft.content);if(Fe)return Ve;if(B){if(X)for(wn=re.call(ye.ownerDocument);ye.firstChild;)wn.appendChild(ye.firstChild);else wn=ye;return(T.shadowroot||T.shadowrootmode)&&(wn=Q.call(i,wn,!0)),wn}let Si=j?ye.outerHTML:ye.innerHTML;return j&&C["!doctype"]&&ye.ownerDocument&&ye.ownerDocument.doctype&&ye.ownerDocument.doctype.name&&Ui(aj,ye.ownerDocument.doctype.name)&&(Si="<!DOCTYPE "+ye.ownerDocument.doctype.name+`>
`+Si),I&&iw([me,_e,Ee],Rr=>{Si=Sg(Si,Rr," ")}),$&&J?$.createHTML(Si):Si},e.setConfig=function(){let Ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Su(Ve),Z=!0},e.clearConfig=function(){ul=null,Z=!1},e.isValidAttribute=function(Ve,Y,ye){ul||Su({});const He=fn(Ve),Ft=fn(Y);return hh(He,Ft,ye)},e.addHook=function(Ve,Y){typeof Y=="function"&&Cg(de[Ve],Y)},e.removeHook=function(Ve,Y){if(Y!==void 0){const ye=GK(de[Ve],Y);return ye===-1?void 0:qK(de[Ve],ye,1)[0]}return kV(de[Ve])},e.removeHooks=function(Ve){de[Ve]=[]},e.removeAllHooks=function(){de=jV()},e}var h6=lj();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var uj;function pe(){return uj.apply(null,arguments)}function d6(t){uj=t}function Qs(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Bc(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Dt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function yO(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Dt(t,e))return!1;return!0}function fr(t){return t===void 0}function el(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function bp(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function cj(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function iu(t,e){for(var n in e)Dt(e,n)&&(t[n]=e[n]);return Dt(e,"toString")&&(t.toString=e.toString),Dt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Zo(t,e,n,i){return Ij(t,e,n,i,!0).utc()}function f6(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function lt(t){return t._pf==null&&(t._pf=f6()),t._pf}var s1;Array.prototype.some?s1=Array.prototype.some:s1=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function CO(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=lt(t),n=s1.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function uS(t){var e=Zo(NaN);return t!=null?iu(lt(e),t):lt(e).userInvalidated=!0,e}var zV=pe.momentProperties=[],IT=!1;function SO(t,e){var n,i,r,s=zV.length;if(fr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),fr(e._i)||(t._i=e._i),fr(e._f)||(t._f=e._f),fr(e._l)||(t._l=e._l),fr(e._strict)||(t._strict=e._strict),fr(e._tzm)||(t._tzm=e._tzm),fr(e._isUTC)||(t._isUTC=e._isUTC),fr(e._offset)||(t._offset=e._offset),fr(e._pf)||(t._pf=lt(e)),fr(e._locale)||(t._locale=e._locale),s>0)for(n=0;n<s;n++)i=zV[n],r=e[i],fr(r)||(t[i]=r);return t}function Rp(t){SO(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),IT===!1&&(IT=!0,pe.updateOffset(this),IT=!1)}function Js(t){return t instanceof Rp||t!=null&&t._isAMomentObject!=null}function hj(t){pe.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Es(t,e){var n=!0;return iu(function(){if(pe.deprecationHandler!=null&&pe.deprecationHandler(null,t),n){var i=[],r,s,a,u=arguments.length;for(s=0;s<u;s++){if(r="",typeof arguments[s]=="object"){r+=`
[`+s+"] ";for(a in arguments[0])Dt(arguments[0],a)&&(r+=a+": "+arguments[0][a]+", ");r=r.slice(0,-2)}else r=arguments[s];i.push(r)}hj(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var YV={};function dj(t,e){pe.deprecationHandler!=null&&pe.deprecationHandler(t,e),YV[t]||(hj(e),YV[t]=!0)}pe.suppressDeprecationWarnings=!1;pe.deprecationHandler=null;function Qo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function g6(t){var e,n;for(n in t)Dt(t,n)&&(e=t[n],Qo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function o1(t,e){var n=iu({},t),i;for(i in e)Dt(e,i)&&(Bc(t[i])&&Bc(e[i])?(n[i]={},iu(n[i],t[i]),iu(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)Dt(t,i)&&!Dt(e,i)&&Bc(t[i])&&(n[i]=iu({},n[i]));return n}function bO(t){t!=null&&this.set(t)}var a1;Object.keys?a1=Object.keys:a1=function(t){var e,n=[];for(e in t)Dt(t,e)&&n.push(e);return n};var m6={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function p6(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return Qo(i)?i.call(e,n):i}function Yo(t,e,n){var i=""+Math.abs(t),r=e-i.length,s=t>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var RO=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,sw=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,NT={},Ud={};function Ye(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(Ud[t]=r),e&&(Ud[e[0]]=function(){return Yo(r.apply(this,arguments),e[1],e[2])}),n&&(Ud[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function v6(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function w6(t){var e=t.match(RO),n,i;for(n=0,i=e.length;n<i;n++)Ud[e[n]]?e[n]=Ud[e[n]]:e[n]=v6(e[n]);return function(r){var s="",a;for(a=0;a<i;a++)s+=Qo(e[a])?e[a].call(r,t):e[a];return s}}function Fy(t,e){return t.isValid()?(e=fj(e,t.localeData()),NT[e]=NT[e]||w6(e),NT[e](t)):t.localeData().invalidDate()}function fj(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(sw.lastIndex=0;n>=0&&sw.test(t);)t=t.replace(sw,i),sw.lastIndex=0,n-=1;return t}var y6={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function C6(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(RO).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var S6="Invalid date";function b6(){return this._invalidDate}var R6="%d",E6=/\d{1,2}/;function T6(t){return this._ordinal.replace("%d",t)}var _6={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function M6(t,e,n,i){var r=this._relativeTime[n];return Qo(r)?r(t,e,n,i):r.replace(/%d/i,t)}function O6(t,e){var n=this._relativeTime[t>0?"future":"past"];return Qo(n)?n(e):n.replace(/%s/i,e)}var GV={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Ts(t){return typeof t=="string"?GV[t]||GV[t.toLowerCase()]:void 0}function EO(t){var e={},n,i;for(i in t)Dt(t,i)&&(n=Ts(i),n&&(e[n]=t[i]));return e}var A6={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function x6(t){var e=[],n;for(n in t)Dt(t,n)&&e.push({unit:n,priority:A6[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var gj=/\d/,Ur=/\d\d/,mj=/\d{3}/,TO=/\d{4}/,cS=/[+-]?\d{6}/,hn=/\d\d?/,pj=/\d\d\d\d?/,vj=/\d\d\d\d\d\d?/,hS=/\d{1,3}/,_O=/\d{1,4}/,dS=/[+-]?\d{1,6}/,ff=/\d+/,fS=/[+-]?\d+/,H6=/Z|[+-]\d\d:?\d\d/gi,gS=/Z|[+-]\d\d(?::?\d\d)?/gi,P6=/[+-]?\d+(\.\d{1,3})?/,Ep=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,gf=/^[1-9]\d?/,MO=/^([1-9]\d|\d)/,aC;aC={};function Ie(t,e,n){aC[t]=Qo(e)?e:function(i,r){return i&&n?n:e}}function I6(t,e){return Dt(aC,t)?aC[t](e._strict,e._locale):new RegExp(N6(t))}function N6(t){return Qa(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,s){return n||i||r||s}))}function Qa(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function vs(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Et(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=vs(e)),n}var l1={};function Xt(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),el(e)&&(i=function(s,a){a[e]=Et(s)}),r=t.length,n=0;n<r;n++)l1[t[n]]=i}function Tp(t,e){Xt(t,function(n,i,r,s){r._w=r._w||{},e(n,r._w,r,s)})}function D6(t,e,n){e!=null&&Dt(l1,t)&&l1[t](e,n._a,n,t)}function mS(t){return t%4===0&&t%100!==0||t%400===0}var $i=0,za=1,Fo=2,hi=3,Ks=4,Ya=5,Nc=6,L6=7,k6=8;Ye("Y",0,0,function(){var t=this.year();return t<=9999?Yo(t,4):"+"+t});Ye(0,["YY",2],0,function(){return this.year()%100});Ye(0,["YYYY",4],0,"year");Ye(0,["YYYYY",5],0,"year");Ye(0,["YYYYYY",6,!0],0,"year");Ie("Y",fS);Ie("YY",hn,Ur);Ie("YYYY",_O,TO);Ie("YYYYY",dS,cS);Ie("YYYYYY",dS,cS);Xt(["YYYYY","YYYYYY"],$i);Xt("YYYY",function(t,e){e[$i]=t.length===2?pe.parseTwoDigitYear(t):Et(t)});Xt("YY",function(t,e){e[$i]=pe.parseTwoDigitYear(t)});Xt("Y",function(t,e){e[$i]=parseInt(t,10)});function Am(t){return mS(t)?366:365}pe.parseTwoDigitYear=function(t){return Et(t)+(Et(t)>68?1900:2e3)};var wj=mf("FullYear",!0);function V6(){return mS(this.year())}function mf(t,e){return function(n){return n!=null?(yj(this,t,n),pe.updateOffset(this,e),this):Xm(this,t)}}function Xm(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function yj(t,e,n){var i,r,s,a,u;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}s=n,a=t.month(),u=t.date(),u=u===29&&a===1&&!mS(s)?28:u,r?i.setUTCFullYear(s,a,u):i.setFullYear(s,a,u)}}function $6(t){return t=Ts(t),Qo(this[t])?this[t]():this}function F6(t,e){if(typeof t=="object"){t=EO(t);var n=x6(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=Ts(t),Qo(this[t]))return this[t](e);return this}function B6(t,e){return(t%e+e)%e}var Un;Array.prototype.indexOf?Un=Array.prototype.indexOf:Un=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function OO(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=B6(e,12);return t+=(e-n)/12,n===1?mS(t)?29:28:31-n%7%2}Ye("M",["MM",2],"Mo",function(){return this.month()+1});Ye("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ye("MMMM",0,0,function(t){return this.localeData().months(this,t)});Ie("M",hn,gf);Ie("MM",hn,Ur);Ie("MMM",function(t,e){return e.monthsShortRegex(t)});Ie("MMMM",function(t,e){return e.monthsRegex(t)});Xt(["M","MM"],function(t,e){e[za]=Et(t)-1});Xt(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[za]=r:lt(n).invalidMonth=t});var W6="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Cj="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Sj=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,U6=Ep,j6=Ep;function z6(t,e){return t?Qs(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Sj).test(e)?"format":"standalone"][t.month()]:Qs(this._months)?this._months:this._months.standalone}function Y6(t,e){return t?Qs(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Sj.test(e)?"format":"standalone"][t.month()]:Qs(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function G6(t,e,n){var i,r,s,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)s=Zo([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(s,"").toLocaleLowerCase();return n?e==="MMM"?(r=Un.call(this._shortMonthsParse,a),r!==-1?r:null):(r=Un.call(this._longMonthsParse,a),r!==-1?r:null):e==="MMM"?(r=Un.call(this._shortMonthsParse,a),r!==-1?r:(r=Un.call(this._longMonthsParse,a),r!==-1?r:null)):(r=Un.call(this._longMonthsParse,a),r!==-1?r:(r=Un.call(this._shortMonthsParse,a),r!==-1?r:null))}function q6(t,e,n){var i,r,s;if(this._monthsParseExact)return G6.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=Zo([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function bj(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Et(e);else if(e=t.localeData().monthsParse(e),!el(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,OO(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function Rj(t){return t!=null?(bj(this,t),pe.updateOffset(this,!0),this):Xm(this,"Month")}function K6(){return OO(this.year(),this.month())}function X6(t){return this._monthsParseExact?(Dt(this,"_monthsRegex")||Ej.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Dt(this,"_monthsShortRegex")||(this._monthsShortRegex=U6),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Z6(t){return this._monthsParseExact?(Dt(this,"_monthsRegex")||Ej.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Dt(this,"_monthsRegex")||(this._monthsRegex=j6),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function Ej(){function t(h,d){return d.length-h.length}var e=[],n=[],i=[],r,s,a,u;for(r=0;r<12;r++)s=Zo([2e3,r]),a=Qa(this.monthsShort(s,"")),u=Qa(this.months(s,"")),e.push(a),n.push(u),i.push(u),i.push(a);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Q6(t,e,n,i,r,s,a){var u;return t<100&&t>=0?(u=new Date(t+400,e,n,i,r,s,a),isFinite(u.getFullYear())&&u.setFullYear(t)):u=new Date(t,e,n,i,r,s,a),u}function Zm(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function lC(t,e,n){var i=7+e-n,r=(7+Zm(t,0,i).getUTCDay()-e)%7;return-r+i-1}function Tj(t,e,n,i,r){var s=(7+n-i)%7,a=lC(t,i,r),u=1+7*(e-1)+s+a,h,d;return u<=0?(h=t-1,d=Am(h)+u):u>Am(t)?(h=t+1,d=u-Am(t)):(h=t,d=u),{year:h,dayOfYear:d}}function Qm(t,e,n){var i=lC(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,s,a;return r<1?(a=t.year()-1,s=r+Ja(a,e,n)):r>Ja(t.year(),e,n)?(s=r-Ja(t.year(),e,n),a=t.year()+1):(a=t.year(),s=r),{week:s,year:a}}function Ja(t,e,n){var i=lC(t,e,n),r=lC(t+1,e,n);return(Am(t)-i+r)/7}Ye("w",["ww",2],"wo","week");Ye("W",["WW",2],"Wo","isoWeek");Ie("w",hn,gf);Ie("ww",hn,Ur);Ie("W",hn,gf);Ie("WW",hn,Ur);Tp(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=Et(t)});function J6(t){return Qm(t,this._week.dow,this._week.doy).week}var e8={dow:0,doy:6};function t8(){return this._week.dow}function n8(){return this._week.doy}function i8(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function r8(t){var e=Qm(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ye("d",0,"do","day");Ye("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ye("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ye("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ye("e",0,0,"weekday");Ye("E",0,0,"isoWeekday");Ie("d",hn);Ie("e",hn);Ie("E",hn);Ie("dd",function(t,e){return e.weekdaysMinRegex(t)});Ie("ddd",function(t,e){return e.weekdaysShortRegex(t)});Ie("dddd",function(t,e){return e.weekdaysRegex(t)});Tp(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:lt(n).invalidWeekday=t});Tp(["d","e","E"],function(t,e,n,i){e[i]=Et(t)});function s8(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function o8(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function AO(t,e){return t.slice(e,7).concat(t.slice(0,e))}var a8="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),_j="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),l8="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),u8=Ep,c8=Ep,h8=Ep;function d8(t,e){var n=Qs(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?AO(n,this._week.dow):t?n[t.day()]:n}function f8(t){return t===!0?AO(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function g8(t){return t===!0?AO(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function m8(t,e,n){var i,r,s,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)s=Zo([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(s,"").toLocaleLowerCase();return n?e==="dddd"?(r=Un.call(this._weekdaysParse,a),r!==-1?r:null):e==="ddd"?(r=Un.call(this._shortWeekdaysParse,a),r!==-1?r:null):(r=Un.call(this._minWeekdaysParse,a),r!==-1?r:null):e==="dddd"?(r=Un.call(this._weekdaysParse,a),r!==-1||(r=Un.call(this._shortWeekdaysParse,a),r!==-1)?r:(r=Un.call(this._minWeekdaysParse,a),r!==-1?r:null)):e==="ddd"?(r=Un.call(this._shortWeekdaysParse,a),r!==-1||(r=Un.call(this._weekdaysParse,a),r!==-1)?r:(r=Un.call(this._minWeekdaysParse,a),r!==-1?r:null)):(r=Un.call(this._minWeekdaysParse,a),r!==-1||(r=Un.call(this._weekdaysParse,a),r!==-1)?r:(r=Un.call(this._shortWeekdaysParse,a),r!==-1?r:null))}function p8(t,e,n){var i,r,s;if(this._weekdaysParseExact)return m8.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=Zo([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(s="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function v8(t){if(!this.isValid())return t!=null?this:NaN;var e=Xm(this,"Day");return t!=null?(t=s8(t,this.localeData()),this.add(t-e,"d")):e}function w8(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function y8(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=o8(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function C8(t){return this._weekdaysParseExact?(Dt(this,"_weekdaysRegex")||xO.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Dt(this,"_weekdaysRegex")||(this._weekdaysRegex=u8),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function S8(t){return this._weekdaysParseExact?(Dt(this,"_weekdaysRegex")||xO.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Dt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=c8),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function b8(t){return this._weekdaysParseExact?(Dt(this,"_weekdaysRegex")||xO.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Dt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=h8),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function xO(){function t(g,p){return p.length-g.length}var e=[],n=[],i=[],r=[],s,a,u,h,d;for(s=0;s<7;s++)a=Zo([2e3,1]).day(s),u=Qa(this.weekdaysMin(a,"")),h=Qa(this.weekdaysShort(a,"")),d=Qa(this.weekdays(a,"")),e.push(u),n.push(h),i.push(d),r.push(u),r.push(h),r.push(d);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function HO(){return this.hours()%12||12}function R8(){return this.hours()||24}Ye("H",["HH",2],0,"hour");Ye("h",["hh",2],0,HO);Ye("k",["kk",2],0,R8);Ye("hmm",0,0,function(){return""+HO.apply(this)+Yo(this.minutes(),2)});Ye("hmmss",0,0,function(){return""+HO.apply(this)+Yo(this.minutes(),2)+Yo(this.seconds(),2)});Ye("Hmm",0,0,function(){return""+this.hours()+Yo(this.minutes(),2)});Ye("Hmmss",0,0,function(){return""+this.hours()+Yo(this.minutes(),2)+Yo(this.seconds(),2)});function Mj(t,e){Ye(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}Mj("a",!0);Mj("A",!1);function Oj(t,e){return e._meridiemParse}Ie("a",Oj);Ie("A",Oj);Ie("H",hn,MO);Ie("h",hn,gf);Ie("k",hn,gf);Ie("HH",hn,Ur);Ie("hh",hn,Ur);Ie("kk",hn,Ur);Ie("hmm",pj);Ie("hmmss",vj);Ie("Hmm",pj);Ie("Hmmss",vj);Xt(["H","HH"],hi);Xt(["k","kk"],function(t,e,n){var i=Et(t);e[hi]=i===24?0:i});Xt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});Xt(["h","hh"],function(t,e,n){e[hi]=Et(t),lt(n).bigHour=!0});Xt("hmm",function(t,e,n){var i=t.length-2;e[hi]=Et(t.substr(0,i)),e[Ks]=Et(t.substr(i)),lt(n).bigHour=!0});Xt("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[hi]=Et(t.substr(0,i)),e[Ks]=Et(t.substr(i,2)),e[Ya]=Et(t.substr(r)),lt(n).bigHour=!0});Xt("Hmm",function(t,e,n){var i=t.length-2;e[hi]=Et(t.substr(0,i)),e[Ks]=Et(t.substr(i))});Xt("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[hi]=Et(t.substr(0,i)),e[Ks]=Et(t.substr(i,2)),e[Ya]=Et(t.substr(r))});function E8(t){return(t+"").toLowerCase().charAt(0)==="p"}var T8=/[ap]\.?m?\.?/i,_8=mf("Hours",!0);function M8(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var Aj={calendar:m6,longDateFormat:y6,invalidDate:S6,ordinal:R6,dayOfMonthOrdinalParse:E6,relativeTime:_6,months:W6,monthsShort:Cj,week:e8,weekdays:a8,weekdaysMin:l8,weekdaysShort:_j,meridiemParse:T8},pn={},Tg={},Jm;function O8(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function qV(t){return t&&t.toLowerCase().replace("_","-")}function A8(t){for(var e=0,n,i,r,s;e<t.length;){for(s=qV(t[e]).split("-"),n=s.length,i=qV(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=pS(s.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&O8(s,i)>=n-1)break;n--}e++}return Jm}function x8(t){return!!(t&&t.match("^[^/\\\\]*$"))}function pS(t){var e=null,n;if(pn[t]===void 0&&typeof oC<"u"&&oC&&oC.exports&&x8(t))try{e=Jm._abbr,n=require,n("./locale/"+t),uu(e)}catch{pn[t]=null}return pn[t]}function uu(t,e){var n;return t&&(fr(e)?n=rl(t):n=PO(t,e),n?Jm=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Jm._abbr}function PO(t,e){if(e!==null){var n,i=Aj;if(e.abbr=t,pn[t]!=null)dj("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=pn[t]._config;else if(e.parentLocale!=null)if(pn[e.parentLocale]!=null)i=pn[e.parentLocale]._config;else if(n=pS(e.parentLocale),n!=null)i=n._config;else return Tg[e.parentLocale]||(Tg[e.parentLocale]=[]),Tg[e.parentLocale].push({name:t,config:e}),null;return pn[t]=new bO(o1(i,e)),Tg[t]&&Tg[t].forEach(function(r){PO(r.name,r.config)}),uu(t),pn[t]}else return delete pn[t],null}function H8(t,e){if(e!=null){var n,i,r=Aj;pn[t]!=null&&pn[t].parentLocale!=null?pn[t].set(o1(pn[t]._config,e)):(i=pS(t),i!=null&&(r=i._config),e=o1(r,e),i==null&&(e.abbr=t),n=new bO(e),n.parentLocale=pn[t],pn[t]=n),uu(t)}else pn[t]!=null&&(pn[t].parentLocale!=null?(pn[t]=pn[t].parentLocale,t===uu()&&uu(t)):pn[t]!=null&&delete pn[t]);return pn[t]}function rl(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Jm;if(!Qs(t)){if(e=pS(t),e)return e;t=[t]}return A8(t)}function P8(){return a1(pn)}function IO(t){var e,n=t._a;return n&&lt(t).overflow===-2&&(e=n[za]<0||n[za]>11?za:n[Fo]<1||n[Fo]>OO(n[$i],n[za])?Fo:n[hi]<0||n[hi]>24||n[hi]===24&&(n[Ks]!==0||n[Ya]!==0||n[Nc]!==0)?hi:n[Ks]<0||n[Ks]>59?Ks:n[Ya]<0||n[Ya]>59?Ya:n[Nc]<0||n[Nc]>999?Nc:-1,lt(t)._overflowDayOfYear&&(e<$i||e>Fo)&&(e=Fo),lt(t)._overflowWeeks&&e===-1&&(e=L6),lt(t)._overflowWeekday&&e===-1&&(e=k6),lt(t).overflow=e),t}var I8=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,N8=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,D8=/Z|[+-]\d\d(?::?\d\d)?/,ow=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],DT=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],L8=/^\/?Date\((-?\d+)/i,k8=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,V8={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function xj(t){var e,n,i=t._i,r=I8.exec(i)||N8.exec(i),s,a,u,h,d=ow.length,g=DT.length;if(r){for(lt(t).iso=!0,e=0,n=d;e<n;e++)if(ow[e][1].exec(r[1])){a=ow[e][0],s=ow[e][2]!==!1;break}if(a==null){t._isValid=!1;return}if(r[3]){for(e=0,n=g;e<n;e++)if(DT[e][1].exec(r[3])){u=(r[2]||" ")+DT[e][0];break}if(u==null){t._isValid=!1;return}}if(!s&&u!=null){t._isValid=!1;return}if(r[4])if(D8.exec(r[4]))h="Z";else{t._isValid=!1;return}t._f=a+(u||"")+(h||""),DO(t)}else t._isValid=!1}function $8(t,e,n,i,r,s){var a=[F8(t),Cj.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return s&&a.push(parseInt(s,10)),a}function F8(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function B8(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function W8(t,e,n){if(t){var i=_j.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return lt(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function U8(t,e,n){if(t)return V8[t];if(e)return 0;var i=parseInt(n,10),r=i%100,s=(i-r)/100;return s*60+r}function Hj(t){var e=k8.exec(B8(t._i)),n;if(e){if(n=$8(e[4],e[3],e[2],e[5],e[6],e[7]),!W8(e[1],n,t))return;t._a=n,t._tzm=U8(e[8],e[9],e[10]),t._d=Zm.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),lt(t).rfc2822=!0}else t._isValid=!1}function j8(t){var e=L8.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(xj(t),t._isValid===!1)delete t._isValid;else return;if(Hj(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:pe.createFromInputFallback(t)}pe.createFromInputFallback=Es("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Od(t,e,n){return t??e??n}function z8(t){var e=new Date(pe.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function NO(t){var e,n,i=[],r,s,a;if(!t._d){for(r=z8(t),t._w&&t._a[Fo]==null&&t._a[za]==null&&Y8(t),t._dayOfYear!=null&&(a=Od(t._a[$i],r[$i]),(t._dayOfYear>Am(a)||t._dayOfYear===0)&&(lt(t)._overflowDayOfYear=!0),n=Zm(a,0,t._dayOfYear),t._a[za]=n.getUTCMonth(),t._a[Fo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[hi]===24&&t._a[Ks]===0&&t._a[Ya]===0&&t._a[Nc]===0&&(t._nextDay=!0,t._a[hi]=0),t._d=(t._useUTC?Zm:Q6).apply(null,i),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[hi]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(lt(t).weekdayMismatch=!0)}}function Y8(t){var e,n,i,r,s,a,u,h,d;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,a=4,n=Od(e.GG,t._a[$i],Qm(cn(),1,4).year),i=Od(e.W,1),r=Od(e.E,1),(r<1||r>7)&&(h=!0)):(s=t._locale._week.dow,a=t._locale._week.doy,d=Qm(cn(),s,a),n=Od(e.gg,t._a[$i],d.year),i=Od(e.w,d.week),e.d!=null?(r=e.d,(r<0||r>6)&&(h=!0)):e.e!=null?(r=e.e+s,(e.e<0||e.e>6)&&(h=!0)):r=s),i<1||i>Ja(n,s,a)?lt(t)._overflowWeeks=!0:h!=null?lt(t)._overflowWeekday=!0:(u=Tj(n,i,r,s,a),t._a[$i]=u.year,t._dayOfYear=u.dayOfYear)}pe.ISO_8601=function(){};pe.RFC_2822=function(){};function DO(t){if(t._f===pe.ISO_8601){xj(t);return}if(t._f===pe.RFC_2822){Hj(t);return}t._a=[],lt(t).empty=!0;var e=""+t._i,n,i,r,s,a,u=e.length,h=0,d,g;for(r=fj(t._f,t._locale).match(RO)||[],g=r.length,n=0;n<g;n++)s=r[n],i=(e.match(I6(s,t))||[])[0],i&&(a=e.substr(0,e.indexOf(i)),a.length>0&&lt(t).unusedInput.push(a),e=e.slice(e.indexOf(i)+i.length),h+=i.length),Ud[s]?(i?lt(t).empty=!1:lt(t).unusedTokens.push(s),D6(s,i,t)):t._strict&&!i&&lt(t).unusedTokens.push(s);lt(t).charsLeftOver=u-h,e.length>0&&lt(t).unusedInput.push(e),t._a[hi]<=12&&lt(t).bigHour===!0&&t._a[hi]>0&&(lt(t).bigHour=void 0),lt(t).parsedDateParts=t._a.slice(0),lt(t).meridiem=t._meridiem,t._a[hi]=G8(t._locale,t._a[hi],t._meridiem),d=lt(t).era,d!==null&&(t._a[$i]=t._locale.erasConvertYear(d,t._a[$i])),NO(t),IO(t)}function G8(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function q8(t){var e,n,i,r,s,a,u=!1,h=t._f.length;if(h===0){lt(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<h;r++)s=0,a=!1,e=SO({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],DO(e),CO(e)&&(a=!0),s+=lt(e).charsLeftOver,s+=lt(e).unusedTokens.length*10,lt(e).score=s,u?s<i&&(i=s,n=e):(i==null||s<i||a)&&(i=s,n=e,a&&(u=!0));iu(t,n||e)}function K8(t){if(!t._d){var e=EO(t._i),n=e.day===void 0?e.date:e.day;t._a=cj([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),NO(t)}}function X8(t){var e=new Rp(IO(Pj(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Pj(t){var e=t._i,n=t._f;return t._locale=t._locale||rl(t._l),e===null||n===void 0&&e===""?uS({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Js(e)?new Rp(IO(e)):(bp(e)?t._d=e:Qs(n)?q8(t):n?DO(t):Z8(t),CO(t)||(t._d=null),t))}function Z8(t){var e=t._i;fr(e)?t._d=new Date(pe.now()):bp(e)?t._d=new Date(e.valueOf()):typeof e=="string"?j8(t):Qs(e)?(t._a=cj(e.slice(0),function(n){return parseInt(n,10)}),NO(t)):Bc(e)?K8(t):el(e)?t._d=new Date(e):pe.createFromInputFallback(t)}function Ij(t,e,n,i,r){var s={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(Bc(t)&&yO(t)||Qs(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=r,s._l=n,s._i=t,s._f=e,s._strict=i,X8(s)}function cn(t,e,n,i){return Ij(t,e,n,i,!1)}var Q8=Es("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=cn.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:uS()}),J8=Es("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=cn.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:uS()});function Nj(t,e){var n,i;if(e.length===1&&Qs(e[0])&&(e=e[0]),!e.length)return cn();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function e5(){var t=[].slice.call(arguments,0);return Nj("isBefore",t)}function t5(){var t=[].slice.call(arguments,0);return Nj("isAfter",t)}var n5=function(){return Date.now?Date.now():+new Date},_g=["year","quarter","month","week","day","hour","minute","second","millisecond"];function i5(t){var e,n=!1,i,r=_g.length;for(e in t)if(Dt(t,e)&&!(Un.call(_g,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[_g[i]]){if(n)return!1;parseFloat(t[_g[i]])!==Et(t[_g[i]])&&(n=!0)}return!0}function r5(){return this._isValid}function s5(){return ro(NaN)}function vS(t){var e=EO(t),n=e.year||0,i=e.quarter||0,r=e.month||0,s=e.week||e.isoWeek||0,a=e.day||0,u=e.hour||0,h=e.minute||0,d=e.second||0,g=e.millisecond||0;this._isValid=i5(e),this._milliseconds=+g+d*1e3+h*6e4+u*1e3*60*60,this._days=+a+s*7,this._months=+r+i*3+n*12,this._data={},this._locale=rl(),this._bubble()}function By(t){return t instanceof vS}function u1(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function o5(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0,a;for(a=0;a<i;a++)Et(t[a])!==Et(e[a])&&s++;return s+r}function Dj(t,e){Ye(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+Yo(~~(n/60),2)+e+Yo(~~n%60,2)})}Dj("Z",":");Dj("ZZ","");Ie("Z",gS);Ie("ZZ",gS);Xt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=LO(gS,t)});var a5=/([\+\-]|\d\d)/gi;function LO(t,e){var n=(e||"").match(t),i,r,s;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(a5)||["-",0,0],s=+(r[1]*60)+Et(r[2]),s===0?0:r[0]==="+"?s:-s)}function kO(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(Js(t)||bp(t)?t.valueOf():cn(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),pe.updateOffset(n,!1),n):cn(t).local()}function c1(t){return-Math.round(t._d.getTimezoneOffset())}pe.updateOffset=function(){};function l5(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=LO(gS,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=c1(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?Vj(this,ro(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,pe.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:c1(this)}function u5(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function c5(t){return this.utcOffset(0,t)}function h5(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(c1(this),"m")),this}function d5(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=LO(H6,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function f5(t){return this.isValid()?(t=t?cn(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function g5(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function m5(){if(!fr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return SO(t,this),t=Pj(t),t._a?(e=t._isUTC?Zo(t._a):cn(t._a),this._isDSTShifted=this.isValid()&&o5(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function p5(){return this.isValid()?!this._isUTC:!1}function v5(){return this.isValid()?this._isUTC:!1}function Lj(){return this.isValid()?this._isUTC&&this._offset===0:!1}var w5=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,y5=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ro(t,e){var n=t,i=null,r,s,a;return By(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:el(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=w5.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:Et(i[Fo])*r,h:Et(i[hi])*r,m:Et(i[Ks])*r,s:Et(i[Ya])*r,ms:Et(u1(i[Nc]*1e3))*r}):(i=y5.exec(t))?(r=i[1]==="-"?-1:1,n={y:Wu(i[2],r),M:Wu(i[3],r),w:Wu(i[4],r),d:Wu(i[5],r),h:Wu(i[6],r),m:Wu(i[7],r),s:Wu(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(a=C5(cn(n.from),cn(n.to)),n={},n.ms=a.milliseconds,n.M=a.months),s=new vS(n),By(t)&&Dt(t,"_locale")&&(s._locale=t._locale),By(t)&&Dt(t,"_isValid")&&(s._isValid=t._isValid),s}ro.fn=vS.prototype;ro.invalid=s5;function Wu(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function KV(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function C5(t,e){var n;return t.isValid()&&e.isValid()?(e=kO(e,t),t.isBefore(e)?n=KV(t,e):(n=KV(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function kj(t,e){return function(n,i){var r,s;return i!==null&&!isNaN(+i)&&(dj(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=n,n=i,i=s),r=ro(n,i),Vj(this,r,t),this}}function Vj(t,e,n,i){var r=e._milliseconds,s=u1(e._days),a=u1(e._months);t.isValid()&&(i=i??!0,a&&bj(t,Xm(t,"Month")+a*n),s&&yj(t,"Date",Xm(t,"Date")+s*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&pe.updateOffset(t,s||a))}var S5=kj(1,"add"),b5=kj(-1,"subtract");function $j(t){return typeof t=="string"||t instanceof String}function R5(t){return Js(t)||bp(t)||$j(t)||el(t)||T5(t)||E5(t)||t===null||t===void 0}function E5(t){var e=Bc(t)&&!yO(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,s,a=i.length;for(r=0;r<a;r+=1)s=i[r],n=n||Dt(t,s);return e&&n}function T5(t){var e=Qs(t),n=!1;return e&&(n=t.filter(function(i){return!el(i)&&$j(t)}).length===0),e&&n}function _5(t){var e=Bc(t)&&!yO(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,s;for(r=0;r<i.length;r+=1)s=i[r],n=n||Dt(t,s);return e&&n}function M5(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function O5(t,e){arguments.length===1&&(arguments[0]?R5(arguments[0])?(t=arguments[0],e=void 0):_5(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||cn(),i=kO(n,this).startOf("day"),r=pe.calendarFormat(this,i)||"sameElse",s=e&&(Qo(e[r])?e[r].call(this,n):e[r]);return this.format(s||this.localeData().calendar(r,this,cn(n)))}function A5(){return new Rp(this)}function x5(t,e){var n=Js(t)?t:cn(t);return this.isValid()&&n.isValid()?(e=Ts(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function H5(t,e){var n=Js(t)?t:cn(t);return this.isValid()&&n.isValid()?(e=Ts(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function P5(t,e,n,i){var r=Js(t)?t:cn(t),s=Js(e)?e:cn(e);return this.isValid()&&r.isValid()&&s.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(s,n):!this.isAfter(s,n))):!1}function I5(t,e){var n=Js(t)?t:cn(t),i;return this.isValid()&&n.isValid()?(e=Ts(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function N5(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function D5(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function L5(t,e,n){var i,r,s;if(!this.isValid())return NaN;if(i=kO(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=Ts(e),e){case"year":s=Wy(this,i)/12;break;case"month":s=Wy(this,i);break;case"quarter":s=Wy(this,i)/3;break;case"second":s=(this-i)/1e3;break;case"minute":s=(this-i)/6e4;break;case"hour":s=(this-i)/36e5;break;case"day":s=(this-i-r)/864e5;break;case"week":s=(this-i-r)/6048e5;break;default:s=this-i}return n?s:vs(s)}function Wy(t,e){if(t.date()<e.date())return-Wy(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,s;return e-i<0?(r=t.clone().add(n-1,"months"),s=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),s=(e-i)/(r-i)),-(n+s)||0}pe.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";pe.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function k5(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function V5(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Fy(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Qo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Fy(n,"Z")):Fy(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function $5(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(n+i+r+s)}function F5(t){t||(t=this.isUtc()?pe.defaultFormatUtc:pe.defaultFormat);var e=Fy(this,t);return this.localeData().postformat(e)}function B5(t,e){return this.isValid()&&(Js(t)&&t.isValid()||cn(t).isValid())?ro({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function W5(t){return this.from(cn(),t)}function U5(t,e){return this.isValid()&&(Js(t)&&t.isValid()||cn(t).isValid())?ro({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function j5(t){return this.to(cn(),t)}function Fj(t){var e;return t===void 0?this._locale._abbr:(e=rl(t),e!=null&&(this._locale=e),this)}var Bj=Es("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function Wj(){return this._locale}var uC=1e3,jd=60*uC,cC=60*jd,Uj=(365*400+97)*24*cC;function zd(t,e){return(t%e+e)%e}function jj(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-Uj:new Date(t,e,n).valueOf()}function zj(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-Uj:Date.UTC(t,e,n)}function z5(t){var e,n;if(t=Ts(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?zj:jj,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=zd(e+(this._isUTC?0:this.utcOffset()*jd),cC);break;case"minute":e=this._d.valueOf(),e-=zd(e,jd);break;case"second":e=this._d.valueOf(),e-=zd(e,uC);break}return this._d.setTime(e),pe.updateOffset(this,!0),this}function Y5(t){var e,n;if(t=Ts(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?zj:jj,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=cC-zd(e+(this._isUTC?0:this.utcOffset()*jd),cC)-1;break;case"minute":e=this._d.valueOf(),e+=jd-zd(e,jd)-1;break;case"second":e=this._d.valueOf(),e+=uC-zd(e,uC)-1;break}return this._d.setTime(e),pe.updateOffset(this,!0),this}function G5(){return this._d.valueOf()-(this._offset||0)*6e4}function q5(){return Math.floor(this.valueOf()/1e3)}function K5(){return new Date(this.valueOf())}function X5(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Z5(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Q5(){return this.isValid()?this.toISOString():null}function J5(){return CO(this)}function e9(){return iu({},lt(this))}function t9(){return lt(this).overflow}function n9(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ye("N",0,0,"eraAbbr");Ye("NN",0,0,"eraAbbr");Ye("NNN",0,0,"eraAbbr");Ye("NNNN",0,0,"eraName");Ye("NNNNN",0,0,"eraNarrow");Ye("y",["y",1],"yo","eraYear");Ye("y",["yy",2],0,"eraYear");Ye("y",["yyy",3],0,"eraYear");Ye("y",["yyyy",4],0,"eraYear");Ie("N",VO);Ie("NN",VO);Ie("NNN",VO);Ie("NNNN",f9);Ie("NNNNN",g9);Xt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?lt(n).era=r:lt(n).invalidEra=t});Ie("y",ff);Ie("yy",ff);Ie("yyy",ff);Ie("yyyy",ff);Ie("yo",m9);Xt(["y","yy","yyy","yyyy"],$i);Xt(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[$i]=n._locale.eraYearOrdinalParse(t,r):e[$i]=parseInt(t,10)});function i9(t,e){var n,i,r,s=this._eras||rl("en")._eras;for(n=0,i=s.length;n<i;++n){switch(typeof s[n].since){case"string":r=pe(s[n].since).startOf("day"),s[n].since=r.valueOf();break}switch(typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":r=pe(s[n].until).startOf("day").valueOf(),s[n].until=r.valueOf();break}}return s}function r9(t,e,n){var i,r,s=this.eras(),a,u,h;for(t=t.toUpperCase(),i=0,r=s.length;i<r;++i)if(a=s[i].name.toUpperCase(),u=s[i].abbr.toUpperCase(),h=s[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(u===t)return s[i];break;case"NNNN":if(a===t)return s[i];break;case"NNNNN":if(h===t)return s[i];break}else if([a,u,h].indexOf(t)>=0)return s[i]}function s9(t,e){var n=t.since<=t.until?1:-1;return e===void 0?pe(t.since).year():pe(t.since).year()+(e-t.offset)*n}function o9(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function a9(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function l9(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function u9(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-pe(r[t].since).year())*n+r[t].offset;return this.year()}function c9(t){return Dt(this,"_erasNameRegex")||$O.call(this),t?this._erasNameRegex:this._erasRegex}function h9(t){return Dt(this,"_erasAbbrRegex")||$O.call(this),t?this._erasAbbrRegex:this._erasRegex}function d9(t){return Dt(this,"_erasNarrowRegex")||$O.call(this),t?this._erasNarrowRegex:this._erasRegex}function VO(t,e){return e.erasAbbrRegex(t)}function f9(t,e){return e.erasNameRegex(t)}function g9(t,e){return e.erasNarrowRegex(t)}function m9(t,e){return e._eraYearOrdinalRegex||ff}function $O(){var t=[],e=[],n=[],i=[],r,s,a,u,h,d=this.eras();for(r=0,s=d.length;r<s;++r)a=Qa(d[r].name),u=Qa(d[r].abbr),h=Qa(d[r].narrow),e.push(a),t.push(u),n.push(h),i.push(a),i.push(u),i.push(h);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ye(0,["gg",2],0,function(){return this.weekYear()%100});Ye(0,["GG",2],0,function(){return this.isoWeekYear()%100});function wS(t,e){Ye(0,[t,t.length],0,e)}wS("gggg","weekYear");wS("ggggg","weekYear");wS("GGGG","isoWeekYear");wS("GGGGG","isoWeekYear");Ie("G",fS);Ie("g",fS);Ie("GG",hn,Ur);Ie("gg",hn,Ur);Ie("GGGG",_O,TO);Ie("gggg",_O,TO);Ie("GGGGG",dS,cS);Ie("ggggg",dS,cS);Tp(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=Et(t)});Tp(["gg","GG"],function(t,e,n,i){e[i]=pe.parseTwoDigitYear(t)});function p9(t){return Yj.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function v9(t){return Yj.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function w9(){return Ja(this.year(),1,4)}function y9(){return Ja(this.isoWeekYear(),1,4)}function C9(){var t=this.localeData()._week;return Ja(this.year(),t.dow,t.doy)}function S9(){var t=this.localeData()._week;return Ja(this.weekYear(),t.dow,t.doy)}function Yj(t,e,n,i,r){var s;return t==null?Qm(this,i,r).year:(s=Ja(t,i,r),e>s&&(e=s),b9.call(this,t,e,n,i,r))}function b9(t,e,n,i,r){var s=Tj(t,e,n,i,r),a=Zm(s.year,0,s.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Ye("Q",0,"Qo","quarter");Ie("Q",gj);Xt("Q",function(t,e){e[za]=(Et(t)-1)*3});function R9(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ye("D",["DD",2],"Do","date");Ie("D",hn,gf);Ie("DD",hn,Ur);Ie("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Xt(["D","DD"],Fo);Xt("Do",function(t,e){e[Fo]=Et(t.match(hn)[0])});var Gj=mf("Date",!0);Ye("DDD",["DDDD",3],"DDDo","dayOfYear");Ie("DDD",hS);Ie("DDDD",mj);Xt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Et(t)});function E9(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ye("m",["mm",2],0,"minute");Ie("m",hn,MO);Ie("mm",hn,Ur);Xt(["m","mm"],Ks);var T9=mf("Minutes",!1);Ye("s",["ss",2],0,"second");Ie("s",hn,MO);Ie("ss",hn,Ur);Xt(["s","ss"],Ya);var _9=mf("Seconds",!1);Ye("S",0,0,function(){return~~(this.millisecond()/100)});Ye(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ye(0,["SSS",3],0,"millisecond");Ye(0,["SSSS",4],0,function(){return this.millisecond()*10});Ye(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ye(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ye(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ye(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ye(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Ie("S",hS,gj);Ie("SS",hS,Ur);Ie("SSS",hS,mj);var ru,qj;for(ru="SSSS";ru.length<=9;ru+="S")Ie(ru,ff);function M9(t,e){e[Nc]=Et(("0."+t)*1e3)}for(ru="S";ru.length<=9;ru+="S")Xt(ru,M9);qj=mf("Milliseconds",!1);Ye("z",0,0,"zoneAbbr");Ye("zz",0,0,"zoneName");function O9(){return this._isUTC?"UTC":""}function A9(){return this._isUTC?"Coordinated Universal Time":""}var Se=Rp.prototype;Se.add=S5;Se.calendar=O5;Se.clone=A5;Se.diff=L5;Se.endOf=Y5;Se.format=F5;Se.from=B5;Se.fromNow=W5;Se.to=U5;Se.toNow=j5;Se.get=$6;Se.invalidAt=t9;Se.isAfter=x5;Se.isBefore=H5;Se.isBetween=P5;Se.isSame=I5;Se.isSameOrAfter=N5;Se.isSameOrBefore=D5;Se.isValid=J5;Se.lang=Bj;Se.locale=Fj;Se.localeData=Wj;Se.max=J8;Se.min=Q8;Se.parsingFlags=e9;Se.set=F6;Se.startOf=z5;Se.subtract=b5;Se.toArray=X5;Se.toObject=Z5;Se.toDate=K5;Se.toISOString=V5;Se.inspect=$5;typeof Symbol<"u"&&Symbol.for!=null&&(Se[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Se.toJSON=Q5;Se.toString=k5;Se.unix=q5;Se.valueOf=G5;Se.creationData=n9;Se.eraName=o9;Se.eraNarrow=a9;Se.eraAbbr=l9;Se.eraYear=u9;Se.year=wj;Se.isLeapYear=V6;Se.weekYear=p9;Se.isoWeekYear=v9;Se.quarter=Se.quarters=R9;Se.month=Rj;Se.daysInMonth=K6;Se.week=Se.weeks=i8;Se.isoWeek=Se.isoWeeks=r8;Se.weeksInYear=C9;Se.weeksInWeekYear=S9;Se.isoWeeksInYear=w9;Se.isoWeeksInISOWeekYear=y9;Se.date=Gj;Se.day=Se.days=v8;Se.weekday=w8;Se.isoWeekday=y8;Se.dayOfYear=E9;Se.hour=Se.hours=_8;Se.minute=Se.minutes=T9;Se.second=Se.seconds=_9;Se.millisecond=Se.milliseconds=qj;Se.utcOffset=l5;Se.utc=c5;Se.local=h5;Se.parseZone=d5;Se.hasAlignedHourOffset=f5;Se.isDST=g5;Se.isLocal=p5;Se.isUtcOffset=v5;Se.isUtc=Lj;Se.isUTC=Lj;Se.zoneAbbr=O9;Se.zoneName=A9;Se.dates=Es("dates accessor is deprecated. Use date instead.",Gj);Se.months=Es("months accessor is deprecated. Use month instead",Rj);Se.years=Es("years accessor is deprecated. Use year instead",wj);Se.zone=Es("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",u5);Se.isDSTShifted=Es("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",m5);function x9(t){return cn(t*1e3)}function H9(){return cn.apply(null,arguments).parseZone()}function Kj(t){return t}var Lt=bO.prototype;Lt.calendar=p6;Lt.longDateFormat=C6;Lt.invalidDate=b6;Lt.ordinal=T6;Lt.preparse=Kj;Lt.postformat=Kj;Lt.relativeTime=M6;Lt.pastFuture=O6;Lt.set=g6;Lt.eras=i9;Lt.erasParse=r9;Lt.erasConvertYear=s9;Lt.erasAbbrRegex=h9;Lt.erasNameRegex=c9;Lt.erasNarrowRegex=d9;Lt.months=z6;Lt.monthsShort=Y6;Lt.monthsParse=q6;Lt.monthsRegex=Z6;Lt.monthsShortRegex=X6;Lt.week=J6;Lt.firstDayOfYear=n8;Lt.firstDayOfWeek=t8;Lt.weekdays=d8;Lt.weekdaysMin=g8;Lt.weekdaysShort=f8;Lt.weekdaysParse=p8;Lt.weekdaysRegex=C8;Lt.weekdaysShortRegex=S8;Lt.weekdaysMinRegex=b8;Lt.isPM=E8;Lt.meridiem=M8;function hC(t,e,n,i){var r=rl(),s=Zo().set(i,e);return r[n](s,t)}function Xj(t,e,n){if(el(t)&&(e=t,t=void 0),t=t||"",e!=null)return hC(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=hC(t,i,n,"month");return r}function FO(t,e,n,i){typeof t=="boolean"?(el(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,el(e)&&(n=e,e=void 0),e=e||"");var r=rl(),s=t?r._week.dow:0,a,u=[];if(n!=null)return hC(e,(n+s)%7,i,"day");for(a=0;a<7;a++)u[a]=hC(e,(a+s)%7,i,"day");return u}function P9(t,e){return Xj(t,e,"months")}function I9(t,e){return Xj(t,e,"monthsShort")}function N9(t,e,n){return FO(t,e,n,"weekdays")}function D9(t,e,n){return FO(t,e,n,"weekdaysShort")}function L9(t,e,n){return FO(t,e,n,"weekdaysMin")}uu("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Et(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});pe.lang=Es("moment.lang is deprecated. Use moment.locale instead.",uu);pe.langData=Es("moment.langData is deprecated. Use moment.localeData instead.",rl);var ya=Math.abs;function k9(){var t=this._data;return this._milliseconds=ya(this._milliseconds),this._days=ya(this._days),this._months=ya(this._months),t.milliseconds=ya(t.milliseconds),t.seconds=ya(t.seconds),t.minutes=ya(t.minutes),t.hours=ya(t.hours),t.months=ya(t.months),t.years=ya(t.years),this}function Zj(t,e,n,i){var r=ro(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function V9(t,e){return Zj(this,t,e,1)}function $9(t,e){return Zj(this,t,e,-1)}function XV(t){return t<0?Math.floor(t):Math.ceil(t)}function F9(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,s,a,u,h;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=XV(h1(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=vs(t/1e3),i.seconds=r%60,s=vs(r/60),i.minutes=s%60,a=vs(s/60),i.hours=a%24,e+=vs(a/24),h=vs(Qj(e)),n+=h,e-=XV(h1(h)),u=vs(n/12),n%=12,i.days=e,i.months=n,i.years=u,this}function Qj(t){return t*4800/146097}function h1(t){return t*146097/4800}function B9(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=Ts(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+Qj(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(h1(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function sl(t){return function(){return this.as(t)}}var Jj=sl("ms"),W9=sl("s"),U9=sl("m"),j9=sl("h"),z9=sl("d"),Y9=sl("w"),G9=sl("M"),q9=sl("Q"),K9=sl("y"),X9=Jj;function Z9(){return ro(this)}function Q9(t){return t=Ts(t),this.isValid()?this[t+"s"]():NaN}function rh(t){return function(){return this.isValid()?this._data[t]:NaN}}var J9=rh("milliseconds"),e7=rh("seconds"),t7=rh("minutes"),n7=rh("hours"),i7=rh("days"),r7=rh("months"),s7=rh("years");function o7(){return vs(this.days()/7)}var Va=Math.round,kd={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function a7(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function l7(t,e,n,i){var r=ro(t).abs(),s=Va(r.as("s")),a=Va(r.as("m")),u=Va(r.as("h")),h=Va(r.as("d")),d=Va(r.as("M")),g=Va(r.as("w")),p=Va(r.as("y")),w=s<=n.ss&&["s",s]||s<n.s&&["ss",s]||a<=1&&["m"]||a<n.m&&["mm",a]||u<=1&&["h"]||u<n.h&&["hh",u]||h<=1&&["d"]||h<n.d&&["dd",h];return n.w!=null&&(w=w||g<=1&&["w"]||g<n.w&&["ww",g]),w=w||d<=1&&["M"]||d<n.M&&["MM",d]||p<=1&&["y"]||["yy",p],w[2]=e,w[3]=+t>0,w[4]=i,a7.apply(null,w)}function u7(t){return t===void 0?Va:typeof t=="function"?(Va=t,!0):!1}function c7(t,e){return kd[t]===void 0?!1:e===void 0?kd[t]:(kd[t]=e,t==="s"&&(kd.ss=e-1),!0)}function h7(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=kd,r,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},kd,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),s=l7(this,!n,i,r),n&&(s=r.pastFuture(+this,s)),r.postformat(s)}var LT=Math.abs;function Uh(t){return(t>0)-(t<0)||+t}function yS(){if(!this.isValid())return this.localeData().invalidDate();var t=LT(this._milliseconds)/1e3,e=LT(this._days),n=LT(this._months),i,r,s,a,u=this.asSeconds(),h,d,g,p;return u?(i=vs(t/60),r=vs(i/60),t%=60,i%=60,s=vs(n/12),n%=12,a=t?t.toFixed(3).replace(/\.?0+$/,""):"",h=u<0?"-":"",d=Uh(this._months)!==Uh(u)?"-":"",g=Uh(this._days)!==Uh(u)?"-":"",p=Uh(this._milliseconds)!==Uh(u)?"-":"",h+"P"+(s?d+s+"Y":"")+(n?d+n+"M":"")+(e?g+e+"D":"")+(r||i||t?"T":"")+(r?p+r+"H":"")+(i?p+i+"M":"")+(t?p+a+"S":"")):"P0D"}var xt=vS.prototype;xt.isValid=r5;xt.abs=k9;xt.add=V9;xt.subtract=$9;xt.as=B9;xt.asMilliseconds=Jj;xt.asSeconds=W9;xt.asMinutes=U9;xt.asHours=j9;xt.asDays=z9;xt.asWeeks=Y9;xt.asMonths=G9;xt.asQuarters=q9;xt.asYears=K9;xt.valueOf=X9;xt._bubble=F9;xt.clone=Z9;xt.get=Q9;xt.milliseconds=J9;xt.seconds=e7;xt.minutes=t7;xt.hours=n7;xt.days=i7;xt.weeks=o7;xt.months=r7;xt.years=s7;xt.humanize=h7;xt.toISOString=yS;xt.toString=yS;xt.toJSON=yS;xt.locale=Fj;xt.localeData=Wj;xt.toIsoString=Es("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",yS);xt.lang=Bj;Ye("X",0,0,"unix");Ye("x",0,0,"valueOf");Ie("x",fS);Ie("X",P6);Xt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});Xt("x",function(t,e,n){n._d=new Date(Et(t))});//! moment.js
pe.version="2.30.1";d6(cn);pe.fn=Se;pe.min=e5;pe.max=t5;pe.now=n5;pe.utc=Zo;pe.unix=x9;pe.months=P9;pe.isDate=bp;pe.locale=uu;pe.invalid=uS;pe.duration=ro;pe.isMoment=Js;pe.weekdays=N9;pe.parseZone=H9;pe.localeData=rl;pe.isDuration=By;pe.monthsShort=I9;pe.weekdaysMin=L9;pe.defineLocale=PO;pe.updateLocale=H8;pe.locales=P8;pe.weekdaysShort=D9;pe.normalizeUnits=Ts;pe.relativeTimeRounding=u7;pe.relativeTimeThreshold=c7;pe.calendarFormat=M5;pe.prototype=Se;pe.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function d7(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function ZV(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function Uy(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,i=t[0].length;for(let r=0;r<n;r++)for(let s=0;s<i;s++)e[s]||(e[s]=[]),e[s][r]=t[r][s];return e}function Sr(t,e,n,i){let r=-1,s=t,a=n;Array.isArray(t)||(s=Array.from(t));const u=s.length;for(r+=1;r<u;)a=e(a,s[r],r,s),r+=1;return a}function Uc(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,s=[];let a=-1;for(;n<r;){const u=i[n];e(u,n,i)&&(a+=1,s[a]=u),n+=1}return s}function Rt(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,s=[];let a=-1;for(;n<r;){const u=i[n];a+=1,s[a]=e(u,n,i),n+=1}return s}function W(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length;for(;n<r&&e(i[n],n,i)!==!1;)n+=1;return t}function f7(t){const e=[];return W(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function QV(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let s=i;return W(r,a=>{s=s.filter(u=>!a.includes(u))}),s}function JV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function $t(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Sr(t,(s,a,u)=>{const h=a.replace(/\r?\n\s*/g,""),d=n[u]?n[u]:"";return s+h+d},"").trim()}function zn(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Pe(t){return typeof t<"u"}function vn(t){return typeof t>"u"}function Vn(t){return t===null||t===""||vn(t)}function g7(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const bm="length",xm=t=>parseInt(t,16),e$=t=>parseInt(t,10),dC=(t,e,n)=>t.substr(e,n),Hm=t=>t.codePointAt(0)-65,d1=t=>`${t}`.replace(/\-/g,""),m7=t=>xm(dC(d1(t),xm("12"),Hm("F")))/(xm(dC(d1(t),Hm("B"),~~![][bm]))||9),p7=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let t$=!1;const n$={invalid:()=>$t`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return $t`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>$t`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},i$={invalid:()=>$t`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return $t`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>$t`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function v7(t,e){const n=!Vn(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",r="15.1.0";let s,a="invalid",u="invalid";t=d1(t||"");const h=w7(t);if(n||i||h)if(h){const d=pe("20/02/2025","DD/MM/YYYY"),g=Math.floor(d.toDate().getTime()/864e5),p=m7(t);s=pe((p+1)*864e5,"x").format("MMMM DD, YYYY"),g>p?(a="expired",u="expired"):(a="valid",u="valid")}else i?(a="non_commercial",u="valid"):(a="invalid",u="invalid");else a="missing",u="missing";if(p7()&&(a="valid",u="valid"),!t$&&a!=="valid"&&(n$[a]({keyValidityDate:s,hotVersion:r})&&console[a==="non_commercial"?"info":"warn"](n$[a]({keyValidityDate:s,hotVersion:r})),t$=!0),u!=="valid"&&e.parentNode&&i$[u]({keyValidityDate:s,hotVersion:r})){const g=document.createElement("div");g.className="handsontable hot-display-license-info",g.innerHTML=i$[u]({keyValidityDate:s,hotVersion:r}),e.parentNode.insertBefore(g,e.nextSibling)}}function w7(t){let e=[][bm],n=e;if(t[bm]!==Hm("Z"))return!1;for(let i="",r="B<H4P+".split(""),s=Hm(r.shift());s;s=Hm(r.shift()||"A"))--s<""[bm]?n=n|(e$(`${e$(xm(i)+(xm(dC(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=dC(t,s,s?r[bm]===1?9:8:6);return n===e}function eo(t){return t[0].toUpperCase()+t.substr(1)}function e2(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function t2(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function n2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,i)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[i]===void 0?"":e[i])}function r$(t){return BO(`${t}`,{ALLOWED_TAGS:[]})}function BO(t,e){return h6.sanitize(t,e)}const pf=t=>["tabindex",t],y7=()=>["role","treegrid"],jo=()=>["role","presentation"],C7=()=>["role","gridcell"],S7=()=>["role","rowheader"],i2=()=>["role","rowgroup"],b7=()=>["role","columnheader"],f1=()=>["role","row"],R7=()=>["role","menu"],E7=()=>["role","menuitem"],T7=()=>["role","menuitemcheckbox"],_7=()=>["role","combobox"],r2=()=>["role","listbox"],M7=()=>["role","option"],O7=()=>["role","checkbox"],A7=()=>["scope","col"],x7=()=>["scope","row"],H7=()=>["type","text"],fC=t=>["aria-label",t],vu=()=>["aria-hidden","true"],P7=()=>["aria-disabled","true"],I7=()=>["aria-multiselectable","true"],s2=t=>["aria-haspopup",t],o2=t=>["aria-rowcount",t],CS=t=>["aria-colcount",t],a2=t=>["aria-rowindex",t],WO=t=>["aria-colindex",t],Cs=t=>["aria-expanded",t],N7=t=>["aria-sort",t],s$=()=>["aria-readonly","true"],o$=()=>["aria-invalid","true"],l2=t=>["aria-checked",t],UO=()=>["aria-selected","true"],D7=()=>["aria-autocomplete","list"],L7=t=>["aria-controls",t],k7=t=>["aria-activedescendant",t],V7=t=>["aria-live",t],$7=t=>["aria-relevant",t],F7=t=>["aria-setsize",t],B7=t=>["aria-posinset",t];function W7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=null,r=t;for(;r!==null;){if(n===e){i=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(n+=1,r=r.parentNode)}return i}function U7(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function j7(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Qd(t){return j7(t)&&t.parent}function jc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:r}=Node;let s=t;for(;s!=null&&s!==n;){const{nodeType:a,nodeName:u}=s;if(a===i&&(e.includes(u)||e.includes(s)))return s;const{host:h}=s;h&&a===r?s=h:s=s.parentNode}return null}function aw(t,e,n){const i=[];let r=t;for(;r&&(r=jc(r,e,n),!(!r||n&&!n.contains(r)));)i.push(r),r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:r=r.parentNode;const s=i.length;return s?i[s-1]:null}function z7(t,e){const n={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&i.classList.contains(e))n.element=i,n.classNames.push(e);else if(e instanceof RegExp){const r=Array.from(i.classList).filter(s=>e.test(s));r.length&&(n.element=i,n.classNames.push(...r))}i=i.parentElement}return n}function Wc(t,e){let n=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);n!==null;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Y7(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Uu(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function u2(t){return!t||!t.length?[]:t.filter(e=>!!e)}function c2(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],i=[];return i.push(...t.filter(r=>{const s=r instanceof RegExp;return s&&e&&n.push(r),!s})),{regexFree:i,regexes:n}}function ze(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function fe(t,e){typeof e=="string"&&(e=e.split(" ")),e=u2(e),e.length>0&&t.classList.add(...e)}function je(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=c2(e,!0);n=u2(n),n.length>0&&t.classList.remove(...n),i.forEach(r=>{t.classList.forEach(s=>{r.test(s)&&t.classList.remove(s)})})}function Ge(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function vf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=c2(e,!0);n.forEach(r=>{r!==""&&t.removeAttribute(r)}),i.forEach(r=>{t.getAttributeNames().forEach(s=>{r.test(s)&&t.removeAttribute(s)})})}function h2(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)h2(e[n])}}function Go(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const G7=/(<(.*)>|&(.*);)/;function wf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;G7.test(e)?t.innerHTML=n?BO(e):e:zc(t,e)}function zc(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Go(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Jd(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return Jd(i.host.impl);if(i.host)return Jd(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function Ci(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let r=t,s,a,u;for(s=r.offsetLeft,a=r.offsetTop,u=r;(r=r.offsetParent)&&!(r===e.body||!("offsetLeft"in r));)s+=r.offsetLeft,a+=r.offsetTop,u=r;return u&&u.style.position==="fixed"&&(s+=n.pageXOffset||i.scrollLeft,a+=n.pageYOffset||i.scrollTop),{left:s,top:a}}function d2(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function jO(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function zO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?d2(e):t.scrollTop}function f2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?jO(e):t.scrollLeft}function gC(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let r=t.parentNode;for(;r&&r.style&&e.body!==r;){let{overflow:s,overflowX:a,overflowY:u}=r.style;if([s,a,u].includes("scroll"))return r;if({overflow:s,overflowX:a,overflowY:u}=n.getComputedStyle(r),i.includes(s)||i.includes(a)||i.includes(u)||r.clientHeight<=r.scrollHeight+1&&(i.includes(u)||i.includes(s))||r.clientWidth<=r.scrollWidth+1&&(i.includes(a)||i.includes(s)))return r;r=r.parentNode}return n}function q7(t){return t.scrollHeight-t.clientHeight}function K7(t){return t.scrollWidth-t.clientWidth}function ef(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const r=n.getComputedStyle(i),s=["scroll","hidden","auto"],a=r.getPropertyValue("overflow"),u=r.getPropertyValue("overflow-y"),h=r.getPropertyValue("overflow-x");if(s.includes(a)||s.includes(u)||s.includes(h))return i;i=i.parentNode}return n}function mC(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const r=n.getComputedStyle(t);if(r[e]!==""&&r[e]!==void 0)return r[e]}function jn(t){return t.offsetWidth}function $n(t){return t.offsetHeight}function Pm(t){return t.clientHeight||t.innerHeight}function g2(t){return t.clientWidth||t.innerWidth}function m2(t){return t.selectionStart?t.selectionStart:0}function X7(t){return t.selectionEnd?t.selectionEnd:0}function a$(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function SS(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const r=t.parentNode,s=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=s}}}let kT;function Z7(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.offsetWidth;n.style.overflow="scroll";let r=e.offsetWidth;return i===r&&(r=n.clientWidth),(t.body||t.documentElement).removeChild(n),i-r}function Mi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return kT===void 0&&(kT=Z7(t)),kT}function Q7(t){return t.offsetWidth!==t.clientWidth}function J7(t){return t.offsetHeight!==t.clientHeight}function YO(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function bS(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function jy(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function p2(t){return jy(t)&&t.hasAttribute("data-hot-input")===!1}function v2(t){return!t.parentNode}function eX(t,e){new IntersectionObserver((i,r)=>{i.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function w2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,r=i.createRange(),s=i.defaultView.getSelection();Ge(t,"contenteditable",!0),n&&Ge(t,...vu()),e&&fe(t,"invisibleSelection"),r.selectNodeContents(t),s.removeAllRanges(),s.addRange(r)}function y2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&je(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function tX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w2(t,n),e(),y2(t,n)}function on(t){return typeof t=="function"}function GO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,i;function r(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];return n&&clearTimeout(n),n=setTimeout(()=>{i=t.apply(this,a)},e),i}return r}function C2(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];return t.apply(this,n.concat(a))}}function nX(t){const e=t.length;function n(i){return function(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];const h=i.concat(a);let d;return h.length>=e?d=t.apply(this,h):d=n(h),d}}return n([])}function g1(t,e,n,i,r,s,a,u){return Pe(u)?t.call(e,n,i,r,s,a,u):Pe(a)?t.call(e,n,i,r,s,a):Pe(s)?t.call(e,n,i,r,s):Pe(r)?t.call(e,n,i,r):Pe(i)?t.call(e,n,i):Pe(n)?t.call(e,n):t.call(e)}var l$={},VT,u$;function iX(){if(u$)return VT;u$=1;var t=Yn(),e=zU(),n=ni(),i=Jc(),r=lS(),s=t([].push);return VT=function(a){if(n(a))return a;if(e(a)){for(var u=a.length,h=[],d=0;d<u;d++){var g=a[d];typeof g=="string"?s(h,g):(typeof g=="number"||i(g)==="Number"||i(g)==="String")&&s(h,r(g))}var p=h.length,w=!0;return function(y,S){if(w)return w=!1,S;if(e(this))return S;for(var _=0;_<p;_++)if(h[_]===y)return S}}},VT}var c$;function rX(){if(c$)return l$;c$=1;var t=en(),e=af(),n=aS(),i=Fi(),r=Yn(),s=Oi(),a=ni(),u=oO(),h=wO(),d=iX(),g=sO(),p=String,w=e("JSON","stringify"),y=r(/./.exec),S=r("".charAt),_=r("".charCodeAt),E=r("".replace),H=r(1 .toString),x=/[\uD800-\uDFFF]/g,D=/^[\uD800-\uDBFF]$/,$=/^[\uDC00-\uDFFF]$/,V=!g||s(function(){var se=e("Symbol")("stringify detection");return w([se])!=="[null]"||w({a:se})!=="{}"||w(Object(se))!=="{}"}),L=s(function(){return w("\uDF06\uD834")!=='"\\udf06\\ud834"'||w("\uDEAD")!=='"\\udead"'}),U=function(se,Q){var de=h(arguments),me=d(Q);if(!(!a(me)&&(se===void 0||u(se))))return de[1]=function(_e,Ee){if(a(me)&&(Ee=i(me,this,p(_e),Ee)),!u(Ee))return Ee},n(w,null,de)},re=function(se,Q,de){var me=S(de,Q-1),_e=S(de,Q+1);return y(D,se)&&!y($,_e)||y($,se)&&!y(D,me)?"\\u"+H(_(se,0),16):se};return w&&t({target:"JSON",stat:!0,arity:3,forced:V||L},{stringify:function(Q,de,me){var _e=h(arguments),Ee=n(V?U:w,null,_e);return L&&typeof Ee=="string"?E(Ee,x,re):Ee}}),l$}rX();function ep(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},dt(t,(n,i)=>{i!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[i]=ep(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[i]=[ep(n[0])]:e[i]=[]:e[i]=null)})),e}function sX(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function ti(t,e,n){const i=Array.isArray(n);return dt(e,(r,s)=>{(i===!1||n.includes(s))&&(t[s]=r)}),t}function RS(t,e){dt(e,(n,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),RS(t[i],e[i])):t[i]=e[i]})}function tr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function qo(t){const e={};return dt(t,(n,i)=>{e[i]=n}),e}function Yt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return W(n,r=>{t.MIXINS.push(r.MIXIN_NAME),dt(r,(s,a)=>{if(t.prototype[a]!==void 0)throw new Error(`Mixin conflict. Property '${a}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[a]=s;else{const u=function(g,p){const w=`_${g}`,y=S=>{let _=S;return(Array.isArray(_)||ht(_))&&(_=tr(_)),_};return function(){return this[w]===void 0&&(this[w]=y(p)),this[w]}},h=function(g){const p=`_${g}`;return function(w){this[p]=w}};Object.defineProperty(t.prototype,a,{get:u(a,s),set:h(a),configurable:!0})}})}),t}function qO(t,e){return JSON.stringify(t)===JSON.stringify(e)}function ht(t){return Object.prototype.toString.call(t)==="[object Object]"}function ol(t,e,n,i){i.value=n,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function dt(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function oX(t,e){const n=e.split(".");let i=t;return dt(n,r=>{if(i=i[r],i===void 0)return i=void 0,!1}),i}function $T(t,e,n){const i=e.split(".");let r=t;i.forEach((s,a)=>{s==="__proto__"||s==="constructor"||s==="prototype"||(a!==i.length-1?(ei(r,s)||(r[s]={}),r=r[s]):r[s]=n)})}function KO(t){if(!ht(t))return 0;const e=function(n){let i=0;return ht(n)?dt(n,(r,s)=>{s!=="__children"&&(i+=e(r))}):i+=1,i};return e(t)}function Wr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(r){this._touched=!0,this[n]=r},enumerable:!0,configurable:!0}),i}function ei(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function pC(t){return window.requestAnimationFrame(t)}function vC(t){window.cancelAnimationFrame(t)}function S2(){return"ontouchstart"in window}function aX(){return typeof window<"u"}let jh;function lX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return jh||(typeof Intl=="object"?jh=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?jh=(n,i)=>`${n}`.localeCompare(i):jh=(n,i)=>n===i?0:n>i?-1:1,jh)}const fs=t=>{const e={value:!1};return e.test=(n,i)=>{e.value=t(n,i)},e},wu={chrome:fs((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:fs(t=>/CriOS/.test(t)),edge:fs(t=>/Edge/.test(t)),edgeWebKit:fs(t=>/EdgiOS/.test(t)),firefox:fs(t=>/Firefox/.test(t)),firefoxWebKit:fs(t=>/FxiOS/.test(t)),mobile:fs(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:fs((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},_p={mac:fs(t=>/^Mac/.test(t)),win:fs(t=>/^Win/.test(t)),linux:fs(t=>/^Linux/.test(t)),ios:fs(t=>/iPhone|iPad|iPod/i.test(t))};function uX(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};dt(wu,n=>{let{test:i}=n;return void i(t,e)})}function cX(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};dt(_p,e=>{let{test:n}=e;return void n(t)})}aX()&&(uX(),cX());function b2(){return wu.chrome.value}function hX(){return wu.chromeWebKit.value}function FT(){return wu.firefox.value}function dX(){return wu.firefoxWebKit.value}function R2(){return wu.safari.value}function fX(){return wu.edge.value}function Ga(){return wu.mobile.value}function E2(){return _p.ios.value}function T2(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&_p.mac.value}function h$(){return _p.win.value}function d$(){return _p.mac.value}const We={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:FT()?182:174,AUDIO_MUTE:FT()?181:173,AUDIO_UP:FT()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},gX=[We.ALT,We.ARROW_DOWN,We.ARROW_LEFT,We.ARROW_RIGHT,We.ARROW_UP,We.AUDIO_DOWN,We.AUDIO_MUTE,We.AUDIO_UP,We.BACKSPACE,We.CAPS_LOCK,We.DELETE,We.END,We.ENTER,We.ESCAPE,We.F1,We.F2,We.F3,We.F4,We.F5,We.F6,We.F7,We.F8,We.F9,We.F10,We.F11,We.F12,We.F13,We.F14,We.F15,We.F16,We.F17,We.F18,We.F19,We.HOME,We.INSERT,We.MEDIA_NEXT,We.MEDIA_PLAY_PAUSE,We.MEDIA_PREV,We.MEDIA_STOP,We.NULL,We.NUM_LOCK,We.PAGE_DOWN,We.PAGE_UP,We.PAUSE,We.SCROLL_LOCK,We.SHIFT,We.TAB];function mX(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function _2(t){return gX.includes(t)}function pX(t){return[We.CONTROL,We.COMMAND_LEFT,We.COMMAND_RIGHT,We.COMMAND_FIREFOX].includes(t)}function Mp(t,e){const n=e.split("|");let i=!1;return W(n,r=>{if(t===We[r])return i=!0,!1}),i}function so(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Pc(t){return t.isImmediatePropagationEnabled===!1}function Yc(t){return t.button===2}function XO(t){return t.button===0}function vX(t){return t instanceof TouchEvent}function wX(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!(e instanceof HTMLElement)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}function Nt(){Pe(console)&&console.warn(...arguments)}function ZO(){Pe(console)&&console.error(...arguments)}const Ic=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],BT=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),WT=new Map([[]]);var f$={},UT,g$;function yX(){if(g$)return UT;g$=1;var t=cf();return UT=function(e,n,i){for(var r=0,s=arguments.length>2?i:t(n),a=new e(s);s>r;)a[r]=n[r++];return a},UT}var jT,m$;function CX(){if(m$)return jT;m$=1;var t=di();return jT=function(e,n){var i=t[e],r=i&&i.prototype;return r&&r[n]},jT}var zT,p$;function ES(){if(p$)return zT;p$=1;var t=io(),e=mO(),n=pu().f,i=t("unscopables"),r=Array.prototype;return r[i]===void 0&&n(r,i,{configurable:!0,value:e(null)}),zT=function(s){r[i][s]=!0},zT}var v$;function SX(){if(v$)return f$;v$=1;var t=en(),e=Yn(),n=Cr(),i=pp(),r=yX(),s=CX(),a=ES(),u=Array,h=e(s("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(g){g!==void 0&&n(g);var p=i(this),w=r(u,p);return h(w,g)}}),a("toSorted"),f$}SX();var w$={},y$={},C$;function bX(){if(C$)return y$;C$=1;var t=en(),e=df(),n=Cr(),i=ii(),r=Xo();return t({target:"Iterator",proto:!0,real:!0},{find:function(a){i(this),n(a);var u=r(this),h=0;return e(u,function(d,g){if(a(d,h++))return g(d)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),y$}var S$;function RX(){return S$||(S$=1,bX()),w$}RX();function EX(t,e){M2(t,e),e.add(t)}function YT(t,e,n){M2(t,e),e.set(t,n)}function M2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b$(t,e,n){return t.set(wC(t,e),n),n}function _i(t,e){return t.get(wC(t,e))}function wC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TX=100;var Ir=new WeakMap,Ad=new WeakMap,GT=new WeakMap,qT=new WeakSet;class R${constructor(){EX(this,qT),YT(this,Ir,new Map),YT(this,Ad,new Map),YT(this,GT,new Set),Ic.forEach(e=>wC(qT,this,E$).call(this,e))}getHooks(e){var n;return(n=_i(Ir,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};_i(Ir,this).has(e)||(wC(qT,this,E$).call(this,e),Ic.push(e));const r=_i(Ir,this).get(e);if(r.find(d=>d.callback===n))return;const s=Number.isInteger(i.orderIndex)?i.orderIndex:0,a=!!i.runOnce,u=!!i.initialHook;let h=!1;if(u){const d=r.find(g=>g.initialHook);d&&(d.callback=n,h=!0)}if(!h){r.push({callback:n,orderIndex:s,runOnce:a,initialHook:u,skip:!1});let d=_i(GT,this).has(e);!d&&s!==0&&(d=!0,_i(GT,this).add(e)),d&&r.length>1&&_i(Ir,this).set(e,r.toSorted((g,p)=>g.orderIndex-p.orderIndex))}}has(e){return _i(Ir,this).has(e)&&_i(Ir,this).get(e).length>0}remove(e,n){if(!_i(Ir,this).has(e))return!1;const i=_i(Ir,this).get(e),r=i.find(s=>s.callback===n);if(r){let s=_i(Ad,this).get(e);return r.skip=!0,s+=1,s>TX&&(_i(Ir,this).set(e,i.filter(a=>!a.skip)),s=0),_i(Ad,this).set(e,s),!0}return!1}destroy(){_i(Ir,this).clear(),_i(Ad,this).clear(),b$(Ir,this,null),b$(Ad,this,null)}}function E$(t){_i(Ir,this).set(t,[]),_i(Ad,this).set(t,0)}function _X(t,e,n){return(e=MX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MX(t){var e=OX(t,"string");return typeof e=="symbol"?e:e+""}function OX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const AX=$t`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Ae{constructor(){_X(this,"globalBucket",new R$)}static getSingleton(){return HX()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new R$),e.pluginHookBucket):this.globalBucket}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?W(n,s=>this.add(e,s,i)):(BT.has(e)&&Nt(n2(AX,{hookName:e,removedInVersion:BT.get(e)})),WT.has(e)&&Nt(WT.get(e)),this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!1})),this}once(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?W(n,s=>this.once(e,s,i)):this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?W(n,r=>this.addAsFixed(e,r,i)):this.getBucket(i).add(e,n,{initialHook:!0}),this}remove(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,i,r,s,a,u,h){{const d=this.getBucket().getHooks(n),g=d?d.length:0;let p=0;if(g)for(;p<g;){if(!d[p]||d[p].skip){p+=1;continue}const w=g1(d[p].callback,e,i,r,s,a,u,h);w!==void 0&&(i=w),d[p]&&d[p].runOnce&&this.remove(n,d[p].callback),p+=1}}{const d=this.getBucket(e).getHooks(n),g=d?d.length:0;let p=0;if(g)for(;p<g;){if(!d[p]||d[p].skip){p+=1;continue}const w=g1(d[p].callback,e,i,r,s,a,u,h);w!==void 0&&(i=w),d[p]&&d[p].runOnce&&this.remove(n,d[p].callback,e),p+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Ic.push(e)}deregister(e){this.isRegistered(e)&&Ic.splice(Ic.indexOf(e),1)}isDeprecated(e){return WT.has(e)||BT.has(e)}isRegistered(e){return Ic.indexOf(e)>=0}getRegistered(){return Ic}}const xX=new Ae;function HX(){return xX}const KT=new Map;function oo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";KT.has(t)||KT.set(t,new Map);const e=KT.get(t);function n(u,h){e.set(u,h)}function i(u){return e.get(u)}function r(u){return e.has(u)}function s(){return[...e.keys()]}function a(){return[...e.values()]}return{register:n,getItem:i,hasItem:r,getNames:s,getValues:a}}const m1=new WeakMap,{register:PX,getItem:O2,hasItem:A2,getNames:HSe,getValues:PSe}=oo("editors");function IX(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new n(i)),e[i.guid]},Ae.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function x2(t,e){let n;if(typeof t=="function")m1.get(t)||Dr(null,t),n=m1.get(t);else if(typeof t=="string")n=O2(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function p1(t){if(typeof t=="function")return t;if(!A2(t))throw Error(`No registered editor found under "${t}" name`);return O2(t).getConstructor()}function Dr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new IX(e);typeof t=="string"&&PX(t,n),m1.set(e,n)}function NX(t,e,n){return(e=DX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DX(t){var e=LX(t,"string");return typeof e=="symbol"?e:e+""}function LX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class to{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;NX(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(a){i.call(this,kX(a))}return this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:s,options:r,eventManager:this}),e.addEventListener(n,s,r),()=>{this.removeEventListener(e,n,i)}}removeEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,a;for(;s;)if(s-=1,a=this.context.eventListeners[s],a.event===n&&a.element===e){if(i&&i!==a.callback||r&&a.eventManager!==this)continue;this.context.eventListeners.splice(s,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const i=this.context.eventListeners[n];e&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const s={bubbles:!0,cancelable:n!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let a;i.createEvent?(a=i.createEvent("MouseEvents"),a.initMouseEvent(n,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,i.body.parentNode)):a=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent(`on${n}`,a)}}function kX(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),so(this)},t}function VX(t,e){$X(t,e),e.add(t)}function $X(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ju(t,e,n){return(e=FX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FX(t){var e=BX(t,"string");return typeof e=="symbol"?e:e+""}function BX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var XT=new WeakSet;class v1{constructor(e,n,i){VX(this,XT),ju(this,"hot",void 0),ju(this,"tableMeta",void 0),ju(this,"selection",void 0),ju(this,"eventManager",void 0),ju(this,"destroyed",!1),ju(this,"activeEditor",void 0),ju(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=i,this.eventManager=new to(e),this.hot.addHook("afterDocumentKeyDown",r=>T$(XT,this,WX).call(this,r)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",r=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",r)}),this.hot.view._wt.update("onCellDblClick",(r,s,a)=>T$(XT,this,UX).call(this,r,s,a))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,d=>{d&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:i,col:r}=n,s=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");let a=i,u=r;if(Array.isArray(s)&&([a,u]=s),this.cellProperties=this.hot.getCellMeta(a,u),!this.isCellEditable()){this.clearActiveEditor();return}const h=this.hot.getCell(i,r,!0);if(h){const d=this.hot.getCellEditor(this.cellProperties),g=this.hot.colToProp(u),p=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a),u);this.activeEditor=x2(d,this.hot),this.activeEditor.prepare(i,r,g,h,p,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,n,i);if(n instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&r.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:s,columnIndexMapper:a}=this.hot,u=s.isHidden(this.hot.toPhysicalRow(i))||a.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!n||u)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function WX(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Pc(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!_2(n)&&!pX(n)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function UX(t,e){e.isCell()&&this.openEditor(null,t,!0)}const _$=new WeakMap;v1.getInstance=function(t,e,n){let i=_$.get(t);return i||(i=new v1(t,e,n),_$.set(t,i)),i};function jX(t,e){H2(t,e),e.add(t)}function Mg(t,e,n){H2(t,e),e.set(t,n)}function H2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mn(t,e){return t.get(Ua(t,e))}function Og(t,e,n){return t.set(Ua(t,e),n),n}function Ua(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Yd=Object.freeze({CELL:"cell",MIXED:"mixed"});var wi=new WeakMap,lw=new WeakMap,uw=new WeakMap,cw=new WeakMap,hw=new WeakMap,Kl=new WeakSet;class zX{constructor(e){var n=this;jX(this,Kl),Mg(this,wi,void 0),Mg(this,lw,void 0),Mg(this,uw,1),Mg(this,cw,null),Mg(this,hw,new Map);const i=e.getSettings();Og(wi,this,e),Og(lw,this,i.imeFastEdit?Yd.MIXED:Yd.CELL),mn(wi,this).addHook("afterUpdateSettings",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return Ua(Kl,n,GX).call(n,...s)}),mn(wi,this).addHook("afterSelection",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return Ua(Kl,n,M$).call(n,...s)}),mn(wi,this).addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return Ua(Kl,n,M$).call(n,...s)}),mn(wi,this).addHook("afterSelectionEnd",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return Ua(Kl,n,YX).call(n,...s)})}getFocusMode(){return mn(lw,this)}setFocusMode(e){Object.values(Yd).includes(e)?Og(lw,this,e):Nt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return mn(uw,this)}setRefocusDelay(e){Og(uw,this,e)}setRefocusElementGetter(e){Og(cw,this,e)}getRefocusElement(){var e;return typeof mn(cw,this)=="function"?mn(cw,this).call(this):(e=mn(wi,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=i=>{var r,s;const a=(r=mn(wi,this).getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;if(!a)return;let u=mn(wi,this).runHooks("modifyFocusedElement",a.row,a.col,i);u instanceof HTMLElement||(u=i),u&&!((s=mn(wi,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&u.focus({preventScroll:!0})};e?n(e):Ua(Kl,this,QO).call(this,i=>n(i))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mn(uw,this);mn(wi,this).getSettings().imeFastEdit&&!((e=mn(wi,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&(mn(hw,this).has(n)||mn(hw,this).set(n,GO(()=>{var i;(i=this.getRefocusElement())===null||i===void 0||i.select()},n)),mn(hw,this).get(n)())}}function QO(t){var e;const n=(e=mn(wi,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!mn(wi,this).selection.isCellVisible(n)){t(null);return}const i=mn(wi,this).getCell(n.row,n.col,!0);i===null?mn(wi,this).addHookOnce("afterScroll",()=>{t(mn(wi,this).getCell(n.row,n.col,!0))}):t(i)}function M$(){Ua(Kl,this,QO).call(this,t=>{const{activeElement:e}=mn(wi,this).rootDocument;e&&p2(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function YX(){Ua(Kl,this,QO).call(this,t=>{this.getFocusMode()===Yd.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function GX(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Yd.MIXED:Yd.CELL)}var O$={},ZT,A$;function qX(){if(A$)return ZT;A$=1;var t=no(),e=Jc(),n=io(),i=n("match");return ZT=function(r){var s;return t(r)&&((s=r[i])!==void 0?!!s:e(r)==="RegExp")},ZT}var QT,x$;function KX(){if(x$)return QT;x$=1;var t=ii();return QT=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},QT}var JT,H$;function XX(){if(H$)return JT;H$=1;var t=Fi(),e=Rs(),n=vp(),i=KX(),r=RegExp.prototype;return JT=function(s){var a=s.flags;return a===void 0&&!("flags"in r)&&!e(s,"flags")&&n(r,s)?t(i,s):a},JT}var e_,P$;function ZX(){if(P$)return e_;P$=1;var t=Yn(),e=lf(),n=Math.floor,i=t("".charAt),r=t("".replace),s=t("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;return e_=function(h,d,g,p,w,y){var S=g+h.length,_=p.length,E=u;return w!==void 0&&(w=e(w),E=a),r(y,E,function(H,x){var D;switch(i(x,0)){case"$":return"$";case"&":return h;case"`":return s(d,0,g);case"'":return s(d,S);case"<":D=w[s(x,1,-1)];break;default:var $=+x;if($===0)return H;if($>_){var V=n($/10);return V===0?H:V<=_?p[V-1]===void 0?i(x,1):p[V-1]+i(x,1):H}D=p[$-1]}return D===void 0?"":D})},e_}var I$;function QX(){if(I$)return O$;I$=1;var t=en(),e=Fi(),n=Yn(),i=mp(),r=ni(),s=rS(),a=qX(),u=lS(),h=wp(),d=XX(),g=ZX(),p=io(),w=mu(),y=p("replace"),S=TypeError,_=n("".indexOf),E=n("".replace),H=n("".slice),x=Math.max;return t({target:"String",proto:!0},{replaceAll:function($,V){var L=i(this),U,re,se,Q,de,me,_e,Ee,Te,ve,Ce=0,Re="";if(!s($)){if(U=a($),U&&(re=u(i(d($))),!~_(re,"g")))throw new S("`.replaceAll` does not allow non-global regexes");if(se=h($,y),se)return e(se,$,L,V);if(w&&U)return E(u(L),$,V)}for(Q=u(L),de=u($),me=r(V),me||(V=u(V)),_e=de.length,Ee=x(1,_e),Te=_(Q,de);Te!==-1;)ve=me?u(V(de,Te,Q)):g(de,Q,Te,[],void 0,V),Re+=H(Q,Ce,Te)+ve,Ce=Te+_e,Te=Te+Ee>Q.length?-1:_(Q,de,Te+Ee);return Ce<Q.length&&(Re+=H(Q,Ce)),Re}}),O$}QX();var N$={},D$={},L$;function JX(){if(L$)return D$;L$=1;var t=en(),e=df(),n=Cr(),i=ii(),r=Xo(),s=TypeError;return t({target:"Iterator",proto:!0,real:!0},{reduce:function(u){i(this),n(u);var h=r(this),d=arguments.length<2,g=d?void 0:arguments[1],p=0;if(e(h,function(w){d?(d=!1,g=w):g=u(g,w,p),p++},{IS_RECORD:!0}),d)throw new s("Reduce of empty iterator with no initial value");return g}}),D$}var k$;function eZ(){return k$||(k$=1,JX()),N$}eZ();const P2={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},tZ=new RegExp(Object.keys(P2).map(t=>`(${t})`).join("|"),"gi");function nZ(t){return(t&&t.nodeName||"")==="TABLE"}function V$(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),s=r.length,a=s>0?r[0].length:0,u=["<table>","</table>"],h=e?["<thead>","</thead>"]:[],d=["<tbody>","</tbody>"],g=n?1:0,p=e?1:0;for(let w=0;w<s;w+=1){const y=e&&w===0,S=[];for(let E=0;E<a;E+=1){const H=!y&&n&&E===0;let x="";if(y)x=`<th>${t.getColHeader(E-g)}</th>`;else if(H)x=`<th>${t.getRowHeader(w-p)}</th>`;else{const D=r[w][E],{hidden:$,rowspan:V,colspan:L}=t.getCellMeta(w-p,E-g);if(!$){const U=[];if(V&&U.push(`rowspan="${V}"`),L&&U.push(`colspan="${L}"`),Vn(D))x=`<td ${U.join(" ")}></td>`;else{const re=D.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");x=`<td ${U.join(" ")}>${re}</td>`}}}S.push(x)}const _=["<tr>",...S,"</tr>"].join("");y?h.splice(1,0,_):d.splice(-1,0,_)}return u.splice(1,0,h.join(""),d.join("")),u.join("")}function $$(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],s=r.length,a=[];i===0&&n.push("<tbody>");for(let u=0;u<s;u+=1){const h=r[u],d=Vn(h)?"":h.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,g=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(g.length-1)} </span>`).replace(/\t/gi,"&#9;");a.push(`<td>${d}</td>`)}n.push("<tr>",...a,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function iZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},i=e.createDocumentFragment(),r=e.createElement("div");i.appendChild(r);let s=t;if(typeof s=="string"){const D=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,$=>{const V=$.match(/<td\b[^>]*?>/g)[0],L=/<p.*?>/g,U=$.substring(V.length,$.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(L,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${V}${U}</td>`});r.insertAdjacentHTML("afterbegin",`${D}`),s=r.querySelector("table")}if(!s||!nZ(s))return;const a=r.querySelector('meta[name$="enerator"]'),u=s.querySelector("tbody th")!==null,h=s.querySelector("tr"),d=h?Array.from(h.cells).reduce((D,$)=>D+$.colSpan,0)-(u?1:0):0,g=s.tFoot&&Array.from(s.tFoot.rows)||[],p=[];let w=!1,y=0,S=0;if(s.tHead){const D=Array.from(s.tHead.rows).filter($=>{const V=$.querySelector("td")!==null;return V&&p.push($),!V});y=D.length,w=y>0,y>1?n.nestedHeaders=Array.from(D).reduce(($,V)=>{const L=Array.from(V.cells).reduce((U,re,se)=>{if(u&&se===0)return U;const{colSpan:Q,innerHTML:de}=re,me=Q>1?{label:de,colspan:Q}:de;return U.push(me),U},[]);return $.push(L),$},[]):w&&(n.colHeaders=Array.from(D[0].children).reduce(($,V,L)=>(u&&L===0||$.push(V.innerHTML),$),[]))}p.length&&(n.fixedRowsTop=p.length),g.length&&(n.fixedRowsBottom=g.length);const _=[...p,...Array.from(s.tBodies).reduce((D,$)=>(D.push(...Array.from($.rows)),D),[]),...g];S=_.length;const E=new Array(S);for(let D=0;D<S;D++)E[D]=new Array(d);const H=[],x=[];for(let D=0;D<S;D++){const $=_[D],V=Array.from($.cells),L=V.length;for(let U=0;U<L;U++){const re=V[U],{nodeName:se,innerHTML:Q,rowSpan:de,colSpan:me}=re,_e=E[D].findIndex(Ee=>Ee===void 0);if(se==="TD"){if(de>1||me>1){for(let Ce=D;Ce<D+de;Ce++)if(Ce<S)for(let Re=_e;Re<_e+me;Re++)E[Ce][Re]=null;const Te=re.getAttribute("style");Te&&Te.includes("mso-ignore:colspan")||H.push({col:_e,row:D,rowspan:de,colspan:me})}let Ee="";a&&/excel/gi.test(a.content)?Ee=Q.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):Ee=Q.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),E[D][_e]=Ee.replace(tZ,Te=>P2[Te])}else x.push(Q)}}return H.length&&(n.mergeCells=H),x.length&&(n.rowHeaders=x),E.length&&(n.data=E),n}function Qi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(r=>`\\${r}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function rZ(t){return Qi(t,[","])}function ke(t,e,n){let i=-1;for(typeof e=="function"?(n=e,e=t):i=t-1;++i<=e&&n(i)!==!1;);}function F$(t,e,n){let i=t+1;for(typeof e=="function"&&(n=e,e=0);--i>=e&&n(i)!==!1;);}function I2(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function _t(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const w1="asc",sZ="desc",B$=new Map([[w1,[-1,1]],[sZ,[1,-1]]]),oZ=t=>`The priority '${t}' is already declared in a map.`,aZ=t=>`The priority '${t}' is not a number.`;function lZ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=on(t)?t:oZ,e=on(e)?e:aZ;function i(s,a){if(!Qi(s))throw new Error(e(s));if(n.has(s))throw new Error(t(s));n.set(s,a)}function r(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:w1;const[a,u]=B$.get(s)||B$.get(w1);return[...n].sort((h,d)=>h[0]<d[0]?a:u).map(h=>h[1])}return{addItem:i,getItems:r}}const uZ=t=>`The id '${t}' is already declared in a map.`;function TS(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=on(t)?t:uZ;function n(d,g){if(h(d))throw new Error(t(d));e.set(d,g)}function i(d){return e.delete(d)}function r(){e.clear()}function s(d){const[g]=u().find(p=>{let[w,y]=p;return d===y?w:!1})||[null];return g}function a(d){return e.get(d)}function u(){return[...e]}function h(d){return e.has(d)}return{addItem:n,clear:r,getId:s,getItem:a,getItems:u,hasItem:h,removeItem:i}}const cZ=t=>`'${t}' value is already declared in a unique set.`;function hZ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=on(t)?t:cZ;function n(s){if(e.has(s))throw new Error(t(s));e.add(s)}function i(){return[...e]}function r(){e.clear()}return{addItem:n,clear:r,getItems:i}}const JO=t=>`There is already registered "${t}" plugin.`,dZ=t=>`There is already registered plugin on priority "${t}".`,fZ=t=>`The priority "${t}" is not a number.`,N2=lZ({errorPriorityExists:dZ,errorPriorityNaN:fZ}),D2=hZ({errorItemExists:JO}),y1=TS({errorIdExists:JO});function L2(){return[...N2.getItems(),...D2.getItems()]}function eA(t){const e=eo(t);return y1.getItem(e)}function gZ(t){return!!eA(t)}function Ot(t,e,n){[t,e,n]=pZ(t,e,n),eA(t)===void 0&&mZ(t,e,n)}function mZ(t,e,n){const i=eo(t);if(y1.hasItem(i))throw new Error(JO(i));n===void 0?D2.addItem(i):N2.addItem(n,i),y1.addItem(i,e)}function pZ(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:vZ,getItem:wZ,hasItem:k2,getNames:ISe,getValues:NSe}=oo("renderers");function C1(t){if(typeof t=="function")return t;if(!k2(t))throw Error(`No registered renderer found under "${t}" name`);return wZ(t)}function hs(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),vZ(t,e)}const{register:yZ,getItem:CZ,hasItem:V2,getNames:DSe,getValues:LSe}=oo("validators");function SZ(t){if(typeof t=="function")return t;if(!V2(t))throw Error(`No registered validator found under "${t}" name`);return CZ(t)}function xd(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),yZ(t,e)}var W$={},U$;function bZ(){if(U$)return W$;U$=1;var t=en(),e=lf(),n=cf(),i=yp(),r=ES();return t({target:"Array",proto:!0},{at:function(a){var u=e(this),h=n(u),d=i(a),g=d>=0?d:h+d;return g<0||g>=h?void 0:u[g]}}),r("at"),W$}bZ();var j$={},z$;function RZ(){if(z$)return j$;z$=1;var t=en(),e=Yn(),n=mp(),i=yp(),r=lS(),s=Oi(),a=e("".charAt),u=s(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:u},{at:function(d){var g=r(n(this)),p=g.length,w=i(d),y=w>=0?w:p+w;return y<0||y>=p?void 0:a(g,y)}}),j$}RZ();function Ag(t,e,n){return(e=EZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EZ(t){var e=TZ(t,"string");return typeof e=="symbol"?e:e+""}function TZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _Z{constructor(){Ag(this,"count",0),Ag(this,"startColumn",null),Ag(this,"endColumn",null),Ag(this,"startPosition",null),Ag(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:s,columnWidth:a}=n,u=r>0?s+1:s;i>=r&&i+a<=r+u&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:s,zeroBasedScrollOffset:a,totalColumns:u,needReverse:h,startPositions:d,columnWidth:g}=e;if(this.endColumn===u-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const S=d[this.endColumn]+g-d[this.startColumn-1];if(S<=r&&(this.startColumn-=1),S>=r)break}this.startPosition=(n=d[this.startColumn])!==null&&n!==void 0?n:null;const p=a>0?r+1:r,w=i+r-p,y=this.startColumn===null?0:e.getColumnWidth(this.startColumn);w<-1*s||i>d.at(-1)||-1*i-r>-1*y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,u<this.endColumn&&(this.endColumn=u-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function xg(t,e,n){return(e=MZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MZ(t){var e=OZ(t,"string");return typeof e=="symbol"?e:e+""}function OZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AZ{constructor(){xg(this,"count",0),xg(this,"startRow",null),xg(this,"endRow",null),xg(this,"startPosition",null),xg(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:s,rowHeight:a}=n;i>=r&&i+a<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:s,totalRows:a,needReverse:u,startPositions:h,rowHeight:d}=e;if(this.endRow===a-1&&u)for(this.startRow=this.endRow;this.startRow>0;){const w=h[this.endRow]+d-h[this.startRow-1];if(w<=r-s&&(this.startRow-=1),w>=r-s)break}this.startPosition=(n=h[this.startRow])!==null&&n!==void 0?n:null;const g=i+r-s,p=this.startRow===null?0:e.getRowHeight(this.startRow);g<p||i>h.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Hg(t,e,n){return(e=xZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xZ(t){var e=HZ(t,"string");return typeof e=="symbol"?e:e+""}function HZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $2{constructor(){Hg(this,"count",0),Hg(this,"startColumn",null),Hg(this,"endColumn",null),Hg(this,"startPosition",null),Hg(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:s}=n;i<=r&&(this.startColumn=e);const a=r>0?s+1:s;i>=r&&i<=r+a&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:s,zeroBasedScrollOffset:a,totalColumns:u,needReverse:h,startPositions:d,columnWidth:g}=e;if(this.endColumn===u-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const y=d[this.endColumn]+g-d[this.startColumn-1];if(this.startColumn-=1,y>r)break}this.startPosition=(n=d[this.startColumn])!==null&&n!==void 0?n:null;const p=a>0?r+1:r;i+r-p<-1*s||i>d.at(-1)+g||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,u<this.endColumn&&(this.endColumn=u-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Pg(t,e,n){return(e=PZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PZ(t){var e=IZ(t,"string");return typeof e=="symbol"?e:e+""}function IZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F2{constructor(){Pg(this,"count",0),Pg(this,"startRow",null),Pg(this,"endRow",null),Pg(this,"startPosition",null),Pg(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:s}=n;i<=r&&(this.startRow=e),i>=r&&i<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:s,totalRows:a,needReverse:u,startPositions:h,rowHeight:d}=e;if(this.endRow===a-1&&u)for(this.startRow=this.endRow;this.startRow>0;){const p=h[this.endRow]+d-h[this.startRow-1];if(this.startRow-=1,p>=r-s)break}this.startPosition=(n=h[this.startRow])!==null&&n!==void 0?n:null,i+r-s<0||i>h.at(-1)+d?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ig(t,e,n){return(e=NZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NZ(t){var e=DZ(t,"string");return typeof e=="symbol"?e:e+""}function DZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LZ{constructor(){Ig(this,"count",0),Ig(this,"startColumn",0),Ig(this,"endColumn",0),Ig(this,"startPosition",0),Ig(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Ng(t,e,n){return(e=kZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kZ(t){var e=VZ(t,"string");return typeof e=="symbol"?e:e+""}function VZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $Z{constructor(){Ng(this,"count",0),Ng(this,"startRow",0),Ng(this,"endRow",0),Ng(this,"startPosition",0),Ng(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function Y$(t,e,n){return(e=FZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FZ(t){var e=BZ(t,"string");return typeof e=="symbol"?e:e+""}function BZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WZ extends $2{constructor(){super(...arguments),Y$(this,"columnStartOffset",0),Y$(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:s}=e;if(this.startColumn!==null&&typeof i=="function"){const a=this.startColumn,u=this.endColumn;i(this),this.columnStartOffset=a-this.startColumn,this.columnEndOffset=this.endColumn-u}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=s[this.startColumn])!==null&&n!==void 0?n:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function G$(t,e,n){return(e=UZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UZ(t){var e=jZ(t,"string");return typeof e=="symbol"?e:e+""}function jZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zZ extends F2{constructor(){super(...arguments),G$(this,"rowStartOffset",0),G$(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:s}=e;if(this.startRow!==null&&typeof i=="function"){const a=this.startRow,u=this.endRow;i(this),this.rowStartOffset=a-this.startRow,this.rowEndOffset=this.endRow-u}this.startRow<0&&(this.startRow=0),this.startPosition=(n=s[this.startRow])!==null&&n!==void 0?n:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function q$(t,e,n){return(e=YZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YZ(t){var e=GZ(t,"string");return typeof e=="symbol"?e:e+""}function GZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B2{constructor(e){q$(this,"calculationTypes",[]),q$(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[i,r]=n;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,n){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,i]=n;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Hs(t,e,n){return(e=qZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qZ(t){var e=KZ(t,"string");return typeof e=="symbol"?e:e+""}function KZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tf=50;class XZ extends B2{constructor(e){let{calculationTypes:n,viewportWidth:i,scrollOffset:r,totalColumns:s,columnWidthFn:a,overrideFn:u,inlineStartOffset:h}=e;super(n),Hs(this,"viewportWidth",0),Hs(this,"scrollOffset",0),Hs(this,"zeroBasedScrollOffset",0),Hs(this,"totalColumns",0),Hs(this,"columnWidthFn",null),Hs(this,"columnWidth",0),Hs(this,"overrideFn",null),Hs(this,"inlineStartOffset",0),Hs(this,"totalCalculatedWidth",0),Hs(this,"startPositions",[]),Hs(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=s,this.columnWidthFn=a,this.overrideFn=u,this.inlineStartOffset=h,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?tf:n}}function ss(t,e,n){return(e=ZZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZZ(t){var e=QZ(t,"string");return typeof e=="symbol"?e:e+""}function QZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JZ extends B2{constructor(e){let{calculationTypes:n,viewportHeight:i,scrollOffset:r,totalRows:s,defaultRowHeight:a,rowHeightFn:u,overrideFn:h,horizontalScrollbarHeight:d}=e;super(n),ss(this,"viewportHeight",0),ss(this,"scrollOffset",0),ss(this,"zeroBasedScrollOffset",0),ss(this,"totalRows",0),ss(this,"rowHeightFn",null),ss(this,"rowHeight",0),ss(this,"overrideFn",null),ss(this,"horizontalScrollbarHeight",0),ss(this,"innerViewportHeight",0),ss(this,"totalCalculatedHeight",0),ss(this,"startPositions",[]),ss(this,"needReverse",!0),this.defaultHeight=a,this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=s,this.rowHeightFn=u,this.overrideFn=h,this.horizontalScrollbarHeight=d??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function eQ(t,e,n){tQ(t,e),e.set(t,n)}function tQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function K$(t,e,n){return(e=nQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nQ(t){var e=iQ(t,"string");return typeof e=="symbol"?e:e+""}function iQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zh(t,e){return t.get(W2(t,e))}function X$(t,e,n){return t.set(W2(t,e),n),n}function W2(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ca=new WeakMap;class Gc{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;K$(this,"row",null),K$(this,"col",null),eQ(this,Ca,!1),X$(Ca,this,i),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:i,countRowHeaders:r,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-r||this.row>=n||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return zh(Ca,this)}isSouthEastOf(e){return this.row>=e.row&&(zh(Ca,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(zh(Ca,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(zh(Ca,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(zh(Ca,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Gc&&X$(Ca,this,e.isRtl()),this}clone(){return new Gc(this.row,this.col,zh(Ca,this))}toObject(){return{row:this.row,col:this.col}}}function rQ(t,e,n){sQ(t,e),e.set(t,n)}function sQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t_(t,e,n){return(e=oQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oQ(t){var e=aQ(t,"string");return typeof e=="symbol"?e:e+""}function aQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function os(t,e){return t.get(U2(t,e))}function lQ(t,e,n){return t.set(U2(t,e),n),n}function U2(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var or=new WeakMap;class Op{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;t_(this,"highlight",null),t_(this,"from",null),t_(this,"to",null),rQ(this,or,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=i.clone(),lQ(or,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:i}=e,r=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return r.row<=n&&s.row>=n&&r.col<=i&&s.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),s=this.getDirection(),a=e.getOuterTopStartCorner(),u=e.getOuterBottomEndCorner(),h=Math.min(i.row,a.row),d=Math.min(i.col,a.col),g=Math.max(r.row,u.row),p=Math.max(r.col,u.col),w=this._createCellCoords(h,d),y=this._createCellCoords(g,p);return this.from=w,this.to=y,this.setDirection(s),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return os(or,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return os(or,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return os(or,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return os(or,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return os(or,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return os(or,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return os(or,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return os(or,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Gc))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return n.top===i.top&&r.push("top"),n.right===i.right&&r.push(os(or,this)?"left":"right"),n.bottom===i.bottom&&r.push("bottom"),n.left===i.left&&r.push(os(or,this)?"right":"left"),r}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let s=e.col;s<=n.col;s++)!(this.from.row===r&&this.from.col===s)&&!(this.to.row===r&&this.to.col===s)&&i.push(this._createCellCoords(r,s));return i}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let s=e.col;s<=n.col;s++)e.row===r&&e.col===s?i.push(e):n.row===r&&n.col===s?i.push(n):i.push(this._createCellCoords(r,s));return i}forAll(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=n.row;r<=i.row;r++)for(let s=n.col;s<=i.col;s++)if(e(r,s)===!1)return}clone(){return new Op(this.highlight,this.from,this.to,os(or,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new Gc(e,n,os(or,this))}}function go(t,e,n){uQ(t,e),e.set(t,n)}function uQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $e(t,e){return t.get(j2(t,e))}function Pl(t,e,n){return t.set(j2(t,e),n),n}function j2(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var as=new WeakMap,n_=new WeakMap,pi=new WeakMap,Yh=new WeakMap,dw=new WeakMap,Ps=new WeakMap,i_=new WeakMap,Dg=new WeakMap,zu=new WeakMap,mo=new WeakMap;let z2=class{constructor(e,n,i,r,s,a){let u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;go(this,as,void 0),go(this,n_,void 0),go(this,pi,void 0),go(this,Yh,void 0),go(this,dw,void 0),go(this,Ps,void 0),go(this,i_,void 0),go(this,Dg,void 0),go(this,zu,[null,null]),go(this,mo,[null,null]),Pl(as,this,i),Pl(n_,this,n),Pl(pi,this,s),Pl(Yh,this,a),Pl(dw,this,u),Pl(Ps,this,r),Pl(i_,this,e),this.registerEvents()}registerEvents(){$e(Ps,this).addEventListener($e(pi,this).holder,"contextmenu",i=>this.onContextMenu(i)),$e(Ps,this).addEventListener($e(pi,this).TABLE,"mouseover",i=>this.onMouseOver(i)),$e(Ps,this).addEventListener($e(pi,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{$e(Ps,this).addEventListener($e(pi,this).holder,"touchstart",i=>this.onTouchStart(i)),$e(Ps,this).addEventListener($e(pi,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),$e(Ps,this).addEventListener($e(pi,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||$e(as,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,$e(as,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{$e(Ps,this).addEventListener($e(pi,this).holder,"mouseup",i=>this.onMouseUp(i)),$e(Ps,this).addEventListener($e(pi,this).holder,"mousedown",i=>this.onMouseDown(i))};Ga()?e():(S2()&&e(),n())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if($e(Dg,this)&&i){const[r,s]=[i.row,$e(Dg,this).from.row],[a,u]=[i.col,$e(Dg,this).from.col];return r===s&&a===u}return!1}parentCell(e){const n={},i=$e(pi,this).TABLE,r=aw(e,["TD","TH"],i);return r?(n.coords=$e(pi,this).getCoords(r),n.TD=r):ze(e,"wtBorder")&&ze(e,"current")?(n.coords=$e(Yh,this).getFocusSelection().cellRange.highlight,n.TD=$e(pi,this).getCell(n.coords)):ze(e,"wtBorder")&&ze(e,"area")&&$e(Yh,this).getAreaSelection().cellRange&&(n.coords=$e(Yh,this).getAreaSelection().cellRange.to,n.TD=$e(pi,this).getCell(n.coords)),n}onMouseDown(e){const n=$e(n_,this).rootDocument.activeElement,i=C2(W7,e.target),r=e.target;if(!["TD","TH"].includes(n.nodeName)&&(r===n||i(0)===n||i(1)===n))return;const s=this.parentCell(r);ze(r,"corner")?$e(as,this).getSetting("onCellCornerMouseDown",e,r):s.TD&&$e(as,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&($e(mo,this)[0]=s.TD,clearTimeout($e(zu,this)[0]),$e(zu,this)[0]=setTimeout(()=>{$e(mo,this)[0]=null},1e3))}onContextMenu(e){if($e(as,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!$e(as,this).has("onCellMouseOver"))return;const n=$e(pi,this).TABLE,i=aw(e.target,["TD","TH"],n),r=$e(dw,this)||this;i&&i!==r.lastMouseOver&&Wc(i,n)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,$e(pi,this).getCoords(i),i))}onMouseOut(e){if(!$e(as,this).has("onCellMouseOut"))return;const n=$e(pi,this).TABLE,i=aw(e.target,["TD","TH"],n),r=aw(e.relatedTarget,["TD","TH"],n),s=$e(dw,this)||this;i&&i!==r&&Wc(i,n)&&(this.callListener("onCellMouseOut",e,$e(pi,this).getCoords(i),i),r===null&&(s.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&$e(as,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===$e(mo,this)[0]&&n.TD===$e(mo,this)[1]?(ze(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),$e(mo,this)[0]=null,$e(mo,this)[1]=null):n.TD===$e(mo,this)[0]&&($e(mo,this)[1]=n.TD,clearTimeout($e(zu,this)[1]),$e(zu,this)[1]=setTimeout(()=>{$e(mo,this)[1]=null},500)))}onTouchStart(e){Pl(Dg,this,$e(Yh,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const i=e.target,r=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,s=Pe(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&s&&$e(as,this).getSetting("isDataViewInstance")){const u=["A","BUTTON","INPUT"];E2()&&(hX()||dX())&&this.selectedCellWasTouched(i)&&!u.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,i,r){const s=$e(as,this).getSettingPure(e);s&&s(n,i,r,$e(i_,this).call(this))}destroy(){clearTimeout($e(zu,this)[0]),clearTimeout($e(zu,this)[1]),$e(Ps,this).destroy()}};function r_(t,e,n){return(e=cQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cQ(t){var e=hQ(t,"string");return typeof e=="symbol"?e:e+""}function hQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dQ{constructor(e,n,i){r_(this,"offset",void 0),r_(this,"total",void 0),r_(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function s_(t,e,n){return(e=fQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fQ(t){var e=gQ(t,"string");return typeof e=="symbol"?e:e+""}function gQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mQ{constructor(e,n,i){s_(this,"offset",void 0),s_(this,"total",void 0),s_(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function fw(t,e,n){return(e=pQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pQ(t){var e=vQ(t,"string");return typeof e=="symbol"?e:e+""}function vQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wQ{constructor(){fw(this,"currentSize",0),fw(this,"nextSize",0),fw(this,"currentOffset",0),fw(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const yQ=0,Z$=1,S1=2;function o_(t,e,n){return(e=CQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CQ(t){var e=SQ(t,"string");return typeof e=="symbol"?e:e+""}function SQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bQ{constructor(){o_(this,"size",new wQ),o_(this,"workingSpace",yQ),o_(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Z$,e.workingSpace=S1,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=S1,e.workingSpace=Z$,this.sharedSize=e.getViewSize()}}var Q$={},a_,J$;function RQ(){if(J$)return a_;J$=1;var t=oS(),e=TypeError;return a_=function(n,i){if(!delete n[i])throw new e("Cannot delete property "+t(i)+" of "+t(n))},a_}var eF;function EQ(){if(eF)return Q$;eF=1;var t=en(),e=lf(),n=cf(),i=YU(),r=RQ(),s=GU(),a=[].unshift(0)!==1,u=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(d){return d instanceof TypeError}},h=a||!u();return t({target:"Array",proto:!0,arity:1,forced:h},{unshift:function(g){var p=e(this),w=n(p),y=arguments.length;if(y){s(w+y);for(var S=w;S--;){var _=S+y;S in p?p[_]=p[S]:r(p,_)}for(var E=0;E<y;E++)p[E]=arguments[E]}return i(p,w+y)}}),Q$}EQ();function TQ(t,e,n){return(e=_Q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Q(t){var e=MQ(t,"string");return typeof e=="symbol"?e:e+""}function MQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tF{constructor(e,n){TQ(this,"order",[]),this.order=[...Array(n).keys()].map(i=>e+i)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function OQ(t,e,n){return(e=AQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AQ(t){var e=xQ(t,"string");return typeof e=="symbol"?e:e+""}function xQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HQ{constructor(e){OQ(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:i}=e.getViewSize();let r=Math.max(i,n);if(r===0)return[];const{currentOffset:s,nextOffset:a}=e.getViewSize(),u=new tF(s,n),h=new tF(a,i),d=[];for(let g=0;g<r;g++){const p=u.get(g),w=h.get(g);if(w===-1)d.push(["remove",p]);else if(p===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(S1)?d.push(["append",w]):d.push(["prepend",w]);else if(w>p)u.has(w)&&(u.remove(w),i<=u.length&&(r-=1)),d.push(["replace",w,p]);else if(w<p){const y=u.prepend(w);d.push(["insert_before",w,p,y])}else d.push(["none",w])}return d}}function Gh(t,e,n){return(e=PQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PQ(t){var e=IQ(t,"string");return typeof e=="symbol"?e:e+""}function IQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y2{constructor(e,n){Gh(this,"rootNode",void 0),Gh(this,"nodesPool",void 0),Gh(this,"sizeSet",new bQ),Gh(this,"collectedNodes",[]),Gh(this,"viewDiffer",new HQ(this.sizeSet)),Gh(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[i,r,s,a]=e,u=this.nodesPool(r);switch(this.collectedNodes.push(u),i){case"prepend":n.insertBefore(u,n.firstChild);break;case"append":n.appendChild(u);break;case"insert_before":n.insertBefore(u,this.nodesPool(s)),n.removeChild(this.nodesPool(a));break;case"replace":n.replaceChild(u,this.nodesPool(s));break;case"remove":n.removeChild(u);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class G2 extends Y2{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function nF(t,e,n){return(e=NQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NQ(t){var e=DQ(t,"string");return typeof e=="symbol"?e:e+""}function DQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LQ{constructor(e){nF(this,"nodeType",void 0),nF(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const r=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(r))return this.pool.get(r);const s=this.rootDocument.createElement(this.nodeType);return this.pool.set(r,s),s}}function Lg(t,e,n){return(e=kQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kQ(t){var e=VQ(t,"string");return typeof e=="symbol"?e:e+""}function VQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ap{constructor(e,n){Lg(this,"nodesPool",null),Lg(this,"nodeType",void 0),Lg(this,"rootNode",void 0),Lg(this,"table",null),Lg(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new LQ(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function iF(t,e,n){return(e=$Q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Q(t){var e=FQ(t,"string");return typeof e=="symbol"?e:e+""}function FQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BQ extends Ap{constructor(){super("TH"),iF(this,"orderViews",new WeakMap),iF(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new G2(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:i,rows:r,cells:s}=this.table;for(let a=0;a<e;a++){const u=this.table.renderedRowToSource(a),h=r.getRenderedNode(a);this.sourceRowIndex=u;const d=this.obtainOrderView(h),g=s.obtainOrderView(h);d.appendView(g).setSize(i).setOffset(0).start();for(let p=0;p<i;p++){d.render();const w=d.getCurrentNode();w.className="",w.removeAttribute("style"),vf(w,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ge(w,[S7(),x7(),WO(p+1),pf(-1)]),n[p](u,w,p)}d.end()}}}class WQ extends Ap{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,s=r+n;for(let u=0,h=e;u<h;u++){for(i=this.rootNode.childNodes[u],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<s;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)i.removeChild(i.lastChild),this.renderedNodes-=1}const a=this.rootNode.childNodes.length;if(a>e)for(let u=e;u<a;u++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&Go(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ge(this.rootNode,[i2()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:s}=this.table,a=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ge(a,[f1(),a2(n+1)]);for(let u=-1*s;u<r;u+=1){const h=this.table.renderedColumnToSource(u),d=a.childNodes[u+s];d.className="",d.removeAttribute("style"),vf(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ge(d,[WO(u+1+this.table.rowHeadersCount),pf(-1),b7(),...u>=0?[A7()]:[f1()]]),i[n](h,d,n)}}}}let rF=!1;class UQ extends Ap{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,i=e+n;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!rF&&e>1e3&&(rF=!0,Nt($t`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){const s=this.table.renderedColumnToSource(r),a=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[r].style.width=`${a}px`}for(let r=0;r<e;r++){const s=this.table.renderedColumnToSource(r),a=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[r+n].style.width=`${a}px`}const i=this.rootNode.firstChild;i&&fe(i,"rowHeader")}}function jQ(t,e,n){return(e=zQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zQ(t){var e=YQ(t,"string");return typeof e=="symbol"?e:e+""}function YQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qh={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let sF=!1;class GQ extends Ap{constructor(e){super("TR",e),jQ(this,"orderView",void 0),this.orderView=new Y2(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!sF&&e>1e3&&(sF=!0,Nt($t`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ge(this.rootNode,[i2()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const s=this.orderView.getCurrentNode(),a=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var n,i;Ge(s,[f1(),a2(a+((n=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(a+1)%2===0?ze(s,qh.rowEven)||(je(s,qh.rowOdd),fe(s,qh.rowEven)):ze(s,qh.rowOdd)||(je(s,qh.rowEven),fe(s,qh.rowOdd))}this.orderView.end()}}function oF(t,e,n){return(e=qQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qQ(t){var e=KQ(t,"string");return typeof e=="symbol"?e:e+""}function KQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XQ extends Ap{constructor(){super("TD"),oF(this,"orderViews",new WeakMap),oF(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new G2(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:i,rowHeaders:r}=this.table;for(let u=0;u<e;u++){const h=this.table.renderedRowToSource(u),d=i.getRenderedNode(u);this.sourceRowIndex=h;const g=this.obtainOrderView(d),p=r.obtainOrderView(d);g.prependView(p).setSize(n).setOffset(0).start();for(let w=0;w<n;w++){g.render();const y=this.table.renderedColumnToSource(w),S=g.getCurrentNode();if(ze(S,"hide")||(S.className=""),S.removeAttribute("style"),S.removeAttribute("dir"),vf(S,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(h,y,S),this.table.isAriaEnabled()){var s,a;Ge(S,[...S.hasAttribute("role")?[]:[C7()],pf(-1),WO(y+((s=(a=this.table.rowUtils)===null||a===void 0||(a=a.dataAccessObject)===null||a===void 0?void 0:a.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}g.end()}}}function Qn(t,e,n){return(e=ZQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZQ(t){var e=QQ(t,"string");return typeof e=="symbol"?e:e+""}function QQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JQ{constructor(e){let{cellRenderer:n,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Qn(this,"rootNode",void 0),Qn(this,"rootDocument",void 0),Qn(this,"rowHeaders",null),Qn(this,"columnHeaders",null),Qn(this,"colGroup",null),Qn(this,"rows",null),Qn(this,"cells",null),Qn(this,"rowFilter",null),Qn(this,"columnFilter",null),Qn(this,"rowUtils",null),Qn(this,"columnUtils",null),Qn(this,"rowsToRender",0),Qn(this,"columnsToRender",0),Qn(this,"rowHeaderFunctions",[]),Qn(this,"rowHeadersCount",0),Qn(this,"columnHeaderFunctions",[]),Qn(this,"columnHeadersCount",0),Qn(this,"cellRenderer",void 0),Qn(this,"activeOverlayName",void 0),Qn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:i,rows:r,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),i.setTable(this),r.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=i,this.rows=r,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let i=0;i<e;i++){const r=n.getRenderedNode(i),s=this.rowUtils;if(r.firstChild){const a=this.renderedRowToSource(i),u=s.getHeightByOverlayName(a,this.activeOverlayName),d=this.stylesHandler.areCellsBorderBox()?0:1;u?r.firstChild.style.height=`${u-d}px`:r.firstChild.style.height=""}}}}class eJ{constructor(){let{TABLE:e,THEAD:n,COLGROUP:i,TBODY:r,rowUtils:s,columnUtils:a,cellRenderer:u,stylesHandler:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new JQ(e,{cellRenderer:u,stylesHandler:h}),this.renderer.setRenderers({rowHeaders:new BQ,columnHeaders:new WQ(n),colGroup:new UQ(i),rows:new GQ(r),cells:new XQ}),this.renderer.setAxisUtils(s,a)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function l_(t,e,n){return(e=tJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tJ(t){var e=nJ(t,"string");return typeof e=="symbol"?e:e+""}function nJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iJ{constructor(e,n){l_(this,"dataAccessObject",void 0),l_(this,"wtSettings",void 0),l_(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let s=0;s<i;s++){let a=Array.isArray(n)?n[s]:n;a=a??r,this.headerWidths.set(s,a)}}}}function aF(t,e,n){return(e=rJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rJ(t){var e=sJ(t,"string");return typeof e=="symbol"?e:e+""}function sJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oJ{constructor(e,n){aF(this,"dataAccessObject",void 0),aF(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}getHeightByOverlayName(e,n){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}}function po(t,e,n){return(e=aJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aJ(t){var e=lJ(t,"string");return typeof e=="symbol"?e:e+""}function lJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yf{constructor(e,n,i,r,s){po(this,"wtSettings",null),po(this,"domBindings",void 0),po(this,"TBODY",null),po(this,"THEAD",null),po(this,"COLGROUP",null),po(this,"hasTableHeight",!0),po(this,"hasTableWidth",!0),po(this,"isTableVisible",!1),po(this,"tableOffset",0),po(this,"holderOffset",0),this.domBindings=i,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,h2(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(a)),this.rowUtils=new oJ(this.dataAccessObject,this.wtSettings),this.columnUtils=new iJ(this.dataAccessObject,this.wtSettings),this.tableRenderer=new eJ({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ze(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ge(i,[jo()]),i}createHider(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ze(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ge(i,[jo()]),i}createHolder(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ze(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ge(i.parentNode,[jo()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ge(i,[jo()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,s=n.getSetting("totalRows"),a=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),h=u.length,d=n.getSetting("columnHeaders"),g=d.length;let p=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=Ci(this.holder),p=r.createCalculators(p),h&&!n.getSetting("fixedColumnsStart"))){const y=i.inlineStartOverlay.getScrollPosition(),S=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,S!==this.correctHeaderWidth&&(p=!1)}if(p)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=Ci(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const y=s>0?this.getFirstRenderedRow():0,S=a>0?this.getFirstRenderedColumn():0;this.rowFilter=new mQ(y,s,g),this.columnFilter=new dQ(S,a,h);let _=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const E={};this.wtSettings.getSetting("beforeDraw",!0,E),_=E.skipRender!==!0}_&&(this.tableRenderer.setHeaderContentRenderers(u,d),(this.is(Bo)||this.is(cu))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Bo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Bo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let w=!1;return this.isMaster&&(w=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(w=i.bottomOverlay.resetFixedPosition()||w),w=i.inlineStartOverlay.resetFixedPosition()||w,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),w?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(p),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let s,a,u;const h=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,s=this.getColumnHeaderHeight(i),a=this.getColumnHeader(n,i),a&&(u=Pm(a),(!s&&r<u||s<u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),Array.isArray(h)?h[i]!==null&&h[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h[i]):isNaN(h)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(h[i]||h)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h[i]||h))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let s=0,a=r.length;s<a;s++)if(i[s]){if(!n[s]||n[s].childNodes.length===0)return;n[s].childNodes[0].style.height=`${i[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Bo))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const s=this.rowFilter.renderedToSource(r);n.oversizedRows&&n.oversizedRows[s]&&(n.oversizedRows[s]=void 0)}}}getCell(e){let n=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",n,i,!this.isMaster,"render");if(r&&Array.isArray(r)&&([n,i]=r),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");const a=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!a&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}getRow(e){let n=null,i=null;if(e<0){var r;n=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var s;n=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const s=r.childNodes[i];s&&n.push(s)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(n>=i)return;const r=this.rowFilter.sourceToRendered(e),s=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,u=(r<0?this.THEAD:this.TBODY).childNodes[s];return u==null?void 0:u.childNodes[n]}getRowHeaders(e){const n=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=s==null?void 0:s.childNodes[r];a&&n.push(a)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=jc(n,["TD","TH"])),n===null)return null;const i=n.parentNode,r=i.parentNode;let s=Y7(i),a=n.cellIndex;Uu(Xc,n,this.wtRootElement)||Uu(qc,n,this.wtRootElement)?r.nodeName==="THEAD"&&(s-=r.childNodes.length):Uu(cu,n,this.wtRootElement)||Uu(Bo,n,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-r.childNodes.length+s:r===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),Uu(Xc,n,this.wtRootElement)||Uu(Kc,n,this.wtRootElement)||Uu(cu,n,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a);const u=this.wtSettings.getSetting("onModifyGetCoordsElement",s,a);return u&&Array.isArray(u)&&([s,a]=u),this.wot.createCellCoords(s,a)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),i=Pm(this.TBODY)-1,r=this.wot.stylesHandler.areCellsBorderBox(),s=r?$n:Pm,a=r?0:1,u=r?1:0;let h,d,g,p,w;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,g=this.rowFilter.renderedToSource(e),h=this.getRowHeight(g),p=this.getTrForRow(g),w=p.querySelector("th");const y=g===0?u:0;w?d=s(w):d=s(p)-a,(!h&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<d-y||h<d)&&(r||(d+=1),this.dataAccessObject.wtViewport.oversizedRows[g]=d)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return jn(this.TABLE)}getHeight(){return $n(this.TABLE)}getTotalWidth(){const e=jn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=$n(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Jd(this.TABLE)}_modifyRowHeaderWidth(e){let n=on(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const uJ="stickyRowsBottom",tA={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ol(tA,"MIXIN_NAME",uJ,{writable:!1,enumerable:!1});const cJ="stickyColumnsStart",_S={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ol(_S,"MIXIN_NAME",cJ,{writable:!1,enumerable:!1});class nA extends yf{constructor(e,n,i,r){super(e,n,i,r,cu)}}Yt(nA,tA);Yt(nA,_S);const qc="top",Bo="bottom",Kc="inline_start",Xc="top_inline_start_corner",cu="bottom_inline_start_corner",q2=[qc,Bo,Kc,Xc,cu],hJ=new Map([[qc,`ht_clone_${qc}`],[Bo,`ht_clone_${Bo}`],[Kc,`ht_clone_${Kc} ht_clone_left`],[Xc,`ht_clone_${Xc} ht_clone_top_left_corner`],[cu,`ht_clone_${cu} ht_clone_bottom_left_corner`]]);function dJ(t,e){fJ(t,e),e.add(t)}function fJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gJ(t,e,n){return(e=mJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mJ(t){var e=pJ(t,"string");return typeof e=="symbol"?e:e+""}function pJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kg=new WeakSet;class vJ{constructor(e){dJ(this,kg),gJ(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,i){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,n),s=this.scrollViewportVertically(e.row,i);return r||s}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i)return!1;const s=Wr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>r)return!1;n=s.value;const{fixedColumnsStart:a,inlineStartOverlay:u}=this.dataAccessObject,h=n==="auto";if(h&&e<a)return!1;const d=this.getFirstVisibleColumn(),g=this.getLastVisibleColumn();let p=!1;return(h&&(e<d||e>g)||!h)&&(p=u.scrollTo(e,h?e>=this.getLastPartiallyVisibleColumn():n==="end")),p}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:r}=this.dataAccessObject;if(!i)return!1;const s=Wr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>r)return!1;n=s.value;const{fixedRowsBottom:a,fixedRowsTop:u,topOverlay:h}=this.dataAccessObject,d=n==="auto";if(d&&(e<u||e>r-a-1))return!1;const g=this.getFirstVisibleRow(),p=this.getLastVisibleRow();let w=!1;return(d&&(e<g||e>p)||!d)&&(w=h.scrollTo(e,d?e>=this.getLastPartiallyVisibleRow():n==="bottom")),w}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return gw(kg,this,uF).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return gw(kg,this,uF).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return gw(kg,this,lF).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return gw(kg,this,lF).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function lF(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:s,rootWindow:a}=this.dataAccessObject;if(n.mainTableScrollableElement===a){const u=e.getSetting("rtlMode");let h=null;if(u){const g=i.TABLE.getBoundingClientRect(),w=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(g.right-w)}else h=Ci(i.wtRootElement).left;const d=Math.abs(f2(a,a));if(h>d){const g=g2(a);let p=r.getRowHeaderWidth();for(let w=1;w<=s;w++)if(p+=n.sumCellSizes(w-1,w),h+p-d>=g){t=w-2;break}}}return t}function uF(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const a=Ci(n.wtRootElement),u=zO(s,s);if(a.top>u){const h=Pm(s);let d=i.getColumnHeaderHeight();for(let g=1;g<=r;g++)if(d+=e.sumCellSizes(g-1,g),a.top+d-u>=h){t=g-2;break}}}return t}function ls(t,e,n){return(e=wJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wJ(t){var e=yJ(t,"string");return typeof e=="symbol"?e:e+""}function yJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iA{get eventManager(){return new to(this)}constructor(e,n){ls(this,"wtTable",void 0),ls(this,"wtScroll",void 0),ls(this,"wtViewport",void 0),ls(this,"wtOverlays",void 0),ls(this,"selectionManager",void 0),ls(this,"wtEvent",void 0),ls(this,"guid",`wt_${e2()}`),ls(this,"drawInterrupted",!1),ls(this,"drawn",!1),ls(this,"activeOverlayName","master"),ls(this,"domBindings",void 0),ls(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new vJ(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,i){zc(i,e[n])}])}}createCellCoords(e,n){return new Gc(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,i){return new Op(e,n,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=i-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,i){return this.wtScroll.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function cF(t,e,n){return(e=CJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CJ(t){var e=SJ(t,"string");return typeof e=="symbol"?e:e+""}function SJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bJ extends iA{constructor(e,n,i){super(e,n),cF(this,"cloneSource",void 0),cF(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.stylesHandler=i.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new z2(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function RJ(t,e,n){return(e=EJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EJ(t){var e=TJ(t,"string");return typeof e=="symbol"?e:e+""}function TJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xp{constructor(e,n,i,r,s){RJ(this,"wtSettings",null),ol(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=n,this.wtSettings=r;const{TABLE:a,hider:u,spreader:h,holder:d,wtRootElement:g}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=u,this.spreader=h,this.holder=d,this.wtRootElement=g,this.trimmingContainer=ef(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=ef(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=gC(e.TABLE)}getRelativeCellPosition(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){Nt(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,s=i<this.wtSettings.getSetting("fixedColumnsStart"),a=n<this.wtSettings.getSetting("fixedRowsTop"),u=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),h=this.clone.wtTable.spreader,d={start:this.getRelativeStartPosition(h),top:h.offsetTop},g={start:this.getRelativeStartPosition(e),top:e.offsetTop};let p=null;return r?p=this.getRelativeCellPositionWithinWindow(a,s,g,d):p=this.getRelativeCellPositionWithinHolder(a,u,s,g,d),p}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,i,r){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let a=0,u=0;if(!n)a=r.start;else{let h=s.left;this.isRtl()&&(h=this.domBindings.rootWindow.innerWidth-(s.left+s.width+Mi())),a=h<=0?-1*h:0}return e?u=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:u=r.top,{start:i.start+a,top:i.top+u}}getRelativeCellPositionWithinHolder(e,n,i,r,s){const a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let u=0,h=0;if(i||(u=a.horizontal-s.start),n){const d=this.wot.wtTable.wtRootElement.getBoundingClientRect();h=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+d.top}else e||(h=a.vertical-s.top);return{start:r.start-u,top:r.top-h}}makeClone(){if(q2.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=i.createElement("div"),a=i.createElement("table"),u=e.wtRootElement.parentNode;s.className=`${hJ.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,n.getSetting("ariaTags")&&Ge(s,[jo()]),a.className=e.TABLE.className,e.TABLE.getAttribute("role")&&a.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(a),u.appendChild(s);const d=this.wtSettings.getSetting("preventOverflow");return d===!0||d==="horizontal"&&this.type===qc||d==="vertical"&&this.type===Kc?this.mainTableScrollableElement=r:r.getComputedStyle(u).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=gC(e.TABLE),new bJ(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,r=n.style,s=e.parentNode.style;[i,r,s].forEach(a=>{a.width="",a.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class _J extends xp{constructor(e,n,i,r,s,a){super(e,n,cu,i,r),this.bottomOverlay=s,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new nA(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${s}px`,n.style.bottom=`${a}px`}else bS(n),this.repositionOverlay();let i=$n(this.clone.wtTable.TABLE);const r=jn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),n.style.height=`${i}px`,n.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=Mi(i)),r.style.bottom=`${s}px`}}const MJ="calculatedColumns",MS={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ol(MS,"MIXIN_NAME",MJ,{writable:!1,enumerable:!1});class rA extends yf{constructor(e,n,i,r){super(e,n,i,r,Bo)}}Yt(rA,tA);Yt(rA,MS);function OJ(t,e,n){return(e=AJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AJ(t){var e=xJ(t,"string");return typeof e=="symbol"?e:e+""}function xJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HJ extends xp{constructor(e,n,i,r){super(e,n,Bo,i,r),OJ(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new rA(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),n.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=Mi(i)),r.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;return this.mainTableScrollableElement===n?(n.scrollTo(jO(n),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:i,stylesHandler:r}=this.wot,s=r.getDefaultRowHeight();let a=e,u=0;for(;a<n;){const h=i.getRowHeight(a);u+=h===void 0?s:h,a+=1}return u}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||u==="horizontal"){let d=n.getWorkspaceWidth();n.hasVerticalScroll()&&(d-=Mi(i)),d=Math.min(d,e.wtRootElement.scrollWidth),a.width=`${d}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let h=$n(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),a.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let i=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let a=0;n&&s.offsetHeight!==s.clientHeight&&(a=Mi(this.domBindings.rootDocument)),n?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=a,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return zO(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),a=r-s,u=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-u+r,0),i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==n,r=this.wtSettings.getSetting("columnHeaders");let s=!1;if((i||n===0)&&r.length>0){const a=this.wot.wtTable.holder.parentNode,u=ze(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(fe(a,"innerBorderBottom"),s=!u):(je(a,"innerBorderBottom"),s=u)}return s}}const PJ="calculatedRows",sA={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ol(sA,"MIXIN_NAME",PJ,{writable:!1,enumerable:!1});class oA extends yf{constructor(e,n,i,r){super(e,n,i,r,Kc)}}Yt(oA,sA);Yt(oA,_S);const IJ="localHooks",Ai={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,i,r,s,a){if(this._localHooks[t]){const u=this._localHooks[t].length;for(let h=0;h<u;h++)g1(this._localHooks[t][h],this,e,n,i,r,s,a)}},clearLocalHooks(){return this._localHooks={},this}};ol(Ai,"MIXIN_NAME",IJ,{writable:!1,enumerable:!1});let K2=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};Yt(K2,Ai);const X2="active-header",aA="header",lA="area",yC="focus",NJ="fill",DJ="row",LJ="column",kJ="custom-selection",uA=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),r=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:i,borderStyle:"solid",borderColor:r})};var hF={},dF;function VJ(){if(dF)return hF;dF=1;var t=ES();return t("flat"),hF}VJ();function $J(t,e){Z2(t,e),e.add(t)}function fF(t,e,n){Z2(t,e),e.set(t,n)}function Z2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function En(t,e){return t.get(Im(t,e))}function gF(t,e,n){return t.set(Im(t,e),n),n}function Im(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vs=new WeakMap,Di=new WeakMap,mw=new WeakSet;class FJ{constructor(){$J(this,mw),fF(this,Vs,void 0),fF(this,Di,void 0)}setActiveOverlay(e){return gF(Di,this,e),this}setActiveSelection(e){return gF(Vs,this,e),this}scan(){const e=En(Vs,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="area"?this.scanCellsRange(i=>n.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i)),this.scanCellsRange(i=>n.add(i))):e==="fill"?this.scanCellsRange(i=>n.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>n.add(i)),this.scanRowsInCellsRange(i=>n.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanColumnsInCellsRange(i=>n.add(i))),n}scanColumnsInHeadersRange(e){const[n,i,r,s]=En(Vs,this).getCorners(),{wtTable:a}=En(Di,this),u=a.getRenderedColumnsCount(),h=a.getColumnHeadersCount();let d=0;for(let g=-a.getRowHeadersCount();g<u;g++){const p=a.columnFilter.renderedToSource(g);if(!(p<i||p>s)){for(let w=-h;w<0;w++){if(w<n||w>r)continue;const y=w+h;let S=a.getColumnHeader(p,y);const _=En(Di,this).getSetting("onBeforeHighlightingColumnHeader",p,y,{selectionType:En(Vs,this).settings.selectionType,columnCursor:d,selectionWidth:s-i+1});_!==null&&(_!==p&&(S=a.getColumnHeader(_,y)),e(S))}d+=1}}}scanRowsInHeadersRange(e){const[n,i,r,s]=En(Vs,this).getCorners(),{wtTable:a}=En(Di,this),u=a.getRenderedRowsCount(),h=a.getRowHeadersCount();let d=0;for(let g=-a.getColumnHeadersCount();g<u;g++){const p=a.rowFilter.renderedToSource(g);if(!(p<n||p>r)){for(let w=-h;w<0;w++){if(w<i||w>s)continue;const y=w+h;let S=a.getRowHeader(p,y);const _=En(Di,this).getSetting("onBeforeHighlightingRowHeader",p,y,{selectionType:En(Vs,this).settings.selectionType,rowCursor:d,selectionHeight:r-n+1});_!==null&&(_!==p&&(S=a.getRowHeader(_,y)),e(S))}d+=1}}}scanCellsRange(e){const{wtTable:n}=En(Di,this);Im(mw,this,BJ).call(this,(i,r)=>{const s=n.getCell(En(Di,this).createCellCoords(i,r)),a=En(Di,this).getSetting("onAfterDrawSelection",i,r,En(Vs,this).settings.layerLevel);typeof a=="string"&&fe(s,a),e(s)})}scanRowsInCellsRange(e){const[n,,i]=En(Vs,this).getCorners(),{wtTable:r}=En(Di,this);Im(mw,this,mF).call(this,(s,a)=>{if(s>=n&&s<=i){const u=r.getCell(En(Di,this).createCellCoords(s,a));e(u)}})}scanColumnsInCellsRange(e){const[,n,,i]=En(Vs,this).getCorners(),{wtTable:r}=En(Di,this);Im(mw,this,mF).call(this,(s,a)=>{if(a>=n&&a<=i){const u=r.getCell(En(Di,this).createCellCoords(s,a));e(u)}})}}function BJ(t){let[e,n,i,r]=En(Vs,this).getCorners();if(e<0&&i<0||n<0&&r<0)return;const{wtTable:s}=En(Di,this),a=e!==i||n!==r;if(n=Math.max(n,0),r=Math.max(r,0),e=Math.max(e,0),i=Math.max(i,0),a){if(n=Math.max(n,s.getFirstRenderedColumn()),r=Math.min(r,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),i=Math.min(i,s.getLastRenderedRow()),r<n||i<e)return}else if(!(s.getCell(En(Di,this).createCellCoords(e,n))instanceof HTMLElement))return;for(let u=e;u<=i;u+=1)for(let h=n;h<=r;h+=1)t(u,h)}function mF(t){const{wtTable:e}=En(Di,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let r=0;r<n;r+=1){const s=e.rowFilter.renderedToSource(r);for(let a=0;a<i;a+=1)t(s,e.columnFilter.renderedToSource(a))}}class pF{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=uA(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,i=this.main.childNodes.length;n<i;n++){const r=this.main.childNodes[n];this.eventManager.addEventListener(r,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),so(e);const i=this,r=this.wot.rootDocument.body,s=n.getBoundingClientRect();n.style.display="none";function a(h){if(h.clientY<Math.floor(s.top)||h.clientY>Math.ceil(s.top+s.height)||h.clientX<Math.floor(s.left)||h.clientX>Math.ceil(s.left+s.width))return!0}function u(h){a(h)&&(i.eventManager.removeEventListener(r,"mousemove",u),n.style.display="block")}this.eventManager.addEventListener(r,"mousemove",u)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let u=0;u<5;u++){const h=i[u],d=n.createElement("div");d.className=`wtBorder ${this.settings.className||""}`,this.settings[h]&&this.settings[h].hide&&(d.className+=" hidden"),r=d.style,r.backgroundColor=this.settings[h]&&this.settings[h].color?this.settings[h].color:e.border.color,r.height=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,r.width=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,this.main.appendChild(d)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ga()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let a=s.bordersHolder;a||(a=n.createElement("div"),a.className="htBorders",s.bordersHolder=a,s.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const r={position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${parseInt(i/1.5,10)}px`};dt(r,(a,u)=>{this.selectionHandles.styles.bottomHitArea[u]=a,this.selectionHandles.styles.topHitArea[u]=a});const s={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};dt(s,(a,u)=>{this.selectionHandles.styles.bottom[u]=a,this.selectionHandles.styles.top[u]=a}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,i,r,s,a){const h=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:d,topHitArea:g,bottom:p,bottomHitArea:w}=this.selectionHandles.styles,y=parseInt(d.borderWidth,10),S=parseInt(d.width,10),_=parseInt(g.width,10),E=this.wot.wtTable.getWidth(),H=this.wot.wtTable.getHeight();d.top=`${parseInt(i-S-1,10)}px`,d[h]=`${parseInt(r-S-1,10)}px`,g.top=`${parseInt(i-_/4*3,10)}px`,g[h]=`${parseInt(r-_/4*3,10)}px`;const x=Math.min(parseInt(r+s,10),E-S-y*2),D=Math.min(parseInt(r+s-_/4,10),E-_-y*2);p[h]=`${x}px`,w[h]=`${D}px`;const $=Math.min(parseInt(i+a,10),H-S-y*2),V=Math.min(parseInt(i+a-_/4,10),H-_-y*2);p.top=`${$}px`,w.top=`${V}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(d.display="block",g.display="block",this.isPartRange(e,n)?(p.display="none",w.display="none"):(p.display="block",w.display="block")):(d.display="none",p.display="none",g.display="none",w.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(d.zIndex="9999",g.zIndex="9999"):(d.zIndex="",g.zIndex="")}appear(e){if(this.disabled)return;let[n,i,r,s]=e;if(n<0&&r<0||i<0&&s<0){this.disappear();return}const{wtTable:a,rootDocument:u,rootWindow:h}=this.wot,d=n!==r||i!==s,g=a.getFirstRenderedRow(),p=a.getLastRenderedRow(),w=a.getFirstRenderedColumn(),y=a.getLastRenderedColumn();let S;if(d){if(i=Math.max(i,w),s=Math.min(s,y),n=Math.max(n,g),r=Math.min(r,p),s<i||r<n){this.disappear();return}S=a.getCell(this.wot.createCellCoords(n,i))}else if(S=a.getCell(this.wot.createCellCoords(n,i)),!(S instanceof HTMLElement)){this.disappear();return}const _=d?a.getCell(this.wot.createCellCoords(r,s)):S,E=Ci(S),H=d?Ci(_):E,x=Ci(a.TABLE),D=E.top,$=E.left,V=this.wot.wtSettings.getSetting("rtlMode");let L=0,U=0;if(V){const Ce=jn(a.TABLE),Re=jn(S),qe=h.innerWidth-x.left-Ce;U=$+Re-H.left,L=h.innerWidth-$-Re-qe-1}else U=H.left+jn(_)-$,L=$-x.left-1;if(this.isEntireColumnSelected(n,r)){const Ce=n,Re=this.getDimensionsFromHeader("columns",i,s,Ce,x);let qe=null;Re&&([qe,L,U]=Re),qe&&(S=qe)}let re=D-x.top-1,se=H.top+$n(_)-D;if(this.isEntireRowSelected(i,s)){const Ce=i,Re=this.getDimensionsFromHeader("rows",n,r,Ce,x);let qe=null;Re&&([qe,re,se]=Re),qe&&(S=qe)}const Q=h.getComputedStyle(S);parseInt(Q.borderTopWidth,10)>0&&(re+=1,se=se>0?se-1:0),parseInt(Q[V?"borderRightWidth":"borderLeftWidth"],10)>0&&(L+=1,U=U>0?U-1:0);const de=V?"right":"left";this.topStyle.top=`${re}px`,this.topStyle[de]=`${L}px`,this.topStyle.width=`${U}px`,this.topStyle.display="block",this.startStyle.top=`${re}px`,this.startStyle[de]=`${L}px`,this.startStyle.height=`${se}px`,this.startStyle.display="block";const me=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${re+se-me}px`,this.bottomStyle[de]=`${L}px`,this.bottomStyle.width=`${U}px`,this.bottomStyle.display="block",this.endStyle.top=`${re}px`,this.endStyle[de]=`${L+U-me}px`,this.endStyle.height=`${se+1}px`,this.endStyle.display="block";let _e=this.settings.border.cornerVisible;_e=typeof _e=="function"?_e(this.settings.layerLevel):_e;const Ee=this.wot.getSetting("onModifyGetCellCoords",r,s,!1,"render");let[Te,ve]=[r,s];if(Ee&&Array.isArray(Ee)&&([,,Te,ve]=Ee),Ga()||!_e||this.isPartRange(Te,ve))this.cornerStyle.display="none";else{this.cornerStyle.top=`${re+se+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[de]=`${L+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ce=ef(a.TABLE);const Re=Ce===h;Re&&(Ce=u.documentElement);const qe=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,F=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),C=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const R=Re?_.getBoundingClientRect().left:_.offsetLeft;let T=!1,A=0;V?(A=R-parseInt(this.cornerDefaultStyle.width,10)/2,T=A<0):(A=R+jn(_)+parseInt(this.cornerDefaultStyle.width,10)/2,T=A>=g2(Ce)),T&&(this.cornerStyle[de]=`${Math.floor(L+U+this.cornerCenterPointOffset-F-qe)}px`,this.cornerStyle[V?"borderLeftWidth":"borderRightWidth"]=0)}if(r===this.wot.getSetting("totalRows")-1){const A=(Re?_.getBoundingClientRect().top:_.offsetTop)+$n(_)+parseInt(this.cornerDefaultStyle.height,10)/2>=Pm(Ce),k=this.wot.stylesHandler.isClassicTheme();if(A){const z=Math.floor(re+se+this.cornerCenterPointOffset-C-qe);k?(this.cornerStyle.top=`${z}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${z-1}px`}}this.cornerStyle.display="block"}Ga()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,s,re,L,U,se)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,i,r,s){const{wtTable:a}=this.wot,u=a.wtRootElement.parentNode;let h=null,d=null,g=null,p=null,w=null,y=null,S=null,_=null;switch(e){case"rows":h=function(){return a.getRowHeader(...arguments)},d=function(){return $n(...arguments)},g="ht__selection--rows",y="top";break;case"columns":h=function(){return a.getColumnHeader(...arguments)},d=function(){return jn(...arguments)},g="ht__selection--columns",y="left";break}if(u.classList.contains(g)){const E=this.wot.getSetting("columnHeaders").length;if(S=h(n,E-r),_=h(i,E-r),!S||!_)return!1;const H=Ci(S),x=Ci(_);return S&&_&&(p=H[y]-s[y]-1,w=x[y]+d(_)-H[y]),[S,p,w]}return!1}changeBorderStyle(e,n){const i=this[e].style,r=n[e];!r||r.hide?fe(this[e],"hidden"):(ze(this[e],"hidden")&&je(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width=`${n.width}px`,i.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?fe(this[e],"hidden"):je(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ga()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function WJ(t,e){Q2(t,e),e.add(t)}function Kh(t,e,n){Q2(t,e),e.set(t,n)}function Q2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ct(t,e){return t.get(cA(t,e))}function vF(t,e,n){return t.set(cA(t,e),n),n}function cA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Li=new WeakMap,gr=new WeakMap,u_=new WeakMap,Rm=new WeakMap,c_=new WeakMap,Yu=new WeakMap,wF=new WeakSet;class UJ{constructor(e){WJ(this,wF),Kh(this,Li,void 0),Kh(this,gr,void 0),Kh(this,u_,new FJ),Kh(this,Rm,new WeakMap),Kh(this,c_,new WeakSet),Kh(this,Yu,new Map),vF(gr,this,e)}setActiveOverlay(e){return vF(Li,this,e),ct(u_,this).setActiveOverlay(ct(Li,this)),ct(Rm,this).has(ct(Li,this))||ct(Rm,this).set(ct(Li,this),new Set),this}getFocusSelection(){return ct(gr,this)!==null?ct(gr,this).getFocus():null}getAreaSelection(){return ct(gr,this)!==null?ct(gr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(ct(Yu,this).has(e)){const i=ct(Yu,this).get(e);if(i.has(ct(Li,this)))return i.get(ct(Li,this));const r=new pF(ct(Li,this),e.settings);return i.set(ct(Li,this),r),r}const n=new pF(ct(Li,this),e.settings);return ct(Yu,this).set(e,new Map([[ct(Li,this),n]])),n}getBorderInstances(e){var n,i;return Array.from((n=(i=ct(Yu,this).get(e))===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[])}destroyBorders(e){ct(Yu,this).get(e).forEach(n=>n.destroy()),ct(Yu,this).delete(e)}render(e){if(ct(gr,this)===null)return;e&&cA(wF,this,jJ).call(this);const n=Array.from(ct(gr,this)),i=new Map,r=new Map;for(let s=0;s<n.length;s++){const a=n[s],{className:u,headerAttributes:h,createLayers:d,selectionType:g}=a.settings;ct(c_,this).has(a)||(ct(c_,this).add(a),a.addLocalHook("destroy",()=>this.destroyBorders(a)));const p=this.getBorderInstance(a);if(a.isEmpty()){p==null||p.disappear();continue}u&&ct(u_,this).setActiveSelection(a).scan().forEach(S=>{if(i.has(S)){const _=i.get(S);_.has(u)&&d===!0?_.set(u,_.get(u)+1):_.set(u,1)}else i.set(S,new Map([[u,1]]));h&&(r.has(S)||r.set(S,[]),S.nodeName==="TH"&&r.get(S).push(...h))});const w=a.getCorners();ct(Li,this).getSetting("onBeforeDrawBorders",w,g),p==null||p.appear(w)}i.forEach((s,a)=>{var u;const h=Array.from(s).map(d=>{let[g,p]=d;return p===1?g:[g,...Array.from({length:p-1},(w,y)=>`${g}-${y+1}`)]}).flat();h.forEach(d=>ct(Rm,this).get(ct(Li,this)).add(d)),fe(a,h),a.nodeName==="TD"&&Array.isArray((u=ct(gr,this).options)===null||u===void 0?void 0:u.cellAttributes)&&Ge(a,ct(gr,this).options.cellAttributes)}),Array.from(r.keys()).forEach(s=>{Ge(s,[...r.get(s)])})}}function jJ(){const t=ct(Rm,this).get(ct(Li,this)),e=ct(Li,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var i,r;const s=ct(Li,this).wtTable.TABLE.querySelectorAll(`.${n}`);let a=[];Array.isArray((i=ct(gr,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(a=ct(gr,this).options.cellAttributes.map(u=>u[0])),Array.isArray((r=ct(gr,this).options)===null||r===void 0?void 0:r.headerAttributes)&&(a=[...a,...ct(gr,this).options.headerAttributes.map(u=>u[0])]);for(let u=0,h=s.length;u<h;u++)je(s[u],n),vf(s[u],a)}),t.clear()}class zJ extends xp{constructor(e,n,i,r){super(e,n,Kc,i,r)}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new oA(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===n&&(!r||r!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),YO(i,`${s}px`,"0px")):(s=this.getScrollPosition(),bS(i));const a=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,d2(n)),i=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,s=0;for(;r<n;)s+=this.wot.wtTable.getColumnWidth(r)||i,r+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||u==="vertical"){let d=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(d-=Mi(i)),d=Math.min(d,e.wtRootElement.scrollHeight),a.height=`${d}px`}else a.height="";this.clone.wtTable.holder.style.height=a.height;const h=jn(this.clone.wtTable.TABLE);a.width=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=uA(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),s=i.getSetting("fixedColumnsStart"),u=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,h=s===0&&r.length>0&&!ze(u.parentNode,"innerBorderInlineStart")?1:0;let d=this.getTableParentOffset(),g=0;if(n){const p=this.wot.wtTable.getColumnWidth(e),w=this.wot.wtViewport.getViewportWidth();p>w&&(n=!1)}return n&&u.offsetWidth!==u.clientWidth&&(g=Mi(this.domBindings.rootDocument)),n?(d+=this.sumCellSizes(0,e+1),d-=this.wot.wtViewport.getViewportWidth(),d+=h):d+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),d+=g,K7(this.mainTableScrollableElement)===d-h&&h>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(h),this.setScrollPosition(d)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(f2(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),a=r-s;i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),a=n.getSetting("totalRows"),u=n.getSetting("preventOverflow")==="vertical";a?je(i,"emptyRows"):fe(i,"emptyRows");let h=!1;if(!u){if(s&&!r.length)fe(i,"innerBorderLeft innerBorderInlineStart");else if(!s&&r.length){const d=ze(i,"innerBorderInlineStart");e?(fe(i,"innerBorderLeft innerBorderInlineStart"),h=!d):(je(i,"innerBorderLeft innerBorderInlineStart"),h=d)}}return h}}const YJ="stickyRowsTop",hA={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ol(hA,"MIXIN_NAME",YJ,{writable:!1,enumerable:!1});class dA extends yf{constructor(e,n,i,r){super(e,n,i,r,Xc)}}Yt(dA,hA);Yt(dA,_S);function yF(t,e,n){return(e=GJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GJ(t){var e=qJ(t,"string");return typeof e=="symbol"?e:e+""}function qJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KJ extends xp{constructor(e,n,i,r,s,a){super(e,n,Xc,i,r),yF(this,"topOverlay",void 0),yF(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new dA(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();YO(e,`${r}px`,`${s}px`)}else bS(e);let n=$n(this.clone.wtTable.TABLE);const i=jn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}}class fA extends yf{constructor(e,n,i,r){super(e,n,i,r,qc)}}Yt(fA,hA);Yt(fA,MS);function XJ(t,e,n){return(e=ZJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZJ(t){var e=QJ(t,"string");return typeof e=="symbol"?e:e+""}function QJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JJ extends xp{constructor(e,n,i,r){super(e,n,qc,i,r),XJ(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new fA(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,s=!1;if(this.trimmingContainer===n&&(!i||i!=="vertical")){const{wtTable:u}=this.wot,h=u.hider.getBoundingClientRect(),d=Math.ceil(h.bottom),g=e.offsetHeight;s=d===g,r=this.getOverlayOffset(),YO(e,"0px",`${r}px`)}else r=this.getScrollPosition(),bS(e);const a=this.adjustHeaderBordersPosition(r,s);return this.adjustElementsSize(),a}setScrollPosition(e){const n=this.domBindings.rootWindow;let i=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(jO(n),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const i=this.wot.stylesHandler.getDefaultRowHeight();let r=e,s=0;for(;r<n;){const a=this.wot.wtTable.getRowHeight(r);s+=a===void 0?i:a,r+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||u==="horizontal"){let d=n.getWorkspaceWidth();n.hasVerticalScroll()&&(d-=Mi(i)),d=Math.min(d,e.wtRootElement.scrollWidth),a.width=`${d}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let h=$n(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),a.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=uA(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:i,wtSettings:r}=this,a=(i.cloneSource?i.cloneSource:i).wtTable.holder,u=r.getSetting("columnHeaders"),d=r.getSetting("fixedRowsTop")===0&&u.length>0&&!ze(a.parentNode,"innerBorderTop")?1:0;let g=this.getTableParentOffset(),p=0;if(n){const w=this.wot.wtTable.getRowHeight(e),y=this.wot.wtViewport.getViewportHeight();w>y&&(n=!1)}if(n&&a.offsetHeight!==a.clientHeight&&(p=Mi(this.domBindings.rootDocument)),n){const w=r.getSetting("fixedRowsBottom"),y=r.getSetting("totalRows");g+=this.sumCellSizes(0,e+1),g-=i.wtViewport.getViewportHeight()-this.sumCellSizes(y-w,y),g+=1,g+=d}else g+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return g+=p,q7(this.mainTableScrollableElement)===g-d&&d>0&&this.wot.wtOverlays.expandHiderVerticallyBy(d),this.setScrollPosition(g)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return zO(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),a=r-s;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,s=i.getSetting("totalColumns"),a=i.getSetting("preventOverflow")==="horizontal";s?je(r,"emptyColumns"):fe(r,"emptyColumns");let u=!1;if(!n&&!a){const h=i.getSetting("fixedRowsTop"),d=this.cachedFixedRowsTop!==h,g=i.getSetting("columnHeaders");if((d||h===0)&&g.length>0){const p=ze(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(fe(r,"innerBorderTop"),u=!p):(je(r,"innerBorderTop"),u=p)}}return u}}function pw(t,e,n){eee(t,e),e.set(t,n)}function eee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sa(t,e,n){return(e=tee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tee(t){var e=nee(t,"string");return typeof e=="symbol"?e:e+""}function nee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gu(t,e,n){return t.set(J2(t,e),n),n}function ba(t,e){return t.get(J2(t,e))}function J2(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xh=new WeakMap,vw=new WeakMap,Zh=new WeakMap,ww=new WeakMap;class iee{constructor(e,n,i,r,s,a){Sa(this,"wot",null),pw(this,Xh,[]),Sa(this,"topOverlay",null),Sa(this,"bottomOverlay",null),Sa(this,"inlineStartOverlay",null),Sa(this,"topInlineStartCornerOverlay",null),Sa(this,"bottomInlineStartCornerOverlay",null),Sa(this,"browserLineHeight",void 0),Sa(this,"wtSettings",null),pw(this,vw,!1),pw(this,Zh,0),pw(this,ww,null),Sa(this,"resizeObserver",new ResizeObserver(g=>{pC(()=>{!Array.isArray(g)||!g.length||(Gu(Zh,this,ba(Zh,this)+1),ba(Zh,this)===100&&(Nt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),ba(ww,this)!==null&&clearTimeout(ba(ww,this)),Gu(ww,this,setTimeout(()=>{Gu(Zh,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=n,this.wtTable=a;const{rootDocument:u,rootWindow:h}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=Mi(u);const d=h.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=d?a.holder:gC(a.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...ba(Xh,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,i=e.getComputedStyle(n.body),r=parseInt(i.lineHeight,10),s=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new JJ(...e),this.bottomOverlay=new HJ(...e),this.inlineStartOverlay=new zJ(...e),this.topInlineStartCornerOverlay=new KJ(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new _J(...e,this.bottomOverlay,this.inlineStartOverlay),Gu(Xh,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Gu(vw,this,ba(Xh,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),ba(Xh,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),ba(Xh,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",p=>this.onKeyDown(p)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",p=>this.onTableScroll(p),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",p=>this.onTableScroll(p),{passive:!0});const s=n.devicePixelRatio&&n.devicePixelRatio>1,a=this.scrollableElement===n,u=this.wtSettings.getSetting("preventWheel"),h={passive:a};(u||s||!b2())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",p=>this.onCloneWheel(p,u),h),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(p=>{this.eventManager.addEventListener(p.clone.wtTable.holder,"wheel",w=>this.onCloneWheel(w,u),h)});let g;this.eventManager.addEventListener(n,"resize",()=>{pC(()=>{clearTimeout(g),this.wtSettings.getSetting("onWindowResize"),g=setTimeout(()=>{Gu(Zh,this,0)},200)})}),a||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(r!==n&&s!==n&&!e.target.contains(r)||i!==n&&s!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,a=e.target,u=s!==i&&a!==i&&!a.contains(s),h=r!==i&&a!==i&&!a.contains(r);if(this.keyPressed&&(u||h)||this.scrollableElement===i)return;const d=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&d)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Mp(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);const r=this.scrollVertically(n),s=this.scrollHorizontally(i);return r||s}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[r,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==r||this.lastScrollX!==e.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=r;const a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=r)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){if(!ba(vw,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),Gu(vw,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=gC(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,i=e.clientHeight,r=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,s=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),u=e.getRowHeaderWidth(),d=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,a)+1,g=u+this.inlineStartOverlay.sumCellSizes(0,s),w=n.hider.style,y=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,d-n.holder.clientHeight),S=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,g-n.holder.clientWidth),_=y()?1:0,E=S()?1:0;w.width=`${g+E}px`,w.height=`${d+_}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return W(n,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];W(n,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function CF(t,e,n){return(e=ree(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ree(t){var e=see(t,"string");return typeof e=="symbol"?e:e+""}function see(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oee{constructor(e){CF(this,"settings",{}),CF(this,"defaults",Object.freeze(this.getDefaults())),dt(this.defaults,(n,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(n===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,i)=>{const r=this.getSetting("data",e,n);zc(i,r??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?dt(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=n,this}getSetting(e,n,i,r,s){return typeof this.settings[e]=="function"?this.settings[e](n,i,r,s):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class gA extends yf{constructor(e,n,i,r){super(e,n,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=ef(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=mC(e,"height",n),s=mC(e,"overflow",n),a=this.holder.style,{scrollWidth:u,scrollHeight:h}=e;let d=e.offsetWidth,g=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(s)){const w=e.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",e.nextElementSibling?i.insertBefore(w,e.nextElementSibling):i.appendChild(w);const y=parseInt(n.getComputedStyle(w).height,10);i.removeChild(w),y===0&&(g=0)}g=Math.min(g,h),a.height=r==="auto"?"auto":`${g}px`,d=Math.min(d,u),a.width=`${d}px`,a.overflow="",this.hasTableHeight=a.height==="auto"?!0:g>0,this.hasTableWidth=d>0}this.isTableVisible=Jd(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,i="master",s=e.getSetting("columnHeaders").length;if(s&&!n.hasOversizedColumnHeadersMarked[i]){const u=e.getSetting("rowHeaders").length,h=this.getRenderedColumnsCount();for(let d=0;d<s;d++)for(let g=-1*u;g<h;g++)this.markIfOversizedColumnHeader(g);n.hasOversizedColumnHeadersMarked[i]=!0}}}Yt(gA,sA);Yt(gA,MS);class aee{constructor(e,n,i,r,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=i,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new $Z:new zZ],["fullyVisible",()=>new AZ],["partiallyVisible",()=>new F2]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new LZ:new WZ],["fullyVisible",()=>new _Z],["partiallyVisible",()=>new $2]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return n===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=$n(n)>0&&n.clientHeight>0?n.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(i===n){const s=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>r&&(r=e.documentElement.clientWidth)}else r=i.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let i=0,r=e;for(;r<n;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getWorkspaceOffset(){return Ci(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=$n(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=n.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,s=n.length;r<s;r++)i?(this.rowHeaderWidth+=jn(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportHeight(),s,a;this.rowHeaderWidth=NaN;let u=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const h=n.getSetting("fixedRowsTop"),d=n.getSetting("fixedRowsBottom"),g=n.getSetting("totalRows");return h&&u>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,h),u+=a,r-=a),d&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(g-d,g),r-=a),i.holder.clientHeight===i.holder.offsetHeight?s=0:s=Mi(this.domBindings.rootDocument),new JZ({calculationTypes:e.map(p=>[p,this.rowsCalculatorTypes.get(p)()]),viewportHeight:r,scrollOffset:u,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:p=>i.getRowHeight(p),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const a=n.getSetting("fixedColumnsStart");if(a&&s>=0){const u=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);s+=u,r-=u}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=Mi(this.domBindings.rootDocument)),new XZ({calculationTypes:e.map(u=>[u,this.columnsCalculatorTypes.get(u)()]),viewportWidth:r,scrollOffset:s,totalColumns:n.getSetting("totalColumns"),columnWidthFn:u=>i.getColumnWidth(u),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!n.getSetting("renderAllColumns")){const s=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:r,endRow:s,rowStartOffset:a,rowEndOffset:u}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(a,d)),i=Math.min(h,i+Math.min(u,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(a/2)),i=Math.min(h,i+Math.ceil(u/2))),n<r||n===r&&n>0?!1:!(i>s||i===s&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:r,endColumn:s,columnStartOffset:a,columnEndOffset:u}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(a,d)),i=Math.min(h,i+Math.min(u,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(a/2)),i=Math.min(h,i+Math.ceil(u/2))),n<r||n===r&&n>0?!1:!(i>s||i===s&&i<h)}resetHasOversizedColumnHeadersMarked(){dt(this.hasOversizedColumnHeadersMarked,(e,n,i)=>{i[n]=void 0})}}function lee(t,e){ez(t,e),e.add(t)}function qu(t,e,n){ez(t,e),e.set(t,n)}function ez(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function un(t,e){return t.get(Gs(t,e))}function Ys(t,e,n){return t.set(Gs(t,e),n),n}function Gs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const SF=23;var xo=new WeakMap,ja=new WeakMap,mA=new WeakMap,b1=new WeakMap,Gl=new WeakMap,Em=new WeakMap,tp=new WeakMap,Io=new WeakSet;class uee{constructor(e){lee(this,Io),qu(this,xo,void 0),qu(this,ja,void 0),qu(this,mA,void 0),qu(this,b1,void 0),qu(this,Gl,!0),qu(this,Em,{}),qu(this,tp,{}),Ys(ja,this,e.rootTable.parentElement.parentElement),Ys(b1,this,e.rootDocument)}isClassicTheme(){return un(Gl,this)}getCSSVariableValue(e){var n;if(un(Gl,this))return null;if(un(Em,this)[`--ht-${e}`])return un(Em,this)[`--ht-${e}`];const i=(n=Gs(Io,this,fee).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Gs(Io,this,tz).call(this,`--ht-${e}`);if(i!==null)return un(Em,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var n;return(n=un(tp,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(un(Gl,this))return SF;const e=Gs(Io,this,cee).call(this);return!e&&ze(un(ja,this),"ht-wrapper")?(Nt(`The "${un(xo,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Ys(Gl,this,!0),this.useTheme(),SF):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Gs(Io,this,bF).call(this),Ys(Gl,this,!0),Ys(xo,this,e||void 0);return}e&&e!==un(xo,this)&&(un(xo,this)&&Gs(Io,this,gee).call(this),Ys(xo,this,e),Ys(Gl,this,!1),Gs(Io,this,hee).call(this),Gs(Io,this,bF).call(this))}getThemeName(){return un(xo,this)}removeClassNames(){ze(un(ja,this),un(xo,this))&&je(un(ja,this),un(xo,this))}}function cee(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function hee(){je(un(ja,this),/ht-theme-.*/g),fe(un(ja,this),un(xo,this))}function bF(){this.isClassicTheme()||Ys(mA,this,getComputedStyle(un(ja,this)));const t=Gs(Io,this,dee).call(this,["box-sizing","border-bottom-width"]);un(tp,this).td={...un(tp,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function dee(t){const e=un(b1,this),n=un(ja,this),i=e.createElement("table"),r=e.createElement("tbody"),s=e.createElement("tr"),a=e.createElement("tr"),u=e.createElement("td");a.appendChild(u),r.appendChild(s),r.appendChild(a),i.appendChild(r),n.appendChild(i);const h=getComputedStyle(u),d={};return t.forEach(g=>{d[g]=h.getPropertyValue(g)}),n.removeChild(i),d}function fee(t){const e=Math.ceil(parseFloat(Gs(Io,this,tz).call(this,t)));return Number.isNaN(e)?null:e}function tz(t){const e=un(mA,this).getPropertyValue(t);return e===""?null:e}function gee(){Ys(tp,this,{}),Ys(Em,this,{}),Ys(Gl,this,!0)}class mee extends iA{constructor(e,n){super(e,new oee(n)),this.stylesHandler=new uee(this.domBindings);const i=this.wtSettings.getSetting("facade",this);this.wtTable=new gA(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new aee(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new UJ(this.wtSettings.getSetting("selections")),this.wtEvent=new z2(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new iee(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],i=[];dt(e,(r,s)=>{this.wtSettings.getSetting(s).length&&i.push(r),n.push(r)}),je(this.wtTable.wtRootElement.parentNode,n),fe(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var n;if(!q2.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(n=this.wtOverlays[`${i}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class pA{constructor(e){e instanceof iA?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const i=new pA(n);return()=>i},this._wot=new mee(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,i){return this._wot.createCellRange(e,n,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,i){return this._wot.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,i,r,s){return this._wot.wtSettings.getSetting(e,n,i,r,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function RF(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:r,selection:s,controller:a,cellCoordsFactory:u}=t;const h=s.isSelected()?s.getSelectedRange().current():null,d=s.isSelectedByCorner(),g=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&h)r.row>=0&&r.col>=0&&!a.cell?s.setRangeEnd(r):(d||g)&&r.row>=0&&r.col>=0&&!a.cell?s.setRangeEnd(u(r.row,r.col)):d&&r.row<0&&!a.column?s.setRangeEnd(u(h.to.row,r.col)):g&&r.col<0&&!a.row?s.setRangeEnd(u(r.row,h.to.col)):(!d&&!g&&r.col<0||d&&r.col<0)&&!a.row?s.selectRows(Math.max(h.from.row,0),r.row,r.col):(!d&&!g&&r.row<0||g&&r.row<0)&&!a.column&&s.selectColumns(Math.max(h.from.col,0),r.col,r.row);else{const p=!s.inInSelection(r),w=n||i&&p;r.row<0&&r.col>=0&&!a.column?w&&s.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!a.row?w&&s.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!a.cell?w&&s.setRangeStart(r):r.col<0&&r.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function pee(t){let{isLeftClick:e,coords:n,selection:i,controller:r,cellCoordsFactory:s}=t;if(!e)return;const a=i.isSelectedByRowHeader(),u=i.isSelectedByColumnHeader(),h=i.tableProps.countCols(),d=i.tableProps.countRows();i.markSource("mouse"),u&&!r.column?i.setRangeEnd(s(d-1,n.col)):a&&!r.row?i.setRangeEnd(s(n.row,h-1)):r.cell||i.setRangeEnd(n),i.markEndSource()}const vee=new Map([["mousedown",RF],["mouseover",pee],["touchstart",RF]]);function EF(t,e){let{coords:n,selection:i,controller:r,cellCoordsFactory:s}=e;vee.get(t.type)({coords:n,selection:i,controller:r,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:XO(t)||t.type==="touchstart",isRightClick:Yc(t)})}const nz=new WeakMap,vA=Symbol("rootInstance");function wee(t){nz.set(t,!0)}function yee(t){return t===vA}function zy(t){return nz.has(t)}function Cee(t,e){iz(t,e),e.add(t)}function Il(t,e,n){iz(t,e),e.set(t,n)}function iz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nl(t,e,n){return(e=See(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=bee(t,"string");return typeof e=="symbol"?e:e+""}function bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wn(t,e){return t.get(Gd(t,e))}function ar(t,e,n){return t.set(Gd(t,e),n),n}function Gd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var h_=new WeakMap,yw=new WeakMap,Cw=new WeakMap,Ra=new WeakMap,Is=new WeakMap,d_=new WeakMap,f_=new WeakMap,Qh=new WeakMap,Tm=new WeakSet;class Ree{constructor(e){Cee(this,Tm),Nl(this,"hot",void 0),Nl(this,"eventManager",void 0),Nl(this,"settings",void 0),Nl(this,"THEAD",void 0),Nl(this,"TBODY",void 0),Nl(this,"_wt",void 0),Nl(this,"activeWt",void 0),Il(this,h_,0),Il(this,yw,0),Nl(this,"postponedAdjustElementsSize",!1),Il(this,Cw,!1),Il(this,Ra,void 0),Il(this,Is,void 0),Il(this,d_,0),Il(this,f_,0),Il(this,Qh,null),this.hot=e,this.eventManager=new to(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),Gd(Tm,this,Tee).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const i=this._wt.getCell(e,n);return i<0?null:i}scrollViewport(e,n,i){return this._wt.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),fe(e,"handsontable"),ar(Is,this,n.createElement("TABLE")),fe(Wn(Is,this),"htCore"),this.hot.getSettings().tableClassName&&fe(Wn(Is,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ge(Wn(Is,this),[jo()]),Ge(e,[y7(),o2(-1),CS(this.hot.countCols()),I7()])),this.THEAD=n.createElement("THEAD"),Wn(Is,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Wn(Is,this).appendChild(this.TBODY),this.hot.table=Wn(Is,this),this.hot.container.insertBefore(Wn(Is,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:i,rootWindow:r}=this.hot,s=n.documentElement;this.eventManager.addEventListener(e,"mousedown",u=>{ar(Cw,this,!0),this.isTextSelectionAllowed(u.target)||(a$(r),u.preventDefault(),r.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{ar(Cw,this,!1)}),this.eventManager.addEventListener(e,"mousemove",u=>{Wn(Cw,this)&&!this.isTextSelectionAllowed(u.target)&&(this.settings.fragmentSelection&&a$(r),u.preventDefault())}),this.eventManager.addEventListener(s,"keyup",u=>{i.isInProgress()&&!u.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",u=>{i.isInProgress()&&XO(u)&&i.finish(),ar(Ra,this,!1);const h=p2(n.activeElement);jy(n.activeElement)&&!h||(h||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(u.target)&&!Yc(u))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",u=>{i.isInProgress()&&Yc(u)&&(i.finish(),ar(Ra,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),ar(Ra,this,!1)}),this.eventManager.addEventListener(s,"mousedown",u=>{const h=u.target,d=u.x||u.clientX,g=u.y||u.clientY;let p=u.target;if(Wn(Ra,this)||!e||!this.hot.view)return;const{holder:w}=this._wt.wtTable;if(p===w){const S=Mi(n);if(n.elementFromPoint(d+S,g)!==w||n.elementFromPoint(d,g+S)!==w)return}else for(;p!==s;){if(p===null){if(u.isTargetWebComponent)break;return}if(p===e)return;p=p.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(h):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=Qd(r);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=Qd(a);this.eventManager.addEventListener(Wn(Is,this),"selectstart",u=>{this.settings.fragmentSelection||jy(u.target)||u.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,i))}translateFromRenderableToVisualIndex(e,n){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),r===null&&(r=n),[i,r]}countRenderableIndexes(e,n){const i=Math.min(e.getNotTrimmedIndexesLength(),n),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,i,r){if(isNaN(e)||e<0)return 0;const s=i.getNearestNotHiddenIndex(e,n),a=i.getRenderableFromVisualIndex(s);if(!Number.isInteger(a))return 0;let u=0;return n<0?u=a+1:n>0&&(u=r-a),u}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&fe(i,e)}removeClassNameFromLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&je(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Wn(Is,this),isDataViewInstance:()=>zy(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,a)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((a,u)=>{const h=a>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(h,u)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),ar(yw,this,s.length),this.hot.getSettings().ariaTags&&Gd(Tm,this,rz).call(this)===this.hot.countCols()&&Gd(Tm,this,Eee).call(this,Wn(yw,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((a,u)=>{const h=a>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(h,u)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),ar(h_,this,s.length),s},columnWidth:s=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(a===null?s:a)},rowHeight:s=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(a===null?s:a)},rowHeightByOverlayName:(s,a)=>{const u=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),h=u===null?s:u;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(h),h,a)},cellRenderer:(s,a,u)=>{const[h,d]=this.translateFromRenderableToVisualIndex(s,a),g=this.hot.runHooks("modifyGetCellCoords",h,d,!1,"meta");let p=h,w=d;Array.isArray(g)&&([p,w]=g);const y=this.hot.getCellMeta(p,w),S=this.hot.colToProp(w);let _=this.hot.getDataAtRowProp(p,S);this.hot.hasHook("beforeValueRender")&&(_=this.hot.runHooks("beforeValueRender",_,y)),this.hot.runHooks("beforeRenderer",u,h,d,S,_,y),this.hot.getCellRenderer(y)(this.hot,u,h,d,S,_,y),this.hot.runHooks("afterRenderer",u,h,d,S,_,y)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Jd(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a),g={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=h,ar(Ra,this,!0),ar(Qh,this,{x:s.clientX,y:s.clientY}),this.hot.runHooks("beforeOnCellMouseDown",s,d,u,g),!Pc(s)&&(EF(s,{coords:d,selection:this.hot.selection,controller:g,cellCoordsFactory:(p,w)=>this.hot._createCellCoords(p,w)}),this.hot.runHooks("afterOnCellMouseDown",s,d,u),this.activeWt=this._wt)},onCellContextMenu:(s,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,ar(Ra,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,d,u),!Pc(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,d,u),this.activeWt=this._wt)},onCellMouseOut:(s,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOut",s,d,u),!Pc(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,d,u),this.activeWt=this._wt)},onCellMouseOver:(s,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a),g={row:!1,column:!1,cell:!1};this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOver",s,d,u,g),!Pc(s)&&(Wn(Ra,this)&&(!Wn(Qh,this)||Wn(Qh,this).x!==s.clientX||Wn(Qh,this).y!==s.clientY)&&EF(s,{coords:d,selection:this.hot.selection,controller:g,cellCoordsFactory:(p,w)=>this.hot._createCellCoords(p,w)}),this.hot.runHooks("afterOnCellMouseOver",s,d,u),this.activeWt=this._wt,ar(Qh,this,null))},onCellMouseUp:(s,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseUp",s,d,u),!(Pc(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,d,u),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,a)=>this.beforeRender(s,a),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,a)=>{const u=this.hot.rowIndexMapper,h=s<0;let d=s;return!h&&(d=u.getVisualFromRenderableIndex(s),d===null)?s:(d=this.hot.runHooks("beforeViewportScrollVertically",d,a),this.hot.runHooks("beforeViewportScroll"),h?d:u.getRenderableFromVisualIndex(d))},onBeforeViewportScrollHorizontally:(s,a)=>{const u=this.hot.columnIndexMapper,h=s<0;let d=s;return!h&&(d=u.getVisualFromRenderableIndex(s),d===null)?s:(d=this.hot.runHooks("beforeViewportScrollHorizontally",d,a),this.hot.runHooks("beforeViewportScroll"),h?d:u.getRenderableFromVisualIndex(d))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,a,u)=>{const h=this.hot.rowIndexMapper,d=s<0;let g=s;d||(g=h.getVisualFromRenderableIndex(s));const p=this.hot.runHooks("beforeHighlightingRowHeader",g,a,u);return d?p:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(p,1))},onBeforeHighlightingColumnHeader:(s,a,u)=>{const h=this.hot.columnIndexMapper,d=s<0;let g=s;d||(g=h.getVisualFromRenderableIndex(s));const p=this.hot.runHooks("beforeHighlightingColumnHeader",g,a,u);return d?p:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(p,1))},onAfterDrawSelection:(s,a,u)=>{let h;const[d,g]=this.translateFromRenderableToVisualIndex(s,a),p=this.hot.selection.getSelectedRange();if(p.size()>0){const y=p.peekByIndex(u??0);h=[y.from.row,y.from.col,y.to.row,y.to.col]}return this.hot.runHooks("afterDrawSelection",d,g,h,u)},onBeforeDrawBorders:(s,a)=>{const[u,h,d,g]=s,p=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(h),this.hot.rowIndexMapper.getVisualFromRenderableIndex(d),this.hot.columnIndexMapper.getVisualFromRenderableIndex(g)];return this.hot.runHooks("beforeDrawBorders",p,a)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,a,u,h)=>{const d=this.hot.rowIndexMapper,g=this.hot.columnIndexMapper,p=a>=0?g.getVisualFromRenderableIndex(a):a,w=s>=0?d.getVisualFromRenderableIndex(s):s,y=this.hot.runHooks("modifyGetCellCoords",w,p,u,h);if(Array.isArray(y)){const[S,_,E,H]=y;return[S>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(S,1)):S,_>=0?g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(_,1)):_,E>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(E,-1)):E,H>=0?g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(H,-1)):H]}},onModifyGetCoordsElement:(s,a)=>{const u=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,d=a>=0?h.getVisualFromRenderableIndex(a):a,g=s>=0?u.getVisualFromRenderableIndex(s):s,p=this.hot.runHooks("modifyGetCoordsElement",g,d);if(Array.isArray(p)){const[w,y]=p;return[w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,y>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(y,1)):y]}},viewportRowCalculatorOverride:s=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const u=this.countRenderableRows(),h=s.startRow,d=s.endRow;if(typeof a=="number")s.startRow=Math.max(h-a,0),s.endRow=Math.min(d+a,u-1);else if(a==="auto"){const g=Math.max(1,Math.ceil(d/u*12));s.startRow=Math.max(h-g,0),s.endRow=Math.min(d+g,u-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const u=this.countRenderableColumns(),h=s.startColumn,d=s.endColumn;if(typeof a=="number"&&(s.startColumn=Math.max(h-a,0),s.endColumn=Math.min(d+a,u-1)),a==="auto"){const g=Math.max(1,Math.ceil(d/u*6));s.startColumn=Math.max(h-g,0),s.endColumn=Math.min(d+g,u-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new pA(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(n,"mousedown",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(jy(e))return!0;const n=Wc(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Wn(Ra,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const i=n.firstChild;if(!ze(i,"relative")){Go(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,s=i.createElement("div"),a=i.createElement("span");s.className="relative",a.className="rowHeader",this.updateCellHeader(a,e,r),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const a=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return a?a.split(" "):[]};if(n.firstChild){const a=n.firstChild;ze(a,"relative")?(this.updateCellHeader(a.querySelector(".colHeader"),e,i,r),a.className="",fe(a,["relative",...s()])):(Go(n),this.appendColHeader(e,n,i,r))}else{const{rootDocument:a}=this.hot,u=a.createElement("div"),h=a.createElement("span"),d=s();u.classList.add("relative",...d),h.className="colHeader",this.settings.ariaTags&&(Ge(u,...jo()),Ge(h,...jo())),this.updateCellHeader(h,e,i,r),u.appendChild(h),n.appendChild(u)}this.hot.runHooks("afterGetColHeader",e,n,r)}updateCellHeader(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=n;const a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ze(e,"colHeader")?s=a.wtTable.columnFilter.sourceToRendered(n):ze(e,"rowHeader")&&(s=a.wtTable.rowFilter.sourceToRendered(n))),s>-1?wf(e,i(n,r)):(zc(e," "),fe(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,n){ar(d_,this,e),ar(f_,this,n)}getLastSize(){return{width:Wn(d_,this),height:Wn(f_,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Wn(h_,this)}getRowHeadersCount(){return Wn(yw,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function rz(){return parseInt(this.hot.rootElement.getAttribute(CS()[0]),10)}function Eee(t){const e=Gd(Tm,this,rz).call(this)+t;Ge(this.hot.rootElement,...CS(e))}function Tee(){const t=this.hot.rootElement;this.hasVerticalScroll()?fe(t,"htHasScrollY"):je(t,"htHasScrollY"),this.hasHorizontalScroll()?fe(t,"htHasScrollX"):je(t,"htHasScrollX")}var TF={},_F={},MF;function _ee(){if(MF)return _F;MF=1;var t=en(),e=df(),n=Cr(),i=ii(),r=Xo();return t({target:"Iterator",proto:!0,real:!0},{every:function(a){i(this),n(a);var u=r(this),h=0;return!e(u,function(d,g){if(!a(d,h++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),_F}var OF;function Mee(){return OF||(OF=1,_ee()),TF}Mee();const Oee="ABCDEFGHIJKLMNOPQRSTUVWXYZ",AF=Oee.length;function Aee(t){let e=t+1,n="",i;for(;e>0;)i=(e-1)%AF,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/AF,10);return n}function sz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((r,s)=>{Array.isArray(r)?r.forEach((a,u)=>{i.push([s+e,u,a])}):Object.keys(r).forEach(a=>{i.push([s+e,a,r[a]])})}),i}function oz(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&ht(t[0])&&(e=KO(t[0]))),e}function xee(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function Hee(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function Vg(t,e,n){return(e=Pee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pee(t){var e=Iee(t,"string");return typeof e=="symbol"?e:e+""}function Iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nee{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Vg(this,"hot",void 0),Vg(this,"data",void 0),Vg(this,"dataType","array"),Vg(this,"colToProp",()=>{}),Vg(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return W(this.data,(i,r)=>{const s=this.getAtCell(r,e);n.push(s)}),n}getAtRow(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=n===void 0&&i===void 0,{dataDotNotation:a}=this.hot.getSettings();let u=null,h=null;if(u=this.modifyRowData(e),Array.isArray(u))h=[],s?u.forEach((d,g)=>{h[g]=this.getAtPhysicalCell(e,g,u)}):ke(n,i,d=>{h[d-n]=this.getAtPhysicalCell(e,d,u)});else if(ht(u)||on(u))if(r?h=[]:h={},!s||r){const g=this.countFirstRowKeys()-1;ke(0,g,p=>{const w=this.colToProp(p);if(p>=(n||0)&&p<=(i||g)&&!Number.isInteger(w)){const y=this.getAtPhysicalCell(e,w,u);r?h.push(y):a?$T(h,w,y):h[w]=y}})}else dt(u,(d,g)=>{const p=this.getAtPhysicalCell(e,g,u);a?$T(h,g,p):h[g]=p});return h}setAtCell(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=Wr(i);this.hot.runHooks("modifySourceData",e,n,r,"set"),r.isTouched()&&(i=r.value)}Number.isInteger(e)&&(Number.isInteger(n)?this.data[e][n]=i:$T(this.data[e],n,i))}}getAtPhysicalCell(e,n,i){let r=null;if(i)if(typeof n=="string"){const{dataDotNotation:s}=this.hot.getSettings();r=s?oX(i,n):i[n]}else typeof n=="function"?r=n(i):r=i[n];if(this.hot.hasHook("modifySourceData")){const s=Wr(r);this.hot.runHooks("modifySourceData",e,n,s,"get"),s.isTouched()&&(r=s.value)}return r}getAtCell(e,n){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,s=null,a=null,u=null,h=null;e===null||n===null?(r=!0,s=0,u=this.countRows()-1):(s=Math.min(e.row,n.row),a=Math.min(e.col,n.col),u=Math.max(e.row,n.row),h=Math.max(e.col,n.col));const d=[];return ke(s,u,g=>{d.push(r?this.getAtRow(g,void 0,void 0,i):this.getAtRow(g,a,h,i))}),d}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return oz(this.data)}destroy(){this.data=null,this.hot=null}}var xF={},HF={},PF;function Dee(){if(PF)return HF;PF=1;var t=en(),e=df(),n=Cr(),i=ii(),r=Xo();return t({target:"Iterator",proto:!0,real:!0},{some:function(a){i(this),n(a);var u=r(this),h=0;return e(u,function(d,g){if(a(d,h++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),HF}var IF;function Lee(){return IF||(IF=1,Dee()),xF}Lee();function NF(t,e,n){return(e=kee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kee(t){var e=Vee(t,"string");return typeof e=="symbol"?e:e+""}function Vee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sh{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;NF(this,"indexedValues",[]),NF(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,on(this.initValueOrFn)?ke(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):ke(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Yt(sh,Ai);function wA(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((s,a)=>on(i)?i(s,a):i),...r===void 0?[]:t.slice(r)]}function yA(t,e){return Uc(t,(n,i)=>e.includes(i)===!1)}class yu extends sh{insert(e,n){this.indexedValues=wA(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=yA(this.indexedValues,e),super.remove(e)}}class OS extends yu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Sr(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}function CA(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function np(t,e){return Uc(t,n=>e.includes(n)===!1)}function SA(t,e){return Rt(t,n=>n-e.filter(i=>i<n).length)}function bA(t,e){const n=e[0],i=e.length;return Rt(t,r=>r>=n?r+i:r)}function $ee(t,e,n){return(e=Fee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fee(t){var e=Bee(t,"string");return typeof e=="symbol"?e:e+""}function Bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AS extends sh{constructor(){super(...arguments),$ee(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=np(this.orderOfIndexes,[e]),on(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=wA(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=bA(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=yA(this.indexedValues,e),this.orderOfIndexes=np(this.orderOfIndexes,e),this.orderOfIndexes=SA(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Hp extends yu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Sr(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}const DF=new Map([["indexesSequence",{getListWithInsertedItems:CA,getListWithRemovedItems:np}],["physicallyIndexed",{getListWithInsertedItems:wA,getListWithRemovedItems:yA}]]),az=t=>{if(DF.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return DF.get(t)};class lz extends sh{constructor(){super(e=>e)}insert(e,n){const i=bA(this.indexedValues,n);this.indexedValues=CA(i,e,n),super.insert(e,n)}remove(e){const n=np(this.indexedValues,e);this.indexedValues=SA(n,e),super.remove(e)}}const LF=new Map([["hiding",OS],["index",sh],["linkedPhysicalIndexToValue",AS],["physicalIndexToValue",yu],["trimming",Hp]]);function Wee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!LF.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(LF.get(t))(e)}function Uee(t,e,n){return(e=jee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jee(t){var e=zee(t,"string");return typeof e=="symbol"?e:e+""}function zee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RA{constructor(){Uee(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)))}unregister(e){const n=this.collection.get(e);Pe(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n))}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return vn(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(i=>{i.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}Yt(RA,Ai);function g_(t,e,n){return(e=Yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yee(t){var e=Gee(t,"string");return typeof e=="symbol"?e:e+""}function Gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kF extends RA{constructor(e,n){super(),g_(this,"mergedValuesCache",[]),g_(this,"aggregationFunction",void 0),g_(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Rt(this.get(),s=>s.getValues()),i=[],r=Pe(n[0])&&n[0].length||0;for(let s=0;s<r;s+=1){const a=[];for(let u=0;u<this.getLength();u+=1)a.push(n[u][s]);i.push(a)}return Rt(i,this.aggregationFunction)}getMergedValueAtIndex(e,n){const i=this.getMergedValues(n)[e];return Pe(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function qee(t,e,n){Kee(t,e),e.set(t,n)}function Kee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xee(t,e,n){return t.set(uz(t,e),n),n}function Zee(t,e){return t.get(uz(t,e))}function uz(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var m_=new WeakMap;class cz{constructor(){qee(this,m_,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Zee(m_,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Xee(m_,this,e)}}Yt(cz,Ai);function VF(t,e){const n=[];let i=0,r=0;for(;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function $g(t,e,n){Qee(t,e),e.set(t,n)}function Qee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function us(t,e){return t.get(hz(t,e))}function Sw(t,e,n){return t.set(hz(t,e),n),n}function hz(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bw=new WeakMap,Fg=new WeakMap,Rw=new WeakMap,Ew=new WeakMap,Tw=new WeakMap;class Jee{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};$g(this,bw,new Set),$g(this,Fg,[]),$g(this,Rw,[]),$g(this,Ew,!1),$g(this,Tw,!1),Sw(Tw,this,e??!1)}createObserver(){const e=new cz;return us(bw,this).add(e),e.addLocalHook("unsubscribe",()=>{us(bw,this).delete(e)}),e._writeInitialChanges(VF(us(Fg,this),us(Rw,this))),e}emit(e){let n=us(Rw,this);(!us(Ew,this)||us(Fg,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(us(Tw,this)):Sw(Fg,this,new Array(e.length).fill(us(Tw,this))),us(Ew,this)||(Sw(Ew,this,!0),n=us(Fg,this)));const i=VF(n,e);us(bw,this).forEach(r=>r._write(i)),Sw(Rw,this,e)}}function ji(t,e,n){return(e=ete(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ete(t){var e=tte(t,"string");return typeof e=="symbol"?e:e+""}function tte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R1{constructor(){ji(this,"indexesSequence",new lz),ji(this,"trimmingMapsCollection",new kF(e=>e.some(n=>n===!0),!1)),ji(this,"hidingMapsCollection",new kF(e=>e.some(n=>n===!0),!1)),ji(this,"variousMapsCollection",new RA),ji(this,"hidingChangesObservable",new Jee({initialIndexValue:!1})),ji(this,"notTrimmedIndexesCache",[]),ji(this,"notHiddenIndexesCache",[]),ji(this,"isBatched",!1),ji(this,"indexesSequenceChanged",!1),ji(this,"indexesChangeSource",void 0),ji(this,"trimmedIndexesChanged",!1),ji(this,"hiddenIndexesChanged",!1),ji(this,"renderablePhysicalIndexesCache",[]),ji(this,"fromPhysicalToVisualIndexesCache",new Map),ji(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,i){return this.registerMap(e,Wee(n,i))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Hp?this.trimmingMapsCollection.register(e,n):n instanceof OS?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const i=this.getNumberOfIndexes();return i>0&&n.init(i),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return Pe(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return Pe(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return Pe(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return Pe(n)?n:null}getNearestNotHiddenIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let a=-1;return n>0?a=s.findIndex(u=>u>e):a=s.reverse().findIndex(u=>u<e),a===-1?i?this.getNearestNotHiddenIndex(e,-n,!1):null:s[a]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const i=Rt(e,d=>this.getPhysicalFromVisualIndex(d)),r=this.getNotTrimmedIndexesLength(),s=e.length,a=np(this.getIndexesSequence(),i),u=a.filter(d=>this.isTrimmed(d)===!1);let h=a.indexOf(u[u.length-1])+1;if(n+s<r){const d=u[n];h=a.indexOf(d)}this.indexesChangeSource="move",this.setIndexesSequence(CA(a,h,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const i=this.getNotTrimmedIndexes()[e],r=Pe(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=Rt(new Array(n).fill(r),(u,h)=>u+h);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,a),this.hidingMapsCollection.insertToEvery(s,a),this.variousMapsCollection.insertToEvery(s,a),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromRenderableIndex(n),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,n)}}}Yt(R1,Ai);function nte(t,e){return dt(e,(n,i)=>{vn(t[i])&&(t[i]=n)}),t}function dz(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function fz(t){Pe(t)&&ZO($t`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function ite(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:rte,getValues:ste}=oo("phraseFormatters");function ote(t,e){rte(t,e)}function ate(){return ste()}ote("pluralize",ite);const gz="ContextMenu:items",it=gz,EA=`${it}.noItems`,TA=`${it}.insertRowAbove`,_A=`${it}.insertRowBelow`,MA=`${it}.insertColumnOnTheLeft`,OA=`${it}.insertColumnOnTheRight`,AA=`${it}.removeRow`,xA=`${it}.removeColumn`,HA=`${it}.undo`,PA=`${it}.redo`,CC=`${it}.readOnly`,IA=`${it}.clearColumn`,NA=`${it}.copy`,DA=`${it}.copyWithHeaders`,LA=`${it}.copyWithGroupHeaders`,kA=`${it}.copyHeadersOnly`,VA=`${it}.cut`,$A=`${it}.freezeColumn`,FA=`${it}.unfreezeColumn`,BA=`${it}.mergeCells`,WA=`${it}.unmergeCells`,UA=`${it}.addComment`,jA=`${it}.editComment`,zA=`${it}.removeComment`,YA=`${it}.readOnlyComment`,GA=`${it}.align`,qA=`${it}.align.left`,KA=`${it}.align.center`,XA=`${it}.align.right`,ZA=`${it}.align.justify`,QA=`${it}.align.top`,JA=`${it}.align.middle`,ex=`${it}.align.bottom`,tx=`${it}.borders`,nx=`${it}.borders.top`,ix=`${it}.borders.right`,rx=`${it}.borders.bottom`,sx=`${it}.borders.left`,ox=`${it}.borders.remove`,ax=`${it}.nestedHeaders.insertChildRow`,lx=`${it}.nestedHeaders.detachFromParent`,ux=`${it}.hideColumn`,cx=`${it}.showColumn`,hx=`${it}.hideRow`,dx=`${it}.showRow`,nr="Filters:",On=`${nr}conditions`,xS=`${On}.none`,fx=`${On}.isEmpty`,gx=`${On}.isNotEmpty`,mx=`${On}.isEqualTo`,px=`${On}.isNotEqualTo`,vx=`${On}.beginsWith`,wx=`${On}.endsWith`,yx=`${On}.contains`,Cx=`${On}.doesNotContain`,lte=`${On}.byValue`,Sx=`${On}.greaterThan`,bx=`${On}.greaterThanOrEqualTo`,Rx=`${On}.lessThan`,Ex=`${On}.lessThanOrEqualTo`,Tx=`${On}.isBetween`,_x=`${On}.isNotBetween`,Mx=`${On}.after`,Ox=`${On}.before`,Ax=`${On}.today`,xx=`${On}.tomorrow`,Hx=`${On}.yesterday`,Px=`${nr}labels.filterByCondition`,Ix=`${nr}labels.filterByValue`,Nx=`${nr}labels.conjunction`,HS=`${nr}labels.disjunction`,SC=`${nr}values.blankCells`,Dx=`${nr}buttons.selectAll`,Lx=`${nr}buttons.clear`,kx=`${nr}buttons.ok`,Vx=`${nr}buttons.cancel`,$x=`${nr}buttons.placeholder.search`,Fx=`${nr}buttons.placeholder.value`,Bx=`${nr}buttons.placeholder.secondValue`,Wx="CheckboxRenderer:",Ux=`${Wx}checked`,jx=`${Wx}unchecked`,ute=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:Ux,CHECKBOX_RENDERER_NAMESPACE:Wx,CHECKBOX_UNCHECKED:jx,CONTEXTMENU_ITEMS_ADD_COMMENT:UA,CONTEXTMENU_ITEMS_ALIGNMENT:GA,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:ex,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:KA,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:ZA,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:qA,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:JA,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:XA,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:QA,CONTEXTMENU_ITEMS_BORDERS:tx,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:rx,CONTEXTMENU_ITEMS_BORDERS_LEFT:sx,CONTEXTMENU_ITEMS_BORDERS_RIGHT:ix,CONTEXTMENU_ITEMS_BORDERS_TOP:nx,CONTEXTMENU_ITEMS_CLEAR_COLUMN:IA,CONTEXTMENU_ITEMS_COPY:NA,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:kA,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:LA,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:DA,CONTEXTMENU_ITEMS_CUT:VA,CONTEXTMENU_ITEMS_EDIT_COMMENT:jA,CONTEXTMENU_ITEMS_FREEZE_COLUMN:$A,CONTEXTMENU_ITEMS_HIDE_COLUMN:ux,CONTEXTMENU_ITEMS_HIDE_ROW:hx,CONTEXTMENU_ITEMS_INSERT_LEFT:MA,CONTEXTMENU_ITEMS_INSERT_RIGHT:OA,CONTEXTMENU_ITEMS_MERGE_CELLS:BA,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:lx,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:ax,CONTEXTMENU_ITEMS_NO_ITEMS:EA,CONTEXTMENU_ITEMS_READ_ONLY:CC,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:YA,CONTEXTMENU_ITEMS_REDO:PA,CONTEXTMENU_ITEMS_REMOVE_BORDERS:ox,CONTEXTMENU_ITEMS_REMOVE_COLUMN:xA,CONTEXTMENU_ITEMS_REMOVE_COMMENT:zA,CONTEXTMENU_ITEMS_REMOVE_ROW:AA,CONTEXTMENU_ITEMS_ROW_ABOVE:TA,CONTEXTMENU_ITEMS_ROW_BELOW:_A,CONTEXTMENU_ITEMS_SHOW_COLUMN:cx,CONTEXTMENU_ITEMS_SHOW_ROW:dx,CONTEXTMENU_ITEMS_UNDO:HA,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:FA,CONTEXTMENU_ITEMS_UNMERGE_CELLS:WA,CONTEXT_MENU_ITEMS_NAMESPACE:gz,FILTERS_BUTTONS_CANCEL:Vx,FILTERS_BUTTONS_CLEAR:Lx,FILTERS_BUTTONS_OK:kx,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:$x,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Bx,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Fx,FILTERS_BUTTONS_SELECT_ALL:Dx,FILTERS_CONDITIONS_AFTER:Mx,FILTERS_CONDITIONS_BEFORE:Ox,FILTERS_CONDITIONS_BEGINS_WITH:vx,FILTERS_CONDITIONS_BETWEEN:Tx,FILTERS_CONDITIONS_BY_VALUE:lte,FILTERS_CONDITIONS_CONTAINS:yx,FILTERS_CONDITIONS_EMPTY:fx,FILTERS_CONDITIONS_ENDS_WITH:wx,FILTERS_CONDITIONS_EQUAL:mx,FILTERS_CONDITIONS_GREATER_THAN:Sx,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:bx,FILTERS_CONDITIONS_LESS_THAN:Rx,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Ex,FILTERS_CONDITIONS_NAMESPACE:On,FILTERS_CONDITIONS_NONE:xS,FILTERS_CONDITIONS_NOT_BETWEEN:_x,FILTERS_CONDITIONS_NOT_CONTAIN:Cx,FILTERS_CONDITIONS_NOT_EMPTY:gx,FILTERS_CONDITIONS_NOT_EQUAL:px,FILTERS_CONDITIONS_TODAY:Ax,FILTERS_CONDITIONS_TOMORROW:xx,FILTERS_CONDITIONS_YESTERDAY:Hx,FILTERS_DIVS_FILTER_BY_CONDITION:Px,FILTERS_DIVS_FILTER_BY_VALUE:Ix,FILTERS_LABELS_CONJUNCTION:Nx,FILTERS_LABELS_DISJUNCTION:HS,FILTERS_NAMESPACE:nr,FILTERS_VALUES_BLANK_CELLS:SC},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const mz={languageCode:"en-US",[EA]:"No available options",[TA]:"Insert row above",[_A]:"Insert row below",[MA]:"Insert column left",[OA]:"Insert column right",[AA]:["Remove row","Remove rows"],[xA]:["Remove column","Remove columns"],[HA]:"Undo",[PA]:"Redo",[CC]:"Read only",[IA]:"Clear column",[GA]:"Alignment",[qA]:"Left",[KA]:"Center",[XA]:"Right",[ZA]:"Justify",[QA]:"Top",[JA]:"Middle",[ex]:"Bottom",[$A]:"Freeze column",[FA]:"Unfreeze column",[tx]:"Borders",[nx]:"Top",[ix]:"Right",[rx]:"Bottom",[sx]:"Left",[ox]:"Remove border(s)",[UA]:"Add comment",[jA]:"Edit comment",[zA]:"Delete comment",[YA]:"Read-only comment",[BA]:"Merge cells",[WA]:"Unmerge cells",[NA]:"Copy",[DA]:["Copy with header","Copy with headers"],[LA]:["Copy with group header","Copy with group headers"],[kA]:["Copy header only","Copy headers only"],[VA]:"Cut",[ax]:"Insert child row",[lx]:"Detach from parent",[ux]:["Hide column","Hide columns"],[cx]:["Show column","Show columns"],[hx]:["Hide row","Hide rows"],[dx]:["Show row","Show rows"],[xS]:"None",[fx]:"Is empty",[gx]:"Is not empty",[mx]:"Is equal to",[px]:"Is not equal to",[vx]:"Begins with",[wx]:"Ends with",[yx]:"Contains",[Cx]:"Does not contain",[Sx]:"Greater than",[bx]:"Greater than or equal to",[Rx]:"Less than",[Ex]:"Less than or equal to",[Tx]:"Is between",[_x]:"Is not between",[Mx]:"After",[Ox]:"Before",[Ax]:"Today",[xx]:"Tomorrow",[Hx]:"Yesterday",[SC]:"Blank cells",[Px]:"Filter by condition",[Ix]:"Filter by value",[Nx]:"And",[HS]:"Or",[Dx]:"Select all",[Lx]:"Clear",[kx]:"OK",[Vx]:"Cancel",[$x]:"Search",[Fx]:"Value",[Bx]:"Second value",[Ux]:"Checked",[jx]:"Unchecked"},cte=ute,E1=mz.languageCode,{register:hte,getItem:pz,hasItem:dte,getValues:fte}=oo("languagesDictionaries");vz(mz);function vz(t,e){let n=t,i=e;return ht(t)&&(i=t,n=i.languageCode),gte(n,i),hte(n,tr(i)),tr(i)}function gte(t,e){t!==E1&&nte(e,pz(E1))}function wz(t){return zx(t)?tr(pz(t)):null}function zx(t){return dte(t)}function mte(){return fte()}function yz(t,e,n){const i=wz(t);if(i===null)return null;const r=i[e];if(vn(r))return null;const s=pte(r,n);return Array.isArray(s)?s[0]:s}function pte(t,e){let n=t;return W(ate(),i=>{n=i(t,e)}),n}function vte(t){let e=dz(t);return zx(e)||(e=E1,fz(t)),e}function wte(t,e,n){return(e=yte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yte(t){var e=Cte(t,"string");return typeof e=="symbol"?e:e+""}function Cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class al extends K2{constructor(e,n){super(e,null),wte(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:i}=e,r=this.getNearestNotHiddenCoords(n,1),s=this.getNearestNotHiddenCoords(i,-1);return r===null||s===null?null:((r.row>s.row||r.col>s.col)&&(r=n,s=i),this.settings.createCellRange(r,r,s))}getNearestNotHiddenCoords(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(r===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return s===null?null:this.settings.createCellCoords(r,s)}getNearestNotHiddenIndex(e,n,i){return n<0?n:e.getNearestNotHiddenIndex(n,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let a=null;if((s===null||s.col===null||s.row===null)&&(a=this.getNearestNotHiddenCoords(n,i,r)),a!==null&&e.overlaps(a)){const u=e.highlight.clone();if(u.row>=0&&(u.row=a.row),u.col>=0&&(u.col=a.col),this.cellRange===null){const h=this.settings.visualToRenderableCoords(u);this.cellRange=this.settings.createCellRange(h)}e.setHighlight(u)}return this.settings.selectionType==="focus"&&s!==null&&a===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(n);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}}function p_(t){let{activeHeaderClassName:e,...n}=t;return new al({className:e,...n,selectionType:X2})}function Ste(t){let{areaCornerVisible:e,...n}=t;return new al({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:lA})}function bte(t){let{...e}=t;return new al({className:"highlight",...e,selectionType:lA})}function Rte(t){let{columnClassName:e,...n}=t;return new al({className:e,...n,selectionType:LJ})}function Ete(t){let{cellCornerVisible:e,...n}=t;return new al({className:"current",headerAttributes:[UO()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:yC})}function Tte(t){let{border:e,visualCellRange:n,...i}=t;return new al({...e,...i,selectionType:kJ},n)}function _te(t){let{...e}=t;return new al({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:NJ})}function $F(t){let{headerClassName:e,...n}=t;return new al({className:e,...n,selectionType:aA})}function Mte(t){let{rowClassName:e,...n}=t;return new al({className:e,...n,selectionType:DJ})}function Ote(t,e){Ate(t,e),e.add(t)}function Ate(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lr(t,e,n){return(e=xte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xte(t){var e=Hte(t,"string");return typeof e=="symbol"?e:e+""}function Hte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ea(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vo=new WeakSet;class Pte{constructor(e){Ote(this,vo),lr(this,"options",void 0),lr(this,"layerLevel",0),lr(this,"focus",void 0),lr(this,"fill",void 0),lr(this,"layeredAreas",new Map),lr(this,"areas",new Map),lr(this,"rowHeaders",new Map),lr(this,"columnHeaders",new Map),lr(this,"activeRowHeaders",new Map),lr(this,"activeColumnHeaders",new Map),lr(this,"activeCornerHeaders",new Map),lr(this,"rowHighlights",new Map),lr(this,"columnHighlights",new Map),lr(this,"customSelections",[]),this.options=e,this.focus=Ete(e),this.fill=_te(e)}isEnabledFor(e,n){let i=e;e===yC&&(i="current");let r=this.options.disabledCellSelection(n.row,n.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Ea(vo,this,Ta).call(this,this.layeredAreas,Ste)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Ea(vo,this,Ta).call(this,this.areas,bte)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Ea(vo,this,Ta).call(this,this.rowHeaders,$F)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Ea(vo,this,Ta).call(this,this.columnHeaders,$F)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Ea(vo,this,Ta).call(this,this.activeRowHeaders,p_)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Ea(vo,this,Ta).call(this,this.activeColumnHeaders,p_)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Ea(vo,this,Ta).call(this,this.activeCornerHeaders,p_)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Ea(vo,this,Ta).call(this,this.rowHighlights,Mte)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Ea(vo,this,Ta).call(this,this.columnHighlights,Rte)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Tte({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),W(this.areas.values(),e=>void e.clear()),W(this.layeredAreas.values(),e=>void e.clear()),W(this.rowHeaders.values(),e=>void e.clear()),W(this.columnHeaders.values(),e=>void e.clear()),W(this.activeRowHeaders.values(),e=>void e.clear()),W(this.activeColumnHeaders.values(),e=>void e.clear()),W(this.activeCornerHeaders.values(),e=>void e.clear()),W(this.rowHighlights.values(),e=>void e.clear()),W(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ta(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e({layerLevel:n,...this.options});return t.set(n,i),i}function FF(t,e,n){return(e=Ite(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ite(t){var e=Nte(t,"string");return typeof e=="symbol"?e:e+""}function Nte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dte{constructor(e){FF(this,"ranges",[]),FF(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function Lte(t,e){Cz(t,e),e.add(t)}function v_(t,e,n){Cz(t,e),e.set(t,n)}function Cz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(t,e){return t.get(Jn(t,e))}function _w(t,e,n){return t.set(Jn(t,e),n),n}function Jn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mw=new WeakMap,sn=new WeakMap,Xs=new WeakMap,li=new WeakSet;class T1{constructor(e,n){Lte(this,li),v_(this,Mw,void 0),v_(this,sn,void 0),v_(this,Xs,{x:0,y:0}),_w(Mw,this,e),_w(sn,this,n)}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=At(sn,this).createCellCoords(e,n);let s=At(Mw,this).current().highlight;const a=At(sn,this).visualToRenderableCoords(s);let u=0,h=0;if(this.runLocalHooks("beforeTransformStart",r),a.row!==null&&a.col!==null){const{width:d,height:g}=Jn(li,this,Sz).call(this),{row:p,col:w}=Jn(li,this,WF).call(this,s),y=At(sn,this).fixedRowsBottom(),S=At(sn,this).minSpareRows(),_=At(sn,this).minSpareCols(),E=At(sn,this).autoWrapRow(),H=At(sn,this).autoWrapCol(),x=At(sn,this).createCellCoords(p+r.row,w+r.col);if(x.row>=g){const V=Wr(i&&S>0&&y===0),L=x.col+1,U=At(sn,this).createCellCoords(x.row-g,L>=d?L-d:L);this.runLocalHooks("beforeColumnWrap",V,Jn(li,this,Jh).call(this,U),L>=d),V.value?this.runLocalHooks("insertRowRequire",At(sn,this).countRenderableRows()):H&&x.assign(U)}else if(x.row<0){const V=Wr(H),L=x.col-1,U=At(sn,this).createCellCoords(g+x.row,L<0?d+L:L);this.runLocalHooks("beforeColumnWrap",V,Jn(li,this,Jh).call(this,U),L<0),H&&x.assign(U)}if(x.col>=d){const V=Wr(i&&_>0),L=x.row+1,U=At(sn,this).createCellCoords(L>=g?L-g:L,x.col-d);this.runLocalHooks("beforeRowWrap",V,Jn(li,this,Jh).call(this,U),L>=g),V.value?this.runLocalHooks("insertColRequire",At(sn,this).countRenderableColumns()):E&&x.assign(U)}else if(x.col<0){const V=Wr(E),L=x.row-1,U=At(sn,this).createCellCoords(L<0?g+L:L,d+x.col);this.runLocalHooks("beforeRowWrap",V,Jn(li,this,Jh).call(this,U),L<0),E&&x.assign(U)}const{rowDir:D,colDir:$}=Jn(li,this,BF).call(this,x);u=D,h=$,s=Jn(li,this,Jh).call(this,x)}return this.runLocalHooks("afterTransformStart",s,u,h),s}transformEnd(e,n){const i=At(sn,this).createCellCoords(e,n),r=At(Mw,this).current(),s=At(sn,this).visualToRenderableCoords(r.highlight),a=Jn(li,this,w_).call(this,r.to.row,r.from.row),u=Jn(li,this,y_).call(this,r.to.col,r.from.col),h=r.to.clone();let d=0,g=0;if(this.runLocalHooks("beforeTransformEnd",i),s.row!==null&&s.col!==null&&a!==null&&u!==null){const{row:p,col:w}=Jn(li,this,WF).call(this,r.highlight),y=At(sn,this).createCellCoords(a+i.row,u+i.col),S=r.getTopStartCorner(),_=r.getTopEndCorner(),E=r.getBottomEndCorner();if(i.col<0&&u>=w&&y.col<w){const $=y.col-w;y.col=Jn(li,this,y_).call(this,S.col,_.col)+$}else if(i.col>0&&u<=w&&y.col>w){const $=Jn(li,this,y_).call(this,_.col,S.col),V=Math.max(y.col-$,1);y.col=$+V}if(i.row<0&&a>=p&&y.row<p){const $=y.row-p;y.row=Jn(li,this,w_).call(this,S.row,E.row)+$}else if(i.row>0&&a<=p&&y.row>p){const $=Jn(li,this,w_).call(this,E.row,S.row),V=Math.max(y.row-$,1);y.row=$+V}const{rowDir:H,colDir:x}=Jn(li,this,BF).call(this,y);d=H,g=x;const D=Jn(li,this,Jh).call(this,y);i.row===0&&i.col!==0?h.col=D.col:i.row!==0&&i.col===0?h.row=D.row:(h.row=D.row,h.col=D.col)}return this.runLocalHooks("afterTransformEnd",h,d,g),h}setOffsetSize(e){let{x:n,y:i}=e;_w(Xs,this,{x:n,y:i})}resetOffsetSize(){_w(Xs,this,{x:0,y:0})}}function BF(t){const{width:e,height:n}=Jn(li,this,Sz).call(this);let i=0,r=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(r=-1,t.col=0):t.col>0&&t.col>=e&&(r=1,t.col=e-1),{rowDir:i,colDir:r}}function Sz(){return{width:At(Xs,this).x+At(sn,this).countRenderableColumns(),height:At(Xs,this).y+At(sn,this).countRenderableRows()}}function w_(t,e){const n=At(sn,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:At(Xs,this).y+n}function y_(t,e){const n=At(sn,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:At(Xs,this).x+n}function WF(t){const{row:e,col:n}=At(sn,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return At(sn,this).createCellCoords(At(Xs,this).y+e,At(Xs,this).x+n)}function Jh(t){const e=t.clone();return e.col=t.col-At(Xs,this).x,e.row=t.row-At(Xs,this).y,At(sn,this).renderableToVisualCoords(e)}Yt(T1,Ai);const PS=0,IS=1,bz=2,Yx=3,kte=[Yx,bz],Vte=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],C_=Symbol("root"),UF=Symbol("child");function nf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C_;if(e!==C_&&e!==UF)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===C_;let r=PS;if(n){const s=t[0];t.length===0?r=IS:i&&s instanceof Op?r=Yx:i&&Array.isArray(s)?r=nf(s,UF):t.length>=2&&t.length<=4&&!t.some((u,h)=>!Vte[h].includes(typeof u))&&(r=bz)}return r}function ip(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!kte.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const a=t===Yx;let u=a?s.from.row:s[0],h=a?s.from.col:s[1],d=a?s.to.row:s[2],g=a?s.to.col:s[3];if(typeof r=="function"&&(typeof h=="string"&&(h=r(h)),typeof g=="string"&&(g=r(g))),vn(d)&&(d=u),vn(g)&&(g=h),!i){const y=u,S=h,_=d,E=g;u=Math.min(y,_),h=Math.min(S,E),d=Math.max(y,_),g=Math.max(S,E)}const p=e(u,h),w=e(d,g);return n(p,p,w)}}function $te(t){const e=nf(t.getSelected());if(e===PS||e===IS)return[];const n=ip(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;W(t.getSelected(),a=>{const{from:u,to:h}=n(a),d=Math.max(u.col,0),g=h.col-d+1;W(Array.from(new Array(g),(p,w)=>d+w),p=>{i.has(p)||i.add(p)})});const r=Array.from(i).sort((a,u)=>a-u);return Sr(r,(a,u,h,d)=>(h!==0&&u===d[h-1]+1?a[a.length-1][1]+=1:a.push([u,1]),a),[])}function Fte(t){const e=nf(t.getSelected());if(e===PS||e===IS)return[];const n=ip(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;W(t.getSelected(),a=>{const{from:u,to:h}=n(a),d=Math.max(u.row,0),g=h.row-d+1;W(Array.from(new Array(g),(p,w)=>d+w),p=>{i.has(p)||i.add(p)})});const r=Array.from(i).sort((a,u)=>a-u);return Sr(r,(a,u,h,d)=>(h!==0&&u===d[h-1]+1?a[a.length-1][1]+=1:a.push([u,1]),a),[])}function ed(t,e,n){Bte(t,e),e.set(t,n)}function Bte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ku(t,e,n){return(e=Wte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wte(t){var e=Ute(t,"string");return typeof e=="symbol"?e:e+""}function Ute(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function an(t,e){return t.get(Rz(t,e))}function wo(t,e,n){return t.set(Rz(t,e),n),n}function Rz(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pi=new WeakMap,Xu=new WeakMap,Ow=new WeakMap,Bg=new WeakMap,Aw=new WeakMap,Wg=new WeakMap;class Ez{constructor(e,n){var i=this;Ku(this,"settings",void 0),Ku(this,"tableProps",void 0),Ku(this,"inProgress",!1),Ku(this,"selectedRange",new Dte((r,s,a)=>this.tableProps.createCellRange(r,s,a))),Ku(this,"highlight",void 0),ed(this,Pi,void 0),ed(this,Xu,void 0),Ku(this,"selectedByRowHeader",new Set),Ku(this,"selectedByColumnHeader",new Set),ed(this,Ow,!1),ed(this,Bg,!1),ed(this,Aw,"unknown"),ed(this,Wg,-1),this.settings=e,this.tableProps=n,this.highlight=new Pte({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[UO()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,s)=>this.tableProps.isDisabledCellSelection(r,s),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,s)=>this.tableProps.createCellCoords(r,s),createCellRange:(r,s,a)=>this.tableProps.createCellRange(r,s,a)}),wo(Pi,this,new T1(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,s)=>this.tableProps.createCellCoords(r,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),wo(Xu,this,new T1(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,r.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,r.getOuterBottomEndCorner().col)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,s)=>this.tableProps.createCellCoords(r,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),an(Pi,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformStart",...s)}),an(Pi,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.runLocalHooks("afterModifyTransformStart",...s)}),an(Pi,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformEnd",...s)}),an(Pi,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.runLocalHooks("afterModifyTransformEnd",...s)}),an(Pi,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.runLocalHooks("insertRowRequire",...s)}),an(Pi,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.runLocalHooks("insertColRequire",...s)}),an(Pi,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.runLocalHooks("beforeRowWrap",...s)}),an(Pi,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.runLocalHooks("beforeColumnWrap",...s)}),an(Xu,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformFocus",...s)}),an(Xu,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){wo(Aw,this,e)}markEndSource(){wo(Aw,this,"unknown")}getSelectionSource(){return an(Aw,this)}setExpectedLayers(e){wo(Wg,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,wo(Wg,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",a=vn(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,u=e.clone();wo(Ow,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,u),(!s||s&&!a&&vn(n))&&this.selectedRange.clear(),this.selectedRange.add(u).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||r>0)&&(i===0&&n.col<0&&!s||r===0&&n.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const a=this.selectedRange.current();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const h=a.getHorizontalDirection(),d=a.getVerticalDirection(),g=this.isMultiple();a.setTo(n),g&&(h!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),g&&(d!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const u=an(Wg,this)===-1||this.selectedRange.size()===an(Wg,this);this.runLocalHooks("afterSetRangeEnd",e,u)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();n<this.highlight.layerLevel&&(W(this.highlight.getAreas(),S=>void S.clear()),W(this.highlight.getLayeredAreas(),S=>void S.clear()),W(this.highlight.getRowHeaders(),S=>void S.clear()),W(this.highlight.getColumnHeaders(),S=>void S.clear()),W(this.highlight.getActiveRowHeaders(),S=>void S.clear()),W(this.highlight.getActiveColumnHeaders(),S=>void S.clear()),W(this.highlight.getActiveCornerHeaders(),S=>void S.clear()),W(this.highlight.getRowHighlights(),S=>void S.clear()),W(this.highlight.getColumnHighlights(),S=>void S.clear())),this.highlight.useLayerLevel(n);const s=this.highlight.createArea(),a=this.highlight.createLayeredArea(),u=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),p=this.highlight.createActiveCornerHeader(),w=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();if(s.clear(),a.clear(),u.clear(),h.clear(),d.clear(),g.clear(),p.clear(),w.clear(),y.clear(),this.highlight.isEnabledFor(lA,e.highlight)&&(this.isMultiple()||n>=1)&&(s.add(e.from).add(e.to).commit(),a.add(e.from).add(e.to).commit(),n===1)){const S=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(S.from).commit().syncWith(S),this.highlight.createLayeredArea().add(S.from).commit().syncWith(S),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(aA,e.highlight)){if(!e.isSingleHeader()){const E=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),H=this.tableProps.createCellCoords(e.to.row,-1),x=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),D=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(u.add(E).commit(),h.add(x).commit(),w.add(E).commit(),y.add(x).commit()):(u.add(E).add(H).commit(),h.add(x).add(D).commit(),w.add(E).add(H).commit(),y.add(x).add(D).commit())}const S=!an(Bg,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),_=!an(Bg,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());S&&d.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),_&&g.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),S&&_&&p.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(yC,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(wo(Ow,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?an(Pi,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):an(Pi,this).resetOffsetSize(),this.setRangeStart(an(Pi,this).transformStart(e,n,i))}transformEnd(e,n){this.settings.navigableHeaders?an(Pi,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):an(Pi,this).resetOffsetSize(),this.setRangeEnd(an(Pi,this).transformEnd(e,n))}transformFocus(e,n){const i=this.selectedRange.current(),{row:r,col:s}=i.getOuterTopStartCorner(),a=this.tableProps.countRenderableColumnsInRange(0,s-1),u=this.tableProps.countRenderableRowsInRange(0,r-1);i.highlight.isHeader()?an(Xu,this).setOffsetSize({x:s<0?Math.abs(s):-a,y:r<0?Math.abs(r):-u}):an(Xu,this).setOffsetSize({x:s<0?0:-a,y:r<0?0:-u});const h=an(Xu,this).transformStart(e,n);this.setRangeFocus(h.normalize())}shiftRows(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:s,highlight:a}=i,u=this.tableProps.countRows(),h=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),g=d?-1:0,p=d?0:n;this.getSelectedRange().pop();const w=this.tableProps.createCellCoords(_t(r.row+p,g,u-1),r.col),y=this.tableProps.createCellCoords(_t(s.row+n,g,u-1),s.col);this.markSource("shift"),a.row>=e?this.setRangeStartOnly(w,!0,this.tableProps.createCellCoords(_t(a.row+n,0,u-1),a.col)):this.setRangeStartOnly(w,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:s,highlight:a}=i,u=this.tableProps.countCols(),h=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),g=h?-1:0,p=h?0:n;this.getSelectedRange().pop();const w=this.tableProps.createCellCoords(r.row,_t(r.col+p,g,u-1)),y=this.tableProps.createCellCoords(s.row,_t(s.col+n,g,u-1));this.markSource("shift"),a.col>=e?this.setRangeStartOnly(w,!0,this.tableProps.createCellCoords(a.row,_t(a.col+n,0,u-1))):this.setRangeStartOnly(w,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Wr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&an(Ow,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{col:s}=r.getOuterTopStartCorner(),a=this.tableProps.countRowHeaders(),u=this.tableProps.countCols();return(a>0&&s<0||a===0)&&r.getWidth()===u};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{row:s}=r.getOuterTopStartCorner(),a=this.tableProps.countColHeaders(),u=this.tableProps.countRows();return(a>0&&s<0||a===0)&&r.getHeight()===u};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),a=this.tableProps.countCols(),u=this.tableProps.countRowHeaders(),h=this.tableProps.countColHeaders(),d=i?-h:0,g=n?-u:0;if(d===0&&g===0&&(s===0||a===0))return;let p=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:w,disableHeadersHighlight:y}=r;wo(Bg,this,y),w&&Number.isInteger(w==null?void 0:w.row)&&Number.isInteger(w==null?void 0:w.col)&&(p=this.tableProps.createCellCoords(_t(w.row,d,s-1),_t(w.col,g,a-1)));const S=this.tableProps.createCellCoords(d,g),_=this.tableProps.createCellCoords(s-1,a-1);this.clear(),this.setRangeStartOnly(S,void 0,p),g<0&&this.selectedByRowHeader.add(this.getLayerLevel()),d<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(_),this.finish(),wo(Bg,this,!1)}selectCells(e){var n=this;const i=nf(e);if(i===IS)return!1;if(i===PS)throw new Error($t`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=ip(i,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:h=>this.tableProps.propToCol(h),keepDirection:!0}),s=this.settings.navigableHeaders,a={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},u=!e.some(h=>{const d=r(h),g=d.isValid(a);return!(g&&!d.containsHeaders()||g&&d.containsHeaders()&&d.isSingleHeader())});return u&&(this.clear(),this.setExpectedLayers(e.length),W(e,h=>{const{from:d,to:g}=r(h);this.setRangeStartOnly(d.clone(),!1),this.setRangeEnd(g.clone())}),this.finish()),u}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof n=="string"?this.tableProps.propToCol(n):n,a=this.tableProps.countRows(),u=this.tableProps.countCols(),h=this.tableProps.countColHeaders(),d=h===0?0:-h,g=this.tableProps.createCellCoords(d,r),p=this.tableProps.createCellCoords(a-1,s),w=this.tableProps.createCellRange(g,g,p).isValid({countRows:a,countCols:u,countRowHeaders:0,countColHeaders:h});if(w){let y=0,S=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(y=_t(i.row,d,a-1),S=_t(i.col,Math.min(r,s),Math.max(r,s))):(y=_t(i,d,a-1),S=r);const _=this.tableProps.createCellCoords(y,S),E=h===0?0:_t(_.row,d,-1),H=a-1,x=this.tableProps.createCellCoords(E,r),D=this.tableProps.createCellCoords(H,s);this.runLocalHooks("beforeSelectColumns",x,D,_),x.row=E,D.row=H,this.setRangeStartOnly(x,void 0,_),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(D),this.runLocalHooks("afterSelectColumns",x,D,_),this.finish()}return w}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),u=a===0?0:-a,h=this.tableProps.createCellCoords(e,u),d=this.tableProps.createCellCoords(n,s-1),g=this.tableProps.createCellRange(h,h,d).isValid({countRows:r,countCols:s,countRowHeaders:a,countColHeaders:0});if(g){let p=0,w=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(p=_t(i.row,Math.min(e,n),Math.max(e,n)),w=_t(i.col,u,s-1)):(p=e,w=_t(i,u,s-1));const y=this.tableProps.createCellCoords(p,w),S=a===0?0:_t(y.col,u,-1),_=s-1,E=this.tableProps.createCellCoords(e,S),H=this.tableProps.createCellCoords(n,_);this.runLocalHooks("beforeSelectRows",E,H,y),E.col=S,H.col=_,this.setRangeStartOnly(E,void 0,y),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(H),this.runLocalHooks("afterSelectRows",E,H,y),this.finish()}return g}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:r,to:s,highlight:a}=i;this.clear(),a.assign({row:_t(a.row,-1/0,e-1),col:_t(a.col,-1/0,n-1)}),r.assign({row:_t(r.row,-1/0,e-1),col:_t(r.col,-1/0,n-1)}),s.assign({row:_t(s.row,0,e-1),col:_t(s.col,0,n-1)}),this.selectedRange.ranges.push(i),this.highlight.getFocus().add(a).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),i=this.selectedRange.current();this.highlight.isEnabledFor(yC,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),a=this.highlight.createLayeredArea(),u=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),p=this.highlight.createActiveCornerHeader(),w=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();s.commit(),a.commit(),u.commit(),h.commit(),d.commit(),g.commit(),p.commit(),w.commit(),y.commit()}this.highlight.useLayerLevel(n)}}Yt(Ez,Ai);const jF=/^(\r\n|\n\r|\r|\n)/,jte=/^[^\t\r\n]+/,zF=/^\t/;function zte(t){const e=[[""]];if(t.length===0)return e;let n=0,i=0,r;for(;t.length>0&&r!==t.length;)if(r=t.length,t.match(zF))t=t.replace(zF,""),n+=1,e[i][n]="";else if(t.match(jF))t=t.replace(jF,""),n=0,i+=1,e[i]=[""];else{let s="";if(t.startsWith('"')){let a=0,u=!0;for(;u;){const h=t.slice(0,1);h==='"'&&(a+=1),s+=h,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&a%2===0)&&(u=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,h=>new Array(Math.floor(h.length/2)).fill('"').join(""))}else{const a=t.match(jte);s=a?a[0]:"",t=t.slice(s.length)}e[i][n]=s}return e}function Nm(t){let e,n,i,r,s="",a;for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,i=0;i<r;i+=1)i>0&&(s+="	"),a=t[e][i],typeof a=="string"?a.indexOf(`
`)>-1?s+=`"${a.replace(/"/g,'""')}"`:s+=a:a==null?s+="":s+=a;e!==n-1&&(s+=`
`)}return s}function Zu(t,e,n){return(e=Yte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yte(t){var e=Gte(t,"string");return typeof e=="symbol"?e:e+""}function Gte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vd{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,i){Zu(this,"hot",void 0),Zu(this,"metaManager",void 0),Zu(this,"tableMeta",void 0),Zu(this,"dataSource",void 0),Zu(this,"duckSchema",void 0),Zu(this,"colToPropCache",void 0),Zu(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,n){let r=0,s=0,a=!1;if(typeof n=="function"){const u=KO(e);r=u>0?u:this.countFirstRowKeys(),a=!0}else{const u=this.tableMeta.maxCols;r=Math.min(u,n.length)}for(i=0;i<r;i++){const u=a?n(i):n[i];if(ht(u)){if(typeof u.data<"u"){const h=a?s:i;this.colToPropCache[h]=u.data,this.propToColCache.set(u.data,h)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return oz(this.dataSource)}recursiveDuckColumns(e,n,i){let r=n,s=i,a;return typeof r>"u"&&(r=0,s=""),typeof e=="object"&&!Array.isArray(e)&&dt(e,(u,h)=>{u===null?(a=s+h,this.colToPropCache.push(a),this.propToColCache.set(a,r),r+=1):r=this.recursiveDuckColumns(u,r,`${h}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&Pe(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(Pe(n))return this.hot.toVisualColumn(n);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ep(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let a=s,u=0,h=e;if((typeof h!="number"||h>=s)&&(h=s),h<this.hot.countRows()&&(a=this.hot.toPhysicalRow(h)),this.hot.runHooks("beforeCreateRow",h,n,i)===!1||a===null)return{delta:0};const g=this.tableMeta.maxRows,p=this.getSchema().length,w=[];for(;u<n&&s+u<g;){let S=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?S=tr(this.getSchema()):(S=[],ke(p-1,()=>S.push(null))):this.hot.dataType==="function"?S=this.tableMeta.dataSchema(h+u):(S={},RS(S,this.getSchema())),w.push(S),u+=1}this.hot.rowIndexMapper.insertIndexes(h,u),r==="below"&&(a=Math.min(a+1,s)),this.spliceData(a,0,w);const y=this.hot.toVisualRow(a);return this.hot.countSourceRows()===w.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),u>0&&(e==null?this.metaManager.createRow(null,u):i!=="auto"&&this.metaManager.createRow(a,n)),this.hot.runHooks("afterCreateRow",y,u,i),this.hot.forceFullRender=!0,{delta:u,startPhysicalIndex:a}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,a=this.tableMeta.maxCols,u=this.hot.countSourceCols();let h=e;if((typeof h!="number"||h>=u)&&(h=u),this.hot.runHooks("beforeCreateCol",h,n,i)===!1)return{delta:0};let g=u;h<this.hot.countCols()&&(g=this.hot.toPhysicalColumn(h));const p=this.hot.countSourceRows();let w=this.hot.countCols(),y=0,S=g;r==="end"&&(S=Math.min(S+1,u));const _=S;for(;y<n&&w<a;){if(typeof h!="number"||h>=w)if(p>0)for(let H=0;H<p;H+=1)typeof s[H]>"u"&&(s[H]=[]),s[H].push(null);else s.push([null]);else for(let H=0;H<p;H++)s[H].splice(S,0,null);y+=1,S+=1,w+=1}this.hot.columnIndexMapper.insertIndexes(h,y),y>0&&(e==null?this.metaManager.createColumn(null,y):i!=="auto"&&this.metaManager.createColumn(_,n));const E=this.hot.toVisualColumn(_);return this.hot.runHooks("afterCreateCol",E,y,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:y,startPhysicalIndex:_}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-n;const s=this.visualRowsToPhysical(r,n),a=this.hot.countSourceRows();if(r=(a+r)%a,this.hot.runHooks("beforeRemoveRow",r,s.length,s,i)===!1)return!1;const h=s.length;if(this.filterData(r,h,s),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const g=Pe(this.tableMeta.columns)||Pe(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&g===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((g,p)=>p-g).forEach(g=>{this.metaManager.removeRow(g,1)}),this.hot.runHooks("afterRemoveRow",r,h,s,i),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-n:e;r=(this.hot.countCols()+r)%this.hot.countCols();const s=this.visualColumnsToPhysical(r,n),a=s.slice(0).sort((p,w)=>w-p);if(this.hot.runHooks("beforeRemoveCol",r,n,s,i)===!1)return!1;let h=!0;const d=a.length,g=this.dataSource;for(let p=0;p<d;p++)h&&s[0]!==s[p]-p&&(h=!1);if(h)for(let p=0,w=this.hot.countSourceRows();p<w;p++)g[p].splice(s[0],n),p===0&&this.metaManager.removeColumn(s[0],n);else for(let p=0,w=this.hot.countSourceRows();p<w;p++)for(let y=0;y<d;y++)g[p].splice(a[y],1),p===0&&this.metaManager.removeColumn(a[y],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,n,s,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,i){const r=this.hot.getDataAtCol(e),s=r.slice(n,n+i),a=r.slice(n+i);for(var u=arguments.length,h=new Array(u>3?u-3:0),d=3;d<u;d++)h[d-3]=arguments[d];ZV(h,a);let g=0;for(;g<i;)h.push(null),g+=1;return d7(h),this.hot.populateFromArray(n,e,h,null,null,"spliceCol"),s}spliceRow(e,n,i){const r=this.hot.getSourceDataAtRow(e),s=r.slice(n,n+i),a=r.slice(n+i);for(var u=arguments.length,h=new Array(u>3?u-3:0),d=3;d<u;d++)h[d-3]=arguments[d];ZV(h,a);let g=0;for(;g<i;)h.push(null),g+=1;return this.hot.populateFromArray(e,n,[h],null,null,"spliceRow"),s}spliceData(e,n,i){if(this.hot.runHooks("beforeDataSplice",e,n,i)!==!1){const s=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(a=>this.dataSource.push(a))}}filterData(e,n,i){let r=this.hot.runHooks("filterData",e,n,i);Array.isArray(r)===!1&&(r=this.dataSource.filter((s,a)=>i.indexOf(a)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,n){const i=this.hot.toPhysicalRow(e);let r=this.dataSource[i];const s=this.hot.runHooks("modifyRowData",i);r=isNaN(s)?s:r;const{dataDotNotation:a}=this.hot.getSettings();let u=null;if(r&&r.hasOwnProperty&&ei(r,n))u=r[n];else if(a&&typeof n=="string"&&n.indexOf(".")>-1){let h=r;if(!h)return null;const d=n.split(".");for(let g=0,p=d.length;g<p;g++)if(h=h[d[g]],typeof h>"u")return null;u=h}else typeof n=="function"&&(u=n(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const h=Wr(u);this.hot.runHooks("modifyData",i,this.propToCol(n),h,"get"),h.isTouched()&&(u=h.value)}return u}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,i){const r=this.hot.toPhysicalRow(e);let s=i,a=this.dataSource[r];const u=this.hot.runHooks("modifyRowData",r);if(a=isNaN(u)?u:a,this.hot.hasHook("modifyData")){const d=Wr(s);this.hot.runHooks("modifyData",r,this.propToCol(n),d,"set"),d.isTouched()&&(s=d.value)}const{dataDotNotation:h}=this.hot.getSettings();if(a&&a.hasOwnProperty&&ei(a,n))a[n]=s;else if(h&&typeof n=="string"&&n.indexOf(".")>-1){let d=a,g=0,p;const w=n.split(".");for(g=0,p=w.length-1;g<p;g++){if(w[g]==="__proto__"||w[g]==="constructor"||w[g]==="prototype")return;typeof d[w[g]]>"u"&&(d[w[g]]={}),d=d[w[g]]}d[w[g]]=s}else if(typeof n=="function")n(this.dataSource.slice(r,r+1)[0],s);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;a[n]=s}}visualRowsToPhysical(e,n){const i=this.hot.countSourceRows(),r=[];let s=(i+e)%i,a=n,u;for(;s<i&&a;)u=this.hot.toPhysicalRow(s),r.push(u),a-=1,s+=1;return r}visualColumnsToPhysical(e,n){const i=this.hot.countCols(),r=[];let s=(i+e)%i,a=n;for(;s<i&&a;){const u=this.hot.toPhysicalColumn(s);r.push(u),a-=1,s+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Vd.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,i){const r=[];let s,a,u;const h=this.tableMeta.maxRows,d=this.tableMeta.maxCols;if(h===0||d===0)return[];const g=i===Vd.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,p=Math.min(Math.max(h-1,0),Math.max(e.row,n.row)),w=Math.min(Math.max(d-1,0),Math.max(e.col,n.col));for(s=Math.min(e.row,n.row);s<=p;s++){u=[];const y=s>=0?this.hot.toPhysicalRow(s):s;for(a=Math.min(e.col,n.col);a<=w&&y!==null;a++)u.push(g.call(this,s,this.colToProp(a)));y!==null&&r.push(u)}return r}getText(e,n){return Nm(this.getRange(e,n,Vd.DESTINATION_RENDERER))}getCopyableText(e,n){return Nm(this.getRange(e,n,Vd.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:qte,getItem:Kte,hasItem:Tz,getNames:$Se,getValues:FSe}=oo("cellTypes");function Xte(t){if(!Tz(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Kte(t)}function $s(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:i,validator:r}=e;n&&Dr(t,n),i&&hs(t,i),r&&xd(t,r),qte(t,e)}function Zte(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!ei(e,t)}function NS(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?Xte(e.type):e.type;if(t._automaticallyAssignedMetaProps&&dt(e,(s,a)=>void t._automaticallyAssignedMetaProps.delete(a)),!ht(i))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const r={};dt(i,(s,a)=>{if(Zte(a,n)){var u;r[a]=s,(u=t._automaticallyAssignedMetaProps)===null||u===void 0||u.add(a)}}),ti(t,r)}function Qte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}sX(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}function Yy(t){return Number.isInteger(t)&&t>=0}function Gy(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function xw(t){return t==null}const _z=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),Vn(i)===!1)return!1;return!0},isEmptyRow(t){let e,n,i,r;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),Vn(i)===!1)return typeof i=="object"?(r=this.getCellMeta(t,e),qO(this.getSchema()[r.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function YF(t,e,n){return(e=Jte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jte(t){var e=ene(t,"string");return typeof e=="symbol"?e:e+""}function ene(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tne(){return class{}}class nne{constructor(e){YF(this,"metaCtor",tne()),YF(this,"meta",void 0),this.meta=this.metaCtor.prototype,ti(this.meta,_z()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;ti(this.meta,e),NS(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function ine(t,e,n){return(e=rne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rne(t){var e=sne(t,"string");return typeof e=="symbol"?e:e+""}function sne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class one{constructor(e){ine(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){ti(this.meta,e),NS(this.meta,e,e)}}function Hw(t,e,n){return(e=ane(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ane(t){var e=lne(t,"string");return typeof e=="symbol"?e:e+""}function lne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bC{constructor(e){Hw(this,"valueFactory",void 0),Hw(this,"data",[]),Hw(this,"index",[]),Hw(this,"holes",new Set),this.valueFactory=e}obtain(e){Gy(()=>Yy(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let i;if(n>=0)i=this.data[n],i===void 0&&(i=this.valueFactory(e),this.data[n]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Gy(()=>Yy(e)||xw(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let a=0;a<n;a++)i.push(r+a),this.data.push(void 0);const s=xw(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...i,...this.index.slice(s)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Gy(()=>Yy(e)||xw(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(xw(e)?this.index.length-n:e,n);for(let r=0;r<i.length;r++){const s=i[r];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&this.data[i]!==void 0&&e.push([r,this.data[i]])}let n=0;return{next:()=>{if(n<e.length){const i=e[n];return n+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function GF(t,e,n){return(e=une(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function une(t){var e=cne(t,"string");return typeof e=="symbol"?e:e+""}function cne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const hne=["data","width"];class dne{constructor(e){GF(this,"globalMeta",void 0),GF(this,"metas",new bC(()=>this._createMeta())),this.globalMeta=e,this.metas=new bC(()=>this._createMeta())}updateMeta(e,n){const i=this.getMeta(e);ti(i,n),NS(i,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Qte(this.globalMeta.getMetaConstructor(),hne).prototype}}function qF(t,e,n){return(e=fne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fne(t){var e=gne(t,"string");return typeof e=="symbol"?e:e+""}function gne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mne{constructor(e){qF(this,"columnMeta",void 0),qF(this,"metas",new bC(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,i){const r=this.getMeta(e,n);ti(r,i),NS(r,i)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}getMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);return i===void 0?r:r[i]}setMeta(e,n,i,r){var s;const a=this.metas.obtain(e).obtain(n);(s=a._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(i),a[i]=r}removeMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);delete r[i]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let i=0;i<n.length;i++)Pe(n[i])&&e.push(...n[i].values());return e}getMetasAtRow(e){Gy(()=>Yy(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new bC(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class Mz{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new nne(e),this.tableMeta=new one(this.globalMeta),this.columnMeta=new dne(this.globalMeta),this.cellMeta=new mne(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,i){let{visualRow:r,visualColumn:s}=i;const a=this.cellMeta.getMeta(e,n);return a.visualRow=r,a.visualCol=s,a.row=e,a.col=n,this.runLocalHooks("afterGetCellMeta",a),a}getCellMetaKeyValue(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}setCellMeta(e,n,i,r){this.cellMeta.setMeta(e,n,i,r)}updateCellMeta(e,n,i){this.cellMeta.updateMeta(e,n,i)}removeCellMeta(e,n,i){this.cellMeta.removeMeta(e,n,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Yt(Mz,Ai);function KF(t,e,n,i){const{hotInstance:r,dataMap:s,dataSource:a,internalSource:u,source:h,metaManager:d,firstRun:g}=i,p=eo(u),w=r.getSettings();Array.isArray(w.dataSchema)?r.dataType="array":on(w.dataSchema)?r.dataType="function":r.dataType="object",s&&s.destroy(),t=r.runHooks(`before${p}`,t,g,h);const y=new Vd(r,t,d);if(e(y),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const S=y.getSchema();t=[];let _,E=0,H=0;for(E=0,H=w.startRows;E<H;E++)if((r.dataType==="object"||r.dataType==="function")&&w.dataSchema)_=tr(S),t.push(_);else if(r.dataType==="array")_=tr(S[0]),t.push(_);else{_=[];for(let x=0,D=w.startCols;x<D;x++)_.push(null);t.push(_)}}else throw new Error(`${u} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(r.dataType="array"),w.data=t,y.dataSource=t,a.data=t,a.dataType=r.dataType,a.colToProp=y.colToProp.bind(y),a.propToCol=y.propToCol.bind(y),a.countCachedColumns=y.countCachedColumns.bind(y),n(y),r.runHooks(`after${p}`,t,g,h),g||(r.runHooks("afterChange",null,u),r.render()),r.getSettings().ariaTags&&Ge(r.rootElement,[o2(-1),CS(r.countCols()+(r.view?r.countRowHeaders():0))])}function XF(t,e,n){return(e=pne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pne(t){var e=vne(t,"string");return typeof e=="symbol"?e:e+""}function vne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wne{constructor(e){XF(this,"metaManager",void 0),XF(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),Ae.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:i,col:r}=e;if((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(r))return;const{visualRow:s,visualCol:a}=e,u=this.metaManager.hot,h=u.colToProp(a);e.prop=h,u.runHooks("beforeGetCellMeta",s,a,e);const d=ei(e,"type")?e.type:null;let g=on(e.cells)?e.cells(i,r,h):null;if(d)if(g){var p;g.type=(p=g.type)!==null&&p!==void 0?p:d}else g={type:d};g&&this.metaManager.updateCellMeta(i,r,g),u.runHooks("afterGetCellMeta",s,a,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}}function yne(t,e,n){Cne(t,e),e.set(t,n)}function Cne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S_(t,e,n){return(e=Sne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sne(t){var e=bne(t,"string");return typeof e=="symbol"?e:e+""}function bne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rne(t,e){return t.get(Ene(t,e))}function Ene(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ZF=new WeakMap;class Tne{constructor(e){S_(this,"metaManager",void 0),S_(this,"usageTracker",new Set),S_(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),yne(this,ZF,(n,i,r)=>{if(!r)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:i,target:r,onChange:s}=e,a=typeof r=="string",u=a?r:n,h=`_${u}`;this.metaManager.globalMeta.meta[h]=this.metaManager.globalMeta.meta[u],s?(this.installPropWatcher(n,h,s),a&&this.installPropWatcher(r,h,s)):i&&(this.installPropWatcher(n,h,Rne(ZF,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(s){const a=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,s,a),this[n]=s},enumerable:!0,configurable:!0})}}const Oz="gridDefault",Cu="editorManager.handlingEditor",_ne={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},Mne="hooksRefRegisterer",Az={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){W(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){dt(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ol(Az,"MIXIN_NAME",Mne,{writable:!1,enumerable:!1});function Ns(t,e,n){return(e=One(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function One(t){var e=Ane(t,"string");return typeof e=="symbol"?e:e+""}function Ane(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xne="base",Ln=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Cf{static get EDITOR_TYPE(){return xne}constructor(e){Ns(this,"hot",void 0),Ns(this,"state",Ln.VIRGIN),Ns(this,"_opened",!1),Ns(this,"_fullEditMode",!1),Ns(this,"_closeCallback",null),Ns(this,"TD",null),Ns(this,"row",null),Ns(this,"col",null),Ns(this,"prop",null),Ns(this,"originalValue",null),Ns(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,i,r,s,a){this.TD=r,this.row=e,this.col=n,this.prop=i,this.originalValue=s,this.cellProperties=a,this.state=this.isOpened()?this.state:Ln.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let i,r,s,a;if(n){const h=this.hot.getSelectedLast();i=Math.max(Math.min(h[0],h[2]),0),r=Math.max(Math.min(h[1],h[3]),0),s=Math.max(h[0],h[2]),a=Math.max(h[1],h[3])}else[i,r,s,a]=[this.row,this.col,null,null];const u=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");Array.isArray(u)&&([i,r]=u),this.hot.populateFromArray(i,r,e,s,a,"edit")}beginEditing(e,n){if(this.state!==Ln.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),a=()=>{if(this.state=Ln.EDITING,this.isInFullEditMode()){const h=typeof e=="string"?e:zn(this.originalValue);this.setValue(h)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",a),i.view.scrollViewport(i._createCellCoords(r,s))||(this.hot.removeHook("afterScroll",a),a())}finishEditing(e,n,i){let r;if(i){const s=this._closeCallback;this._closeCallback=a=>{s&&s(a),i(a),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Ln.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Ln.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:r=[[s]],this.state=Ln.WAITING,this.saveValue(r,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=Ln.FINISHED,this.discardEditor(a)}):(this.state=Ln.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Ln.FINISHED,this.discardEditor()}discardEditor(e){this.state===Ln.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Ln.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Ln.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Ln.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,s=this.hot.rootWindow,a=Ci(n),u=jn(n),h=Ci(this.hot.rootElement),d=jn(this.hot.rootElement),g=i.topOverlay.holder,p=i.inlineStartOverlay.holder,w=g!==s?g.scrollTop:0,y=p!==s?p.scrollLeft:0,S=s.innerWidth-h.left-d,{wtTable:_}=(e=i.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,E=_.name,H=["master","inline_start"].includes(E)?w:0,x=["master","top","bottom"].includes(E)?y:0,D=a.top===h.top?0:1;let $=a.top-h.top-D-H,V=0;this.hot.isRtl()?V=s.innerWidth-a.left-u-S-1+x:V=a.left-h.left-1-x,["top","top_inline_start_corner"].includes(E)&&($+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(E)&&(V+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const L=this.hot.hasColHeaders(),U=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),re=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Q=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(L&&U<=0||U===Q)&&($+=1),re<=0&&(V+=1);const de=r.rowsRenderCalculator.startPosition,me=r.columnsRenderCalculator.startPosition,_e=Math.abs(i.inlineStartOverlay.getScrollPosition()),Ee=i.topOverlay.getScrollPosition(),Te=Mi(this.hot.rootDocument);let ve=n.offsetTop;if(["inline_start","master"].includes(E)&&(ve+=de-Ee),["bottom","bottom_inline_start_corner"].includes(E)){const{wtViewport:ae,wtTable:be}=i.bottomOverlay.clone;ve+=ae.getWorkspaceHeight()-be.getHeight()-Te}let Ce=n.offsetLeft;this.hot.isRtl()?(Ce>=0?Ce=_.getWidth()-n.offsetLeft:Ce=Math.abs(Ce),Ce+=me-_e-u):["top","master","bottom"].includes(E)&&(Ce+=me-_e);const Re=s.getComputedStyle(this.TD),qe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",F=parseInt(Re[qe],10)>0?0:1,C=parseInt(Re.borderTopWidth,10)>0?0:1,R=jn(n)+F,T=$n(n)+C,A=Q7(g)?Te:0,k=J7(p)?Te:0,z=this.hot.view.maximumVisibleElementWidth(Ce)-A+F,le=Math.max(this.hot.view.maximumVisibleElementHeight(ve)-k+C,this.hot.view.getDefaultRowHeight());return{top:$,start:V,height:T,maxHeight:le,width:R,maxWidth:z}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}Yt(Cf,Az);const Hne={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),r=i.getActiveEditor();r.isInFullEditMode()&&r.state===Ln.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},Pne={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},Ine={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Nne={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Dne={name:"editorOpen",callback(t,e,n){const i=t._getEditorManager(),r=t.getSelectedRangeLast(),{highlight:s}=r;if(t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const a=t.getSettings(),u=typeof a.enterMoves=="function"?a.enterMoves(e):a.enterMoves;n.includes("shift")?t.selection.transformFocus(-u.row,-u.col):t.selection.transformFocus(u.row,u.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),so(e))}};function Lne(){return[_ne,Hne,Pne,Ine,Nne,Dne]}const kne={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},Vne={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),i=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(i!==null){const r=t._createCellCoords(i,e.col),s=e.row-t.getFirstFullyVisibleRow(),a=Math.min(r.row-s,t.countRows()-1);t.selection.setRangeEnd(r),t.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}},$ne={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},Fne={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},Bne={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,i.col,e)}},Wne={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),a=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(t.countRows()-1,-1),h=r.clone();h.row=i.row,e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(u,s.col))}}},Une={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const a=n.getNearestNotHiddenIndex(t.countCols()-1,-1),u=r.clone();u.col=i.col,e.setRangeStart(u,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},jne={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const a=parseInt(t.getSettings().fixedColumnsStart,10),u=n.getNearestNotHiddenIndex(a,1),h=r.clone();h.col=i.col,e.setRangeStart(h,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(s.row,u))}}},zne={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),a=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),h=r.clone();h.col=i.col,e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,u))}}},Yne={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),a=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),h=r.clone();h.col=i.col,e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,u))}}},Gne={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeLast(),a=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(0,1),h=r.clone();h.row=i.row,e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(u,s.col))}}},qne={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,i.row,e)}},Kne={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},Xne={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),i=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(i!==null){const r=t._createCellCoords(i,e.col),s=e.row-t.getFirstFullyVisibleRow(),a=Math.max(r.row-s,0);t.selection.setRangeEnd(r),t.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}};function Zne(){return[kne,Vne,$ne,Fne,Bne,Wne,Une,jne,zne,Yne,Gne,qne,Kne,Xne]}const Qne={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},Jne={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let r=t.countVisibleRows()+n;r=r===0?1:r,i===t.countRows()-1?r=1:i+r>t.countRows()&&(r=t.countRows()-i-1),t.selection.transformStart(r,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},eie={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),i=t.getSelectedRangeLast(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-r.row,-r.col):t.selection.transformStart(-r.row,-r.col)}},tie={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),i=t.getSelectedRangeLast(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(r.row,r.col):t.selection.transformStart(r.row,r.col)}},nie={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},iie={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},rie={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},sie={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsBottom,10),s=n.getNearestNotHiddenIndex(t.countRows()-r-1,-1),a=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(s,a))}},oie={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},aie={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),r=t.getSelectedRangeLast().highlight.row,s=n.getNearestNotHiddenIndex(i,1);e.setRangeStart(t._createCellCoords(r,s))}},lie={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeLast().highlight.row;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);r===null&&(r=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(i,r))}},uie={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeLast().highlight;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);r===null&&(r=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(i,r))}},cie={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},hie={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(r,1),u=i.getNearestNotHiddenIndex(s,1);e.setRangeStart(t._createCellCoords(a,u))}},die={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},fie={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let r=t.countVisibleRows()+n;r=r===0?-1:-r,i===-n?r=-1:i+r<n&&(r=-(i+n)),t.selection.transformStart(r,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function gie(){return[Qne,Jne,eie,tie,nie,iie,rie,sie,oie,aie,lie,uie,cie,hie,die,fie]}const mie={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},pie={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,r=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,a=t._createCellCoords(n,i),u=t._createCellCoords(r,s);if(!t._createCellRange(a,a,u).includes(e)&&(e.row>=0||e.col>=0)){const d={};if(e.col>=0){const g=Math.floor(t.countVisibleCols()/2);d.col=Math.max(e.col-g,0)}if(e.row>=0){const g=Math.floor(t.countVisibleRows()/2);d.row=Math.max(e.row-g,0)}t.scrollViewportTo({...d,verticalSnap:"top",horizontalSnap:"start"})}}},vie={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},wie={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},yie={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),r=t.getDataAtCell(n,i),s=new Map;for(let a=0;a<e.length;a++)e[a].forAll((u,h)=>{if(u>=0&&h>=0&&(u!==n||h!==i)){const{readOnly:d}=t.getCellMeta(u,h);d||s.set(`${u}x${h}`,[u,h,r])}});t.setDataAtCell(Array.from(s.values()))}},Cie=[...Lne(),...Zne(),...gie(),mie,pie,vie,wie,yie];function xz(t){const e={};return Cie.forEach(n=>{let{name:i,callback:r}=n;e[i]=function(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];return r(t,...a)}}),e}function Sie(t){const e=t.getShortcutManager().addContext("editor"),n=xz(t),i={group:Cu};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,s)=>n.editorCloseAndSaveByEnter(r,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,s)=>n.editorCloseAndSaveByEnter(r,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(r,s)=>n.editorCloseAndSave(r,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,s)=>n.editorCloseAndSaveByArrowKeys(r,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function bie(t){const e=t.getShortcutManager().addContext("grid"),n=xz(t),i={runOnlyIf:()=>{const{navigableHeaders:r}=t.getSettings();return Pe(t.getSelected())&&(r||!r&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Oz};e.addShortcuts([{keys:[["F2"]],callback:r=>n.editorFastOpen(r)},{keys:[["Enter"],["Enter","Shift"]],callback:(r,s)=>n.editorOpen(r,s)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Cu,runOnlyIf:()=>Pe(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var r;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var r;return(r=t.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var r,s;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineStart(r)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineEnd(r)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i)}function Rie(t){[bie,Sie].forEach(e=>e(t))}function Eie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,i=QF(t),r=QF(t);return i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(i),n.lastChild.after(r),{activate(){t._registerTimeout(()=>{i.tabIndex=0,r.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,r.tabIndex=-1},10)}}}function QF(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ge(n,[jo(),vu()]),n}function Tie(t){const e=_ie(t);let n;const{activate:i,deactivate:r}=Eie(t,{onFocusFromTop(){var p;const w=(p=e(n))!==null&&p!==void 0?p:_1(t);w&&(t.runHooks("modifyFocusOnTabNavigation","from_above",w),t.selectCell(w.row,w.col)),t.listen()},onFocusFromBottom(){var p;const w=(p=e(n))!==null&&p!==void 0?p:M1(t);w&&(t.runHooks("modifyFocusOnTabNavigation","from_below",w),t.selectCell(w.row,w.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let a=!0,u=!1,h=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>i()),t.addHook("afterSelection",(p,w,y,S,_)=>{if(u&&(s.wrapped&&s.flipped||h)&&(h=!1,_.value=!0),a){var E;n=(E=t.getSelectedRangeLast())===null||E===void 0?void 0:E.highlight}}),t.addHook("beforeRowWrap",(p,w,y)=>{s.wrapped=!0,s.flipped=y});function d(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const g={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Oz,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...g,callback:()=>{const{tabNavigation:p}=t.getSettings();u=!0,t.getSelectedRangeLast()&&!p&&(a=!1),p||(h=!0)},position:"before"},{...g,callback:p=>{const{tabNavigation:w,autoWrapRow:y}=t.getSettings();if(u=!1,a=!0,!w||!t.selection.isSelected()||y&&s.wrapped&&s.flipped||!y&&s.wrapped)return y&&s.wrapped&&s.flipped&&(n=p.shiftKey?_1(t):M1(t)),d(),!1;p.preventDefault()},position:"after"}])}function _1(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let r=i&&t.countColHeaders()>0?-t.countColHeaders():0,s=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),s===0&&(s=n.getVisualFromRenderableIndex(s)),r===null||s===null?null:t._createCellCoords(r,s)}function M1(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:r}=t,{navigableHeaders:s}=t.getSettings();let a=i.getRenderableIndexesLength()-1,u=r.getRenderableIndexesLength()-1;if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}if(u<0){if(!s||t.countColHeaders()===0)return null;u=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(a))!==null&&e!==void 0?e:a,(n=r.getVisualFromRenderableIndex(u))!==null&&n!==void 0?n:u)}function _ie(t){return e=>{if(!e)return null;const n=_1(t),i=M1(t);return e.col<n.col&&(e.col=n.col),e.col>i.col&&(e.col=i.col),e.row<n.row&&(e.row=n.row),e.row>i.row&&(e.row=i.row),e}}function Mie(t){return e=>{let{col:n}=e;t.scrollViewportTo({col:n})}}function Oie(){return()=>{}}function Aie(t){return e=>{t.scrollViewportTo(e.toObject())}}function xie(t){return e=>{t.scrollViewportTo(e.toObject())}}function Hie(t){return e=>{t.scrollViewportTo(e.toObject())}}function Pie(t){return e=>{let{row:n}=e;t.scrollViewportTo({row:n})}}function Iie(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:r}=e;if(i<0&&r>=0)t.scrollViewportTo({col:r});else if(r<0&&i>=0)t.scrollViewportTo({row:i});else{if(n==="mouse"&&(r===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:r})}}}function Nie(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(r){var s;if(n||i){n=!1;return}let a;e.isFocusSelectionChanged()?a=Aie(t):e.isSelectedByCorner()?a=Oie():e.isSelectedByRowHeader()?a=Pie(t):e.isSelectedByColumnHeader()?a=Mie(t):e.getSelectedRange().size()===1&&e.isMultiple()?a=xie(t):e.getSelectedRange().size()===1&&!e.isMultiple()?a=Iie(t):e.getSelectedRange().size()>1&&(a=Hie(t)),(s=a)===null||s===void 0||s(r)}}}const JF=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Pw=t=>t.map(e=>{const n=e.toLowerCase();return JF.has(n)?JF.get(n):n}).sort().join("+"),Die=t=>t.split("+"),eB=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),b_=t=>{let{which:e,key:n}=t;if(eB.has(e))return eB.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},Hz=Symbol("shortcut-context");function Pz(t){return ht(t)&&t.__kindOf===Hz}const Lie=t=>{const e=TS({errorIdExists:h=>`The "${h}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:h,callback:d,group:g,runOnlyIf:p=()=>!0,captureCtrl:w=!1,preventDefault:y=!0,stopPropagation:S=!1,relativeToGroup:_,position:E,forwardToContext:H}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(vn(g))throw new Error("You need to define the shortcut's group.");if(on(d)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(h)===!1)throw new Error($t`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const x={callback:d,group:g,runOnlyIf:p,captureCtrl:w,preventDefault:y,stopPropagation:S};Pe(_)&&(x.relativeToGroup=_,x.position=E),Pz(H)&&(x.forwardToContext=H),h.forEach(D=>{const $=Pw(D);if(e.hasItem($)){const L=e.getItem($);let U=L.findIndex(re=>re.group===_);U!==-1?E==="before"?U-=1:U+=1:U=L.length,L.splice(U,0,x)}else e.addItem($,[x])})},i=function(h){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};h.forEach(g=>{dt(d,(p,w)=>{Object.prototype.hasOwnProperty.call(g,w)===!1&&(g[w]=d[w])}),n(g)})},r=h=>{const d=Pw(h);e.removeItem(d)};return{__kindOf:Hz,addShortcut:n,addShortcuts:i,getShortcuts:h=>{const d=Pw(h),g=e.getItem(d);return Pe(g)?g.slice():[]},hasShortcut:h=>{const d=Pw(h);return e.hasItem(d)},removeShortcutsByKeys:r,removeShortcutsByGroup:h=>{e.getItems().forEach(g=>{let[p,w]=g;const y=w.filter(S=>S.group!==h);y.length===0?r(Die(p)):(w.length=0,w.push(...y))})}}};function kie(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Vie=["meta","alt","shift","control"],Ug=kie(),jg=[];let Iw=0;function $ie(t,e,n,i,r){const s=y=>Vie.includes(y),a=function(y){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const _=[];return y.altKey&&_.push("alt"),S&&(y.ctrlKey||y.metaKey)?_.push("control/meta"):(y.ctrlKey&&_.push("control"),y.metaKey&&_.push("meta")),y.shiftKey&&_.push("shift"),_},u=y=>{if(e(y)===!1||n(y)===!1||y.keyCode===229||typeof y.key!="string"||Pc(y))return;const _=b_(y);let E=[];s(_)||(E=a(y));const H=[_].concat(E);!r(y,H)&&(d$()&&E.includes("meta")||!d$()&&E.includes("control"))&&r(y,[_].concat(a(y,!0))),i(y)},h=y=>{if(typeof y.key=="string"){const S=b_(y);s(S)&&Ug.press(S)}},d=y=>{if(typeof y.key=="string"){const S=b_(y);s(S)&&Ug.release(S)}},g=()=>{Ug.releaseAll()};return{mount:()=>{let y=t;for(Iw+=1;y;)Iw===1&&(y.document.documentElement.addEventListener("keydown",h),jg.push({event:"keydown",listener:h}),y.document.documentElement.addEventListener("keyup",d),jg.push({event:"keyup",listener:d})),y.document.documentElement.addEventListener("keydown",u),y.document.documentElement.addEventListener("blur",g),y=Qd(y)},unmount:()=>{let y=t;for(Iw-=1;y;){if(Iw===0){for(let S=0;S<jg.length;S++){const{event:_,listener:E}=jg[S];y.document.documentElement.removeEventListener(_,E)}jg.length=0}y.document.documentElement.removeEventListener("keydown",u),y.document.documentElement.removeEventListener("blur",g),y=Qd(y)}},isPressed:y=>Ug.isPressed(y),releasePressedKeys:()=>Ug.releaseAll()}}const Fie=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:r}=t;const s=TS({errorIdExists:S=>`The "${S}" context name is already registered.`});let a="grid";const u=S=>{const _=Lie(S);return s.addItem(S,_),_},h=()=>a,d=S=>s.getItem(S),g=S=>{if(!s.hasItem(S))throw new Error($t`You've tried to activate the "${S}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=S};let p=!1;const w=function(S,_){let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h();const H=Pz(E)?E:d(E);let x=!1;if(!H.hasShortcut(_))return x;const D=H.getShortcuts(_);for(let $=0;$<D.length;$++){const{callback:V,runOnlyIf:L,preventDefault:U,stopPropagation:re,captureCtrl:se,forwardToContext:Q}=D[$];if(L(S)===!0){if(p=se,x=V(S,_)===!1,p=!1,U&&S.preventDefault(),re&&(so(S),S.stopPropagation()),x)break;Q&&w(S,_,Q)}}return x},y=$ie(e,n,i,r,w);return y.mount(),{addContext:u,getActiveContextName:h,getContext:d,setActiveContextName:g,isCtrlPressed:()=>!p&&(y.isPressed("control")||y.isPressed("meta")),releasePressedKeys:()=>y.releasePressedKeys(),destroy:()=>y.unmount()}};function tB(t){const{classNames:e}=z7(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let R_=null;const E_=new Map;function Iz(t,e){var n,i=this;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new to(s);let u,h,d,g,p,w,y=!0;yee(r)&&wee(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const S=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",_=["rtl","ltr"].includes(S)?S:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",_),this.isRtl=function(){return _==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=vte(e.language);const E=new Mz(s,e,[wne,Tne]),H=E.getTableMeta(),x=E.getGlobalMeta(),D=TS();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),zy(this)&&(v7(e.licenseKey,t),fe(t,"ht-wrapper")),this.guid=`ht_${e2()}`,E_.set(this.guid,this),this.columnIndexMapper=new R1,this.rowIndexMapper=new R1,this.columnIndexMapper.addLocalHook("indexesSequenceChange",C=>{s.runHooks("afterColumnSequenceChange",C)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",C=>{s.runHooks("afterRowSequenceChange",C)}),h=new Nee(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const $=C=>{const{row:R,col:T}=C;return s._createCellCoords(R>=0?s.rowIndexMapper.getRenderableFromVisualIndex(R):R,T>=0?s.columnIndexMapper.getRenderableFromVisualIndex(T):T)},V=C=>{const{row:R,col:T}=C;return s._createCellCoords(R>=0?s.rowIndexMapper.getVisualFromRenderableIndex(R):R,T>=0?s.columnIndexMapper.getVisualFromRenderableIndex(T):T)},L=(C,R)=>{const T=R>C?1:-1,A=Math.min(C,R),k=Math.max(C,R),z=s.rowIndexMapper.getNearestNotHiddenIndex(C,T);return z===null||T===1&&z>k||T===-1&&z<A?null:z>=0?s.rowIndexMapper.getRenderableFromVisualIndex(z):z},U=(C,R)=>{const T=R>C?1:-1,A=Math.min(C,R),k=Math.max(C,R),z=s.columnIndexMapper.getNearestNotHiddenIndex(C,T);return z===null||T===1&&z>k||T===-1&&z<A?null:z>=0?s.columnIndexMapper.getRenderableFromVisualIndex(z):z};let re=new Ez(H,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:C=>u.propToCol(C),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(C,R)=>s._createCellCoords(C,R),createCellRange:(C,R,T)=>s._createCellRange(C,R,T),visualToRenderableCoords:$,renderableToVisualCoords:V,findFirstNonHiddenRenderableRow:L,findFirstNonHiddenRenderableColumn:U,isDisabledCellSelection:(C,R)=>C<0||R<0?s.getSettings().disableVisualSelection:s.getCellMeta(C,R).disableVisualSelection});this.selection=re;const se=C=>{let{hiddenIndexesChanged:R}=C;R&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",se),this.rowIndexMapper.addLocalHook("cacheUpdated",se),this.selection.addLocalHook("afterSetRangeEnd",(C,R)=>{const T=Wr(!1),A=this.selection.getSelectedRange(),{from:k,to:z}=A.current(),le=A.size()-1;this.runHooks("afterSelection",k.row,k.col,z.row,z.col,T,le),this.runHooks("afterSelectionByProp",k.row,s.colToProp(k.col),z.row,s.colToProp(z.col),T,le),R&&(!T.isTouched()||T.isTouched()&&!T.value)&&w.scrollTo(C);const ae=re.isSelectedByRowHeader(),be=re.isSelectedByColumnHeader();ae&&be?fe(this.rootElement,["ht__selection--rows","ht__selection--columns"]):ae?(je(this.rootElement,"ht__selection--columns"),fe(this.rootElement,"ht__selection--rows")):be?(je(this.rootElement,"ht__selection--rows"),fe(this.rootElement,"ht__selection--columns")):je(this.rootElement,["ht__selection--rows","ht__selection--columns"]),re.getSelectionSource()!=="shift"&&g.closeEditor(null),s.view.render(),g.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",C=>{this.runHooks("beforeSelectionFocusSet",C.row,C.col)}),this.selection.addLocalHook("afterSetFocus",C=>{const R=Wr(!1);this.runHooks("afterSelectionFocusSet",C.row,C.col,R),(!R.isTouched()||R.isTouched()&&!R.value)&&w.scrollTo(C),g.closeEditor(),s.view.render(),g.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",C=>{const R=C.length-1,{from:T,to:A}=C[R];this.runHooks("afterSelectionEnd",T.row,T.col,A.row,A.col,R),this.runHooks("afterSelectionEndByProp",T.row,s.colToProp(T.col),A.row,s.colToProp(A.col),R)}),this.selection.addLocalHook("afterIsMultipleSelection",C=>{const R=this.runHooks("afterIsMultipleSelection",C.value);C.value&&(C.value=R)}),this.selection.addLocalHook("afterDeselect",()=>{g.closeEditor(),s.view.render(),je(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("beforeSetRangeStart",...R)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("beforeSetRangeStartOnly",...R)}).addLocalHook("beforeSetRangeEnd",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("beforeSetRangeEnd",...R)}).addLocalHook("beforeSelectColumns",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("beforeSelectColumns",...R)}).addLocalHook("afterSelectColumns",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("afterSelectColumns",...R)}).addLocalHook("beforeSelectRows",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("beforeSelectRows",...R)}).addLocalHook("afterSelectRows",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("afterSelectRows",...R)}).addLocalHook("beforeModifyTransformStart",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("modifyTransformStart",...R)}).addLocalHook("afterModifyTransformStart",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("afterModifyTransformStart",...R)}).addLocalHook("beforeModifyTransformFocus",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("modifyTransformFocus",...R)}).addLocalHook("afterModifyTransformFocus",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("afterModifyTransformFocus",...R)}).addLocalHook("beforeModifyTransformEnd",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("modifyTransformEnd",...R)}).addLocalHook("afterModifyTransformEnd",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("afterModifyTransformEnd",...R)}).addLocalHook("beforeRowWrap",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("beforeRowWrap",...R)}).addLocalHook("beforeColumnWrap",function(){for(var C=arguments.length,R=new Array(C),T=0;T<C;T++)R[T]=arguments[T];return i.runHooks("beforeColumnWrap",...R)}).addLocalHook("insertRowRequire",C=>this.alter("insert_row_above",C,1,"auto")).addLocalHook("insertColRequire",C=>this.alter("insert_col_start",C,1,"auto")),d={alter(C,R){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,k=arguments.length>4?arguments[4]:void 0;const z=le=>{if(le.length===0)return[];const ae=[...le];return ae.sort((M,O)=>{let[I]=M,[q]=O;return I===q?0:I>q?1:-1}),Sr(ae,(M,O)=>{let[I,q]=O;const j=M[M.length-1],[Z,ne]=j,B=Z+ne;if(I<=B){const X=Math.max(q-(B-I),0);j[1]+=X}else M.push([I,q]);return M},[ae[0]])};switch(C){case"insert_row_below":case"insert_row_above":const le=s.countSourceRows();if(H.maxRows===le)return;const ae=C==="insert_row_below"?"below":"above";R=R??(ae==="below"?le:0);const{delta:be,startPhysicalIndex:M}=u.createRow(R,T,{source:A,mode:ae});re.shiftRows(s.toVisualRow(M),be);break;case"insert_col_start":case"insert_col_end":const O=C==="insert_col_end"?"end":"start";R=R??(O==="end"?s.countSourceCols():0);const{delta:I,startPhysicalIndex:q}=u.createCol(R,T,{source:A,mode:O});if(I){if(Array.isArray(H.colHeaders)){const ne=[s.toVisualColumn(q),0];ne.length+=I,Array.prototype.splice.apply(H.colHeaders,ne)}re.shiftColumns(s.toVisualColumn(q),I)}break;case"remove_row":const j=ne=>{let B=0;W(ne,X=>{let[J,ee]=X;const ce=Vn(J)?s.countRows()-1:Math.max(J-B,0);if(Number.isInteger(J)&&(J=Math.max(J-B,0)),!u.removeRow(J,ee,A))return;if(re.isSelected()){const{row:ft}=s.getSelectedRangeLast().highlight;ft>=J&&ft<=J+ee-1&&g.closeEditor(!0)}const Ne=s.countRows();Ne===0?re.deselect():A==="ContextMenu.removeRow"?re.refresh():re.shiftRows(J,-ee);const Fe=H.fixedRowsTop;Fe>=ce+1&&(H.fixedRowsTop-=Math.min(ee,Fe-ce));const st=H.fixedRowsBottom;st&&ce>=Ne-st&&(H.fixedRowsBottom-=Math.min(ee,st)),B+=ee})};Array.isArray(R)?j(z(R)):j([[R,T]]);break;case"remove_col":const Z=ne=>{let B=0;W(ne,X=>{let[J,ee]=X;const ce=Vn(J)?s.countCols()-1:Math.max(J-B,0);let xe=s.toPhysicalColumn(ce);if(Number.isInteger(J)&&(J=Math.max(J-B,0)),!u.removeCol(J,ee,A))return;if(re.isSelected()){const{col:ft}=s.getSelectedRangeLast().highlight;ft>=J&&ft<=J+ee-1&&g.closeEditor(!0)}s.countCols()===0?re.deselect():A==="ContextMenu.removeColumn"?re.refresh():re.shiftColumns(J,-ee);const st=H.fixedColumnsStart;st>=ce+1&&(H.fixedColumnsStart-=Math.min(ee,st-ce)),Array.isArray(H.colHeaders)&&(typeof xe>"u"&&(xe=-1),H.colHeaders.splice(xe,ee)),B+=ee})};Array.isArray(R)?Z(z(R)):Z([[R,T]]);break;default:throw new Error(`There is no such action "${C}"`)}k||d.adjustRowsAndCols(),s.view.render(),s.view.adjustElementsSize()},adjustRowsAndCols(){const C=H.minRows,R=H.minSpareRows,T=H.minCols,A=H.minSpareCols;if(C){const k=s.countRows();k<C&&u.createRow(k,C-k,{source:"auto"})}if(R){const k=s.countEmptyRows(!0);if(k<R){const z=R-k,le=Math.min(z,H.maxRows-s.countSourceRows());u.createRow(s.countRows(),le,{source:"auto"})}}{let k;(T||A)&&(k=s.countEmptyCols(!0));let z=s.countCols();if(T&&!H.columns&&z<T){const le=T-z;k+=le,u.createCol(z,le,{source:"auto"})}if(A&&!H.columns&&s.dataType==="array"&&k<A){z=s.countCols();const le=A-k,ae=Math.min(le,H.maxCols-z);u.createCol(z,ae,{source:"auto"})}}},populateFromArray(C,R,T,A,k){let z,le,ae,be;const M=[],O={},I=[],q=C.row,j=C.col;if(le=R.length,le===0)return!1;let Z=0,ne=0;switch(ht(T)&&(Z=T.col-j+1,ne=T.row-q+1),k){case"shift_down":const B=Uy(R),X=B.length,J=Math.max(X,Z),ee=s.getData().slice(q),ce=Uy(ee).slice(j,j+J);for(ae=0;ae<J;ae+=1)if(ae<X){for(z=0,le=B[ae].length;z<ne-le;z+=1)B[ae].push(B[ae][z%le]);ae<ce.length?I.push(B[ae].concat(ce[ae])):I.push(B[ae].concat(new Array(ee.length).fill(null)))}else I.push(B[ae%X].concat(ce[ae]));s.populateFromArray(q,j,Uy(I));break;case"shift_right":const xe=R.length,Ne=Math.max(xe,ne),Fe=s.getData().slice(q).map(qn=>qn.slice(j));for(z=0;z<Ne;z+=1)if(z<xe){for(ae=0,be=R[z].length;ae<Z-be;ae+=1)R[z].push(R[z][ae%be]);if(z<Fe.length)for(let qn=0;qn<Fe[z].length;qn+=1)R[z].push(Fe[z][qn]);else R[z].push(...new Array(Fe[0].length).fill(null))}else R.push(R[z%le].slice(0,Ne).concat(Fe[z]));s.populateFromArray(q,j,R);break;case"overwrite":default:O.row=C.row,O.col=C.col;let st=0,ft=0,Je=!0,rt;const dn=function(tn){let Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Zt=R[tn%R.length];return Ct!==null?Zt[Ct%Zt.length]:Zt},ir=R.length,jr=T?T.row-C.row+1:0;for(T?le=jr:le=Math.max(ir,jr),z=0;z<le&&!(T&&O.row>T.row&&jr>ir||!H.allowInsertRow&&O.row>s.countRows()-1||O.row>=H.maxRows);z++){const qn=z-st,tn=dn(qn).length,Ct=T?T.col-C.col+1:0;if(T?be=Ct:be=Math.max(tn,Ct),O.col=C.col,rt=s.getCellMeta(O.row,O.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&rt.skipRowOnPaste){st+=1,O.row+=1,le+=1;continue}for(ft=0,ae=0;ae<be&&!(T&&O.col>T.col&&Ct>tn||!H.allowInsertColumn&&O.col>s.countCols()-1||O.col>=H.maxCols);ae++){if(rt=s.getCellMeta(O.row,O.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&rt.skipColumnOnPaste){ft+=1,O.col+=1,be+=1;continue}if(rt.readOnly&&A!=="UndoRedo.undo"){O.col+=1;continue}const Zt=ae-ft;let gt=dn(qn,Zt),Ke=s.getDataAtCell(O.row,O.col);if(gt!==null&&typeof gt=="object")if(Array.isArray(gt)&&Ke===null&&(Ke=[]),Ke===null||typeof Ke!="object")Je=!1;else{const ah=ep(Array.isArray(Ke)?Ke:Ke[0]||Ke),ea=ep(Array.isArray(gt)?gt:gt[0]||gt);qO(ah,ea)||Array.isArray(ah)&&Array.isArray(ea)?gt=tr(gt):Je=!1}else Ke!==null&&typeof Ke=="object"&&(Je=!1);Je&&M.push([O.row,O.col,gt]),Je=!0,O.col+=1}O.row+=1}s.setDataAtCell(M,null,null,A||"populateFromArray");break}}};function Q(C){const R=dz(C);zx(R)?(s.runHooks("beforeLanguageChange",R),x.language=R,s.runHooks("afterLanguageChange",R)):fz(C)}function de(C,R){const T=C==="className"?s.rootElement:s.table;if(y)fe(T,R);else{let A=[],k=[];x[C]&&(A=Array.isArray(x[C])?x[C]:JV(x[C])),R&&(k=Array.isArray(R)?R:JV(R));const z=QV(A,k),le=QV(k,A);z.length&&je(T,z),le.length&&fe(T,le)}x[C]=R}this.init=function(){h.setData(H.data),s.runHooks("beforeInit"),(Ga()||T2())&&fe(s.rootElement,"mobile"),this.updateSettings(H,!0),this.view=new Ree(this);const C=H.themeName||tB(s.rootElement);s.useTheme(C),s.view.addClassNameToLicenseElement(s.getCurrentThemeName()),g=v1.getInstance(s,H,re),w=Nie(s),p=new zX(s),zy(this)&&Tie(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),y&&s.rootElement.offsetParent===null&&eX(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof y=="object"&&(s.runHooks("afterChange",y[0],y[1]),y=!1),s.runHooks("afterInit")};function me(){let C=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,C=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&C===!1&&(C=!0,this.onQueueEmpty(this.valid))}}}function _e(C){const R=C.replace(",",".");return isNaN(parseFloat(R))===!1?parseFloat(R):C}function Ee(C,R,T){if(!C.length){T();return}const A=s.getActiveEditor(),k=new me;let z=!0;k.onQueueEmpty=()=>{A&&z&&A.cancelChanges(),T()};for(let le=C.length-1;le>=0;le--){const[ae,be]=C[le],M=u.propToCol(be);let O;Number.isInteger(M)?O=s.getCellMeta(ae,M):O={...Object.getPrototypeOf(H),...H},s.getCellValidator(O)&&(k.addValidatorToQueue(),s.validateCell(C[le][3],O,function(I,q){return function(j){if(typeof j!="boolean")throw new Error("Validation error: result is not boolean");j===!1&&q.allowInvalid===!1&&(z=!1,C.splice(I,1),q.valid=!0),k.removeValidatorFormQueue()}}(le,O),R))}k.checkIfQueueIsEmpty()}function Te(C,R){for(let A=C.length-1;A>=0;A--){let k=!1;if(C[A]===null){C.splice(A,1);continue}if(!((C[A][2]===null||C[A][2]===void 0)&&(C[A][3]===null||C[A][3]===void 0))){if(H.allowInsertRow)for(;C[A][0]>s.countRows()-1;){const{delta:z}=u.createRow(void 0,void 0,{source:"auto"});if(z===0){k=!0;break}}if(s.dataType==="array"&&(!H.columns||H.columns.length===0)&&H.allowInsertColumn)for(;u.propToCol(C[A][1])>s.countCols()-1;){const{delta:z}=u.createCol(void 0,void 0,{source:"auto"});if(z===0){k=!0;break}}k||u.set(C[A][0],C[A][1],C[A][3])}}const T=C.length>0;if(s.forceFullRender=!0,T){d.adjustRowsAndCols(),s.runHooks("beforeChangeRender",C,R),g.closeEditor(),s.view.render(),g.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",C,R||"edit");const A=s.getActiveEditor();A&&Pe(A.refreshValue)&&A.refreshValue()}else s.view.render()}this._createCellCoords=function(C,R){return s.view._wt.createCellCoords(C,R)},this._createCellRange=function(C,R,T){return s.view._wt.createCellRange(C,R,T)},this.validateCell=function(C,R,T,A){let k=s.getCellValidator(R);function z(le){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||R.hidden===!0){T(le);return}const be=R.visualCol,M=R.visualRow,O=s.getCell(M,be,!0);if(O&&O.nodeName!=="TH"){const I=s.rowIndexMapper.getRenderableFromVisualIndex(M),q=s.columnIndexMapper.getRenderableFromVisualIndex(be);s.view._wt.getSetting("cellRenderer",I,q,O)}T(le)}g7(k)&&(k=function(le){return function(ae,be){be(le.test(ae))}}(k)),on(k)?(C=s.runHooks("beforeValidate",C,R.visualRow,R.prop,A),s._registerImmediate(()=>{k.call(R,C,le=>{s&&(le=s.runHooks("afterValidate",le,C,R.visualRow,R.prop,A),R.valid=le,z(le),s.runHooks("postAfterValidate",le,C,R.visualRow,R.prop,A))})})):s._registerImmediate(()=>{R.valid=!0,z(R.valid,!1)})};function ve(C,R,T){return Array.isArray(C)?C:[[C,R,T]]}function Ce(C,R){const T=s.runHooks("beforeChange",C,R||"edit"),A=C.filter(z=>z!==null);if(T===!1||A.length===0){var k;return(k=s.getActiveEditor())===null||k===void 0||k.cancelChanges(),[]}for(let z=A.length-1;z>=0;z--){const[le,ae,,be]=A[z],M=u.propToCol(ae);let O;Number.isInteger(M)?O=s.getCellMeta(le,M):O={...Object.getPrototypeOf(H),...H},O.type==="numeric"&&typeof be=="string"&&rZ(be)&&(A[z][3]=_e(be))}return A}this.setDataAtCell=function(C,R,T,A){const k=ve(C,R,T),z=[];let le=A,ae,be,M;for(ae=0,be=k.length;ae<be;ae++){if(typeof k[ae]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof k[ae][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");k[ae][1]>=this.countCols()?M=k[ae][1]:M=u.colToProp(k[ae][1]),z.push([k[ae][0],M,h.getAtCell(this.toPhysicalRow(k[ae][0]),k[ae][1]),k[ae][2]])}!le&&typeof C=="object"&&(le=R);const O=Ce(z,le);s.runHooks("afterSetDataAtCell",O,le),Ee(O,le,()=>{Te(O,le)})},this.setDataAtRowProp=function(C,R,T,A){const k=ve(C,R,T),z=[];let le=A,ae,be;for(ae=0,be=k.length;ae<be;ae++)z.push([k[ae][0],k[ae][1],h.getAtCell(this.toPhysicalRow(k[ae][0]),k[ae][1]),k[ae][2]]);!le&&typeof C=="object"&&(le=R);const M=Ce(z,A);s.runHooks("afterSetDataAtRowProp",M,le),Ee(M,le,()=>{Te(M,le)})},this.listen=function(){s&&!s.isListening()&&(E_.forEach(C=>{s!==C&&C.unlisten()}),R_=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(R_=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return R_===s.guid},this.destroyEditor=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;g.closeEditor(C),s.view.render(),R&&re.isSelected()&&g.prepareEditor()},this.populateFromArray=function(C,R,T,A,k,z,le){if(!(typeof T=="object"&&typeof T[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const ae=typeof A=="number"?s._createCellCoords(A,k):null;return d.populateFromArray(s._createCellCoords(C,R),T,ae,z,le)},this.spliceCol=function(C,R,T){for(var A=arguments.length,k=new Array(A>3?A-3:0),z=3;z<A;z++)k[z-3]=arguments[z];return u.spliceCol(C,R,T,...k)},this.spliceRow=function(C,R,T){for(var A=arguments.length,k=new Array(A>3?A-3:0),z=3;z<A;z++)k[z-3]=arguments[z];return u.spliceRow(C,R,T,...k)},this.getSelected=function(){if(re.isSelected())return Rt(re.getSelectedRange(),C=>{let{from:R,to:T}=C;return[R.row,R.col,T.row,T.col]})},this.getSelectedLast=function(){const C=this.getSelected();let R;return C&&C.length>0&&(R=C[C.length-1]),R},this.getSelectedRange=function(){if(re.isSelected())return Array.from(re.getSelectedRange())},this.getSelectedRangeLast=function(){const C=this.getSelectedRange();let R;return C&&C.length>0&&(R=C[C.length-1]),R},this.emptySelectedCells=function(C){if(!re.isSelected()||this.countRows()===0||this.countCols()===0)return;const R=[];W(re.getSelectedRange(),T=>{if(T.isSingleHeader())return;const A=T.getTopStartCorner(),k=T.getBottomEndCorner();ke(A.row,k.row,z=>{ke(A.col,k.col,le=>{this.getCellMeta(z,le).readOnly||R.push([z,le,null])})})}),R.length>0&&this.setDataAtCell(R,C)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const C=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(C,0),!this.isRenderSuspended()&&C===this.renderSuspendedCounter&&(this.renderCall?this.render():s.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(C){this.suspendRender();const R=C();return this.resumeRender(),R},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const R=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(R,0),(!this.isExecutionSuspended()&&R===this.executionSuspendedCounter||C)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(C){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const T=C();return this.resumeExecution(R),T},this.batch=function(C){this.suspendRender(),this.suspendExecution();const R=C();return this.resumeExecution(),this.resumeRender(),R},this.refreshDimensions=function(){if(!s.view)return;const C=s.view,{width:R,height:T}=C.getLastSize(),{width:A,height:k}=s.rootElement.getBoundingClientRect(),z=A!==R||k!==T;s.runHooks("beforeRefreshDimensions",{width:R,height:T},{width:A,height:k},z)!==!1&&((z||C._wt.wtOverlays.scrollableElement===s.rootWindow)&&(C.setLastSize(A,k),s.render(),C.adjustElementsSize()),s.runHooks("afterRefreshDimensions",{width:R,height:T},{width:A,height:k},z))},this.updateData=function(C,R){KF(C,T=>{u=T},T=>{u=T,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),d.adjustRowsAndCols(),re.refresh()},{hotInstance:s,dataMap:u,dataSource:h,internalSource:"updateData",source:R,metaManager:E,firstRun:y})},this.loadData=function(C,R){KF(C,T=>{u=T},()=>{E.clearCellsCache(),s.initIndexMappers(),d.adjustRowsAndCols(),re.refresh(),y&&(y=[null,"loadData"])},{hotInstance:s,dataMap:u,dataSource:h,internalSource:"loadData",source:R,metaManager:E,firstRun:y})},this.getInitialColumnCount=function(){const C=H.columns;let R=0;if(Array.isArray(C))R=C.length;else if(on(C))if(s.dataType==="array"){const T=this.countSourceCols();for(let A=0;A<T;A+=1)C(A)&&(R+=1)}else(s.dataType==="object"||s.dataType==="function")&&(R=u.colToPropCache.length);else if(Pe(H.dataSchema)){const T=u.getSchema();R=Array.isArray(T)?T.length:KO(T)}else R=this.countSourceCols();return R},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(C,R,T,A){return vn(C)?u.getAll():u.getRange(s._createCellCoords(C,R),s._createCellCoords(T,A),u.DESTINATION_RENDERER)},this.getCopyableText=function(C,R,T,A){return u.getCopyableText(s._createCellCoords(C,R),s._createCellCoords(T,A))},this.getCopyableData=function(C,R){return u.getCopyable(C,u.colToProp(R))},this.getSchema=function(){return u.getSchema()},this.updateSettings=function(C){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const T=(y?s.loadData:s.updateData).bind(this);let A=!1,k,z;if(Pe(C.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Pe(C.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Pe(C.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(k in C)k==="data"||(k==="language"?Q(C.language):k==="className"?de("className",C.className):k==="tableClassName"&&s.table?(de("tableClassName",C.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):Ae.getSingleton().isRegistered(k)||Ae.getSingleton().isDeprecated(k)?on(C[k])?Ae.getSingleton().addAsFixed(k,C[k],s):Array.isArray(C[k])&&Ae.getSingleton().add(k,C[k],s):!R&&ei(C,k)&&(x[k]=C[k]));C.data===void 0&&H.data===void 0?T(null,"updateSettings"):C.data!==void 0?T(C.data,"updateSettings"):C.columns!==void 0&&(u.createMap(),s.initIndexMappers());const le=s.countCols(),ae=H.columns;if(ae&&on(ae)&&(A=!0),(C.cell!==void 0||C.cells!==void 0||C.columns!==void 0)&&E.clearCache(),le>0)for(k=0,z=0;k<le;k++){if(ae){const O=A?ae(k):ae[z];O&&E.updateColumnMeta(z,O)}z+=1}Pe(C.cell)&&dt(C.cell,O=>{s.setCellMetaObject(O.row,O.col,O)}),s.runHooks("afterCellMetaReset");let be=s.rootElement.style.height;be!==""&&(be=parseInt(s.rootElement.style.height,10));let M=C.height;if(on(M)&&(M=M()),R&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),M===null){const O=s.rootElement.getAttribute("data-initialstyle");O&&(O.indexOf("height")>-1||O.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",O):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else M!==void 0&&(s.rootElement.style.height=isNaN(M)?`${M}`:`${M}px`,s.rootElement.style.overflow="hidden");if(typeof C.width<"u"){let O=C.width;on(O)&&(O=O()),s.rootElement.style.width=isNaN(O)?`${O}`:`${O}px`}if(!R){if(s.view){s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames();const O=s.getCurrentThemeName(),I=ei(C,"themeName");O&&I&&O!==C.themeName&&(s.view.getStylesHandler().removeClassNames(),s.view.removeClassNameFromLicenseElement(O));const q=I&&C.themeName||tB(s.rootElement);s.useTheme(q),s.view.addClassNameToLicenseElement(s.getCurrentThemeName())}s.runHooks("afterUpdateSettings",C)}d.adjustRowsAndCols(),s.view&&!y&&(s.forceFullRender=!0,s.view.render(),s.view._wt.wtOverlays.adjustElementsSize()),!R&&s.view&&(be===""||M===""||M===void 0)&&be!==M&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const C=s.getSelectedLast();if(H.getValue){if(on(H.getValue))return H.getValue.call(s);if(C)return s.getData()[C[0][0]][H.getValue]}else if(C)return s.getDataAtCell(C[0],C[1])},this.getSettings=function(){return H},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(C,R,T,A,k){d.alter(C,R,T,A,k)},this.getCell=function(C,R){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=R,k=C;if(R>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(R)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(R)}if(C>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(C)))return null;k=this.rowIndexMapper.getRenderableFromVisualIndex(C)}return k===null||A===null||k===void 0||A===void 0?null:s.view.getCellAtCoords(s._createCellCoords(k,A),T)},this.getCoords=function(C){const R=this.view._wt.wtTable.getCoords(C);if(R===null)return null;const{row:T,col:A}=R;let k=T,z=A;return T>=0&&(k=this.rowIndexMapper.getVisualFromRenderableIndex(T)),A>=0&&(z=this.columnIndexMapper.getVisualFromRenderableIndex(A)),s._createCellCoords(k,z)},this.colToProp=function(C){return u.colToProp(C)},this.propToCol=function(C){return u.propToCol(C)},this.toVisualRow=C=>this.rowIndexMapper.getVisualFromPhysicalIndex(C),this.toVisualColumn=C=>this.columnIndexMapper.getVisualFromPhysicalIndex(C),this.toPhysicalRow=C=>this.rowIndexMapper.getPhysicalFromVisualIndex(C),this.toPhysicalColumn=C=>this.columnIndexMapper.getPhysicalFromVisualIndex(C),this.getDataAtCell=function(C,R){return u.get(C,u.colToProp(R))},this.getDataAtRowProp=function(C,R){return u.get(C,R)},this.getDataAtCol=function(C){const R=[],T=u.getRange(s._createCellCoords(0,C),s._createCellCoords(H.data.length-1,C),u.DESTINATION_RENDERER);for(let A=0;A<T.length;A+=1)for(let k=0;k<T[A].length;k+=1)R.push(T[A][k]);return R},this.getDataAtProp=function(C){const R=[],T=u.getRange(s._createCellCoords(0,u.propToCol(C)),s._createCellCoords(H.data.length-1,u.propToCol(C)),u.DESTINATION_RENDERER);for(let A=0;A<T.length;A+=1)for(let k=0;k<T[A].length;k+=1)R.push(T[A][k]);return R},this.getSourceData=function(C,R,T,A){let k;return C===void 0?k=h.getData():k=h.getByRange(s._createCellCoords(C,R),s._createCellCoords(T,A)),k},this.getSourceDataArray=function(C,R,T,A){let k;return C===void 0?k=h.getData(!0):k=h.getByRange(s._createCellCoords(C,R),s._createCellCoords(T,A),!0),k},this.getSourceDataAtCol=function(C){return h.getAtColumn(C)},this.setSourceDataAtCell=function(C,R,T,A){const k=ve(C,R,T),z=this.hasHook("afterSetSourceDataAtCell"),le=[];z&&W(k,be=>{let[M,O,I]=be;le.push([M,O,h.getAtCell(M,O),I])}),W(k,be=>{let[M,O,I]=be;h.setAtCell(M,O,I)}),z&&this.runHooks("afterSetSourceDataAtCell",le,A),this.render();const ae=s.getActiveEditor();ae&&Pe(ae.refreshValue)&&ae.refreshValue()},this.getSourceDataAtRow=function(C){return h.getAtRow(C)},this.getSourceDataAtCell=function(C,R){return h.getAtCell(C,R)},this.getDataAtRow=function(C){return u.getRange(s._createCellCoords(C,0),s._createCellCoords(C,this.countCols()-1),u.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(C,R,T,A){const k=C===void 0?[0,0,this.countRows(),this.countCols()]:[C,R,T,A],[z,le]=k;let[,,ae,be]=k,M=null,O=null;ae===void 0&&(ae=z),be===void 0&&(be=le);let I="mixed";return ke(Math.max(Math.min(z,ae),0),Math.max(z,ae),q=>{let j=!0;return ke(Math.max(Math.min(le,be),0),Math.max(le,be),Z=>(O=this.getCellMeta(q,Z).type,M?j=M===O:M=O,j)),I=j?O:"mixed",j}),I},this.removeCellMeta=function(C,R,T){const[A,k]=[this.toPhysicalRow(C),this.toPhysicalColumn(R)];let z=E.getCellMetaKeyValue(A,k,T);s.runHooks("beforeRemoveCellMeta",C,R,T,z)!==!1&&(E.removeCellMeta(A,k,T),s.runHooks("afterRemoveCellMeta",C,R,T,z)),z=null},this.spliceCellsMeta=function(C){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var T=arguments.length,A=new Array(T>2?T-2:0),k=2;k<T;k++)A[k-2]=arguments[k];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");R>0&&E.removeRow(this.toPhysicalRow(C),R),A.length>0&&W(A.reverse(),z=>{E.createRow(this.toPhysicalRow(C)),W(z,(le,ae)=>this.setCellMetaObject(C,ae,le))}),s.render()},this.setCellMetaObject=function(C,R,T){typeof T=="object"&&dt(T,(A,k)=>{this.setCellMeta(C,R,k,A)})},this.setCellMeta=function(C,R,T,A){if(s.runHooks("beforeSetCellMeta",C,R,T,A)===!1)return;let z=C,le=R;C<this.countRows()&&(z=this.toPhysicalRow(C)),R<this.countCols()&&(le=this.toPhysicalColumn(R)),E.setCellMeta(z,le,T,A),s.runHooks("afterSetCellMeta",C,R,T,A)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(C,R){let T=this.toPhysicalRow(C),A=this.toPhysicalColumn(R);return T===null&&(T=C),A===null&&(A=R),E.getCellMeta(T,A,{visualRow:C,visualColumn:R})},this.getColumnMeta=function(C){return E.getColumnMeta(this.toPhysicalColumn(C))},this.getCellMetaAtRow=function(C){return E.getCellsMetaAtRow(C)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||H.columns)},this.getCellRenderer=function(C,R){const T=typeof C=="number"?s.getCellMeta(C,R).renderer:C.renderer;return typeof T=="string"?C1(T):vn(T)?C1("text"):T},this.getCellEditor=function(C,R){const T=typeof C=="number"?s.getCellMeta(C,R).editor:C.editor;return typeof T=="string"?p1(T):vn(T)?p1("text"):T},this.getCellValidator=function(C,R){const T=typeof C=="number"?s.getCellMeta(C,R).validator:C.validator;return typeof T=="string"?SZ(T):T},this.validateCells=function(C){this._validateCells(C)},this.validateRows=function(C,R){if(!Array.isArray(C))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(R,C)},this.validateColumns=function(C,R){if(!Array.isArray(C))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(R,void 0,C)},this._validateCells=function(C,R,T){const A=new me;C&&(A.onQueueEmpty=C);let k=s.countRows()-1;for(;k>=0;){if(R!==void 0&&R.indexOf(k)===-1){k-=1;continue}let z=s.countCols()-1;for(;z>=0;){if(T!==void 0&&T.indexOf(z)===-1){z-=1;continue}A.addValidatorToQueue(),s.validateCell(s.getDataAtCell(k,z),s.getCellMeta(k,z),le=>{if(typeof le!="boolean")throw new Error("Validation error: result is not boolean");le===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),z-=1}k-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(C){let R=H.rowHeaders,T=C;return T!==void 0&&(T=s.runHooks("modifyRowHeader",T)),T===void 0?(R=[],ke(s.countRows()-1,A=>{R.push(s.getRowHeader(A))})):Array.isArray(R)&&R[T]!==void 0?R=R[T]:on(R)?R=R(T):R&&typeof R!="string"&&typeof R!="number"&&(R=T+1),R},this.hasRowHeaders=function(){return!!H.rowHeaders},this.hasColHeaders=function(){if(H.colHeaders!==void 0&&H.colHeaders!==null)return!!H.colHeaders;for(let C=0,R=s.countCols();C<R;C++)if(s.getColHeader(C))return!0;return!1},this.getColHeader=function(C){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const T=s.runHooks("modifyColHeader",C);if(T===void 0){const ae=[],be=s.countCols();for(let M=0;M<be;M++)ae.push(s.getColHeader(M));return ae}let A=H.colHeaders;const k=function(ae){const be=[],M=s.countCols();let O=0;for(;O<M;O++)on(H.columns)&&H.columns(O)&&be.push(O);return be[ae]},z=s.toPhysicalColumn(T),le=k(z);return H.colHeaders===!1?A=null:H.columns&&on(H.columns)&&H.columns(le)&&H.columns(le).title?A=H.columns(le).title:H.columns&&H.columns[z]&&H.columns[z].title?A=H.columns[z].title:Array.isArray(H.colHeaders)&&H.colHeaders[z]!==void 0?A=H.colHeaders[z]:on(H.colHeaders)?A=H.colHeaders(z):H.colHeaders&&typeof H.colHeaders!="string"&&typeof H.colHeaders!="number"&&(A=Aee(T)),A=s.runHooks("modifyColumnHeaderValue",A,C,R),A},this._getColWidthFromSettings=function(C){let R;if(C>=0&&(R=s.getCellMeta(0,C).width),(R===void 0||R===H.width)&&(R=H.colWidths),R!=null){switch(typeof R){case"object":R=R[C];break;case"function":R=R(C);break}typeof R=="string"&&(R=parseInt(R,10))}return R},this.getColWidth=function(C,R){let T=s._getColWidthFromSettings(C);return T=s.runHooks("modifyColWidth",T,C,R),T===void 0&&(T=tf),T},this._getRowHeightFromSettings=function(C){let R=H.rowHeights;if(R!=null){switch(typeof R){case"object":R=R[C];break;case"function":R=R(C);break}typeof R=="string"&&(R=parseInt(R,10))}return R},this.getRowHeight=function(C,R){let T=s._getRowHeightFromSettings(C);return T=s.runHooks("modifyRowHeight",T,C,R),T},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return u.getLength()},this.countCols=function(){const C=H.maxCols,R=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(C,R)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return F$(s.countRows()-1,T=>{if(s.isEmptyRow(T))R+=1;else if(C===!0)return!1}),R},this.countEmptyCols=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return F$(s.countCols()-1,T=>{if(s.isEmptyCol(T))R+=1;else if(C===!0)return!1}),R},this.isEmptyRow=function(C){return H.isEmptyRow.call(s,C)},this.isEmptyCol=function(C){return H.isEmptyCol.call(s,C)},this.selectCell=function(C,R,T,A){let k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,z=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return vn(C)||vn(R)?!1:this.selectCells([[C,R,T,A]],k,z)},this.selectCells=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;R===!1&&w.suspend();const A=re.selectCells(C);return A&&T&&s.listen(),w.resume(),A},this.selectColumns=function(C){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,T=arguments.length>2?arguments[2]:void 0;return re.selectColumns(C,R,T)},this.selectRows=function(C){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,T=arguments.length>2?arguments[2]:void 0;return re.selectRows(C,R,T)},this.deselectCell=function(){re.deselect()},this.selectAll=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,T=arguments.length>2?arguments[2]:void 0;w.skipNextScrollCycle(),re.selectAll(C,R,T)};const Re=(C,R)=>C.getNearestNotHiddenIndex(R,1,!0);this.scrollViewportTo=function(C){if(typeof C=="number"){var R;C={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(R=arguments[4])!==null&&R!==void 0?R:!0}}const{row:T,col:A,considerHiddenIndexes:k}=C??{};let z=T,le=A;if(k===void 0||k){const M=Number.isInteger(T)&&T>=0,O=Number.isInteger(A)&&A>=0,I=M?Re(this.rowIndexMapper,T):void 0,q=O?Re(this.columnIndexMapper,A):void 0;if(I===null||q===null)return!1;z=M?s.rowIndexMapper.getRenderableFromVisualIndex(I):T,le=O?s.columnIndexMapper.getRenderableFromVisualIndex(q):A}const ae=Number.isInteger(z),be=Number.isInteger(le);return ae&&z>=0&&be&&le>=0?s.view.scrollViewport(s._createCellCoords(z,le),C.horizontalSnap,C.verticalSnap):ae&&z>=0&&(be&&le<0||!be)?s.view.scrollViewportVertically(z,C.verticalSnap):be&&le>=0&&(ae&&z<0||!ae)?s.view.scrollViewportHorizontally(le,C.horizontalSnap):!1},this.scrollToFocusedCell=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",C);const{highlight:R}=this.getSelectedRangeLast();this.scrollViewportTo(R.toObject())?this.view.render():(this.removeHook("afterScroll",C),this._registerImmediate(()=>C()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),E.clearCache(),E_.delete(this.guid),zy(s)){const C=this.rootDocument.querySelector(".hot-display-license-info");C&&C.parentNode.removeChild(C)}Go(s.rootElement),a.destroy(),g&&g.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),D.getItems().forEach(C=>{let[,R]=C;R.destroy()}),D.clear(),s.runHooks("afterDestroy")},!0),Ae.getSingleton().destroy(s),dt(s,(C,R,T)=>{on(C)?T[R]=qe(R):R!=="guid"&&(T[R]=null)}),s.isDestroyed=!0,u&&u.destroy(),u=null,d=null,re=null,g=null,s=null};function qe(C){return()=>{throw new Error(`The "${C}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return g.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(C){return D.getItem(eo(C))},this.getPluginName=function(C){return C===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:D.getId(C)},this.getInstance=function(){return s},this.addHook=function(C,R,T){Ae.getSingleton().add(C,R,s,T)},this.hasHook=function(C){return Ae.getSingleton().has(C,s)||Ae.getSingleton().has(C)},this.addHookOnce=function(C,R,T){Ae.getSingleton().once(C,R,s,T)},this.removeHook=function(C,R){Ae.getSingleton().remove(C,R,s)},this.runHooks=function(C,R,T,A,k,z,le){return Ae.getSingleton().run(s,C,R,T,A,k,z,le)},this.getTranslatedPhrase=function(C,R){return yz(H.language,C,R)},this.toHTML=()=>V$(this),this.toTableElement=()=>{const C=this.rootDocument.createElement("div");return C.insertAdjacentHTML("afterbegin",V$(this)),C.firstElementChild},this.timeouts=[],this.useTheme=C=>{this.view.getStylesHandler().useTheme(C),this.runHooks("afterSetTheme",C,!!y)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(C){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,T=C;typeof T=="function"&&(T=setTimeout(T,R)),this.timeouts.push(T)},this._clearTimeouts=function(){W(this.timeouts,C=>{clearTimeout(C)})},this.immediates=[],this._registerImmediate=function(C){this.immediates.push(setImmediate(C))},this._clearImmediates=function(){W(this.immediates,C=>{clearImmediate(C)})},this._getEditorManager=function(){return g},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const F=Fie({handleEvent(){return s.isListening()},beforeKeyDown:C=>this.runHooks("beforeKeyDown",C),afterKeyDown:C=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",C)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",C=>{C.ctrlKey===!1&&C.metaKey===!1&&F.releasePressedKeys()}),this.getShortcutManager=function(){return F},this.getFocusManager=function(){return p},L2().forEach(C=>{const R=eA(C);D.addItem(C,new R(this))}),Rie(s),F.setActiveContextName("grid"),Ae.getSingleton().run(s,"construct")}function nB(t,e,n){t.addEventListener(e,n,!1)}function iB(t,e,n){t.removeEventListener(e,n,!1)}function Nw(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Nz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:p=>p.value,...e},i=t.body,r=t.createTextNode(""),s=t.createElement("span");let a;function u(){var p,w;r.textContent=n.textContent(a),s.style.position="absolute",s.style.fontSize=Nw(a).fontSize,s.style.fontFamily=Nw(a).fontFamily,s.style.whiteSpace="pre",i.appendChild(s);const y=parseInt(((p=Nw(a))===null||p===void 0?void 0:p.paddingInlineStart)||0,10),S=parseInt(((w=Nw(a))===null||w===void 0?void 0:w.paddingInlineEnd)||0,10),_=s.clientWidth+y+S+1;i.removeChild(s);const E=a.style;E.height=`${n.minHeight}px`,n.minWidth>_?E.width=`${n.minWidth}px`:_>n.maxWidth?E.width=`${n.maxWidth}px`:E.width=`${_}px`;const H=a.scrollHeight?a.scrollHeight-1:0;n.minHeight>H?E.height=`${n.minHeight}px`:n.maxHeight<H?(E.height=`${n.maxHeight}px`,E.overflowY="visible"):E.height=`${H}px`}function h(){t.defaultView.setTimeout(u,0)}function d(p){if(p&&p.minHeight)if(p.minHeight==="inherit")n.minHeight=a.clientHeight;else{const w=parseInt(p.minHeight,10);isNaN(w)||(n.minHeight=w)}if(p&&p.maxHeight)if(p.maxHeight==="inherit")n.maxHeight=a.clientHeight;else{const w=parseInt(p.maxHeight,10);isNaN(w)||(n.maxHeight=w)}if(p&&p.minWidth)if(p.minWidth==="inherit")n.minWidth=a.clientWidth;else{const w=parseInt(p.minWidth,10);isNaN(w)||(n.minWidth=w)}if(p&&p.maxWidth)if(p.maxWidth==="inherit")n.maxWidth=a.clientWidth;else{const w=parseInt(p.maxWidth,10);isNaN(w)||(n.maxWidth=w)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(r))}function g(p,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;a=p,d(w),a.nodeName==="TEXTAREA"&&(a.style.resize="none",a.style.height=`${n.minHeight}px`,a.style.minWidth=`${n.minWidth}px`,a.style.maxWidth=`${n.maxWidth}px`,a.style.overflowY="hidden"),y&&(nB(a,"input",u),nB(a,"keydown",h)),u()}return{init:g,resize:u,unObserve(){iB(a,"input",u),iB(a,"keydown",h)}}}function rB(t,e){const n=m2(e),i=e.value.split(`
`);let r=n,s=0;for(let a=0;a<i.length;a++){const u=i[a];a!==0&&(s+=i[a-1].length+1);const h=s+u.length;if(t==="home"?r=s:t==="end"&&(r=h),n<=h)break}SS(e,r)}function Qu(t,e,n){return(e=Bie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bie(t){var e=Wie(t,"string");return typeof e=="symbol"?e:e+""}function Wie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Uie="ht_editor_visible",Dw="ht_editor_hidden",sB="textEditor",jie="text";class oh extends Cf{static get EDITOR_TYPE(){return jie}constructor(e){super(e),Qu(this,"eventManager",new to(this)),Qu(this,"autoResize",Nz(this.hot.rootDocument)),Qu(this,"TEXTAREA",void 0),Qu(this,"textareaStyle",void 0),Qu(this,"TEXTAREA_PARENT",void 0),Qu(this,"textareaParentStyle",void 0),Qu(this,"layerClass",void 0),this.eventManager=new to(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),U7(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,i,r,s,a){const u=this.state;if(super.prepare(e,n,i,r,s,a),!a.readOnly){this.refreshDimensions(!0);const{allowInvalid:h}=a;h&&!this.isOpened()&&(this.TEXTAREA.value=""),u!==Ln.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Ln.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),SS(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ge(this.TEXTAREA,[["data-hot-input",""],pf(-1)]),fe(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),fe(this.TEXTAREA_PARENT,"handsontableInputHolder"),ze(this.TEXTAREA_PARENT,this.layerClass)&&je(this.TEXTAREA_PARENT,this.layerClass),fe(this.TEXTAREA_PARENT,Dw),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){fX()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",je(this.TEXTAREA_PARENT,this.layerClass),fe(this.TEXTAREA_PARENT,Dw)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;ke(e.length-1,i=>{const r=e[i];if(ze(r,"handsontableEditor"))return n=!0,!1}),ze(this.TEXTAREA_PARENT,Dw)&&je(this.TEXTAREA_PARENT,Dw),n?(this.layerClass=Uie,fe(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),fe(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Ln.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:i,width:r,maxWidth:s,height:a,maxHeight:u}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const h=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,s),minHeight:Math.min(a,u),maxWidth:s,maxHeight:u},!0)}bindEvents(){E2()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Ln.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Ln.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>Pe(this.hot.getSelected()),group:sB},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[u]=a;rB(u,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[u]=a;rB(u,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(sB)}}const zie="base";function Pp(t,e,n,i,r,s,a){const u=a.ariaTags,h=[],d=[],g=[],p=[];a.className&&fe(e,a.className),a.readOnly?(h.push(a.readOnlyCellClassName),u&&p.push(s$())):u&&g.push(s$()[0]),a.valid===!1&&a.invalidCellClassName?(h.push(a.invalidCellClassName),u&&p.push(o$())):(d.push(a.invalidCellClassName),u&&g.push(o$()[0])),a.wordWrap===!1&&a.noWordWrapClassName&&h.push(a.noWordWrapClassName),!s&&a.placeholder&&h.push(a.placeholderCellClassName),je(e,d),fe(e,h),vf(e,g),Ge(e,p)}Pp.RENDERER_TYPE=zie;const Yie="text";function ll(t,e,n,i,r,s,a){Pp.apply(this,[t,e,n,i,r,s,a]);let u=s;if(!u&&a.placeholder&&(u=a.placeholder),u=zn(u),a.trimWhitespace&&(u=u.trim()),a.rendererTemplate){Go(e);const h=t.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=t.getSourceDataAtRow(n),e.appendChild(h)}else zc(e,u)}ll.RENDERER_TYPE=Yie;const Gie="text",Dz={CELL_TYPE:Gie,editor:oh,renderer:ll};$s(Dz);yr.editors={BaseEditor:Cf};function yr(t,e){const n=new Iz(t,e||{},vA);return n.init(),n}yr.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Iz(t,e,vA)};yr.DefaultSettings=_z();yr.hooks=Ae.getSingleton();yr.CellCoords=Gc;yr.CellRange=Op;yr.packageName="handsontable";yr.buildDate="19/02/2025 10:01:07";yr.version="15.1.0";yr.languages={dictionaryKeys:cte,getLanguageDictionary:wz,getLanguagesDictionaries:mte,registerLanguageDictionary:vz,getTranslatedPhrase:yz};var T_=null,qie="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",Kie="Providing a component-based renderer using `hot-renderer`-annotated component is no longer supported. Pass your component using `renderer` prop of the `HotTable` or `HotColumn` component instead.",Xie="Providing a component-based editor using `hot-editor`-annotated component is no longer supported. Pass your component using `editor` prop of the `HotTable` or `HotColumn` component instead.",Zie="Unexpected children nodes found in HotTable component. Only HotColumn components are allowed.",Qie="Unexpected children nodes found in HotColumn component. HotColumn components do not support any children.",Jie="The Handsontable instance bound to this component was destroyed and cannot be used properly.",ere="hot-wrapper-editor-container";function rp(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function O1(t){return oB(t,"hot-renderer")?(rp(Kie),!0):oB(t,"hot-editor")?(rp(Xie),!0):!1}function tre(t,e){var n=ci.Children.toArray(t);return n.some(function(i){return i.type!==e})?(rp(Zie),!0):!1}function nre(t){var e=ci.Children.toArray(t);return e.length?(rp(Qie),!0):!1}function oB(t,e){var n=ci.Children.toArray(t);return n.some(function(i){return i.props[e]!==void 0})}function Lz(t,e){if(!t||!e)return null;var n=ci.createElement(e,null),i=kz({},!1);return i.className="".concat(ere," ").concat(i.className),xU.createPortal(ci.createElement("div",Object.assign({},i),n),t.body)}function ire(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;e||(e=document),T_||(T_=e.createDocumentFragment());var r=i??e.createElement("DIV");return T_.appendChild(r),{portal:xU.createPortal(t,r,n),portalContainer:r}}function kz(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function rre(){return typeof window<"u"}function sre(t,e){var n=ci.useRef(!1);Xe.useEffect(function(){if(n.current)return t();n.current=!0},e)}function A1(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function ore(t){if(Array.isArray(t))return t}function are(t){if(Array.isArray(t))return A1(t)}function lre(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ure(t,e,n){return e=RC(e),vre(t,Fz()?Reflect.construct(e,n||[],RC(t).constructor):e.apply(t,n))}function Vz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aB(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Sre(i.key),i)}}function $z(t,e,n){return e&&aB(t.prototype,e),n&&aB(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function RC(t){return RC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},RC(t)}function cre(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x1(t,e)}function Fz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fz=function(){return!!t})()}function hre(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dre(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,a,u=[],h=!0,d=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(h=(i=s.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(g){d=!0,r=g}finally{try{if(!h&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(d)throw r}}return u}}function fre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mre(t,e){if(t==null)return{};var n,i,r=pre(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function pre(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function vre(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lre(t)}function x1(t,e){return x1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},x1(t,e)}function wre(t,e){return ore(t)||dre(t,e)||Bz(t,e)||fre()}function yre(t){return are(t)||hre(t)||Bz(t)||gre()}function Cre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Sre(t){var e=Cre(t,"string");return typeof e=="symbol"?e:e+""}function Bz(t,e){if(t){if(typeof t=="string")return A1(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A1(t,e):void 0}}var Wz=function(){function t(){Vz(this,t)}return $z(t,null,[{key:"getSettings",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.prevProps,s=r===void 0?{}:r,a=i.isInit,u=a===void 0?!1:a,h=i.initOnlySettingKeys,d=h===void 0?[]:h,g=function(S){return!u&&d.includes(S)?s[S]===n[S]:!1},p={};for(var w in n)w!=="children"&&!g(w)&&n.hasOwnProperty(w)&&(p[w]=n[w]);return p}}])}(),Uz=Xe.createContext(void 0),bre=function(e){var n=e.children,i=Xe.useRef([]),r=Xe.useCallback(function(E,H){i.current[H]=E},[]),s=Xe.useRef(new Map),a=Xe.useRef(new Map),u=Xe.useCallback(function(){return a.current.clear()},[]),h=Xe.useRef(new Map),d=Xe.useCallback(function(){return h.current.clear()},[]),g=Xe.useRef(new Map),p=Xe.useCallback(function(E){return function(x,D,$,V,L,U,re){var se="".concat($,"-").concat(V),Q=x.guid,de="".concat(Q,"-").concat(se),me="".concat(se,"-").concat(Q);if(a.current.has(se)&&(D.innerHTML=a.current.get(se).innerHTML),D&&!D.getAttribute("ghost-table")){for(var _e=h.current.get(me),Ee=g.current.get(de);D.firstChild;)D.removeChild(D.firstChild);if(_e&&Ee)D.appendChild(Ee);else{var Te=ci.createElement(E,{instance:x,TD:D,row:$,col:V,prop:L,value:U,cellProperties:re}),ve=ire(Te,D.ownerDocument,me,Ee),Ce=ve.portal,Re=ve.portalContainer;g.current.set(de,Re),D.appendChild(Re),h.current.set(me,Ce)}}return a.current.set("".concat($,"-").concat(V),D),D}},[]),w=Xe.useRef(function(){}),y=Xe.useCallback(function(E){w.current=E},[]),S=Xe.useCallback(function(){w.current(yre(h.current.values()))},[]),_=Xe.useMemo(function(){return{componentRendererColumns:s.current,columnsSettings:i.current,emitColumnSettings:r,getRendererWrapper:p,clearPortalCache:d,clearRenderedCellCache:u,setRenderersPortalManagerRef:y,pushCellPortalsIntoPortalManager:S}},[r,p,u,y,S]);return ci.createElement(Uz.Provider,{value:_},n)};function jz(){return Xe.useContext(Uz)}var zz=Xe.createContext(void 0),Rre=function(e){var n=e.columnIndex,i=e.getOwnerDocument,r=e.children,s=Xe.useMemo(function(){return{columnIndex:n,getOwnerDocument:i}},[n,i]);return ci.createElement(zz.Provider,{value:s},r)},Ere=function(){return Xe.useContext(zz)},Tre=["close","focus","open"],_re=["getValue","setValue"],__={open:"onOpen",close:"onClose",prepare:"onPrepare",focus:"onFocus"};function Yz(t,e){return function(n){function i(r){var s;return Vz(this,i),s=ure(this,i,[r]),e.current=s,Object.getOwnPropertyNames(yr.editors.BaseEditor.prototype).forEach(function(a){if(!(a==="constructor"||_re.includes(a))){var u=yr.editors.BaseEditor.prototype[a];i.prototype[a]=(function(){for(var h,d,g=arguments.length,p=new Array(g),w=0;w<g;w++)p[w]=arguments[w];if(Tre.includes(a)||(d=u.call.apply(u,[this].concat(p))),__[a]&&(h=t.current)!==null&&h!==void 0&&h[__[a]]){var y;d=(y=t.current[__[a]]).call.apply(y,[this].concat(p))}return d}).bind(s)}}),s}return cre(i,n),$z(i,[{key:"focus",value:function(){}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(s){this.value=s}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(yr.editors.BaseEditor)}var Mre=Xe.createContext(void 0),Gz=function(e){var n=e.hooksRef,i=e.hotCustomEditorInstanceRef,r=e.children;return ci.createElement(Mre.Provider,{value:{hooksRef:n,hotCustomEditorInstanceRef:i}},r)},Ore=function(e){return e.type===Gx},Are=["_columnIndex","_getOwnerDocument","children"],Gx=function(e){var n=jz(),i=n.componentRendererColumns,r=n.emitColumnSettings,s=n.getRendererWrapper,a=Ere(),u=a.columnIndex,h=a.getOwnerDocument,d=Xe.useRef(null),g=Xe.useRef(null);Xe.useEffect(function(){var w=function(){return Object.keys(e).filter(function(E){return!Are.includes(E)}).reduce(function(E,H){return E[H]=e[H],E},{})},y=function(){var E=Wz.getSettings(w());return e.renderer?(E.renderer=s(e.renderer),i.set(u,!0)):e.hotRenderer&&(E.renderer=e.hotRenderer),e.editor?E.editor=Yz(d,g):e.hotEditor&&(E.editor=e.hotEditor),E},S=y();r(S,u),O1(e.children)||nre(e.children)});var p=Lz(h(),e.editor);return ci.createElement(Gz,{hooksRef:d,hotCustomEditorInstanceRef:g},p)},xre="15.1.0",Hre=Xe.forwardRef(function(t,e){var n=Xe.useState([]),i=wre(n,2),r=i[0],s=i[1];return Xe.useImperativeHandle(e,function(){return s}),ci.createElement(Xe.Fragment,null,r)});function Pre(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qz={exports:{}},M_,lB;function Ire(){if(lB)return M_;lB=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return M_=t,M_}var O_,uB;function Nre(){if(uB)return O_;uB=1;var t=Ire();function e(){}function n(){}return n.resetWarningCache=e,O_=function(){function r(u,h,d,g,p,w){if(w!==t){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}r.isRequired=r;function s(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:n,resetWarningCache:e};return a.PropTypes=a,a},O_}qz.exports=Nre()();var Dre=qz.exports,A_=Pre(Dre),Kz=Xe.forwardRef(function(t,e){var n=Xe.useRef(null),i=Xe.useRef(null),r=Xe.useRef(null),s=Xe.useRef(null),a=Xe.useRef(),u=jz(),h=Xe.useCallback(function(){return!n.current||!n.current.isDestroyed?n.current:(console.warn(Jie),null)},[n]),d=Xe.useCallback(function(){return!n.current||n.current.isDestroyed},[n]),g=Xe.useCallback(function(){u.clearRenderedCellCache(),u.componentRendererColumns.clear()},[u]),p=Xe.useCallback(function(){return rre()?i.current?i.current.ownerDocument:document:null},[i]),w=function(){var x,D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},V=d()?[]:((x=h())===null||x===void 0||(x=x.getSettings())===null||x===void 0?void 0:x._initOnlySettings)||[],L=Wz.getSettings(t,{prevProps:$,isInit:D,initOnlySettingKeys:V});return L.columns=u.columnsSettings.length?u.columnsSettings:L.columns,t.renderer?(L.renderer=u.getRendererWrapper(t.renderer),u.componentRendererColumns.set("global",!0)):L.renderer=t.hotRenderer||C1("text"),t.editor?L.editor=Yz(r,s):L.editor=t.hotEditor||p1("text"),L},y=function(x){var D,$;x&&((D=x.getPlugin("autoRowSize"))!==null&&D!==void 0&&D.enabled||($=x.getPlugin("autoColumnSize"))!==null&&$!==void 0&&$.enabled)&&u.componentRendererColumns.size>0&&rp(qie)};Xe.useEffect(function(){var H=w(!0);return a.current=t,n.current=new yr.Core(i.current,H),n.current.addHook("beforeViewRender",function(){u.clearPortalCache(),u.clearRenderedCellCache()}),n.current.addHook("afterViewRender",function(){u.pushCellPortalsIntoPortalManager()}),n.current.init(),y(n.current),O1(t.children)||tre(t.children,Gx),function(){var x;g(),(x=h())===null||x===void 0||x.destroy()}},[]),sre(function(){g();var H=h(),x=w(!1,a.current);a.current=t,H==null||H.updateSettings(x,!1),y(H),O1(t.children)}),Xe.useImperativeHandle(e,function(){return{get hotElementRef(){return i.current},get hotInstance(){return h()}}});var S=Xe.Children.toArray(t.children).filter(Ore).map(function(H,x){return ci.createElement(Rre,{columnIndex:x,getOwnerDocument:p,key:x},H)}),_=kz(t),E=Lz(p(),t.editor);return ci.createElement(Xe.Fragment,null,ci.createElement("div",Object.assign({ref:i},_),S),ci.createElement(Hre,{ref:u.setRenderersPortalManagerRef}),ci.createElement(Gz,{hooksRef:r,hotCustomEditorInstanceRef:s},E))});Kz.propTypes={style:A_.object,id:A_.string,className:A_.string};var Lre=["children"],Xz=Xe.forwardRef(function(t,e){var n,i=t.children,r=mre(t,Lre),s=(n=r.id)!==null&&n!==void 0?n:Xe.useId();return ci.createElement(bre,null,ci.createElement(Kz,Object.assign({id:s},r,{ref:e}),i))});Xz.version=xre;const cB="handsontableEditor",kre="handsontable";class qx extends oh{static get EDITOR_TYPE(){return kre}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),SS(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,i,r,s,a){super.prepare(e,n,i,r,s,a);const u=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(d,g){const p=this.getSourceData(g.row,g.col);p!==void 0&&u.setValue(p),u.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&ti(h,a.handsontable),this.htOptions=h}beginEditing(e,n){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,n,i)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var i;(i=this.htEditor)===null||i===void 0||i.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:cB,relativeToGroup:Cu,position:"before"},r=(s,a)=>{const u=this.htEditor;if(s!==void 0&&(s<0||u.flipped&&s>u.countRows()-1?u.deselectCell():u.selectCell(s,0),u.getData().length))return a.preventDefault(),so(a),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const a=this.htEditor;let u,h;return!a.getSelectedLast()&&a.flipped?u=a.countRows()-1:a.getSelectedLast()&&(a.flipped?(h=a.getSelectedLast()[0],u=Math.max(0,h-1)):(h=a.getSelectedLast()[0],u=h-1)),r(u,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const a=this.htEditor;let u,h;if(!a.getSelectedLast()&&!a.flipped)u=0;else if(a.getSelectedLast()){if(a.flipped)u=a.getSelectedLast()[0]+1;else if(!a.flipped){const d=a.countRows()-1;h=a.getSelectedLast()[0],u=Math.min(d,h+1)}}return r(u,s)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(cB)}}function Vre(t,e,n){$re(t,e),e.set(t,n)}function $re(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lw(t,e,n){return(e=Fre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fre(t){var e=Bre(t,"string");return typeof e=="symbol"?e:e+""}function Bre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hB(t,e){return t.get(Wre(t,e))}function Wre(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ure="autocomplete";var x_=new WeakMap;class Kx extends qx{constructor(){super(...arguments),Lw(this,"query",null),Lw(this,"strippedChoices",[]),Lw(this,"rawChoices",[]),Vre(this,x_,this.hot.guid.slice(0,9)),Lw(this,"sortByRelevance",function(e,n,i){const r=[],s=[],a=e.length;let u=n.length,h,d,g,p;if(a===0){for(g=0;g<u;g++)s.push(g);return s}for(g=0;g<u;g++){if(d=r$(zn(n[g])),i)p=d.indexOf(e);else{const w=this.cellProperties.locale;p=d.toLocaleLowerCase(w).indexOf(e.toLocaleLowerCase(w))}p!==-1&&(h=d.length-p-a,r.push({baseIndex:g,index:p,charsLeft:h,value:d}))}for(r.sort((w,y)=>{if(y.index===-1)return-1;if(w.index===-1)return 1;if(w.index<y.index)return-1;if(y.index<w.index)return 1;if(w.index===y.index){if(w.charsLeft<y.charsLeft)return-1;if(w.charsLeft>y.charsLeft)return 1}return 0}),g=0,u=r.length;g<u;g++)s.push(r[g].baseIndex);return s})}static get EDITOR_TYPE(){return Ure}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return Pe(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),fe(this.htContainer,"autocompleteEditor"),fe(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ge(this.TEXTAREA,[H7(),_7(),s2("listbox"),D7()])}prepare(e,n,i,r,s,a){super.prepare(e,n,i,r,s,a),this.hot.getSettings().ariaTags&&Ge(this.TEXTAREA,[Cs("false"),L7(`${hB(x_,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i==null?void 0:i.length,{row:s,col:a}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",u=>this.onBeforeKeyDown(u)),this.htEditor.updateSettings({colWidths:e?[jn(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(u,h,d,g,p,w,y)=>{ll(u,h,d,g,p,w,y);const{filteringCaseSensitive:S,allowHtml:_,locale:E}=this.cellProperties,H=this.query;let x=zn(w),D,$;x&&!_&&(D=S===!0?x.indexOf(H):x.toLocaleLowerCase(E).indexOf(H.toLocaleLowerCase(E)),D!==-1&&($=x.substr(D,H.length),x=x.replace($,`<strong>${$}</strong>`))),n&&Ge(h,[M7(),...i?[F7(r)]:[],...i?[B7(i.indexOf(w)+1)]:[],["id",`${this.htEditor.rootElement.id}_${d}-${g}`]]),h.innerHTML=x},afterSelectionEnd:(u,h)=>{if(n){const d=this.htEditor.getCell(u,h,!0);Ge(d,[UO()]),Ge(this.TEXTAREA,...k7(d.id))}}}),n&&(Ge(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...jo()),Ge(this.htEditor.rootElement,[r2(),V7("polite"),$7("text"),["id",`${hB(x_,this)}-listbox-${s}-${a}`]]),Ge(this.TEXTAREA,...Cs("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ge(this.TEXTAREA,[Cs("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=m2(this.TEXTAREA),i=X7(this.TEXTAREA),r=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let a=null,u=null,h=e;r&&(a=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),h,this.cellProperties.filteringCaseSensitive));const d=Array.isArray(a)?a.length:0;if(s===!1)u=d>0?a[0]:0;else{const g=[];for(let p=0,w=h.length;p<w&&!(r&&d<=p);p++)d?g.push(h[a[p]]):g.push(h[p]);u=0,h=g}this.strippedChoices=h,h.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Uy([h])),h.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(u)),this.hot.listen(),SS(this.TEXTAREA,n,n===i?void 0:i)}flipDropdownIfNeeded(){const e=ef(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(n||!n&&(i||i==="horizontal"))return!1;const r=Ci(this.TEXTAREA),s=$n(this.TEXTAREA),a=this.getHeight(),u=e.scrollTop,h=$n(this.hot.view._wt.wtTable.THEAD),d=Ci(e),g=r.top-d.top-h+u,p=e.scrollHeight-g-h-s,w=a>p&&g>p;return w?this.flipDropdown(a):this.unflipDropdown(),this.limitDropdownIfNeeded(w?g:p,a),w}limitDropdownIfNeeded(e,n){if(n>e){let i=0,r=0,s=0,a=null;do s=this.htEditor.getRowHeight(r)||this.htEditor.view.getDefaultRowHeight(),i+=s,r+=1;while(i<e);a=i-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-a}px`),this.setDropdownHeight(i-s)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+Mi(this.hot.rootDocument)}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),i=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:i},(s,a)=>a).reduce((s,a)=>s+this.htEditor.getRowHeight(a),0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,i=Rt(e,s=>zn(s));return Rt(i,s=>n?s:r$(s))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),i={row:n?n.from.row:-1};let r=!1;return e===We.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),e===We.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(e){if(mX(e.keyCode)||e.keyCode===We.BACKSPACE||e.keyCode===We.DELETE||e.keyCode===We.INSERT){let n=10;if(e.keyCode===We.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const jre="checkbox";class Zz extends Cf{static get EDITOR_TYPE(){return jre}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');ze(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const su=()=>window,ps=()=>window.document,H1=(t,e)=>window.setTimeout(t,e),Ho=function(t,e,n,i){t.addEventListener(e,n,!!i)},_a=function(t,e,n,i){t.removeEventListener(e,n,!!i)},zre=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Nr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},H_=function(t,e){Nr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},P_=function(t,e){t.className=zre((" "+t.className+" ").replace(" "+e+" "," "))},Xx=function(t){return/Array/.test(Object.prototype.toString.call(t))},Vr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Yre=function(t){let e=t.getDay();return e===0||e===6},Gre=function(t){return t%4===0&&t%100!==0||t%400===0},dB=function(t,e){return[31,Gre(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},kw=function(t){Vr(t)&&t.setHours(0,0,0,0)},Vw=function(t,e){return t.getTime()===e.getTime()},EC=function(t,e,n){let i,r;for(i in e)r=t[i]!==void 0,r&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?Vr(e[i])?n&&(t[i]=new Date(e[i].getTime())):Xx(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=EC({},e[i],n):(n||!r)&&(t[i]=e[i]);return t},fB=function(t,e,n){let i=ps().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=EC(i,n),t.dispatchEvent(i)},gB=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},yo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},mB=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},qre=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},Kre=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),r=e,s=r-1,a=7,u=function(w){return(w+a-1)%a};t.setDate(n+s-u(i));let h=new Date(t.getFullYear(),0,r),d=24*60*60*1e3,g=(t.getTime()-h.getTime())/d;return 1+Math.round((g-s+u(h.getDay()))/a)},Xre=function(t,e,n,i,r){let s=new Date(i,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():Kre(s,r))+"</td>"},Zre=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Qre=function(t){return"<tbody>"+t.join("")+"</tbody>"},Jre=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+mB(t,e)+'">'+mB(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},ese=function(t,e,n,i,r,s){let a,u,h,d=t._o,g=n===d.minYear,p=n===d.maxYear,w='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',y,S,_=!0,E=!0;for(h=[],a=0;a<12;a++)h.push('<option value="'+(n===r?a-e:12+a-e)+'"'+(a===i?' selected="selected"':"")+(g&&a<d.minMonth||p&&a>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[a]+"</option>");for(y='<div class="pika-label">'+d.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+h.join("")+"</select></div>",Xx(d.yearRange)?(a=d.yearRange[0],u=d.yearRange[1]+1):(a=n-d.yearRange,u=1+n+d.yearRange),h=[];a<u&&a<=d.maxYear;a++)a>=d.minYear&&h.push('<option value="'+a+'"'+(a===n?' selected="selected"':"")+">"+a+"</option>");return S='<div class="pika-label">'+n+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+h.join("")+"</select></div>",d.showMonthAfterYear?w+=S+y:w+=y+S,g&&(i===0||d.minMonth>=i)&&(_=!1),p&&(i===11||d.maxMonth<=i)&&(E=!1),e===0&&(w+='<button class="pika-prev'+(_?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(w+='<button class="pika-next'+(E?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),w+="</div>"},tse=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Jre(t)+Qre(e)+"</table>"};function P1(t){let e=this,n=e.config(t);e._onMouseDown=function(r){if(!e._v)return;r=r||su().event;let s=r.target||r.srcElement;if(s)if(Nr(s,"is-disabled")||(Nr(s,"pika-button")&&!Nr(s,"is-empty")&&!Nr(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),n.bound&&H1(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Nr(s,"pika-prev")?e.prevMonth():Nr(s,"pika-next")&&e.nextMonth()),Nr(s,"pika-select"))e._c=!0;else if(r.preventDefault)r.preventDefault();else return r.returnValue=!1,!1},e._onChange=function(r){r=r||su().event;let s=r.target||r.srcElement;s&&(Nr(s,"pika-select-month")?e.gotoMonth(s.value):Nr(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(r){if(r=r||su().event,e.isVisible())switch(r.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let r=this.moment(n.field.value,n.format,n.formatStrict);return r&&r.isValid()?r.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(r){let s;r.firedBy!==e&&(s=e._parseFieldValue(),Vr(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let r=ps().activeElement;do if(Nr(r,"pika-single"))return;while(r=r.parentNode);e._c||(e._b=H1(function(){e.hide()},50)),e._c=!1},e._onClick=function(r){r=r||su().event;let s=r.target||r.srcElement,a=s;if(s){!hasEventListeners&&Nr(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),Ho(s,"change",e._onChange)));do if(Nr(a,"pika-single")||a===n.trigger)return;while(a=a.parentNode);e._v&&s!==n.trigger&&a!==n.trigger&&e.hide()}},e.el=ps().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Ho(e.el,"mousedown",e._onMouseDown,!0),Ho(e.el,"touchend",e._onMouseDown,!0),Ho(e.el,"change",e._onChange),n.keyboardInput&&Ho(ps(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?ps().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Ho(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;Vr(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Ho(n.trigger,"click",e._onInputClick),Ho(n.trigger,"focus",e._onInputFocus),Ho(n.trigger,"blur",e._onInputBlur)):this.show()}P1.prototype={config:function(t){this._o||(this._o=EC({},yo,!0));let e=EC(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Vr(e.minDate)||(e.minDate=!1),Vr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),Xx(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||yo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Vr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Vr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",fB(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Vr(t))return;let n=this._o.minDate,i=this._o.maxDate;Vr(n)&&t<n?t=n:Vr(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),kw(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fB(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Vr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,r;t==="add"?r=new Date(n.valueOf()+i):t==="subtract"&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=gB(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=gB({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(kw(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=yo.minDate,this._o.minYear=yo.minYear,this._o.minMonth=yo.minMonth,this._o.startRange=yo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(kw(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=yo.maxDate,this._o.maxYear=yo.maxYear,this._o.maxMonth=yo.maxMonth,this._o.endRange=yo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,i=e.maxYear,r=e.minMonth,s=e.maxMonth,a="",u;this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let h=0;h<e.numberOfMonths;h++)u="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+ese(this,h,this.calendars[h].year,this.calendars[h].month,this.calendars[0].year,u)+this.render(this.calendars[h].year,this.calendars[h].month,u)+"</div>";this.el.innerHTML=a,e.bound&&e.field.type!=="hidden"&&H1(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,i,r,s,a,u,h,d,g;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=su().innerWidth||ps().documentElement.clientWidth,r=su().innerHeight||ps().documentElement.clientHeight,s=ps().body.scrollTop||ps().documentElement.scrollTop,d=!0,g=!0,h=t.getBoundingClientRect(),a=h.left+su().pageXOffset,u=h.bottom+su().pageYOffset,(this._o.reposition&&a+e>i||this._o.position.indexOf("right")>-1&&a-e+t.offsetWidth>0)&&(a=a-e+t.offsetWidth,d=!1),(this._o.reposition&&u+n>r+s||this._o.position.indexOf("top")>-1&&u-n-t.offsetHeight>0)&&(u=u-n-t.offsetHeight,g=!1),a<0&&(a=0),u<0&&(u=0),this.el.style.left=a+"px",this.el.style.top=u+"px",H_(this.el,d?"left-aligned":"right-aligned"),H_(this.el,g?"bottom-aligned":"top-aligned"),P_(this.el,d?"right-aligned":"left-aligned"),P_(this.el,g?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,r=new Date,s=dB(t,e),a=new Date(t,e,1).getDay(),u=[],h=[];kw(r),i.firstDay>0&&(a-=i.firstDay,a<0&&(a+=7));let d=e===0?11:e-1,g=e===11?0:e+1,p=e===0?t-1:t,w=e===11?t+1:t,y=dB(p,d),S=s+a,_=S;for(;_>7;)_-=7;S+=7-_;let E=!1;for(let H=0,x=0;H<S;H++){let D=new Date(t,e,1+(H-a)),$=Vr(this._d)?Vw(D,this._d):!1,V=Vw(D,r),L=i.events.indexOf(D.toDateString())!==-1,U=H<a||H>=s+a,re=1+(H-a),se=e,Q=t,de=i.startRange&&Vw(i.startRange,D),me=i.endRange&&Vw(i.endRange,D),_e=i.startRange&&i.endRange&&i.startRange<D&&D<i.endRange,Ee=i.minDate&&D<i.minDate||i.maxDate&&D>i.maxDate||i.disableWeekends&&Yre(D)||i.disableDayFn&&i.disableDayFn(D);U&&(H<a?(re=y+re,se=d,Q=p):(re=re-s,se=g,Q=w));let Te={day:re,month:se,year:Q,hasEvent:L,isSelected:$,isToday:V,isDisabled:Ee,isEmpty:U,isStartRange:de,isEndRange:me,isInRange:_e,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&$&&(E=!0),h.push(qre(Te)),++x===7&&(i.showWeekNumber&&h.unshift(Xre(this,H-a,e,t,i.firstWeekOfYearMinDays)),u.push(Zre(h,i.isRTL,i.pickWholeWeek,E)),h=[],x=0,E=!1)}return tse(i,u,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),P_(this.el,"is-hidden"),this._o.bound&&(Ho(ps(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&_a(ps(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),H_(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),_a(this.el,"mousedown",this._onMouseDown,!0),_a(this.el,"touchend",this._onMouseDown,!0),_a(this.el,"change",this._onChange),t.keyboardInput&&_a(ps(),"keydown",this._onKeyChange),t.field&&(_a(t.field,"change",this._onInputChange),t.bound&&(_a(t.trigger,"click",this._onInputClick),_a(t.trigger,"focus",this._onInputFocus),_a(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function I_(t,e,n){return(e=nse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nse(t){var e=ise(t,"string");return typeof e=="symbol"?e:e+""}function ise(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Qz="date",pB="dateEditor";class Jz extends oh{constructor(){super(...arguments),I_(this,"defaultDateFormat","DD/MM/YYYY"),I_(this,"parentDestroyed",!1),I_(this,"$datePicker",null)}static get EDITOR_TYPE(){return Qz}init(){if(typeof pe!="function")throw new Error("You need to include moment.js to your project.");if(typeof P1!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(je(this.datePicker,/ht-theme-.*/g),fe(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),fe(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();je(this.datePicker,/ht-theme-.*/g),fe(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{ze(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,i,r,s,a){super.prepare(e,n,i,r,s,a)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:pB})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(pB),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),r=e?_2(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new P1(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(pe),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,pe(s,n,!0).isValid()&&this.$datePicker.setMoment(pe(s,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,pe(s,n,!0).isValid()&&this.$datePicker.setMoment(pe(s,n),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&RS(n,this.cellProperties.datePickerConfig);const i=n.onSelect,r=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=pe(a).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(a),i&&i(),Ga()&&this.hideDatepicker()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),r&&r()},n}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Ln.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:a}=(n=s.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,u=i.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleRow()),h=i.getVisualFromRenderableIndex(a.getLastPartiallyVisibleRow()),d=r.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleColumn()),g=r.getVisualFromRenderableIndex(a.getLastPartiallyVisibleColumn());if(this.row>=u&&this.row<=h&&this.col>=d&&this.col<=g){const p=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+p.top+$n(this.TD)}px`;let w=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?w+=p.right-jn(this.datePicker):w+=p.left,this.datePickerStyle.left=`${w}px`}else this.hideDatepicker()}}const rse="dropdown";class eY extends Kx{static get EDITOR_TYPE(){return rse}prepare(e,n,i,r,s,a){a.filter=!1,a.strict=!0,super.prepare(e,n,i,r,s,a)}}const sse="numeric";class tY extends oh{static get EDITOR_TYPE(){return sse}}function ose(t,e,n){return(e=ase(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ase(t){var e=lse(t,"string");return typeof e=="symbol"?e:e+""}function lse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const use="password";class nY extends oh{constructor(){super(...arguments),ose(this,"autoResize",Nz(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return use}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Go(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const N_="ht_editor_visible",vB="selectEditor",cse="select";class iY extends Cf{static get EDITOR_TYPE(){return cse}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...vu()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),fe(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ze(this.selectWrapper,N_)&&je(this.selectWrapper,N_),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,i,r,s,a){super.prepare(e,n,i,r,s,a);const u=this.cellProperties.selectOptions;let h;typeof u=="function"?h=this.prepareOptions(u(this.row,this.col,this.prop)):h=this.prepareOptions(u),Go(this.select),dt(h,(d,g)=>{const p=this.hot.rootDocument.createElement("OPTION");p.value=g,wf(p,d),this.select.appendChild(p)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)n[e[i]]=e[i];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Ln.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:i,height:r}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${r}px`,s.width=`${i}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${n}px`,s.margin="0px",fe(this.selectWrapper,N_)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={group:vB};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(vB)}}const hse="time";class rY extends oh{static get EDITOR_TYPE(){return hse}prepare(e,n,i,r,s,a){super.prepare(e,n,i,r,s,a),this.TEXTAREA.dir="ltr"}}function dse(){Dr(Cf),Dr(Kx),Dr(Zz),Dr(Jz),Dr(eY),Dr(qx),Dr(tY),Dr(nY),Dr(iY),Dr(oh),Dr(rY)}const fse="html";function Zx(t,e,n,i,r,s,a){Pp.apply(this,[t,e,n,i,r,s,a]),wf(e,s??"",!1)}Zx.RENDERER_TYPE=fse;const gse="autocomplete";function Sf(t,e,n,i,r,s,a){const{rootDocument:u}=t,h=a.allowHtml?Zx:ll,d=u.createElement("DIV"),g=t.getSettings().ariaTags;if(d.className="htAutocompleteArrow",g&&d.setAttribute(...vu()),d.appendChild(u.createTextNode("▼")),h.apply(this,[t,e,n,i,r,s,a]),e.firstChild||e.appendChild(u.createTextNode(" ")),e.insertBefore(d,e.firstChild),fe(e,"htAutocomplete"),!t.acArrowListener){const p=new to(t);t.acArrowListener=function(w){ze(w.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},p.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{p.destroy()})}}Sf.RENDERER_TYPE=gse;const mse="dropdown";function Qx(t,e,n,i,r,s,a){Sf.apply(this,[t,e,n,i,r,s,a])}Qx.RENDERER_TYPE=mse;const wB=new WeakMap,yB=new WeakMap,pse="htBadValue",rf="data-row",sf="data-col",vse="checkboxRenderer",sY="checkbox";Ae.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:i,type:r,row:s,column:a,prop:u}=e;if(r===sY){if(i){const{value:h,property:d}=i;let g=n;if(h)g=typeof h=="function"?h(s,a,u,n):h;else if(d){const p=this.getDataAtRowProp(s,d);g=p!==null?p:n}t=g}return t}});function Jx(t,e,n,i,r,s,a){const{rootDocument:u}=t,h=t.getSettings().ariaTags;Pp.apply(this,[t,e,n,i,r,s,a]),wse(t);let d=yse(u);const g=a.label;let p=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),Go(e),s===a.checkedTemplate||zn(s).toLocaleLowerCase(a.locale)===zn(a.checkedTemplate).toLocaleLowerCase(a.locale)?d.checked=!0:s===a.uncheckedTemplate||zn(s).toLocaleLowerCase(a.locale)===zn(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?d.checked=!1:Vn(s)?fe(d,"noValue"):(d.style.display="none",fe(d,pse),p=!0),Ge(d,[[rf,n],[sf,i]]),h&&Ge(d,[fC(d.checked?t.getTranslatedPhrase(Ux):t.getTranslatedPhrase(jx)),l2(d.checked),O7()]),!p&&g){let _="";if(g.value)_=typeof g.value=="function"?g.value.call(this,n,i,r,s):g.value;else if(g.property){const H=t.getDataAtRowProp(n,g.property);_=H!==null?H:""}const E=Cse(u,_,g.separated!==!0);g.position==="before"?g.separated?(e.appendChild(E),e.appendChild(d)):(E.appendChild(d),d=E):(!g.position||g.position==="after")&&(g.separated?(e.appendChild(d),e.appendChild(E)):(E.insertBefore(d,E.firstChild),d=E))}(!g||g&&!g.separated)&&e.appendChild(d),p&&e.appendChild(u.createTextNode("#bad-value#")),wB.has(t)||(wB.set(t,!0),w());function w(){const E=t.getShortcutManager().getContext("grid"),H={group:vse,relativeToGroup:Cu,position:"before"};E.addShortcuts([{keys:[["space"]],callback:()=>(y(),!S()),runOnlyIf:()=>{var x;return(x=t.getSelectedRangeLast())===null||x===void 0?void 0:x.highlight.isCell()}},{keys:[["enter"]],callback:()=>(y(),!S()),runOnlyIf:()=>{const x=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(x==null?void 0:x.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(y(!0),!S()),runOnlyIf:()=>{var x;return(x=t.getSelectedRangeLast())===null||x===void 0?void 0:x.highlight.isCell()}}],H)}function y(){let _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const E=t.getSelectedRange(),H=[],x=new Map;let D=[],$=0;if(E){for(let V=0;V<E.length;V++){const{row:L,col:U}=E[V].getTopStartCorner(),{row:re,col:se}=E[V].getBottomEndCorner();for(let Q=L;Q<=re;Q+=1)for(let de=U;de<=se;de+=1){const me=t.getCellMeta(Q,de);if(me.hidden)continue;const _e={checkedTemplate:me.checkedTemplate,uncheckedTemplate:me.uncheckedTemplate};if(me.type!=="checkbox"){_===!0&&!me.readOnly&&(x.has(H.length)?x.set(H.length,[...x.get(H.length),[Q,de,null]]):x.set(H.length,[[Q,de,null]]));continue}if(me.readOnly===!0)continue;typeof me.checkedTemplate>"u"&&(me.checkedTemplate=!0),typeof me.uncheckedTemplate>"u"&&(me.uncheckedTemplate=!1);const Ee=t.getDataAtCell(Q,de);_===!1?[me.checkedTemplate,me.checkedTemplate.toString()].includes(Ee)?D.push([Q,de,me.uncheckedTemplate,_e]):[me.uncheckedTemplate,me.uncheckedTemplate.toString(),null,void 0].includes(Ee)&&D.push([Q,de,me.checkedTemplate,_e]):D.push([Q,de,me.uncheckedTemplate,_e]),$+=1}H.push($),$=0}D.every(V=>{let[,,L]=V;return L===D[0][2]})?D=D.map(V=>{let[L,U,re]=V;return[L,U,re]}):D=D.map(V=>{let[L,U,,re]=V;return[L,U,re.checkedTemplate]}),D.length>0&&H.forEach((V,L)=>{let U=D.splice(0,V);x.size&&x.has(L)&&(U=[...U,...x.get(L)]),t.setDataAtCell(U)})}}function S(){const _=t.getSelectedRange();if(_){for(let E=0;E<_.length;E++){const H=_[E].getTopStartCorner(),x=_[E].getBottomEndCorner();for(let D=H.row;D<=x.row;D++)for(let $=H.col;$<=x.col;$++){if(t.getCellMeta(D,$).readOnly)continue;const L=t.getCell(D,$);if(L instanceof HTMLElement&&L.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}Jx.RENDERER_TYPE=sY;function wse(t){let e=yB.get(t);if(!e){const{rootElement:n}=t;e=new to(t),e.addEventListener(n,"click",i=>bse(i,t)),e.addEventListener(n,"mouseup",i=>Sse(i,t)),e.addEventListener(n,"change",i=>Rse(i,t)),yB.set(t,e)}return e}function yse(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Cse(t,e,n){const i=t.createElement("label");i.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const r=t.createTextNode(e);if(n){const s=t.createElement("span");s.appendChild(r),i.appendChild(s)}else i.appendChild(r);return i.cloneNode(!0)}function Sse(t,e){const{target:n}=t;eH(n)&&(!n.hasAttribute(rf)||!n.hasAttribute(sf)||setTimeout(e.listen,10))}function bse(t,e){const{target:n}=t;if(!eH(n)||!n.hasAttribute(rf)||!n.hasAttribute(sf))return;const i=parseInt(n.getAttribute(rf),10),r=parseInt(n.getAttribute(sf),10);e.getCellMeta(i,r).readOnly&&t.preventDefault()}function Rse(t,e){const{target:n}=t;if(!eH(n)||!n.hasAttribute(rf)||!n.hasAttribute(sf))return;const i=parseInt(n.getAttribute(rf),10),r=parseInt(n.getAttribute(sf),10),s=e.getCellMeta(i,r);if(!s.readOnly){let a=null;t.target.checked?a=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:a=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(i,r,a)}}function eH(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const Ese="handsontable";function tH(t,e,n,i,r,s,a){Sf.apply(this,[t,e,n,i,r,s,a])}tH.RENDERER_TYPE=Ese;var Tse=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _se(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var D_,CB;function Mse(){return CB||(CB=1,D_={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),D_}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var L_,SB;function oY(){if(SB)return L_;SB=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(h){return h.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(h,d,g,p,w,y,S){if(!isNaN(+h))return+h;let _="",E=h.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(E!==h)return-1*n(E,d,g,p,w,y);for(let L=0;L<t.length;L++){let U=t[L];if(_=h.replace(RegExp(`([0-9 ])(${U.key})$`),"$1"),_!==h)return n(_,d,g,p,w,y)*U.factor}if(_=h.replace("%",""),_!==h)return n(_,d,g,p,w,y)/100;let H=parseFloat(h);if(isNaN(H))return;let x=p(H);if(x&&x!=="."&&(_=h.replace(new RegExp(`${e(x)}$`),""),_!==h))return n(_,d,g,p,w,y);let D={};Object.keys(y).forEach(L=>{D[y[L]]=L});let $=Object.keys(D).sort().reverse(),V=$.length;for(let L=0;L<V;L++){let U=$[L],re=D[U];if(_=h.replace(U,""),_!==h){let se;switch(re){case"thousand":se=Math.pow(10,3);break;case"million":se=Math.pow(10,6);break;case"billion":se=Math.pow(10,9);break;case"trillion":se=Math.pow(10,12);break}return n(_,d,g,p,w,y)*se}}}function i(h,d,g){let p=h.replace(g,"");return p=p.replace(new RegExp(`([0-9])${e(d.thousands)}([0-9])`,"g"),"$1$2"),p=p.replace(d.decimal,"."),p}function r(h,d,g="",p,w,y,S){if(h==="")return;if(h===w)return 0;let _=i(h,d,g);return n(_,d,g,p,w,y)}function s(h,d){if(!(h.indexOf(":")&&d.thousands!==":"))return!1;let p=h.split(":");if(p.length!==3)return!1;let w=+p[0],y=+p[1],S=+p[2];return!isNaN(w)&&!isNaN(y)&&!isNaN(S)}function a(h){let d=h.split(":"),g=+d[0],p=+d[1];return+d[2]+60*p+3600*g}function u(h,d){const g=rH();let p=g.currentDelimiters(),w=g.currentCurrency().symbol,y=g.currentOrdinal(),S=g.getZeroFormat(),_=g.currentAbbreviations(),E;if(typeof h=="string")s(h,p)?E=a(h):E=r(h,p,w,y,S,_);else if(typeof h=="number")E=h;else return;if(E!==void 0)return E}return L_={unformat:u},L_}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var k_,bB;function nH(){if(bB)return k_;bB=1;let t=oY();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],r=["prefix","infix","postfix"],s=["sign","parenthesis"],a={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},d={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(E,H)=>H.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:E=>E.output==="byte"},characteristic:{type:"number",restriction:E=>E>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(E,H)=>H.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:r},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:E=>E>=0,message:"value must be positive"},{restriction:(E,H)=>!H.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:E=>E>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(E,H)=>H.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},g={languageTag:{type:"string",mandatory:!0,restriction:E=>E.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:a,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function p(E,H){let x=w(E),D=S(H);return x&&D}function w(E){return t.unformat(E)!==void 0}function y(E,H,x,D=!1){let $=Object.keys(E).map(V=>{if(!H[V])return console.error(`${x} Invalid key: ${V}`),!1;let L=E[V],U=H[V];if(typeof U=="string"&&(U={type:U}),U.type==="format"){if(!y(L,d,`[Validate ${V}]`,!0))return!1}else if(typeof L!==U.type)return console.error(`${x} ${V} type mismatched: "${U.type}" expected, "${typeof L}" provided`),!1;if(U.restrictions&&U.restrictions.length){let re=U.restrictions.length;for(let se=0;se<re;se++){let{restriction:Q,message:de}=U.restrictions[se];if(!Q(L,E))return console.error(`${x} ${V} invalid value: ${de}`),!1}}return U.restriction&&!U.restriction(L,E)?(console.error(`${x} ${V} invalid value: ${U.message}`),!1):U.validValues&&U.validValues.indexOf(L)===-1?(console.error(`${x} ${V} invalid value: must be among ${JSON.stringify(U.validValues)}, "${L}" provided`),!1):!(U.children&&!y(L,U.children,`[Validate ${V}]`))});return D||$.push(...Object.keys(H).map(V=>{let L=H[V];if(typeof L=="string"&&(L={type:L}),L.mandatory){let U=L.mandatory;if(typeof U=="function"&&(U=U(E)),U&&E[V]===void 0)return console.error(`${x} Missing mandatory key "${V}"`),!1}return!0})),$.reduce((V,L)=>V&&L,!0)}function S(E){return y(E,d,"[Validate format]")}function _(E){return y(E,g,"[Validate language]")}return k_={validate:p,validateFormat:S,validateInput:w,validateLanguage:_},k_}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Ose(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function Ase(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function xse(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function Hse(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function Pse(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function Ise(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function Nse(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function Dse(t,e){let n=t.split(".")[1];if(n){let i=n.match(/0+/);i&&(e.mantissa=i[0].length)}}function Lse(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function kse(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function Vse(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function $se(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function Fse(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function Bse(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function Wse(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function Use(t,e={}){return typeof t!="string"?t:(t=Ose(t,e),t=Ase(t,e),xse(t,e),Ise(t,e),Nse(t,e),Fse(t,e),kse(t,e),Vse(t,e),Dse(t,e),$se(t,e),Lse(t,e),Hse(t,e),Pse(t,e),Bse(t,e),Wse(t,e),e)}var iH={parseFormat:Use};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var V_,RB;function rH(){if(RB)return V_;RB=1;const t=Mse(),e=nH(),n=iH;let i={},r,s={},a=null,u={};function h(g){r=g}function d(){return s[r]}return i.languages=()=>Object.assign({},s),i.currentLanguage=()=>r,i.currentBytes=()=>d().bytes||{},i.currentCurrency=()=>d().currency,i.currentAbbreviations=()=>d().abbreviations,i.currentDelimiters=()=>d().delimiters,i.currentOrdinal=()=>d().ordinal,i.currentDefaults=()=>Object.assign({},d().defaults,u),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().timeFormat),i.setDefaults=g=>{g=n.parseFormat(g),e.validateFormat(g)&&(u=g)},i.getZeroFormat=()=>a,i.setZeroFormat=g=>a=typeof g=="string"?g:null,i.hasZeroFormat=()=>a!==null,i.languageData=g=>{if(g){if(s[g])return s[g];throw new Error(`Unknown tag "${g}"`)}return d()},i.registerLanguage=(g,p=!1)=>{if(!e.validateLanguage(g))throw new Error("Invalid language data");s[g.languageTag]=g,p&&h(g.languageTag)},i.setLanguage=(g,p=t.languageTag)=>{if(!s[g]){let w=g.split("-")[0],y=Object.keys(s).find(S=>S.split("-")[0]===w);if(!s[y]){h(p);return}h(y);return}h(g)},i.registerLanguage(t),r=t.languageTag,V_=i,V_}function jse(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function zse(t,e){t.forEach(n=>{let i;try{i=jse(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}i&&e.registerLanguage(i)})}var Yse=t=>({loadLanguagesInNode:e=>zse(e,t)}),aY={exports:{}};(function(t){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,s=Math.floor,a="[BigNumber Error] ",u=a+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,g=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],w=1e7,y=1e9;function S(L){var U,re,se,Q=A.prototype={constructor:A,toString:null,valueOf:null},de=new A(1),me=20,_e=4,Ee=-7,Te=21,ve=-1e7,Ce=1e7,Re=!1,qe=1,F=0,C={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},R="0123456789abcdefghijklmnopqrstuvwxyz",T=!0;function A(M,O){var I,q,j,Z,ne,B,X,J,ee=this;if(!(ee instanceof A))return new A(M,O);if(O==null){if(M&&M._isBigNumber===!0){ee.s=M.s,!M.c||M.e>Ce?ee.c=ee.e=null:M.e<ve?ee.c=[ee.e=0]:(ee.e=M.e,ee.c=M.c.slice());return}if((B=typeof M=="number")&&M*0==0){if(ee.s=1/M<0?(M=-M,-1):1,M===~~M){for(Z=0,ne=M;ne>=10;ne/=10,Z++);Z>Ce?ee.c=ee.e=null:(ee.e=Z,ee.c=[M]);return}J=String(M)}else{if(!i.test(J=String(M)))return se(ee,J,B);ee.s=J.charCodeAt(0)==45?(J=J.slice(1),-1):1}(Z=J.indexOf("."))>-1&&(J=J.replace(".","")),(ne=J.search(/e/i))>0?(Z<0&&(Z=ne),Z+=+J.slice(ne+1),J=J.substring(0,ne)):Z<0&&(Z=J.length)}else{if(x(O,2,R.length,"Base"),O==10&&T)return ee=new A(M),ae(ee,me+ee.e+1,_e);if(J=String(M),B=typeof M=="number"){if(M*0!=0)return se(ee,J,B,O);if(ee.s=1/M<0?(J=J.slice(1),-1):1,A.DEBUG&&J.replace(/^0\.0*|\./,"").length>15)throw Error(u+M)}else ee.s=J.charCodeAt(0)===45?(J=J.slice(1),-1):1;for(I=R.slice(0,O),Z=ne=0,X=J.length;ne<X;ne++)if(I.indexOf(q=J.charAt(ne))<0){if(q=="."){if(ne>Z){Z=X;continue}}else if(!j&&(J==J.toUpperCase()&&(J=J.toLowerCase())||J==J.toLowerCase()&&(J=J.toUpperCase()))){j=!0,ne=-1,Z=0;continue}return se(ee,String(M),B,O)}B=!1,J=re(J,O,10,ee.s),(Z=J.indexOf("."))>-1?J=J.replace(".",""):Z=J.length}for(ne=0;J.charCodeAt(ne)===48;ne++);for(X=J.length;J.charCodeAt(--X)===48;);if(J=J.slice(ne,++X)){if(X-=ne,B&&A.DEBUG&&X>15&&(M>g||M!==s(M)))throw Error(u+ee.s*M);if((Z=Z-ne-1)>Ce)ee.c=ee.e=null;else if(Z<ve)ee.c=[ee.e=0];else{if(ee.e=Z,ee.c=[],ne=(Z+1)%d,Z<0&&(ne+=d),ne<X){for(ne&&ee.c.push(+J.slice(0,ne)),X-=d;ne<X;)ee.c.push(+J.slice(ne,ne+=d));ne=d-(J=J.slice(ne)).length}else ne-=X;for(;ne--;J+="0");ee.c.push(+J)}}else ee.c=[ee.e=0]}A.clone=S,A.ROUND_UP=0,A.ROUND_DOWN=1,A.ROUND_CEIL=2,A.ROUND_FLOOR=3,A.ROUND_HALF_UP=4,A.ROUND_HALF_DOWN=5,A.ROUND_HALF_EVEN=6,A.ROUND_HALF_CEIL=7,A.ROUND_HALF_FLOOR=8,A.EUCLID=9,A.config=A.set=function(M){var O,I;if(M!=null)if(typeof M=="object"){if(M.hasOwnProperty(O="DECIMAL_PLACES")&&(I=M[O],x(I,0,y,O),me=I),M.hasOwnProperty(O="ROUNDING_MODE")&&(I=M[O],x(I,0,8,O),_e=I),M.hasOwnProperty(O="EXPONENTIAL_AT")&&(I=M[O],I&&I.pop?(x(I[0],-1e9,0,O),x(I[1],0,y,O),Ee=I[0],Te=I[1]):(x(I,-1e9,y,O),Ee=-(Te=I<0?-I:I))),M.hasOwnProperty(O="RANGE"))if(I=M[O],I&&I.pop)x(I[0],-1e9,-1,O),x(I[1],1,y,O),ve=I[0],Ce=I[1];else if(x(I,-1e9,y,O),I)ve=-(Ce=I<0?-I:I);else throw Error(a+O+" cannot be zero: "+I);if(M.hasOwnProperty(O="CRYPTO"))if(I=M[O],I===!!I)if(I)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Re=I;else throw Re=!I,Error(a+"crypto unavailable");else Re=I;else throw Error(a+O+" not true or false: "+I);if(M.hasOwnProperty(O="MODULO_MODE")&&(I=M[O],x(I,0,9,O),qe=I),M.hasOwnProperty(O="POW_PRECISION")&&(I=M[O],x(I,0,y,O),F=I),M.hasOwnProperty(O="FORMAT"))if(I=M[O],typeof I=="object")C=I;else throw Error(a+O+" not an object: "+I);if(M.hasOwnProperty(O="ALPHABET"))if(I=M[O],typeof I=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(I))T=I.slice(0,10)=="0123456789",R=I;else throw Error(a+O+" invalid: "+I)}else throw Error(a+"Object expected: "+M);return{DECIMAL_PLACES:me,ROUNDING_MODE:_e,EXPONENTIAL_AT:[Ee,Te],RANGE:[ve,Ce],CRYPTO:Re,MODULO_MODE:qe,POW_PRECISION:F,FORMAT:C,ALPHABET:R}},A.isBigNumber=function(M){if(!M||M._isBigNumber!==!0)return!1;if(!A.DEBUG)return!0;var O,I,q=M.c,j=M.e,Z=M.s;e:if({}.toString.call(q)=="[object Array]"){if((Z===1||Z===-1)&&j>=-1e9&&j<=y&&j===s(j)){if(q[0]===0){if(j===0&&q.length===1)return!0;break e}if(O=(j+1)%d,O<1&&(O+=d),String(q[0]).length==O){for(O=0;O<q.length;O++)if(I=q[O],I<0||I>=h||I!==s(I))break e;if(I!==0)return!0}}}else if(q===null&&j===null&&(Z===null||Z===1||Z===-1))return!0;throw Error(a+"Invalid BigNumber: "+M)},A.maximum=A.max=function(){return z(arguments,-1)},A.minimum=A.min=function(){return z(arguments,1)},A.random=function(){var M=9007199254740992,O=Math.random()*M&2097151?function(){return s(Math.random()*M)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(I){var q,j,Z,ne,B,X=0,J=[],ee=new A(de);if(I==null?I=me:x(I,0,y),ne=r(I/d),Re)if(crypto.getRandomValues){for(q=crypto.getRandomValues(new Uint32Array(ne*=2));X<ne;)B=q[X]*131072+(q[X+1]>>>11),B>=9e15?(j=crypto.getRandomValues(new Uint32Array(2)),q[X]=j[0],q[X+1]=j[1]):(J.push(B%1e14),X+=2);X=ne/2}else if(crypto.randomBytes){for(q=crypto.randomBytes(ne*=7);X<ne;)B=(q[X]&31)*281474976710656+q[X+1]*1099511627776+q[X+2]*4294967296+q[X+3]*16777216+(q[X+4]<<16)+(q[X+5]<<8)+q[X+6],B>=9e15?crypto.randomBytes(7).copy(q,X):(J.push(B%1e14),X+=7);X=ne/7}else throw Re=!1,Error(a+"crypto unavailable");if(!Re)for(;X<ne;)B=O(),B<9e15&&(J[X++]=B%1e14);for(ne=J[--X],I%=d,ne&&I&&(B=p[d-I],J[X]=s(ne/B)*B);J[X]===0;J.pop(),X--);if(X<0)J=[Z=0];else{for(Z=-1;J[0]===0;J.splice(0,1),Z-=d);for(X=1,B=J[0];B>=10;B/=10,X++);X<d&&(Z-=d-X)}return ee.e=Z,ee.c=J,ee}}(),A.sum=function(){for(var M=1,O=arguments,I=new A(O[0]);M<O.length;)I=I.plus(O[M++]);return I},re=function(){var M="0123456789";function O(I,q,j,Z){for(var ne,B=[0],X,J=0,ee=I.length;J<ee;){for(X=B.length;X--;B[X]*=q);for(B[0]+=Z.indexOf(I.charAt(J++)),ne=0;ne<B.length;ne++)B[ne]>j-1&&(B[ne+1]==null&&(B[ne+1]=0),B[ne+1]+=B[ne]/j|0,B[ne]%=j)}return B.reverse()}return function(I,q,j,Z,ne){var B,X,J,ee,ce,xe,Ne,Fe,st=I.indexOf("."),ft=me,Je=_e;for(st>=0&&(ee=F,F=0,I=I.replace(".",""),Fe=new A(q),xe=Fe.pow(I.length-st),F=ee,Fe.c=O(V(E(xe.c),xe.e,"0"),10,j,M),Fe.e=Fe.c.length),Ne=O(I,q,j,ne?(B=R,M):(B=M,R)),J=ee=Ne.length;Ne[--ee]==0;Ne.pop());if(!Ne[0])return B.charAt(0);if(st<0?--J:(xe.c=Ne,xe.e=J,xe.s=Z,xe=U(xe,Fe,ft,Je,j),Ne=xe.c,ce=xe.r,J=xe.e),X=J+ft+1,st=Ne[X],ee=j/2,ce=ce||X<0||Ne[X+1]!=null,ce=Je<4?(st!=null||ce)&&(Je==0||Je==(xe.s<0?3:2)):st>ee||st==ee&&(Je==4||ce||Je==6&&Ne[X-1]&1||Je==(xe.s<0?8:7)),X<1||!Ne[0])I=ce?V(B.charAt(1),-ft,B.charAt(0)):B.charAt(0);else{if(Ne.length=X,ce)for(--j;++Ne[--X]>j;)Ne[X]=0,X||(++J,Ne=[1].concat(Ne));for(ee=Ne.length;!Ne[--ee];);for(st=0,I="";st<=ee;I+=B.charAt(Ne[st++]));I=V(I,J,B.charAt(0))}return I}}(),U=function(){function M(q,j,Z){var ne,B,X,J,ee=0,ce=q.length,xe=j%w,Ne=j/w|0;for(q=q.slice();ce--;)X=q[ce]%w,J=q[ce]/w|0,ne=Ne*X+J*xe,B=xe*X+ne%w*w+ee,ee=(B/Z|0)+(ne/w|0)+Ne*J,q[ce]=B%Z;return ee&&(q=[ee].concat(q)),q}function O(q,j,Z,ne){var B,X;if(Z!=ne)X=Z>ne?1:-1;else for(B=X=0;B<Z;B++)if(q[B]!=j[B]){X=q[B]>j[B]?1:-1;break}return X}function I(q,j,Z,ne){for(var B=0;Z--;)q[Z]-=B,B=q[Z]<j[Z]?1:0,q[Z]=B*ne+q[Z]-j[Z];for(;!q[0]&&q.length>1;q.splice(0,1));}return function(q,j,Z,ne,B){var X,J,ee,ce,xe,Ne,Fe,st,ft,Je,rt,dn,ir,jr,qn,tn,Ct,Zt=q.s==j.s?1:-1,gt=q.c,Ke=j.c;if(!gt||!gt[0]||!Ke||!Ke[0])return new A(!q.s||!j.s||(gt?Ke&&gt[0]==Ke[0]:!Ke)?NaN:gt&&gt[0]==0||!Ke?Zt*0:Zt/0);for(st=new A(Zt),ft=st.c=[],J=q.e-j.e,Zt=Z+J+1,B||(B=h,J=_(q.e/d)-_(j.e/d),Zt=Zt/d|0),ee=0;Ke[ee]==(gt[ee]||0);ee++);if(Ke[ee]>(gt[ee]||0)&&J--,Zt<0)ft.push(1),ce=!0;else{for(jr=gt.length,tn=Ke.length,ee=0,Zt+=2,xe=s(B/(Ke[0]+1)),xe>1&&(Ke=M(Ke,xe,B),gt=M(gt,xe,B),tn=Ke.length,jr=gt.length),ir=tn,Je=gt.slice(0,tn),rt=Je.length;rt<tn;Je[rt++]=0);Ct=Ke.slice(),Ct=[0].concat(Ct),qn=Ke[0],Ke[1]>=B/2&&qn++;do{if(xe=0,X=O(Ke,Je,tn,rt),X<0){if(dn=Je[0],tn!=rt&&(dn=dn*B+(Je[1]||0)),xe=s(dn/qn),xe>1)for(xe>=B&&(xe=B-1),Ne=M(Ke,xe,B),Fe=Ne.length,rt=Je.length;O(Ne,Je,Fe,rt)==1;)xe--,I(Ne,tn<Fe?Ct:Ke,Fe,B),Fe=Ne.length,X=1;else xe==0&&(X=xe=1),Ne=Ke.slice(),Fe=Ne.length;if(Fe<rt&&(Ne=[0].concat(Ne)),I(Je,Ne,rt,B),rt=Je.length,X==-1)for(;O(Ke,Je,tn,rt)<1;)xe++,I(Je,tn<rt?Ct:Ke,rt,B),rt=Je.length}else X===0&&(xe++,Je=[0]);ft[ee++]=xe,Je[0]?Je[rt++]=gt[ir]||0:(Je=[gt[ir]],rt=1)}while((ir++<jr||Je[0]!=null)&&Zt--);ce=Je[0]!=null,ft[0]||ft.splice(0,1)}if(B==h){for(ee=1,Zt=ft[0];Zt>=10;Zt/=10,ee++);ae(st,Z+(st.e=ee+J*d-1)+1,ne,ce)}else st.e=J,st.r=+ce;return st}}();function k(M,O,I,q){var j,Z,ne,B,X;if(I==null?I=_e:x(I,0,8),!M.c)return M.toString();if(j=M.c[0],ne=M.e,O==null)X=E(M.c),X=q==1||q==2&&(ne<=Ee||ne>=Te)?$(X,ne):V(X,ne,"0");else if(M=ae(new A(M),O,I),Z=M.e,X=E(M.c),B=X.length,q==1||q==2&&(O<=Z||Z<=Ee)){for(;B<O;X+="0",B++);X=$(X,Z)}else if(O-=ne,X=V(X,Z,"0"),Z+1>B){if(--O>0)for(X+=".";O--;X+="0");}else if(O+=Z-B,O>0)for(Z+1==B&&(X+=".");O--;X+="0");return M.s<0&&j?"-"+X:X}function z(M,O){for(var I,q,j=1,Z=new A(M[0]);j<M.length;j++)q=new A(M[j]),(!q.s||(I=H(Z,q))===O||I===0&&Z.s===O)&&(Z=q);return Z}function le(M,O,I){for(var q=1,j=O.length;!O[--j];O.pop());for(j=O[0];j>=10;j/=10,q++);return(I=q+I*d-1)>Ce?M.c=M.e=null:I<ve?M.c=[M.e=0]:(M.e=I,M.c=O),M}se=function(){var M=/^(-?)0([xbo])(?=\w[\w.]*$)/i,O=/^([^.]+)\.$/,I=/^\.([^.]+)$/,q=/^-?(Infinity|NaN)$/,j=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Z,ne,B,X){var J,ee=B?ne:ne.replace(j,"");if(q.test(ee))Z.s=isNaN(ee)?null:ee<0?-1:1;else{if(!B&&(ee=ee.replace(M,function(ce,xe,Ne){return J=(Ne=Ne.toLowerCase())=="x"?16:Ne=="b"?2:8,!X||X==J?xe:ce}),X&&(J=X,ee=ee.replace(O,"$1").replace(I,"0.$1")),ne!=ee))return new A(ee,J);if(A.DEBUG)throw Error(a+"Not a"+(X?" base "+X:"")+" number: "+ne);Z.s=null}Z.c=Z.e=null}}();function ae(M,O,I,q){var j,Z,ne,B,X,J,ee,ce=M.c,xe=p;if(ce){e:{for(j=1,B=ce[0];B>=10;B/=10,j++);if(Z=O-j,Z<0)Z+=d,ne=O,X=ce[J=0],ee=s(X/xe[j-ne-1]%10);else if(J=r((Z+1)/d),J>=ce.length)if(q){for(;ce.length<=J;ce.push(0));X=ee=0,j=1,Z%=d,ne=Z-d+1}else break e;else{for(X=B=ce[J],j=1;B>=10;B/=10,j++);Z%=d,ne=Z-d+j,ee=ne<0?0:s(X/xe[j-ne-1]%10)}if(q=q||O<0||ce[J+1]!=null||(ne<0?X:X%xe[j-ne-1]),q=I<4?(ee||q)&&(I==0||I==(M.s<0?3:2)):ee>5||ee==5&&(I==4||q||I==6&&(Z>0?ne>0?X/xe[j-ne]:0:ce[J-1])%10&1||I==(M.s<0?8:7)),O<1||!ce[0])return ce.length=0,q?(O-=M.e+1,ce[0]=xe[(d-O%d)%d],M.e=-O||0):ce[0]=M.e=0,M;if(Z==0?(ce.length=J,B=1,J--):(ce.length=J+1,B=xe[d-Z],ce[J]=ne>0?s(X/xe[j-ne]%xe[ne])*B:0),q)for(;;)if(J==0){for(Z=1,ne=ce[0];ne>=10;ne/=10,Z++);for(ne=ce[0]+=B,B=1;ne>=10;ne/=10,B++);Z!=B&&(M.e++,ce[0]==h&&(ce[0]=1));break}else{if(ce[J]+=B,ce[J]!=h)break;ce[J--]=0,B=1}for(Z=ce.length;ce[--Z]===0;ce.pop());}M.e>Ce?M.c=M.e=null:M.e<ve&&(M.c=[M.e=0])}return M}function be(M){var O,I=M.e;return I===null?M.toString():(O=E(M.c),O=I<=Ee||I>=Te?$(O,I):V(O,I,"0"),M.s<0?"-"+O:O)}return Q.absoluteValue=Q.abs=function(){var M=new A(this);return M.s<0&&(M.s=1),M},Q.comparedTo=function(M,O){return H(this,new A(M,O))},Q.decimalPlaces=Q.dp=function(M,O){var I,q,j,Z=this;if(M!=null)return x(M,0,y),O==null?O=_e:x(O,0,8),ae(new A(Z),M+Z.e+1,O);if(!(I=Z.c))return null;if(q=((j=I.length-1)-_(this.e/d))*d,j=I[j])for(;j%10==0;j/=10,q--);return q<0&&(q=0),q},Q.dividedBy=Q.div=function(M,O){return U(this,new A(M,O),me,_e)},Q.dividedToIntegerBy=Q.idiv=function(M,O){return U(this,new A(M,O),0,1)},Q.exponentiatedBy=Q.pow=function(M,O){var I,q,j,Z,ne,B,X,J,ee,ce=this;if(M=new A(M),M.c&&!M.isInteger())throw Error(a+"Exponent not an integer: "+be(M));if(O!=null&&(O=new A(O)),B=M.e>14,!ce.c||!ce.c[0]||ce.c[0]==1&&!ce.e&&ce.c.length==1||!M.c||!M.c[0])return ee=new A(Math.pow(+be(ce),B?M.s*(2-D(M)):+be(M))),O?ee.mod(O):ee;if(X=M.s<0,O){if(O.c?!O.c[0]:!O.s)return new A(NaN);q=!X&&ce.isInteger()&&O.isInteger(),q&&(ce=ce.mod(O))}else{if(M.e>9&&(ce.e>0||ce.e<-1||(ce.e==0?ce.c[0]>1||B&&ce.c[1]>=24e7:ce.c[0]<8e13||B&&ce.c[0]<=9999975e7)))return Z=ce.s<0&&D(M)?-0:0,ce.e>-1&&(Z=1/Z),new A(X?1/Z:Z);F&&(Z=r(F/d+2))}for(B?(I=new A(.5),X&&(M.s=1),J=D(M)):(j=Math.abs(+be(M)),J=j%2),ee=new A(de);;){if(J){if(ee=ee.times(ce),!ee.c)break;Z?ee.c.length>Z&&(ee.c.length=Z):q&&(ee=ee.mod(O))}if(j){if(j=s(j/2),j===0)break;J=j%2}else if(M=M.times(I),ae(M,M.e+1,1),M.e>14)J=D(M);else{if(j=+be(M),j===0)break;J=j%2}ce=ce.times(ce),Z?ce.c&&ce.c.length>Z&&(ce.c.length=Z):q&&(ce=ce.mod(O))}return q?ee:(X&&(ee=de.div(ee)),O?ee.mod(O):Z?ae(ee,F,_e,ne):ee)},Q.integerValue=function(M){var O=new A(this);return M==null?M=_e:x(M,0,8),ae(O,O.e+1,M)},Q.isEqualTo=Q.eq=function(M,O){return H(this,new A(M,O))===0},Q.isFinite=function(){return!!this.c},Q.isGreaterThan=Q.gt=function(M,O){return H(this,new A(M,O))>0},Q.isGreaterThanOrEqualTo=Q.gte=function(M,O){return(O=H(this,new A(M,O)))===1||O===0},Q.isInteger=function(){return!!this.c&&_(this.e/d)>this.c.length-2},Q.isLessThan=Q.lt=function(M,O){return H(this,new A(M,O))<0},Q.isLessThanOrEqualTo=Q.lte=function(M,O){return(O=H(this,new A(M,O)))===-1||O===0},Q.isNaN=function(){return!this.s},Q.isNegative=function(){return this.s<0},Q.isPositive=function(){return this.s>0},Q.isZero=function(){return!!this.c&&this.c[0]==0},Q.minus=function(M,O){var I,q,j,Z,ne=this,B=ne.s;if(M=new A(M,O),O=M.s,!B||!O)return new A(NaN);if(B!=O)return M.s=-O,ne.plus(M);var X=ne.e/d,J=M.e/d,ee=ne.c,ce=M.c;if(!X||!J){if(!ee||!ce)return ee?(M.s=-O,M):new A(ce?ne:NaN);if(!ee[0]||!ce[0])return ce[0]?(M.s=-O,M):new A(ee[0]?ne:_e==3?-0:0)}if(X=_(X),J=_(J),ee=ee.slice(),B=X-J){for((Z=B<0)?(B=-B,j=ee):(J=X,j=ce),j.reverse(),O=B;O--;j.push(0));j.reverse()}else for(q=(Z=(B=ee.length)<(O=ce.length))?B:O,B=O=0;O<q;O++)if(ee[O]!=ce[O]){Z=ee[O]<ce[O];break}if(Z&&(j=ee,ee=ce,ce=j,M.s=-M.s),O=(q=ce.length)-(I=ee.length),O>0)for(;O--;ee[I++]=0);for(O=h-1;q>B;){if(ee[--q]<ce[q]){for(I=q;I&&!ee[--I];ee[I]=O);--ee[I],ee[q]+=h}ee[q]-=ce[q]}for(;ee[0]==0;ee.splice(0,1),--J);return ee[0]?le(M,ee,J):(M.s=_e==3?-1:1,M.c=[M.e=0],M)},Q.modulo=Q.mod=function(M,O){var I,q,j=this;return M=new A(M,O),!j.c||!M.s||M.c&&!M.c[0]?new A(NaN):!M.c||j.c&&!j.c[0]?new A(j):(qe==9?(q=M.s,M.s=1,I=U(j,M,0,3),M.s=q,I.s*=q):I=U(j,M,0,qe),M=j.minus(I.times(M)),!M.c[0]&&qe==1&&(M.s=j.s),M)},Q.multipliedBy=Q.times=function(M,O){var I,q,j,Z,ne,B,X,J,ee,ce,xe,Ne,Fe,st,ft,Je=this,rt=Je.c,dn=(M=new A(M,O)).c;if(!rt||!dn||!rt[0]||!dn[0])return!Je.s||!M.s||rt&&!rt[0]&&!dn||dn&&!dn[0]&&!rt?M.c=M.e=M.s=null:(M.s*=Je.s,!rt||!dn?M.c=M.e=null:(M.c=[0],M.e=0)),M;for(q=_(Je.e/d)+_(M.e/d),M.s*=Je.s,X=rt.length,ce=dn.length,X<ce&&(Fe=rt,rt=dn,dn=Fe,j=X,X=ce,ce=j),j=X+ce,Fe=[];j--;Fe.push(0));for(st=h,ft=w,j=ce;--j>=0;){for(I=0,xe=dn[j]%ft,Ne=dn[j]/ft|0,ne=X,Z=j+ne;Z>j;)J=rt[--ne]%ft,ee=rt[ne]/ft|0,B=Ne*J+ee*xe,J=xe*J+B%ft*ft+Fe[Z]+I,I=(J/st|0)+(B/ft|0)+Ne*ee,Fe[Z--]=J%st;Fe[Z]=I}return I?++q:Fe.splice(0,1),le(M,Fe,q)},Q.negated=function(){var M=new A(this);return M.s=-M.s||null,M},Q.plus=function(M,O){var I,q=this,j=q.s;if(M=new A(M,O),O=M.s,!j||!O)return new A(NaN);if(j!=O)return M.s=-O,q.minus(M);var Z=q.e/d,ne=M.e/d,B=q.c,X=M.c;if(!Z||!ne){if(!B||!X)return new A(j/0);if(!B[0]||!X[0])return X[0]?M:new A(B[0]?q:j*0)}if(Z=_(Z),ne=_(ne),B=B.slice(),j=Z-ne){for(j>0?(ne=Z,I=X):(j=-j,I=B),I.reverse();j--;I.push(0));I.reverse()}for(j=B.length,O=X.length,j-O<0&&(I=X,X=B,B=I,O=j),j=0;O;)j=(B[--O]=B[O]+X[O]+j)/h|0,B[O]=h===B[O]?0:B[O]%h;return j&&(B=[j].concat(B),++ne),le(M,B,ne)},Q.precision=Q.sd=function(M,O){var I,q,j,Z=this;if(M!=null&&M!==!!M)return x(M,1,y),O==null?O=_e:x(O,0,8),ae(new A(Z),M,O);if(!(I=Z.c))return null;if(j=I.length-1,q=j*d+1,j=I[j]){for(;j%10==0;j/=10,q--);for(j=I[0];j>=10;j/=10,q++);}return M&&Z.e+1>q&&(q=Z.e+1),q},Q.shiftedBy=function(M){return x(M,-9007199254740991,g),this.times("1e"+M)},Q.squareRoot=Q.sqrt=function(){var M,O,I,q,j,Z=this,ne=Z.c,B=Z.s,X=Z.e,J=me+4,ee=new A("0.5");if(B!==1||!ne||!ne[0])return new A(!B||B<0&&(!ne||ne[0])?NaN:ne?Z:1/0);if(B=Math.sqrt(+be(Z)),B==0||B==1/0?(O=E(ne),(O.length+X)%2==0&&(O+="0"),B=Math.sqrt(+O),X=_((X+1)/2)-(X<0||X%2),B==1/0?O="5e"+X:(O=B.toExponential(),O=O.slice(0,O.indexOf("e")+1)+X),I=new A(O)):I=new A(B+""),I.c[0]){for(X=I.e,B=X+J,B<3&&(B=0);;)if(j=I,I=ee.times(j.plus(U(Z,j,J,1))),E(j.c).slice(0,B)===(O=E(I.c)).slice(0,B))if(I.e<X&&--B,O=O.slice(B-3,B+1),O=="9999"||!q&&O=="4999"){if(!q&&(ae(j,j.e+me+2,0),j.times(j).eq(Z))){I=j;break}J+=4,B+=4,q=1}else{(!+O||!+O.slice(1)&&O.charAt(0)=="5")&&(ae(I,I.e+me+2,1),M=!I.times(I).eq(Z));break}}return ae(I,I.e+me+1,_e,M)},Q.toExponential=function(M,O){return M!=null&&(x(M,0,y),M++),k(this,M,O,1)},Q.toFixed=function(M,O){return M!=null&&(x(M,0,y),M=M+this.e+1),k(this,M,O)},Q.toFormat=function(M,O,I){var q,j=this;if(I==null)M!=null&&O&&typeof O=="object"?(I=O,O=null):M&&typeof M=="object"?(I=M,M=O=null):I=C;else if(typeof I!="object")throw Error(a+"Argument not an object: "+I);if(q=j.toFixed(M,O),j.c){var Z,ne=q.split("."),B=+I.groupSize,X=+I.secondaryGroupSize,J=I.groupSeparator||"",ee=ne[0],ce=ne[1],xe=j.s<0,Ne=xe?ee.slice(1):ee,Fe=Ne.length;if(X&&(Z=B,B=X,X=Z,Fe-=Z),B>0&&Fe>0){for(Z=Fe%B||B,ee=Ne.substr(0,Z);Z<Fe;Z+=B)ee+=J+Ne.substr(Z,B);X>0&&(ee+=J+Ne.slice(Z)),xe&&(ee="-"+ee)}q=ce?ee+(I.decimalSeparator||"")+((X=+I.fractionGroupSize)?ce.replace(new RegExp("\\d{"+X+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):ce):ee}return(I.prefix||"")+q+(I.suffix||"")},Q.toFraction=function(M){var O,I,q,j,Z,ne,B,X,J,ee,ce,xe,Ne=this,Fe=Ne.c;if(M!=null&&(B=new A(M),!B.isInteger()&&(B.c||B.s!==1)||B.lt(de)))throw Error(a+"Argument "+(B.isInteger()?"out of range: ":"not an integer: ")+be(B));if(!Fe)return new A(Ne);for(O=new A(de),J=I=new A(de),q=X=new A(de),xe=E(Fe),Z=O.e=xe.length-Ne.e-1,O.c[0]=p[(ne=Z%d)<0?d+ne:ne],M=!M||B.comparedTo(O)>0?Z>0?O:J:B,ne=Ce,Ce=1/0,B=new A(xe),X.c[0]=0;ee=U(B,O,0,1),j=I.plus(ee.times(q)),j.comparedTo(M)!=1;)I=q,q=j,J=X.plus(ee.times(j=J)),X=j,O=B.minus(ee.times(j=O)),B=j;return j=U(M.minus(I),q,0,1),X=X.plus(j.times(J)),I=I.plus(j.times(q)),X.s=J.s=Ne.s,Z=Z*2,ce=U(J,q,Z,_e).minus(Ne).abs().comparedTo(U(X,I,Z,_e).minus(Ne).abs())<1?[J,q]:[X,I],Ce=ne,ce},Q.toNumber=function(){return+be(this)},Q.toPrecision=function(M,O){return M!=null&&x(M,1,y),k(this,M,O,2)},Q.toString=function(M){var O,I=this,q=I.s,j=I.e;return j===null?q?(O="Infinity",q<0&&(O="-"+O)):O="NaN":(M==null?O=j<=Ee||j>=Te?$(E(I.c),j):V(E(I.c),j,"0"):M===10&&T?(I=ae(new A(I),me+j+1,_e),O=V(E(I.c),I.e,"0")):(x(M,2,R.length,"Base"),O=re(V(E(I.c),j,"0"),10,M,q,!0)),q<0&&I.c[0]&&(O="-"+O)),O},Q.valueOf=Q.toJSON=function(){return be(this)},Q._isBigNumber=!0,L!=null&&A.set(L),A}function _(L){var U=L|0;return L>0||L===U?U:U-1}function E(L){for(var U,re,se=1,Q=L.length,de=L[0]+"";se<Q;){for(U=L[se++]+"",re=d-U.length;re--;U="0"+U);de+=U}for(Q=de.length;de.charCodeAt(--Q)===48;);return de.slice(0,Q+1||1)}function H(L,U){var re,se,Q=L.c,de=U.c,me=L.s,_e=U.s,Ee=L.e,Te=U.e;if(!me||!_e)return null;if(re=Q&&!Q[0],se=de&&!de[0],re||se)return re?se?0:-_e:me;if(me!=_e)return me;if(re=me<0,se=Ee==Te,!Q||!de)return se?0:!Q^re?1:-1;if(!se)return Ee>Te^re?1:-1;for(_e=(Ee=Q.length)<(Te=de.length)?Ee:Te,me=0;me<_e;me++)if(Q[me]!=de[me])return Q[me]>de[me]^re?1:-1;return Ee==Te?0:Ee>Te^re?1:-1}function x(L,U,re,se){if(L<U||L>re||L!==s(L))throw Error(a+(se||"Argument")+(typeof L=="number"?L<U||L>re?" out of range: ":" not an integer: ":" not a primitive number: ")+String(L))}function D(L){var U=L.c.length-1;return _(L.e/d)==U&&L.c[U]%2!=0}function $(L,U){return(L.length>1?L.charAt(0)+"."+L.slice(1):L)+(U<0?"e":"e+")+U}function V(L,U,re){var se,Q;if(U<0){for(Q=re+".";++U;Q+=re);L=Q+L}else if(se=L.length,++U>se){for(Q=re,U-=se;--U;Q+=re);L+=Q}else U<se&&(L=L.slice(0,U)+"."+L.slice(U));return L}n=S(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(Tse)})(aY);var lY=aY.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ws=rH(),Gse=nH(),qse=iH,Kse=lY,Ti={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Ip={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:uY,decimalSuffixes:TC}=Ws.currentBytes(),sH={general:{scale:1024,suffixes:TC},binary:{scale:1024,suffixes:uY},decimal:{scale:1e3,suffixes:TC}};function Xse(t,e={},n){if(typeof e=="string"&&(e=qse.parseFormat(e)),!Gse.validateFormat(e))return"ERROR: invalid format";let r=e.prefix||"",s=e.postfix||"",a=Zse(t,e,n);return a=poe(a,r),a=voe(a,s),a}function Zse(t,e,n){switch(e.output){case"currency":return e=Hd(e,Ws.currentCurrencyDefaultFormat()),soe(t,e,Ws);case"percent":return e=Hd(e,Ws.currentPercentageDefaultFormat()),roe(t,e,Ws,n);case"byte":return e=Hd(e,Ws.currentByteDefaultFormat()),toe(t,e,Ws,n);case"time":return e=Hd(e,Ws.currentTimeDefaultFormat()),ioe(t);case"ordinal":return e=Hd(e,Ws.currentOrdinalDefaultFormat()),noe(t,e,Ws);case"number":default:return Np({instance:t,providedFormat:e})}}function Qse(t){let e=sH.decimal;return DS(t._value,e.suffixes,e.scale).suffix}function Jse(t){let e=sH.binary;return DS(t._value,e.suffixes,e.scale).suffix}function eoe(t){let e=sH.general;return DS(t._value,e.suffixes,e.scale).suffix}function DS(t,e,n){let i=e[0],r=Math.abs(t);if(r>=n){for(let s=1;s<e.length;++s){let a=Math.pow(n,s),u=Math.pow(n,s+1);if(r>=a&&r<u){i=e[s],t=t/a;break}}i===e[0]&&(t=t/Math.pow(n,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function toe(t,e,n,i){let r=e.base||"binary",s=Object.assign({},Ip,e);const{binarySuffixes:a,decimalSuffixes:u}=n.currentBytes();let d={general:{scale:1024,suffixes:u||TC,marker:"bd"},binary:{scale:1024,suffixes:a||uY,marker:"b"},decimal:{scale:1e3,suffixes:u||TC,marker:"d"}}[r],{value:g,suffix:p}=DS(t._value,d.suffixes,d.scale);return`${Np({instance:i(g),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${p}`}function noe(t,e,n){let i=n.currentOrdinal(),r=Object.assign({},Ip,e),s=Np({instance:t,providedFormat:e,state:n}),a=i(t._value);return`${s}${r.spaceSeparated?" ":""}${a}`}function ioe(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${i<10?"0":""}${i}`}function roe(t,e,n,i){let r=e.prefixSymbol,s=Np({instance:i(t._value*100),providedFormat:e,state:n}),a=Object.assign({},Ip,e);return r?`%${a.spaceSeparated?" ":""}${s}`:`${s}${a.spaceSeparated?" ":""}%`}function soe(t,e,n){const i=n.currentCurrency();let r=Object.assign({},e),s=Object.assign({},Ip,r),a,u="",h=!!s.totalLength||!!s.forceAverage||s.average,d=r.currencyPosition||i.position,g=r.currencySymbol||i.symbol;const p=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;r.lowPrecision===void 0&&(r.lowPrecision=!1),p&&(u=" "),d==="infix"&&(a=u+g+u);let w=Np({instance:t,providedFormat:r,state:n,decimalSeparator:a});return d==="prefix"&&(t._value<0&&s.negative==="sign"?w=`-${u}${g}${w.slice(1)}`:t._value>0&&s.forceSign?w=`+${u}${g}${w.slice(1)}`:w=g+u+w),(!d||d==="postfix")&&(u=!s.spaceSeparatedAbbreviation&&h?"":u,w=w+u+g),w}function ooe({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:i,spaceSeparated:r=!1,totalLength:s=0,roundingFunction:a=Math.round}){let u="",h=Math.abs(t),d=-1;if(e&&i[e]&&Ti[e]?(u=i[e],t=t/Ti[e]):h>=Ti.trillion||n&&a(h/Ti.trillion)===1?(u=i.trillion,t=t/Ti.trillion):h<Ti.trillion&&h>=Ti.billion||n&&a(h/Ti.billion)===1?(u=i.billion,t=t/Ti.billion):h<Ti.billion&&h>=Ti.million||n&&a(h/Ti.million)===1?(u=i.million,t=t/Ti.million):(h<Ti.million&&h>=Ti.thousand||n&&a(h/Ti.thousand)===1)&&(u=i.thousand,t=t/Ti.thousand),u&&(u=(r?" ":"")+u),s){let p=t<0,w=t.toString().split(".")[0],y=p?w.length-1:w.length;d=Math.max(s-y,0)}return{value:t,abbreviation:u,mantissaPrecision:d}}function aoe({value:t,characteristicPrecision:e}){let[n,i]=t.toExponential().split("e"),r=+n;if(!e)return{value:r,abbreviation:`e${i}`};let s=1;return s<e&&(r=r*Math.pow(10,e-s),i=+i-(e-s),i=i>=0?`+${i}`:i),{value:r,abbreviation:`e${i}`}}function $w(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function loe(t,e){let n=t.toString(),[i,r]=n.split("e"),[s,a=""]=i.split(".");if(+r>0)n=s+a+$w(r-a.length);else{let u=".";+s<0?u=`-0${u}`:u=`0${u}`;let h=($w(-r-1)+Math.abs(s)+a).substr(0,e);h.length<e&&(h+=$w(e-h.length)),n=u+h}return+r>0&&e>0&&(n+=`.${$w(e)}`),n}function uoe(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?loe(t,e):new Kse(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function coe(t,e,n,i,r,s){if(i===-1)return t;let a=uoe(e,i,s),[u,h=""]=a.toString().split(".");if(h.match(/^0+$/)&&(n||r))return u;let d=h.match(/0+$/);return r&&d?`${u}.${h.toString().slice(0,d.index)}`:a.toString()}function hoe(t,e,n,i){let r=t,[s,a]=r.toString().split(".");if(s.match(/^-?0$/)&&n)return a?`${s.replace("0","")}.${a}`:s.replace("0","");const u=e<0&&s.indexOf("-")===0;if(u&&(s=s.slice(1),r=r.slice(1)),s.length<i){let h=i-s.length;for(let d=0;d<h;d++)r=`0${r}`}return u&&(r=`-${r}`),r.toString()}function doe(t,e){let n=[],i=0;for(let r=t;r>0;r--)i===e&&(n.unshift(r),i=0),i++;return n}function foe(t,e,n,i,r){let s=i.currentDelimiters(),a=s.thousands;r=r||s.decimal;let u=s.thousandsSize||3,h=t.toString(),d=h.split(".")[0],g=h.split(".")[1];const p=e<0&&d.indexOf("-")===0;return n&&(p&&(d=d.slice(1)),doe(d.length,u).forEach((y,S)=>{d=d.slice(0,y+S)+a+d.slice(y+S)}),p&&(d=`-${d}`)),g?h=d+r+g:h=d,h}function goe(t,e){return t+e}function moe(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function poe(t,e){return e+t}function voe(t,e){return t+e}function Np({instance:t,providedFormat:e,state:n=Ws,decimalSeparator:i,defaults:r=n.currentDefaults()}){let s=t._value;if(s===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(s))return s.toString();let a=Object.assign({},Ip,r,e),u=a.totalLength,h=u?0:a.characteristic,d=a.optionalCharacteristic,g=a.forceAverage,p=a.lowPrecision,w=!!u||!!g||a.average,y=u?-1:w&&e.mantissa===void 0?0:a.mantissa,S=u?!1:e.optionalMantissa===void 0?y===-1:a.optionalMantissa,_=a.trimMantissa,E=a.thousandSeparated,H=a.spaceSeparated,x=a.negative,D=a.forceSign,$=a.exponential,V=a.roundingFunction,L="";if(w){let re=ooe({value:s,forceAverage:g,lowPrecision:p,abbreviations:n.currentAbbreviations(),spaceSeparated:H,roundingFunction:V,totalLength:u});s=re.value,L+=re.abbreviation,u&&(y=re.mantissaPrecision)}if($){let re=aoe({value:s,characteristicPrecision:h});s=re.value,L=re.abbreviation+L}let U=coe(s.toString(),s,S,y,_,V);return U=hoe(U,s,d,h),U=foe(U,s,E,n,i),(w||$)&&(U=goe(U,L)),(D||s<0)&&(U=moe(U,s,x)),U}function Hd(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var woe=t=>({format:(...e)=>Xse(...e,t),getByteUnit:(...e)=>eoe(...e,t),getBinaryByteUnit:(...e)=>Jse(...e,t),getDecimalByteUnit:(...e)=>Qse(...e,t),formatOrDefault:Hd});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const tl=lY;function yoe(t,e,n){let i=new tl(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new tl(r),t._value=i.plus(r).toNumber(),t}function cY(t,e,n){let i=new tl(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new tl(r),t._value=i.minus(r).toNumber(),t}function Coe(t,e,n){let i=new tl(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new tl(r),t._value=i.times(r).toNumber(),t}function Soe(t,e,n){let i=new tl(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new tl(r),t._value=i.dividedBy(r).toNumber(),t}function boe(t,e,n){let i=e;return n.isNumbro(e)&&(i=e._value),t._value=i,t}function Roe(t,e,n){let i=n(t._value);return cY(i,e,n),Math.abs(i._value)}var Eoe=t=>({add:(e,n)=>yoe(e,n,t),subtract:(e,n)=>cY(e,n,t),multiply:(e,n)=>Coe(e,n,t),divide:(e,n)=>Soe(e,n,t),set:(e,n)=>boe(e,n,t),difference:(e,n)=>Roe(e,n,t),BigNumber:tl});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Toe="2.5.0",Jo=rH(),_oe=nH(),Moe=Yse(Fn),Ooe=oY();let Ju=woe(Fn),Ac=Eoe(Fn);const Aoe=iH;class hY{constructor(e){this._value=e}clone(){return Fn(this._value)}format(e={}){return Ju.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=Aoe.parseFormat(e)),e=Ju.formatOrDefault(e,Jo.currentCurrencyDefaultFormat()),e.output="currency",Ju.format(this,e)}formatTime(e={}){return e.output="time",Ju.format(this,e)}binaryByteUnits(){return Ju.getBinaryByteUnit(this)}decimalByteUnits(){return Ju.getDecimalByteUnit(this)}byteUnits(){return Ju.getByteUnit(this)}difference(e){return Ac.difference(this,e)}add(e){return Ac.add(this,e)}subtract(e){return Ac.subtract(this,e)}multiply(e){return Ac.multiply(this,e)}divide(e){return Ac.divide(this,e)}set(e){return Ac.set(this,dY(e))}value(){return this._value}valueOf(){return this._value}}function dY(t){let e=t;return Fn.isNumbro(t)?e=t._value:typeof t=="string"?e=Fn.unformat(t):isNaN(t)&&(e=NaN),e}function Fn(t){return new hY(dY(t))}Fn.version=Toe;Fn.isNumbro=function(t){return t instanceof hY};Fn.language=Jo.currentLanguage;Fn.registerLanguage=Jo.registerLanguage;Fn.setLanguage=Jo.setLanguage;Fn.languages=Jo.languages;Fn.languageData=Jo.languageData;Fn.zeroFormat=Jo.setZeroFormat;Fn.defaultFormat=Jo.currentDefaults;Fn.setDefaults=Jo.setDefaults;Fn.defaultCurrencyFormat=Jo.currentCurrencyDefaultFormat;Fn.validate=_oe.validate;Fn.loadLanguagesInNode=Moe.loadLanguagesInNode;Fn.unformat=Ooe.unformat;Fn.BigNumber=Ac.BigNumber;var xoe=Fn,ec=_se(xoe);const Hoe="numeric";function fY(t,e){if(Qi(t)){const n=e.numericFormat,i=n&&n.culture||"-",r=n&&n.pattern;if(typeof i<"u"&&!ec.languages()[i]){const s=i.replace("-",""),a=ec.allLanguages?ec.allLanguages[i]:ec[s];a&&ec.registerLanguage(a)}ec.setLanguage(i),t=ec(t).format(r||"0")}return t}function oH(t,e,n,i,r,s,a){let u=s;if(Qi(u)){const h=a.className||"",d=h.length?h.split(" "):[];u=fY(u,a),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),a.className=d.join(" "),e.dir="ltr"}ll(t,e,n,i,r,u,a)}oH.RENDERER_TYPE=Hoe;const Poe="password";function aH(t,e,n,i,r,s,a){ll.apply(this,[t,e,n,i,r,s,a]);const u=a.hashLength||e.innerHTML.length,h=a.hashSymbol||"*";let d="";ke(u-1,()=>{d+=h}),wf(e,d)}aH.RENDERER_TYPE=Poe;const Ioe="select";function lH(t,e,n,i,r,s,a){ll.apply(this,[t,e,n,i,r,s,a])}lH.RENDERER_TYPE=Ioe;const Noe="time";function uH(t,e,n,i,r,s,a){ll.apply(this,[t,e,n,i,r,s,a]),e.dir="ltr"}uH.RENDERER_TYPE=Noe;function Doe(){hs(Sf),hs(Pp),hs(Jx),hs(Qx),hs(tH),hs(Zx),hs(oH),hs(aH),hs(lH),hs(ll),hs(uH)}const Loe="autocomplete";function LS(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,EB(n,e)):EB(n,e)(this.source):e(!0)}LS.VALIDATOR_TYPE=Loe;function EB(t,e){const n=t;return function(i){let r=!1;for(let s=0,a=i.length;s<a;s++)if(n===i[s]){r=!0;break}e(r)}}function koe(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Voe="date";function cH(t,e){const n=x2(Qz,this.instance);let i=t,r=!0;i==null&&(i="");let s=pe(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),a=pe(new Date(i)).isValid()||s;if(this.allowEmpty&&i===""&&(a=!0,s=!0),a||(r=!1),!a&&s&&(r=!0),a&&!s)if(this.correctFormat===!0){const u=$oe(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"dateValidator"),r=!0}else r=!1;e(r)}cH.VALIDATOR_TYPE=Voe;function $oe(t,e){const n=pe(koe(t)),i=pe(t,e),r=t.search(/[A-Za-z]/g)>-1;let s;return n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||r?s=n:s=i,s.format(e)}const Foe="dropdown";function hH(t,e){LS.apply(this,[t,e])}hH.VALIDATOR_TYPE=Foe;const Boe="numeric";function dH(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Qi(t))}dH.VALIDATOR_TYPE=Boe;const Woe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Uoe="time";function fH(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,r=t;r===null&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;const s=/^\d{1,2}$/.test(r);s&&(r+=":00");const a=pe(r,Woe,!0).isValid()?pe(r):pe(r,n);let u=a.isValid(),h=pe(r,n,!0).isValid()&&!s;if(this.allowEmpty&&r===""&&(u=!0,h=!0),u||(i=!1),!u&&h&&(i=!0),u&&!h)if(this.correctFormat===!0){const d=a.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,d,"timeValidator"),i=!0}else i=!1;e(i)}fH.VALIDATOR_TYPE=Uoe;function joe(){xd(LS),xd(hH),xd(cH),xd(dH),xd(fH)}const zoe="autocomplete",Yoe={CELL_TYPE:zoe,editor:Kx,renderer:Sf,validator:LS},Goe="checkbox",qoe={CELL_TYPE:Goe,editor:Zz,renderer:Jx},Koe="date";function gY(t,e,n,i,r,s,a){Sf.apply(this,[t,e,n,i,r,s,a])}gY.RENDERER_TYPE=Koe;const Xoe="date",Zoe={CELL_TYPE:Xoe,editor:Jz,renderer:gY,validator:cH},Qoe="dropdown",Joe={CELL_TYPE:Qoe,editor:eY,renderer:Qx,validator:hH,filter:!1,strict:!0},eae="handsontable",tae={CELL_TYPE:eae,editor:qx,renderer:tH},nae="numeric",iae={CELL_TYPE:nae,editor:tY,renderer:oH,validator:dH,dataType:"number"},rae="password",sae={CELL_TYPE:rae,editor:nY,renderer:aH,copyable:!1},oae="select",aae={CELL_TYPE:oae,editor:iY,renderer:lH},lae="time",uae={CELL_TYPE:lae,editor:rY,renderer:uH,validator:fH};function cae(){$s(Yoe),$s(qoe),$s(Zoe),$s(Joe),$s(tae),$s(iae),$s(sae),$s(aae),$s(Dz),$s(uae)}function hae(t,e){mY(t,e),e.add(t)}function dae(t,e,n){mY(t,e),e.set(t,n)}function mY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function td(t,e,n){return(e=fae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fae(t){var e=gae(t,"string");return typeof e=="symbol"?e:e+""}function gae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nd(t,e){return t.get(pY(t,e))}function pY(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TB=new Map([["plugin",gZ],["cell-type",Tz],["editor",A2],["renderer",k2],["validator",V2]]),vY=Symbol("mainSetting"),mae="base",Fw=[];let tc=null;var nc=new WeakMap,_B=new WeakSet;class Ht{static get PLUGIN_KEY(){return mae}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){hae(this,_B),td(this,"eventManager",new to(this)),td(this,"pluginName",null),td(this,"pluginsInitializedCallbacks",[]),td(this,"isPluginsReady",!1),td(this,"enabled",!1),td(this,"initialized",!1),dae(this,nc,{}),ol(this,"hot",e,{writable:!1}),tc=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const r=[];if(n.forEach(s=>{const[a,u]=s.split(":");if(!TB.has(a))throw new Error(`Unknown plugin dependency type "${a}" was found.`);TB.get(a)(u)||r.push(` - ${u} (${a})`)}),r.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");Fw.push(s)}}if(tc||(tc=L2()),tc.indexOf(this.pluginName)>=0&&tc.splice(tc.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),tc.length===0){if(Fw.length>0){const r=[`${Fw.join(`
`)}
`,"You have to import and register them manually."].join("");throw Fw.length=0,new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const i=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||ht(n))&&i[vY]===e){var r;return Array.isArray(n)?n:(r=n[e])!==null&&r!==void 0?r:i[e]}if(ht(n)){var s;return(s=n[e])!==null&&s!==void 0?s:i[e]}return i[e]}addHook(e,n,i){nd(nc,this)[e]=nd(nc,this)[e]||[];const r=nd(nc,this)[e];this.hot.addHook(e,n,i),r.push(n),nd(nc,this)[e]=r}removeHooks(e){W(nd(nc,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=nd(nc,this);dt(e,(n,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){W(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=pY(_B,this,pae).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),dt(this,(n,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function pae(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ic(t,e,n){return(e=vae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vae(t){var e=wae(t,"string");return typeof e=="symbol"?e:e+""}function wae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let wY=class{constructor(e){ic(this,"hot",null),ic(this,"container",null),ic(this,"injected",!1),ic(this,"rows",[]),ic(this,"columns",[]),ic(this,"samples",null),ic(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),W(this.rows,n=>{const{height:i}=n.table.getBoundingClientRect();e(n.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),W(this.columns,n=>{const{width:i}=n.table.getBoundingClientRect();e(n.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{W(i.strings,r=>{n.appendChild(this.createColElement(r.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(s=>{W(s.strings,a=>{const u=a.col,h=this.hot.getCellMeta(e,u),d=this.hot.getCellRenderer(h),g=n.createElement("td");g.setAttribute("ghost-table",1),d(this.hot,g,e,u,this.hot.colToProp(u),a.value,h),i.appendChild(g)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),n.appendChild(r)}this.samples.forEach(r=>{W(r.strings,s=>{const a=s.col,u=e.createElement("th");i.push([a,u]),n.appendChild(u)})}),this.table.tHead.appendChild(n),W(i,r=>{const[s,a]=r;this.hot.view.appendColHeader(s,a)})}createCol(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment();return this.samples.forEach(r=>{W(r.strings,s=>{const a=s.row,u=this.hot.getCellMeta(a,e),h=this.hot.getCellRenderer(u),d=n.createElement("td"),g=n.createElement("tr");d.setAttribute("ghost-table",1),h(this.hot,d,a,e,this.hot.colToProp(e),s.value,u),g.appendChild(d),i.appendChild(g)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const i=this.hot.rootDocument.createElement("col");let r=0;n>=0&&e>=0&&(r=this.hot.getCellMeta(n,e).colspan);let s=this.hot.getColWidth(e);if(r>1)for(let a=e+1;a<e+r;a++)s+=this.hot.getColWidth(a);return i.style.width=`${s}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("table"),s=n.createElement("thead"),a=n.createElement("tbody"),u=n.createElement("colgroup"),h=n.createElement("tr"),d=n.createElement("th");return this.isVertical()&&r.appendChild(u),this.isHorizontal()&&(h.appendChild(d),s.appendChild(h),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(s),this.isVertical()&&a.appendChild(h),r.appendChild(a),fe(r,e),i.appendChild(r),{fragment:i,table:r,tHead:s,tBody:a,colGroup:u,tr:h,th:d}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return fe(r,s),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Bw(t,e,n){return(e=yae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yae(t){var e=Cae(t,"string");return typeof e=="symbol"?e:e+""}function Cae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kS{static get SAMPLE_COUNT(){return 3}constructor(e){Bw(this,"samples",null),Bw(this,"dataFactory",null),Bw(this,"customSampleCount",null),Bw(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:kS.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,i){const r=new Map,{from:s,to:a}=typeof i=="number"?{from:i,to:i}:i;return ke(s,a,u=>{const h=this.generateSample(e,n,u);r.set(u,h)}),r}generateSample(e,n,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const r=new Map,s=e==="row"?"col":"row",a=[];return ke(n.from,n.to,u=>{const h=e==="row"?this.dataFactory(i,u):this.dataFactory(u,i);if(h===!1)return;const{value:d,bundleSeed:g}=h,p=typeof g=="string"&&g.length>0;let w;p?w=g:ht(d)?w=`${Object.keys(d).length}`:Array.isArray(d)?w=`${d.length}`:w=`${zn(d).length}`,r.has(w)||r.set(w,{needed:this.getSampleCount(),strings:[]});const y=r.get(w);y.needed&&(!(a.indexOf(d)>-1)||this.allowDuplicates||p)&&(y.strings.push({value:d,[s]:u}),a.push(d),y.needed-=1)}),r}}function Sae(t,e){yY(t,e),e.add(t)}function MB(t,e,n){yY(t,e),e.set(t,n)}function yY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zg(t,e,n){return(e=bae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bae(t){var e=Rae(t,"string");return typeof e=="symbol"?e:e+""}function Rae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dc(t,e){return t.get(ko(t,e))}function gH(t,e,n){return t.set(ko(t,e),n),n}function ko(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("modifyAutoColumnSizeSeed");const $_="autoColumnSize",Eae=10,Tae="autoColumnSize";var Pd=new WeakMap,of=new WeakMap,Ia=new WeakSet;class Dm extends Ht{static get PLUGIN_KEY(){return $_}static get PLUGIN_PRIORITY(){return Eae}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Sae(this,Ia),zg(this,"ghostTable",new wY(this.hot)),zg(this,"samplesGenerator",new kS((n,i)=>{const r=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(s))return!1;const a=this.hot.getCellMeta(n,i);let u="";a.spanned||(u=this.hot.getDataAtCell(n,i));let h="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(h=this.hot.runHooks("modifyAutoColumnSizeSeed",h,a,u)),{value:u,bundleSeed:h}})),zg(this,"inProgress",!1),zg(this,"measuredColumns",0),zg(this,"columnWidthsMap",new yu),MB(this,Pd,[]),MB(this,of,[]),this.hot.columnIndexMapper.registerMap(Tae,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,i,r)=>ko(Ia,this,OB).call(this,n,i,r))}isEnabled(){return this.hot.getSettings()[$_]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return ko(Ia,e,Oae).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return ko(Ia,e,Aae).call(e,...r)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return ko(Ia,e,Hae).call(e,...r)}),this.addHook("beforeRender",()=>ko(Ia,this,Mae).call(this)),this.addHook("modifyColWidth",(i,r)=>this.getColumnWidth(r,i)),this.addHook("init",()=>ko(Ia,this,xae).call(this)),super.enablePlugin()}updatePlugin(){gH(of,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,i)=>ko(Ia,this,OB).call(this,e,n,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const i=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;ke(r.from,r.to,a=>{let u=this.hot.toPhysicalColumn(a);u===null&&(u=a),(i||this.columnWidthsMap.getValueAtIndex(u)===null&&!this.hot._getColWidthFromSettings(u))&&this.samplesGenerator.generateColumnSamples(a,s).forEach((d,g)=>this.ghostTable.addColumn(g,d))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((a,u)=>{const h=this.hot.toPhysicalColumn(a);this.columnWidthsMap.setValueAtIndex(h,u)})},!0),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countCols()-1;let s=null;this.inProgress=!0;const a=()=>{if(!this.hot){vC(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+Dm.CALCULATION_STEP,r)},e,n),i=i+Dm.CALCULATION_STEP+1,i<r?s=pC(a):(vC(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateColumnsWidth({from:0,to:u},e,n),i=u+1),i<r?a():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[$_];let n=Dm.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return ht(e)&&(n=e.syncLimit,t2(n)?n=I2(i,n):n>>=0),Math.min(n,i)}getColumnWidth(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n;return r===void 0&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof r=="number"&&(r=Math.max(r,tf))),r}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,r,s)=>{const a=Dc(Pd,this).length;return(a-1<s||Dc(Pd,this)[s]!==r)&&i.push(this.hot.toVisualColumn(s)),a-1<s?Dc(Pd,this).push(r):Dc(Pd,this)[s]=r,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _ae(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const i=this.hot.toPhysicalColumn(n);i!==null&&(this.hot._getColWidthFromSettings(i)||this.samplesGenerator.generateColumnSamples(n,e).forEach((s,a)=>this.ghostTable.addColumn(a,s)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((n,i)=>{const r=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function Mae(){this.calculateVisibleColumnsWidth(),this.inProgress||(ko(Ia,this,_ae).call(this,Dc(of,this)),gH(of,this,[]))}function Oae(t,e){e||this.recalculateAllColumnsWidth()}function Aae(t){const e=t.reduce((n,i)=>{let[,r]=i;const s=this.hot.propToCol(r);return Number.isInteger(s)&&n.indexOf(s)===-1&&n.push(s),n},[]);Dc(of,this).push(...e)}function OB(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function xae(){gH(Pd,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function Hae(t){const e=t.reduce((n,i)=>{var r;const s=(r=i.address)===null||r===void 0?void 0:r.col;if(Number.isInteger(s)){const a=this.hot.toVisualColumn(s);n.indexOf(a)===-1&&n.push(a)}return n},[]);Dc(of,this).push(...e)}const Lc={horizontal:"horizontal",vertical:"vertical"};function Pae(t,e,n){let i,r,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",i=n(e[0],e[1]),r=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",i=n(e[0],t[3]+1),r=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",i=n(e[0],e[1]),r=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",i=n(t[2]+1,e[1]),r=n(e[2],e[3])),i&&i.normalize(),r&&r.normalize(),{directionOfDrag:s,startOfDragCoords:i,endOfDragCoords:r}}function Iae(t){const e={};return t===!0?(e.directions=Object.keys(Lc),e.autoInsertRow=!0):ht(t)?(Pe(t.autoInsertRow)?t.direction===Lc.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Pe(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Lc)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Nae(t,e){Dae(t,e),e.add(t)}function Dae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function id(t,e,n){return(e=Lae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lae(t){var e=kae(t,"string");return typeof e=="symbol"?e:e+""}function kae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("modifyAutofillRange");Ae.getSingleton().register("beforeAutofill");Ae.getSingleton().register("afterAutofill");const AB="autofill",Vae=20,$ae=["fillHandle"],Fae="insert_row_below",Bae=200;var rd=new WeakSet;class Wae extends Ht{constructor(){super(...arguments),Nae(this,rd),id(this,"addingStarted",!1),id(this,"mouseDownOnCellCorner",!1),id(this,"mouseDragOutside",!1),id(this,"handleDraggedCells",0),id(this,"directions",[]),id(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return AB}static get PLUGIN_PRIORITY(){return Vae}static get SETTING_KEYS(){return[AB,...$ae]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Yg(rd,this,jae).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Yg(rd,this,Uae).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Yg(rd,this,zae).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:i,endRow:r,endCol:s}]),u=[],h=[],d=[];return W(a,g=>{for(let p=g.startRow;p<=g.endRow;p+=1)u.indexOf(p)===-1&&u.push(p);for(let p=g.startCol;p<=g.endCol;p+=1)h.indexOf(p)===-1&&h.push(p)}),W(u,g=>{const p=[];W(h,w=>{p.push(this.hot.getCopyableData(g,w))}),d.push(p)}),d}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),a=s.getTopStartCorner(),u=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const h=[a.row,a.col,u.row,u.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,e),Math.min(a.col,n),Math.max(u.row,i),Math.max(u.col,r)],h),{directionOfDrag:g,startOfDragCoords:p,endOfDragCoords:w}=Pae(h,d,(y,S)=>this.hot._createCellCoords(y,S));if(p&&p.row>-1&&p.col>-1){const y=this.getSelectionData(),S=s.clone(),_=this.hot._createCellRange(p,p,w),E=this.hot.runHooks("beforeAutofill",y,S,_,g);if(E===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let H=E;const x=E;if(["up","left"].indexOf(g)>-1&&!(x.length===1&&x[0].length===0))if(H=[],g==="up"){const D=w.row-p.row+1,$=D%x.length;for(let V=0;V<D;V++)H.push(x[(V+(x.length-$))%x.length])}else{const D=w.col-p.col+1,$=D%x[0].length;for(let V=0;V<x.length;V++){H.push([]);for(let L=0;L<D;L++)H[V].push(x[V][(L+(x[V].length-$))%x[V].length])}}this.hot.populateFromArray(p.row,p.col,H,w.row,w.col,`${this.pluginName}.fill`,null),this.setSelection(d),this.hot.runHooks("afterAutofill",H,S,_,g),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),i=n.getBottomEndCorner();let r=e;if(this.directions.includes(Lc.vertical)&&this.directions.includes(Lc.horizontal)){const s=n.getTopStartCorner();(i.col<=e.col||s.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||s.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(Lc.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(Lc.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Fae,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Bae)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),i=this.hot.countRows();let r;for(let s=e[2]+1;s<i;s++){for(let h=e[1];h<=e[3];h++){const d=n[s][h];if(!Vn(d))return-1}const a=n[s][e[1]-1],u=n[s][e[3]+1];(!Vn(a)||!Vn(u))&&(r=s)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Rt(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,i=Ci(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+$n(this.hot.table),r=Ci(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+jn(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Yg(rd,this,Yae).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Yg(rd,this,Gae).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Iae(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Uae(){this.selectAdjacent()&&this.fillIn()}function jae(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function zae(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Yae(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Gae(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function qae(t,e){CY(t,e),e.add(t)}function Kae(t,e,n){CY(t,e),e.set(t,n)}function CY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sd(t,e,n){return(e=Xae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xae(t){var e=Zae(t,"string");return typeof e=="symbol"?e:e+""}function Zae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qae(t,e,n){return t.set(Vo(t,e),n),n}function mH(t,e){return t.get(Vo(t,e))}function Vo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const F_="autoRowSize",Jae=40,ele="autoRowSize";var sp=new WeakMap,Na=new WeakSet;class Lm extends Ht{static get PLUGIN_KEY(){return F_}static get PLUGIN_PRIORITY(){return Jae}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),qae(this,Na),sd(this,"headerHeight",null),sd(this,"ghostTable",new wY(this.hot)),sd(this,"samplesGenerator",new kS((n,i)=>{const r=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(s)||n>=0&&i>=0&&this.hot.getCellMeta(n,i).hidden)return!1;let a;return n>=0?a=this.hot.getDataAtCell(n,i):n===-1&&(a=this.hot.getColHeader(i)),{value:a}})),sd(this,"inProgress",!1),sd(this,"measuredRows",0),sd(this,"rowHeightsMap",new yu),Kae(this,sp,[]),this.hot.rowIndexMapper.registerMap(ele,this.rowHeightsMap),this.addHook("beforeRowResize",(n,i,r)=>Vo(Na,this,xB).call(this,n,i,r))}isEnabled(){const e=this.hot.getSettings()[F_];return e===!0||ht(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Vo(Na,e,ile).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Vo(Na,e,rle).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Vo(Na,e,ole).call(e,...r)}),this.addHook("beforeRender",()=>Vo(Na,this,nle).call(this)),this.addHook("modifyRowHeight",(i,r)=>this.getRowHeight(r,i)),this.addHook("init",()=>Vo(Na,this,sle).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,i)=>Vo(Na,this,xB).call(this,e,n,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const i=this.hot.renderCall;this.calculateRowsHeight({from:e,to:n},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const a=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(a.get(-1))}ke(r.from,r.to,a=>{let u=this.hot.toPhysicalRow(a);u===null&&(u=a),(i||this.rowHeightsMap.getValueAtIndex(u)===null)&&this.samplesGenerator.generateRowSamples(a,s).forEach((d,g)=>this.ghostTable.addRow(g,d))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((a,u)=>{a<0?this.headerHeight=u:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(a),u)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countRows()-1;let s=null;this.inProgress=!0;const a=()=>{if(!this.hot){vC(s),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+Lm.CALCULATION_STEP,r)},e,n),i=i+Lm.CALCULATION_STEP+1,i<r?s=pC(a):(vC(s),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateRowsHeight({from:0,to:u},e,n),i=u+1),i<r?a():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[F_];let n=Lm.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return ht(e)&&(n=e.syncLimit,t2(n)?n=I2(i,n):n>>=0),Math.min(n,i)}getRowHeight(e,n){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let r=n;return i!==null&&i>(n||0)&&(r=i),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{ke(Math.min(n,i),Math.max(n,i),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function tle(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((r,s)=>this.ghostTable.addRow(s,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,i)=>{const r=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function nle(){this.calculateVisibleRowsHeight(),this.inProgress||(Vo(Na,this,tle).call(this,mH(sp,this)),Qae(sp,this,[]))}function xB(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function ile(t,e){e||this.recalculateAllRowsHeight()}function rle(t){const e=t.reduce((n,i)=>{let[r]=i;return n.indexOf(r)===-1&&n.push(r),n},[]);mH(sp,this).push(...e)}function sle(){this.recalculateAllRowsHeight()}function ole(t){const e=t.reduce((n,i)=>{var r;const s=(r=i.address)===null||r===void 0?void 0:r.row;if(Number.isInteger(s)){const a=this.hot.toVisualRow(s);n.indexOf(a)===-1&&n.push(a)}return n},[]);mH(sp,this).push(...e)}const{getListWithInsertedItems:ale,getListWithRemovedItems:lle}=az("physicallyIndexed");class ule extends sh{constructor(){super(e=>e)}insert(e,n){const i=bA(this.indexedValues,n);this.indexedValues=ale(i,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=lle(this.indexedValues,e);this.indexedValues=SA(n,e),super.remove(e)}}const{getListWithInsertedItems:cle,getListWithRemovedItems:hle}=az("physicallyIndexed");class dle extends sh{constructor(){super(e=>e)}insert(e,n){this.indexedValues=cle(this.indexedValues,e,n,(i,r)=>this.getNextValue(r)),super.insert(e,n)}remove(e){this.indexedValues=hle(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function fle(t,e){gle(t,e),e.add(t)}function gle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mle(t,e,n){return(e=ple(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ple(t){var e=vle(t,"string");return typeof e=="symbol"?e:e+""}function vle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wle(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const HB="bindRowsWithHeaders",yle=210,Cle="loose",PB=new Map([["loose",ule],["strict",dle]]);var IB=new WeakSet;class Sle extends Ht{constructor(){super(...arguments),fle(this,IB),mle(this,"headerIndexes",null)}static get PLUGIN_KEY(){return HB}static get PLUGIN_PRIORITY(){return yle}isEnabled(){return!!this.hot.getSettings()[HB]}enablePlugin(){var e;if(this.enabled)return;const n=(e=PB.get(this.getSetting()))!==null&&e!==void 0?e:PB.get(Cle);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",i=>wle(IB,this,ble).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function ble(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Rle(t,e){SY(t,e),e.add(t)}function Ele(t,e,n){SY(t,e),e.set(t,n)}function SY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NB(t,e,n){return(e=Tle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tle(t){var e=_le(t,"string");return typeof e=="symbol"?e:e+""}function _le(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DB(t,e){return t.get($d(t,e))}function B_(t,e,n){return t.set($d(t,e),n),n}function $d(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qy="collapsibleColumns",Mle=290,Ole=["nestedHeaders"],qd="collapsibleIndicator",LB=qy,kB=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var od=new WeakMap,Gg=new WeakSet;class Ale extends Ht{constructor(){super(...arguments),Rle(this,Gg),NB(this,"nestedHeadersPlugin",null),NB(this,"headerStateManager",null),Ele(this,od,null)}static get PLUGIN_KEY(){return qy}static get PLUGIN_PRIORITY(){return Mle}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[qy,...Ole]}isEnabled(){return!!this.hot.getSettings()[qy]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Nt("You need to configure the Nested Headers plugin in order to use collapsible headers."),B_(od,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>$d(Gg,this,Ple).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return $d(Gg,e,Ile).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return $d(Gg,e,xle).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,s)=>$d(Gg,this,Hle).call(this,i,r,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),B_(od,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:s,columnIndex:a}=(e=this.headerStateManager.getHeaderTreeNodeData(n,i))!==null&&e!==void 0?e:{};if(r)return s?this.expandSection({row:n,col:a}):this.collapseSection({row:n,col:a}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:LB,relativeToGroup:Cu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(LB)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(a){a&&a.parentNode.removeChild(a)};ke(0,e-1,a=>{const u=n.childNodes[a],h=i.childNodes[a],d=r?r.childNodes[a]:null;ke(0,u.childNodes.length-1,g=>{let p=u.childNodes[g].querySelector(`.${qd}`);s(p),h&&h.childNodes[g]&&(p=h.childNodes[g].querySelector(`.${qd}`),s(p)),r&&d&&d.childNodes[g]&&(p=d.childNodes[g].querySelector(`.${qd}`),s(p))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:s,headerLevel:a,columnIndex:u,isCollapsed:h}=i;if(r===!0&&s>1&&(h&&e==="expand"||!h&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(a),col:u}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!kB.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const i=Uc(e,y=>{let{row:S}=y;return S<0});let r=i.length>0;W(i,y=>{var S;let{row:_,col:E}=y;const{collapsible:H,isCollapsed:x}=(S=this.headerStateManager.getHeaderSettings(_,E))!==null&&S!==void 0?S:{};if(!H||x&&n==="collapse"||!x&&n==="expand")return r=!1,!1});const s=[],a=[];r&&W(i,y=>{let{row:S,col:_}=y;const{colspanCompensation:E,affectedColumns:H,rollbackModification:x}=this.headerStateManager.triggerNodeModification(n,S,_);E>0&&(a.push(...H),s.push(x))});const u=this.getCollapsedColumns();let h=[];n==="collapse"?h=f7([...u,...a]):n==="expand"&&(h=Uc(u,y=>!a.includes(y)));const d=kB.get(n);if(this.hot.runHooks(d.beforeHook,u,h,r)===!1){W(s,y=>{y()});return}this.hot.batchExecution(()=>{W(a,y=>{DB(od,this).setValueAtIndex(this.hot.toPhysicalColumn(y),d.hideColumn)})},!0);const p=this.getCollapsedColumns().length!==u.length,w=this.hot.getSelectedRangeLast();if(n==="collapse"&&p&&w){const{row:y,col:S}=w.highlight;if((this.hot.rowIndexMapper.isHidden(y)||this.hot.columnIndexMapper.isHidden(S))&&a.includes(S)){const E=y>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(y,1,!0):y,H=S>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(S,1,!0):S;E!==null&&H!==null&&this.hot.selectCell(E,H)}}this.hot.runHooks(d.afterHook,u,h,r,p),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return DB(od,this).getHiddenIndexes()}destroy(){B_(od,this,null),super.destroy()}}function xle(t,e,n){var i;const{collapsible:r,origColspan:s,isCollapsed:a}=(i=this.headerStateManager.getHeaderSettings(n,t))!==null&&i!==void 0?i:{},u=r&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,h=this.hot.getSettings().ariaTags;let d=e.querySelector(`.${qd}`);if(vf(e,[Cs("")[0]]),u)d||(d=this.hot.rootDocument.createElement("div"),fe(d,qd),e.querySelector("div:first-child").appendChild(d)),je(d,["collapsed","expanded"]),a?(fe(d,"collapsed"),zc(d,"+"),h&&Ge(e,...Cs(!1))):(fe(d,"expanded"),zc(d,"-"),h&&Ge(e,...Cs(!0))),h&&Ge(d,...vu());else{var g;(g=d)===null||g===void 0||g.remove()}}function Hle(t,e){ze(t.target,qd)&&(ze(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ze(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),so(t))}function Ple(){this.updatePlugin()}function Ile(t,e){e||this.updatePlugin()}function rc(t,e,n){return(e=Nle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nle(t){var e=Dle(t,"string");return typeof e=="symbol"?e:e+""}function Dle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Lle=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],kle=!1,Vle=!0,$le=!0;class Fle{constructor(e,n){rc(this,"hot",void 0),rc(this,"sortingStates",new AS),rc(this,"sortEmptyCells",kle),rc(this,"indicator",Vle),rc(this,"headerAction",$le),rc(this,"compareFunctionFactory",void 0),rc(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){ht(e)&&dt(e,(n,i)=>{Lle.includes(i)&&(this[i]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[i]=n;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return ht(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[i,r]=n;return{column:this.hot.toVisualColumn(i),...r}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(Pe(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function bY(t,e,n){const i=e.locale;return function(r,s){const{sortEmptyCells:a}=n;return typeof r=="string"&&(r=r.toLocaleLowerCase(i)),typeof s=="string"&&(s=s.toLocaleLowerCase(i)),r===s?zo:Vn(r)?Vn(s)?zo:a&&t==="asc"?_n:Mn:Vn(s)?a&&t==="asc"?Mn:_n:isNaN(r)&&!isNaN(s)?t==="asc"?Mn:_n:!isNaN(r)&&isNaN(s)||(isNaN(r)||isNaN(s)||(r=parseFloat(r),s=parseFloat(s)),r<s)?t==="asc"?_n:Mn:r>s?t==="asc"?Mn:_n:zo}}const RY="default";function Ble(t,e,n){return function(i,r){const s=parseFloat(i),a=parseFloat(r),{sortEmptyCells:u}=n;if(s===a||isNaN(s)&&isNaN(a))return zo;if(u){if(Vn(i))return t==="asc"?_n:Mn;if(Vn(r))return t==="asc"?Mn:_n}return isNaN(s)?Mn:isNaN(a)?_n:s<a?t==="asc"?_n:Mn:s>a?t==="asc"?Mn:_n:zo}}const Wle="numeric";function Ule(t,e,n){const i=e.checkedTemplate,r=e.uncheckedTemplate,{sortEmptyCells:s}=n;return function(a,u){const h=Vn(a),d=Vn(u),g=h?r:a,p=d?r:u,w=g===r||g===i,y=p===r||p===i;if(s===!1){if(h&&d===!1)return Mn;if(h===!1&&d)return _n}return w===!1&&y?t==="asc"?_n:Mn:w&&y===!1?t==="asc"?Mn:_n:w===!1&&y===!1?bY(t,e,n)(a,u):g===r&&p===i?t==="asc"?_n:Mn:g===i&&p===r?t==="asc"?Mn:_n:zo}}const jle="checkbox";function zle(t,e,n){return AY(t,e.dateFormat,n)}const Yle="date";function Gle(t,e,n){return AY(t,e.timeFormat,n)}const qle="time",{register:Dp,getItem:VB,hasItem:Kle}=oo("sorting.compareFunctionFactory"),{register:EY,getItem:Xle}=oo("sorting.mainSortComparator");function TY(t){return Kle(t)?VB(t):VB(RY)}Dp(jle,Ule);Dp(Yle,zle);Dp(RY,bY);Dp(Wle,Ble);Dp(qle,Gle);const zo=0,_n=-1,Mn=1;function Zle(t,e){const n=Xle(e);for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];t.sort(n(...r))}const _C="asc",MC="desc",_Y="colHeader";function Qle(t){if(ht(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[_C,MC].includes(n)}function Jle(t){if(t.some(n=>Qle(n)===!1))return!1;const e=t.map(n=>{let{column:i}=n;return i});return new Set(e).size===e.length}function $B(t){if(t!==MC)return t===_C?MC:_C}function MY(t){return t.querySelector(`.${_Y}`)}function OY(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function pH(t,e,n){return t===-1&&e>=0&&Yc(n)===!1}function AY(t,e,n){return function(i,r){const{sortEmptyCells:s}=n;if(i===r)return zo;if(Vn(i))return Vn(r)?zo:s&&t==="asc"?_n:Mn;if(Vn(r))return s&&t==="asc"?Mn:_n;const a=pe(i,e),u=pe(r,e);return a.isValid()?u.isValid()?u.isAfter(a)?t==="asc"?_n:Mn:u.isBefore(a)?t==="asc"?Mn:_n:zo:_n:Mn}}const eue="ascending",tue="descending",xY="indicatorDisabled",HY="columnSorting",PY="sortAction",IY=new Map([[_C,eue],[MC,tue]]);function nue(t,e,n,i){const r=[HY];if(i&&r.push(PY),n===!1)return r.push(xY),r;const s=t.getSortOrderOfColumn(e);return Pe(s)&&r.push(IY.get(s)),r}function iue(){return Array.from(IY.values()).concat(PY,xY,HY)}function rue(t,e){return function(n,i){const[,...r]=n,[,...s]=i;return function(u){const h=t[u],d=e[u],g=r[u],p=s[u],w=d.columnSorting;return(w.compareFunctionFactory?w.compareFunctionFactory:TY(d.type))(h,d,w)(g,p)}(0)}}function sue(t,e){oue(t,e),e.add(t)}function oue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ww(t,e,n){return(e=aue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aue(t){var e=lue(t,"string");return typeof e=="symbol"?e:e+""}function lue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Id(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OC="columnSorting",uue=50,AC="append",cue="replace",FB=OC;EY(OC,rue);Ae.getSingleton().register("beforeColumnSort");Ae.getSingleton().register("afterColumnSort");var xc=new WeakSet;class NY extends Ht{constructor(){super(...arguments),sue(this,xc),Ww(this,"columnStatesManager",null),Ww(this,"columnMetaCache",null),Ww(this,"pluginKey",OC),Ww(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return OC}static get PLUGIN_PRIORITY(){return uue}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new Fle(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new yu(n=>{let i=this.hot.toVisualColumn(n);return i===null&&(i=n),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,i)=>Id(xc,this,hue).call(this,n,i)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Id(xc,e,fue).call(e,...i)}),this.addHook("afterOnCellMouseDown",(n,i)=>this.onAfterOnCellMouseDown(n,i)),this.addHook("afterInit",()=>Id(xc,this,I1).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Id(xc,e,due).call(e,...i)}),this.hot.view&&Id(xc,this,I1).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,i)=>{const r=MY(i);OY(n,i)===!1||r===null||this.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:Cu,position:"before",group:FB})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FB)}sort(e){const n=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",n,i,r)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new lz),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",n,r?i:n,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Pe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return Jle(e)&&e.every(i=>{let{column:r}=i;return r<=n&&r>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let{column:s,...a}=r;return{column:this.hot.toPhysicalColumn(s),...a}};n.initialConfig=Rt(e,i),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,i=r=>{let{column:s,...a}=r;return{column:this.hot.toVisualColumn(s),...a}};return Pe(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Rt(n.initialConfig,i)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(Pe(n)){const r=$B(n);return Pe(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:$B()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:AC;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,s=this.getSortConfig(),a=this.getColumnNextConfig(e);if(r){if(vn(a))return[...s.slice(0,i),...s.slice(i+1)];if(n===AC)return[...s.slice(0,i),...s.slice(i+1),a];if(n===cue)return[...s.slice(0,i),a,...s.slice(i+1)]}return Pe(a)?s.concat(a):s}getPluginColumnConfig(e){if(ht(e)){const n=e[this.pluginKey];if(ht(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(r);return Array.isArray(s.columns)?Object.assign(i,n,this.getPluginColumnConfig(s.columns[e])):on(s.columns)?Object.assign(i,n,this.getPluginColumnConfig(s.columns(e))):Object.assign(i,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),i=Object.create(n);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],i=this.hot.countRows(),r=d=>Rt(e,g=>this.hot.getDataAtCell(d,g.column));for(let d=0;d<this.getNumberOfRowsToSort(i);d+=1)n.push([this.hot.toPhysicalRow(d)].concat(r(d)));const s=Rt(n,d=>d[0]);Zle(n,this.pluginKey,Rt(e,d=>d.sortOrder),Rt(e,d=>this.getFirstCellSettings(d.column)));for(let d=n.length;d<i;d+=1)n.push([d].concat(r(d)));const a=Rt(n,d=>d[0]),u=new Map(Rt(s,(d,g)=>[d,a[g]])),h=Rt(this.hot.rowIndexMapper.getIndexesSequence(),d=>u.has(d)?u.get(d):d);this.hot.rowIndexMapper.setIndexesSequence(h)}sortBySettings(e){if(ht(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||ht(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(je(e,iue()),this.enabled!==!1){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];fe(e,nue(...i))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Pe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ze(e.target,_Y)}onAfterOnCellMouseDown(e,n){if(pH(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const i=this.hot.getActiveEditor(),r=this.getColumnNextConfig(n.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(r)}):this.sort(r)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function I1(){const t=this.getAllSavedSortSettings();if(ht(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function hue(t,e){const n=MY(e);if(OY(t,e)===!1||n===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],r=i.indicator,s=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,r,s),this.hot.getSettings().ariaTags){const a=this.columnStatesManager.getSortOrderOfColumn(t);Ge(e,...N7(a?`${a}ending`:"none"))}}function due(t){t===!0&&this.hot.view&&Id(xc,this,I1).call(this)}function fue(t,e,n,i){pH(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function sc(t,e,n){return(e=gue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gue(t){var e=mue(t,"string");return typeof e=="symbol"?e:e+""}function mue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pue{constructor(e,n){sc(this,"plugin",void 0),sc(this,"hot",void 0),sc(this,"endpoints",[]),sc(this,"settings",void 0),sc(this,"settingsType","array"),sc(this,"currentEndpoint",null),sc(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),W(i,r=>{const s={};this.assignSetting(r,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,s,"reversedRowCoords",!1),this.assignSetting(r,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,s,"sourceColumn",r.destinationColumn),this.assignSetting(r,s,"type","sum"),this.assignSetting(r,s,"forceNumeric",!1),this.assignSetting(r,s,"suppressDataTypeErrors",!0),this.assignSetting(r,s,"customFunction",null),this.assignSetting(r,s,"readOnly",!0),this.assignSetting(r,s,"roundFloat",!1),n.push(s)}),n}assignSetting(e,n,i,r){if(i==="ranges"&&e[i]===void 0){n[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;n[i]=r}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}resetSetupBeforeStructureAlteration(e,n,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();W(s,a=>{r==="row"&&a.destinationRow>=n&&(e==="insert_row"?a.alterRowOffset=i:e==="remove_row"&&(a.alterRowOffset=-1*i)),r==="col"&&a.destinationColumn>=n&&(e==="insert_col"?a.alterColumnOffset=i:e==="remove_col"&&(a.alterColumnOffset=-1*i))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,n,i,r,s){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const w=()=>(this.hot.removeHook("beforeViewRender",w),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",w);return}const u=e.indexOf("row")>-1?"row":"col",h=e.indexOf("remove")>-1?-1:1,d=this.getAllEndpoints(),g=e.indexOf("move_row")===0,p=n;W(d,w=>{u==="row"&&w.destinationRow>=p&&(w.alterRowOffset=h*i),u==="col"&&w.destinationColumn>=p&&(w.alterColumnOffset=h*i)}),this.resetAllEndpoints(d,!g),g?W(d,w=>{this.extendEndpointRanges(w,p,r[0],r.length),this.recreatePhysicalRanges(w),this.clearOffsetInformation(w)}):W(d,w=>{this.shiftEndpointCoordinates(w,p)}),a&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,i,r){W(e.ranges,s=>{s[1]&&(n>=s[0]&&n<=s[1]?i>s[1]?s[1]+=r:i<s[0]&&(s[0]-=r):i>=s[0]&&i<=s[1]&&(s[1]-=r,n<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,i=[],r=[];W(n,s=>{const a=[];if(s[1])for(let u=s[0];u<=s[1];u++)a.push(this.hot.toPhysicalRow(u));else a.push(this.hot.toPhysicalRow(s[0]));r.push(a)}),W(r,s=>{let a=[];W(s,(u,h)=>{h===0?a.push(u):s[h]!==s[h-1]+1&&(a.push(s[h-1]),i.push(a),a=[],a.push(u)),h===s.length-1&&(a.push(u),i.push(a))})}),e.ranges=i}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,W(e.ranges,i=>{W(i,(r,s)=>{r>=n&&(i[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const s=r.alterRowOffset||0,a=r.alterColumnOffset||0;return r.destinationRow+s>=this.hot.countRows()||r.destinationColumn+a>=this.hot.countCols()})||(this.cellsToSetCache=[],W(e,r=>{this.resetEndpointValue(r,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],W(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],W(e,(i,r,s)=>{`${i[2]||""}`!=`${i[3]}`&&W(this.getAllEndpoints(),(a,u)=>{this.hot.propToCol(s[r][1])===a.sourceColumn&&n.indexOf(u)===-1&&n.push(u)})}),W(n,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const i=this.hot.getCellMeta(n,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?r:0)),""])}setEndpointValue(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const a=this.hot.getCellMeta(s,e.destinationColumn);(n==="init"||a.readOnly!==e.readOnly)&&(a.readOnly=e.readOnly,a.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const a=e.roundFloat;let u=0;Number.isInteger(a)&&(u=Math.min(Math.max(0,a),100)),e.result=e.result.toFixed(u)}i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Nt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function W_(t){return t==null||isNaN(t)}function vue(t,e){wue(t,e),e.add(t)}function wue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yue(t,e,n){return(e=Cue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cue(t){var e=Sue(t,"string");return typeof e=="symbol"?e:e+""}function Sue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const U_="columnSummary",bue=220;var qg=new WeakSet;class Rue extends Ht{constructor(){super(...arguments),vue(this,qg),yue(this,"endpoints",null)}static get PLUGIN_KEY(){return U_}static get PLUGIN_PRIORITY(){return bue}isEnabled(){return!!this.hot.getSettings()[U_]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[U_],this.endpoints=new pue(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Uw(qg,e,Eue).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Uw(qg,e,_ue).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Uw(qg,e,Tue).call(e,...i)}),this.addHook("beforeCreateRow",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,i,null,r)),this.addHook("beforeCreateCol",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,i,null,r)),this.addHook("afterCreateCol",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,i,null,r)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Uw(qg,e,Mue).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return dt(e.ranges,i=>{n+=this.getPartialSum(i,e.sourceColumn)}),n}getPartialSum(e,n){let i=0,r=e[1]||e[0],s=null,a=0;do{if(s=this.getCellValue(r,n),s=W_(s)?null:s,s!==null){const u=(`${s}`.split(".")[1]||[]).length||1;u>a&&(a=u)}i+=s||0,r-=1}while(r>=e[0]);return Math.round(i*10**a)/10**a}calculateMinMax(e,n){let i=null;return dt(e.ranges,r=>{const s=this.getPartialMinMax(r,e.sourceColumn,n);if(i===null&&s!==null&&(i=s),s!==null)switch(n){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}}),i===null?"Not enough data":i}getPartialMinMax(e,n,i){let r=null,s=e[1]||e[0],a;do{if(a=this.getCellValue(s,n),a=W_(a)?null:a,r===null)r=a;else if(a!==null)switch(i){case"min":r=Math.min(r,a);break;case"max":r=Math.max(r,a);break}s-=1}while(s>=e[0]);return r}countEmpty(e,n){let i,r=0,s=e[1]||e[0];do i=this.getCellValue(s,n),i=W_(i)?null:i,i===null&&(r+=1),s-=1;while(s>=e[0]);return r}countEntries(e){let n=0;const i=e.ranges;return dt(i,r=>{const s=r[1]===void 0?1:r[1]-r[0]+1,a=this.countEmpty(r,e.sourceColumn);n+=s,n-=a}),n}calculateAverage(e){const n=this.calculateSum(e),i=this.countEntries(e);return n/i}getCellValue(e,n){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(n);let s=this.hot.getSourceDataAtCell(e,n),a="";if(i!==null&&r!==null&&(a=this.hot.getCellMeta(i,r).className||""),a.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error($t`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function Eue(){this.endpoints.initEndpoints()}function Tue(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function _ue(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Mue(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Oue(t,e){DY(t,e),e.add(t)}function j_(t,e,n){DY(t,e),e.set(t,n)}function DY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nd(t,e){return t.get(vH(t,e))}function N1(t,e,n){return t.set(vH(t,e),n),n}function vH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xC=new WeakMap,jw=new WeakMap,zw=new WeakMap,BB=new WeakSet;class LY{constructor(){Oue(this,BB),j_(this,xC,!0),j_(this,jw,null),j_(this,zw,new ResizeObserver(e=>vH(BB,this,Aue).call(this,e)))}setObservedElement(e){N1(jw,this,e)}unobserve(){Nd(zw,this).unobserve(Nd(jw,this))}observe(){N1(xC,this,!0),Nd(zw,this).observe(Nd(jw,this))}destroy(){Nd(zw,this).disconnect()}}function Aue(t){if(Nd(xC,this)||!Array.isArray(t)||!t.length){N1(xC,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:i,blockSize:r}=n[0];this.runLocalHooks("resize",i,r)})}Yt(LY,Ai);function oc(t,e,n){xue(t,e),e.set(t,n)}function xue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ut(t,e){return t.get(kY(t,e))}function Ma(t,e,n){return t.set(kY(t,e),n),n}function kY(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ac=new WeakMap,z_=new WeakMap,Oa=new WeakMap,Dl=new WeakMap,Ll=new WeakMap,Yw=new WeakMap,ad=new WeakMap;class kc{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var i=this;oc(this,ac,void 0),oc(this,z_,!1),oc(this,Oa,null),oc(this,Dl,void 0),oc(this,Ll,void 0),oc(this,Yw,!0),oc(this,ad,new LY),Ma(ac,this,e),Ma(z_,this,n),Ma(Dl,this,this.createEditor()),Ma(Ll,this,Ut(Dl,this).style),Ut(ad,this).setObservedElement(this.getInputElement()),Ut(ad,this).addLocalHook("resize",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){Ut(Ll,this).left=`${e}px`,Ut(Ll,this).top=`${n}px`}setSize(e,n){if(e&&n){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${n}px`}}getSize(){return{width:jn(this.getInputElement()),height:$n(this.getInputElement())}}observeSize(){Ut(ad,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){Ut(Ll,this).display="block",Ma(Yw,this,!1)}hide(){Ut(ad,this).unobserve(),Ut(Yw,this)||(Ut(Ll,this).display="none"),Ma(Yw,this,!0)}isVisible(){return Ut(Ll,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return Ut(ac,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Ut(ac,this).createElement("div"),n=Ut(ac,this).createElement("textarea");return e.style.display="none",Ma(Oa,this,Ut(ac,this).createElement("div")),Ut(Oa,this).setAttribute("dir",Ut(z_,this)?"rtl":"ltr"),fe(Ut(Oa,this),kc.CLASS_EDITOR_CONTAINER),Ut(ac,this).body.appendChild(Ut(Oa,this)),fe(e,kc.CLASS_EDITOR),fe(n,kc.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),Ut(Oa,this).appendChild(e),e}getInputElement(){return Ut(Dl,this).querySelector(`.${kc.CLASS_INPUT}`)}getEditorElement(){return Ut(Dl,this)}destroy(){const e=Ut(Oa,this)?Ut(Oa,this).parentNode:null;Ut(Dl,this).parentNode.removeChild(Ut(Dl,this)),Ma(Dl,this,null),Ma(Ll,this,null),Ut(ad,this).destroy(),e&&e.removeChild(Ut(Oa,this))}}Yt(kc,Ai);function Y_(t,e,n){return(e=Hue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hue(t){var e=Pue(t,"string");return typeof e=="symbol"?e:e+""}function Pue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Iue=250,Nue=250;class VY{constructor(e){Y_(this,"wasLastActionShow",!0),Y_(this,"showDebounced",null),Y_(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Nue)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Iue;this.showDebounced=GO(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}Yt(VY,Ai);function Due(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Lue(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function lc(t,e){const n={};return W(t,i=>{i.forAll((r,s)=>{r>=0&&s>=0&&(n[r]||(n[r]=[]),n[r][s]=e(r,s))})}),n}function ql(t,e,n,i,r){W(t,s=>{s.forAll((a,u)=>{a>=0&&u>=0&&kue(a,u,e,n,i,r)})})}function kue(t,e,n,i,r,s){const a=r(t,e);let u=i;a.className&&(n==="vertical"?u=Due(a.className,i):u=Lue(a.className,i)),s(t,e,"className",u)}function $Y(t){return`<span class="selected">✓</span>${t}`}function Ky(t,e){let n=!1;return Array.isArray(t)&&W(t,i=>(i.forAll((r,s)=>{if(r>=0&&s>=0&&e(r,s))return n=!0,!1}),n)),n}function VS(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:r,left:s}=i.getBoundingClientRect();n.top=r,n.left=s}return n}const ut="---------";function Vue(){return{name:ut}}const gs="alignment";function $ue(){return{key:gs,name(){return this.getTranslatedPhrase(GA)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${gs}:left`,name(){return this.getTranslatedPhrase(qA)},callback(){const t=this.getSelectedRange(),e=lc(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),ql(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,a,u)=>this.setCellMeta(r,s,a,u)),this.render()},disabled:!1},{key:`${gs}:center`,name(){return this.getTranslatedPhrase(KA)},callback(){const t=this.getSelectedRange(),e=lc(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),ql(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,a,u)=>this.setCellMeta(r,s,a,u)),this.render()},disabled:!1},{key:`${gs}:right`,name(){return this.getTranslatedPhrase(XA)},callback(){const t=this.getSelectedRange(),e=lc(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),ql(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,a,u)=>this.setCellMeta(r,s,a,u)),this.render()},disabled:!1},{key:`${gs}:justify`,name(){return this.getTranslatedPhrase(ZA)},callback(){const t=this.getSelectedRange(),e=lc(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),ql(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,a,u)=>this.setCellMeta(r,s,a,u)),this.render()},disabled:!1},{name:ut},{key:`${gs}:top`,name(){return this.getTranslatedPhrase(QA)},callback(){const t=this.getSelectedRange(),e=lc(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),ql(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,a,u)=>this.setCellMeta(r,s,a,u)),this.render()},disabled:!1},{key:`${gs}:middle`,name(){return this.getTranslatedPhrase(JA)},callback(){const t=this.getSelectedRange(),e=lc(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),ql(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,a,u)=>this.setCellMeta(r,s,a,u)),this.render()},disabled:!1},{key:`${gs}:bottom`,name(){return this.getTranslatedPhrase(ex)},callback(){const t=this.getSelectedRange(),e=lc(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),ql(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,a,u)=>this.setCellMeta(r,s,a,u)),this.render()},disabled:!1}]}}}const $S="clear_column";function Fue(){return{key:$S,name(){return this.getTranslatedPhrase(IA)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,i)=>{if(n<0||i<0)return!0;const{readOnly:r}=this.getCellMeta(n,i);return r?!0:(e=!0,!1)}),!e}}}const Lp="col_left";function Bue(){return{key:Lp,name(){return this.getTranslatedPhrase(MA)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const kp="col_right";function Wue(){return{key:kp,name(){return this.getTranslatedPhrase(OA)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Vp="make_read_only";function Uue(){return{key:Vp,checkable:!0,ariaChecked(){return Ky(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(CC)},name(){let t=this.getTranslatedPhrase(CC);return Ky(this.getSelectedRange(),(n,i)=>this.getCellMeta(n,i).readOnly)&&(t=$Y(t)),t},callback(){const t=this.getSelectedRange(),e=Ky(t,(n,i)=>this.getCellMeta(n,i).readOnly);W(t,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&this.setCellMeta(i,r,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const FS="redo";function jue(){return{key:FS,name(){return this.getTranslatedPhrase(PA)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const $p="remove_col";function zue(){return{key:$p,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(xA,e)},callback(){this.alter("remove_col",$te(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const BS="remove_row";function Yue(){return{key:BS,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(AA,e)},callback(){this.alter("remove_row",Fte(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const WS="row_above";function Gue(){return{key:WS,name(){return this.getTranslatedPhrase(TA)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const US="row_below";function que(){return{key:US,name(){return this.getTranslatedPhrase(_A)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const op="no_items";function Kue(){return{key:op,name(){return this.getTranslatedPhrase(EA)},disabled:!0,isCommand:!1}}const jS="undo";function Xue(){return{key:jS,name(){return this.getTranslatedPhrase(HA)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Zue=[WS,US,Lp,kp,$S,BS,$p,jS,FS,Vp,gs,ut,op],Que={[ut]:Vue,[op]:Kue,[WS]:Gue,[US]:que,[Lp]:Bue,[kp]:Wue,[$S]:Fue,[BS]:Yue,[$p]:zue,[jS]:Xue,[FS]:jue,[Vp]:Uue,[gs]:$ue};function FY(){const t={};return dt(Que,(e,n)=>{t[n]=e()}),t}function Jue(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(jA):this.getTranslatedPhrase(UA)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ece(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(zA)},callback(){this.getSelectedRangeLast().forAll((n,i)=>{n>=0&&i>=0&&t.removeCommentAtCell(n,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function tce(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(YA);return Ky(this.getSelectedRange(),(i,r)=>t.getCommentMeta(i,r,Xy))?$Y(e):e},callback(){this.getSelectedRangeLast().forAll((n,i)=>{if(n>=0&&i>=0){const r=!!t.getCommentMeta(n,i,Xy);t.updateCommentMeta(n,i,{[Xy]:!r})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function nce(t,e){BY(t,e),e.add(t)}function ld(t,e,n){BY(t,e),e.set(t,n)}function BY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ice(t,e,n){return(e=rce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rce(t){var e=sce(t,"string");return typeof e=="symbol"?e:e+""}function sce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ou(t,e,n){return t.set(Lr(t,e),n),n}function at(t,e){return t.get(Lr(t,e))}function Lr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const HC="comments",oce=60,$a="comment",_m="value",WY="style",Xy="readOnly",Kg=HC,D1=`plugin:${HC}`;var Wt=new WeakMap,No=new WeakMap,zS=new WeakMap,Zy=new WeakMap,L1=new WeakMap,PC=new WeakMap,cs=new WeakSet;class ace extends Ht{constructor(){super(...arguments),nce(this,cs),ice(this,"range",{}),ld(this,Wt,null),ld(this,No,null),ld(this,zS,!1),ld(this,Zy,!1),ld(this,L1,null),ld(this,PC,"")}static get PLUGIN_KEY(){return HC}static get PLUGIN_PRIORITY(){return oce}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[HC]}enablePlugin(){var e=this;this.enabled||(at(Wt,this)||(ou(Wt,this,new kc(this.hot.rootDocument,this.hot.isRtl())),at(Wt,this).addLocalHook("resize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Lr(cs,e,mce).call(e,...i)})),at(No,this)||ou(No,this,new VY(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,i,r,s,a,u)=>Lr(cs,this,dce).call(this,n,u)),this.addHook("afterScroll",()=>Lr(cs,this,vce).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Lr(cs,this,pce).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Lr(cs,e,wce).call(e,...i)}),at(No,this).addLocalHook("hide",()=>this.hide()),at(No,this).addLocalHook("show",(n,i)=>this.showAtCell(n,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){at(No,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),i=e.addContext(D1);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeLast();ou(Zy,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(D1),this.hot._registerTimeout(()=>{ou(Zy,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isCell()},group:Kg}),i.addShortcut({keys:[["Escape"]],callback:()=>{at(Wt,this).setValue(at(PC,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>at(Wt,this).isVisible()&&at(Wt,this).isFocused(),group:Kg}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>at(Wt,this).isVisible()&&at(Wt,this).isFocused(),group:Kg}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{at(Wt,this).setValue(at(Wt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:Kg})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Kg)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>Lr(cs,this,cce).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Lr(cs,this,lce).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Lr(cs,this,hce).call(this)),this.eventManager.addEventListener(n,"focus",()=>Lr(cs,this,gce).call(this)),this.eventManager.addEventListener(n,"blur",()=>Lr(cs,this,fce).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",i=>Lr(cs,this,uce).call(this,i))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=jc(e.target,"TD","TBODY");return!!(n&&ze(n,"htCommentCell")&&jc(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=at(Wt,this).getValue();let i="";e!=null?i=e:n!=null&&(i=n);const r=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(r,s,{[_m]:i}),this.hot.render()}setCommentAtCell(e,n,i){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,$a),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(i)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,_m)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,_m)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:i}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return at(No,this).cancelHiding(),at(Wt,this).setValue((e=r[$a]?r[$a][_m]:null)!==null&&e!==void 0?e:""),at(Wt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){at(Wt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!at(Wt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:r,col:s}=this.range.from;let a=n.getRenderableFromVisualIndex(r),u=i.getRenderableFromVisualIndex(s);const h=a===null;at(Wt,this).setPosition(0,0),a===null&&(a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1))),u===null&&(u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)));const d=a===null,g=u===null;a=a??0,u=u??0;const{rootWindow:p,view:{_wt:w}}=this.hot,{wtTable:y}=w,S=w.getCell({row:a,col:u},!0),_=this.getCommentMeta(r,s,WY);_?at(Wt,this).setSize(_.width,_.height):at(Wt,this).resetSize();const E=g?0:y.getColumnWidth(u),H=h&&!d?$n(S):0,{left:x,top:D,width:$,height:V}=S.getBoundingClientRect(),{width:L,height:U}=at(Wt,this).getSize(),{innerWidth:re,innerHeight:se}=this.hot.rootWindow,Q=this.hot.rootDocument.documentElement;let de=x+p.scrollX+E,me=D+p.scrollY+H;this.hot.isRtl()&&(de-=L+E),this.hot.isLtr()&&x+$+L>re?de=x+p.scrollX-L-1:this.hot.isRtl()&&de<-(Q.scrollWidth-Q.clientWidth)&&(de=x+p.scrollX+E+1),D+U>se&&(me-=U-V+1),at(Wt,this).setPosition(de,me),at(Wt,this).setReadOnlyState(this.getCommentMeta(r,s,Xy)),at(Wt,this).observeSize()}focusEditor(){at(Wt,this).focus()}updateCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n)[$a];let s;r?(s=tr(r),RS(s,i)):s=i,this.hot.setCellMeta(e,n,$a,s)}getCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n);if(r[$a])return r[$a][i]}addToContextMenu(e){e.items.push({name:ut},Jue(this),ece(this),tce(this))}getEditorInputElement(){return at(Wt,this).getInputElement()}destroy(){var e,n;(e=at(Wt,this))===null||e===void 0||e.destroy(),(n=at(No,this))===null||n===void 0||n.destroy(),super.destroy()}}function lce(t){if(!(!this.hot.view||!this.hot.view._wt)&&!at(zS,this)&&!this.targetIsCommentTextArea(t)){const e=jc(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function uce(t){t.stopPropagation()}function cce(t){const{rootDocument:e}=this.hot;if(!(at(zS,this)||at(Wt,this).isFocused()||ze(t.target,"wtBorder")||at(L1,this)===t.target||!at(Wt,this)))if(ou(L1,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));at(No,this).show(n)}else Wc(t.target,e)&&!this.targetIsCommentTextArea(t)&&at(No,this).hide()}function hce(){ou(zS,this,!1)}function dce(t,e){e[$a]&&e[$a][_m]&&fe(t,e.commentedCellClassName)}function fce(){ou(PC,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function gce(){ou(PC,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(D1)}function mce(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[WY]:{width:t,height:e}})}function pce(t){at(Wt,this).isFocused()&&so(t)}function vce(){at(Zy,this)||this.hide()}function wce(){const t=at(Wt,this).getEditorElement();je(t,/ht-theme-.*/g),fe(t,this.hot.getCurrentThemeName())}function G_(t,e,n){return(e=yce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yce(t){var e=Cce(t,"string");return typeof e=="symbol"?e:e+""}function Cce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UY{constructor(e){G_(this,"hot",void 0),G_(this,"commands",{}),G_(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const s=e.split(":"),a=s[0],u=s.length===2?s[1]:null;let h=this.commands[a];if(!h)throw new Error(`Menu command '${a}' not exists.`);if(u&&h.submenu&&(h=Sce(u,h.submenu.items)),h.disabled===!0||typeof h.disabled=="function"&&h.disabled.call(this.hot)===!0||ei(h,"submenu"))return;const d=[];typeof h.callback=="function"&&d.push(h.callback),typeof this.commonCallback=="function"&&d.push(this.commonCallback),i.unshift(s.join(":")),W(d,g=>g.apply(this.hot,i))}}function Sce(t,e){let n;return W(e,i=>{const r=i.key?i.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=i,!1}),n}function q_(t,e,n){return(e=bce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bce(t){var e=Rce(t,"string");return typeof e=="symbol"?e:e+""}function Rce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jY{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;q_(this,"hot",void 0),q_(this,"predefinedItems",FY()),q_(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,dt(e,(i,r)=>{let s="";i.name===ut?(n[ut]=i,s=ut):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,n[r]=i,s=i.key):(n[i.key]=i,s=i.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Ece(e,this.defaultOrderPattern,this.predefinedItems)}}function Ece(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let r=t;return r&&r.items?r=r.items:Array.isArray(r)||(r=e),ht(r)?dt(r,(s,a)=>{let u=n[typeof s=="string"?s:a];u||(u=s),ht(s)?ti(u,s):typeof u=="string"&&(u={name:u}),u.key===void 0&&(u.key=a),i.push(u)}):W(r,(s,a)=>{let u=n[s];!u&&Zue.indexOf(s)>=0||(u||(u={name:s,key:`${a}`}),ht(s)&&ti(u,s),u.key===void 0&&(u.key=a),i.push(u))}),i}function kl(t,e,n){return(e=Tce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tce(t){var e=_ce(t,"string");return typeof e=="symbol"?e:e+""}function _ce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mce{constructor(e,n){kl(this,"top",void 0),kl(this,"topRelative",void 0),kl(this,"left",void 0),kl(this,"leftRelative",void 0),kl(this,"scrollTop",void 0),kl(this,"scrollLeft",void 0),kl(this,"cellHeight",void 0),kl(this,"cellWidth",void 0);const i=n.scrollY,r=n.scrollX;let s,a,u,h,d,g;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),u=parseInt(e.left,10),d=e.height||0,g=e.width||0,a=s,h=u,s+=i,u+=r):this.type==="event"&&(s=parseInt(e.pageY,10),u=parseInt(e.pageX,10),d=e.target.clientHeight,g=e.target.clientWidth,a=s-i,h=u-r),this.top=s,this.topRelative=a,this.left=u,this.leftRelative=h,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=d,this.cellWidth=g}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Xg(t,e,n){Oce(t,e),e.set(t,n)}function Oce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pt(t,e){return t.get(zY(t,e))}function Gw(t,e,n){return t.set(zY(t,e),n),n}function zY(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zi=new WeakMap,Co=new WeakMap,ur=new WeakMap,K_=new WeakMap,ud=new WeakMap;class Ace{constructor(e){Xg(this,zi,void 0),Xg(this,Co,void 0),Xg(this,ur,void 0),Xg(this,K_,!1),Xg(this,ud,{above:0,below:0,left:0,right:0}),Gw(K_,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return pt(ud,this)[e]=n,this}setElement(e){return Gw(zi,this,e),this}setParentElement(e){return Gw(Co,this,e),this}updatePosition(e){Gw(ur,this,new Mce(e,pt(zi,this).ownerDocument.defaultView)),pt(K_,this)?(pt(ur,this).fitsBelow(pt(zi,this))?this.setPositionBelowCursor():pt(ur,this).fitsAbove(pt(zi,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){pt(zi,this).dir==="rtl"?pt(ur,this).fitsOnLeft(pt(zi,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():pt(ur,this).fitsOnRight(pt(zi,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=pt(ud,this).above+pt(ur,this).top-pt(zi,this).offsetHeight;pt(Co,this)&&(e=pt(ur,this).top+pt(ur,this).cellHeight-pt(zi,this).offsetHeight+3),pt(zi,this).style.top=`${e}px`}setPositionBelowCursor(){let e=pt(ud,this).below+pt(ur,this).top+1;pt(Co,this)&&(e=pt(ur,this).top-1),pt(zi,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=pt(ur,this).left;if(pt(Co,this)){const n=pt(Co,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(pt(Co,this).querySelector(".htCore")).borderRightWidth,10);e+=pt(ur,this).cellWidth+i}else e+=pt(ud,this).right;pt(zi,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=pt(ud,this).left+pt(ur,this).left-pt(zi,this).offsetWidth;if(pt(Co,this)){const n=pt(Co,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(pt(Co,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}pt(zi,this).style.left=`${e}px`}}function YY(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:r=()=>{}}=t;const s=new Set;let a=_t(e,-1,S()-1);function u(E,H){const x=S()-1;return E<0&&(E=x),E>x&&(E=0),s.has(E)?-1:(s.add(E),i(E,!1)===!1&&(E=u(H===1?++E:--E,H)),E)}function h(E){E>-1&&E<S()&&i(E,!0)!==!1&&(a=E)}function d(){return a}function g(){S()>0&&(s.clear(),a=u(0,1))}function p(){S()>0&&(s.clear(),a=u(S()-1,-1))}function w(){S()>0&&(s.clear(),a=u(++a,1))}function y(){S()>0&&(s.clear(),a=u(--a,-1))}function S(){return Math.max(n(),0)}function _(){s.clear(),a=e,r()}return{setCurrentPage:h,getCurrentPage:d,toFirstItem:g,toLastItem:p,toNextItem:w,toPreviousItem:y,getSize:S,clear:_}}function xce(t){return Rt(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function k1(t){return ei(t,"submenu")}function V1(t){return new RegExp(ut,"i").test(t.name)}function Qy(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function WB(t){return ei(t,"disableSelection")}function Hce(t){return ze(t,"htSeparator")}function Pce(t){return ze(t,"htSubmenu")}function Ice(t){return ze(t,"htDisabled")}function Nce(t){return ze(t,"htSelectionDisabled")}function Dce(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function GY(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function Lce(t,e){let n=t.slice(0);return n.reverse(),n=GY(n,e),n.reverse(),n}function kce(t){const e=[];return W(t,(n,i)=>{i>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Vce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ut,n=t.slice(0);return n=GY(n,e),n=Lce(n,e),n=kce(n),n}function $ce(t){return t.checkable===!0}function Fce(t){return YY({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||Hce(i)||Ice(i)||Nce(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Bce(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{const s=e.getSettings(),a=typeof s.tabMoves=="function"?s.tabMoves(i):s.tabMoves;r.includes("shift")?e.selection.transformStart(-a.row,-a.col):e.selection.transformStart(a.row,a.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const i=n.getSelectedLast();if(i){const r=t.openSubMenu(i[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const r=n.getSelectedLast();r&&(n.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const qY="menu",UB=qY;function Wce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];i(Bce(t)),e.forEach(d=>{let{shortcuts:g,contextName:p}=d;r(g,p)});function i(d,g){u(g).addShortcuts(d,{group:qY})}function r(d,g){const p=u(g);d.forEach(w=>{let{keys:y}=w;y.forEach(S=>p.removeShortcutsByKeys(S))}),n.push({shortcuts:d,contextName:g}),i(d,g)}function s(){return[...n]}function a(d){return d?`${UB}:${d}`:UB}function u(d){var g;const p=t.hotMenu.getShortcutManager(),w=a(d);return(g=p.getContext(w))!==null&&g!==void 0?g:p.addContext(w)}function h(d){t.hotMenu.getShortcutManager().setActiveContextName(a(d))}return{addCustomShortcuts:r,getCustomShortcuts:s,getContext:u,listen:h}}function Uce(t){return(e,n,i,r,s,a)=>{const u=e.getSourceDataAtRow(i),h=t.rootDocument.createElement("div"),d=typeof a=="function"?a.call(t):a,g=typeof u.ariaLabel=="function"?u.ariaLabel.call(t):u.ariaLabel,p=typeof u.ariaChecked=="function"?u.ariaChecked.call(t):u.ariaChecked;if(Go(n),fe(h,"htItemWrapper"),t.getSettings().ariaTags){const w=!Qy(u,t)&&!WB(u)&&!V1(u);Ge(n,[...$ce(u)?[T7(),fC(g),l2(p)]:[E7(),fC(d)],...w?[pf(-1)]:[],...Qy(u,t)?[P7()]:[],...k1(u)?[Cs(!1)]:[]])}n.className="",n.appendChild(h),V1(u)?fe(n,"htSeparator"):typeof u.renderer=="function"?(fe(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(e,h,i,r,s,d))):wf(h,d),Qy(u,t)?fe(n,"htDisabled"):WB(u)?fe(n,"htSelectionDisabled"):k1(u)&&fe(n,"htSubmenu")}}function X_(t,e,n){jce(t,e),e.set(t,n)}function jce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function So(t,e,n){return(e=zce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zce(t){var e=Yce(t,"string");return typeof e=="symbol"?e:e+""}function Yce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Z_(t,e,n){return t.set(KY(t,e),n),n}function uc(t,e){return t.get(KY(t,e))}function KY(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jB=215;var Zg=new WeakMap,qw=new WeakMap,Kw=new WeakMap;class bf{get tableBorderWidth(){return uc(Kw,this)===void 0&&this.hotMenu&&Z_(Kw,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),uc(Kw,this)}constructor(e,n){var i=this;So(this,"hot",void 0),So(this,"options",void 0),So(this,"eventManager",new to(this)),So(this,"container",void 0),So(this,"positioner",void 0),So(this,"hotMenu",null),So(this,"hotSubMenus",{}),So(this,"parentMenu",void 0),So(this,"menuItems",null),So(this,"origOutsideClickDeselects",null),X_(this,Zg,void 0),X_(this,qw,void 0),X_(this,Kw,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:jB,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Ace(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return i.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(r,s)=>{if(!s){var a;(a=this.hotMenu)===null||a===void 0||a.useTheme(r)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Qd(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return uc(Zg,this)}getKeyboardShortcutsCtrl(){return uc(qw,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=GO(u=>this.openSubMenu(u),300),n=this.options.minWidth||jB;let i=!1,r=Uc(this.menuItems,u=>(u.key===op&&(i=!0),Dce(u,this.hot)));if(r.length<1&&!i)r.push(FY()[op]);else if(r.length===0)return;r=Vce(r,ut);let s=!1;const a={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(u){return Pe(u)&&u<n?n:u},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Uce(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(u,h)=>{uc(Zg,this).setCurrentPage(h.row)},afterOnCellMouseOver:(u,h)=>{this.isAllSubMenusClosed()?e(h.row):this.openSubMenu(h.row)},rowHeights:u=>r[u].name===ut?1:void 0,afterOnCellContextMenu:u=>{u.preventDefault(),h$()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(u,h,d,g,p)=>{this.hotMenu.view.isMouseDown()&&(p.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:u=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(u))},afterOnCellMouseUp:u=>{(!h$()||!Yc(u))&&s&&this.hasSelectedItem()&&(Ga()||T2()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Z_(Zg,this,Fce(this.hotMenu)),Z_(qw,this,Wce(this)),uc(qw,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(uc(Zg,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const i=this.parentMenu.hotMenu.getCell(n[0],0);Ge(i,[Cs(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Pce(n))return!1;const i=this.hotMenu.getSourceDataAtRow(e),r=new bf(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&Ge(n,[Cs(!0)]),r}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];if(i){i.destroy(),delete this.hotSubMenus[n.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ge(r,[Cs(!1)])}}closeAllSubMenus(){W(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const i=this.hot.getSelectedRange(),r=i?xce(i):[];this.runLocalHooks("executeCommand",n.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,r,e)}isCommandPassive(e){return e.isCommand===!1||V1(e)||Qy(e,this.hot)||k1(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,i=e.hider.style,r=e.holder.style,s=parseInt(i.width,10),a=Sr(n,(u,h,d)=>{const p=this.hotMenu.getCell(d,0)?$n(this.hotMenu.getCell(d,0)):0;return u+(h.name===ut?1:p)},0);r.width=`${s}px`,r.height=`${a}px`,i.height=r.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let i=e,r;return i&&(on(i)&&(i=i.call(this.hot),i===null||vn(i)?i="":i=i.toString()),i=i.replace(/[^A-Za-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,r=n.querySelector(`.${this.options.className}.${i}`)),r||(r=n.createElement("div"),fe(r,`htMenu handsontable ${this.options.className}`),i&&fe(r,i),this.options.container.appendChild(r)),r}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ge(this.hotMenu.rootElement,[R7(),pf(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Wc(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Wc(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ze(e.target,"htCore")&&Wc(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Yt(bf,Ai);function Gce(t,e){qce(t,e),e.add(t)}function qce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Q_(t,e,n){return(e=Kce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kce(t){var e=Xce(t,"string");return typeof e=="symbol"?e:e+""}function Xce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Mm="contextMenu",Zce=70,zB=Mm;Ae.getSingleton().register("afterContextMenuDefaultOptions");Ae.getSingleton().register("beforeContextMenuShow");Ae.getSingleton().register("afterContextMenuShow");Ae.getSingleton().register("afterContextMenuHide");Ae.getSingleton().register("afterContextMenuExecute");var Qg=new WeakSet;class YS extends Ht{constructor(){super(...arguments),Gce(this,Qg),Q_(this,"commandExecutor",new UY(this.hot)),Q_(this,"itemsFactory",null),Q_(this,"menu",null)}static get PLUGIN_KEY(){return Mm}static get PLUGIN_PRIORITY(){return Zce}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[WS,US,ut,Lp,kp,ut,BS,$p,ut,jS,FS,ut,Vp,ut,gs]}isEnabled(){return!!this.hot.getSettings()[Mm]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Mm];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new bf(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Xw(Qg,this,Jce).call(this)),this.menu.addLocalHook("afterOpen",()=>Xw(Qg,this,ehe).call(this)),this.menu.addLocalHook("afterClose",()=>Xw(Qg,this,the).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return e.executeCommand.call(e,...r)}),this.addHook("afterOnCellContextMenu",i=>Xw(Qg,this,Qce).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=VS(this.menu.container,this.hot.rootDocument);this.open({left:n.left+i.left,top:n.top+i.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:zB})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zB)}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const r=this.menu.tableBorderWidth>0;dt(i,(s,a)=>{const u=["below","right"].includes(a)?s+1:s-1;this.menu.setOffset(a,r?s:u)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new jY(this.hot,YS.DEFAULT_ITEMS);const e=this.hot.getSettings()[Mm],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),W(i,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Qce(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;function r(u){return u.nodeName==="TD"||u.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),ze(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||i)&&!r(s)&&!(ze(s,"current")&&ze(s,"wtBorder"))))return;const a=VS(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+a.top,left:t.clientX+a.left})}function Jce(){this.hot.runHooks("beforeContextMenuShow",this)}function ehe(){this.hot.runHooks("afterContextMenuShow",this)}function the(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}YS.SEPARATOR={name:ut};function nhe(t){return{key:"copy",name(){return this.getTranslatedPhrase(NA)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ihe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?_t(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(kA,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function rhe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?_t(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(LA,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function she(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?_t(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(DA,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ohe(t){return{key:"cut",name(){return this.getTranslatedPhrase(VA)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class ahe{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class lhe{constructor(){this.clipboardData=new ahe}preventDefault(){}}function uhe(t,e){XY(t,e),e.add(t)}function cd(t,e,n){XY(t,e),e.set(t,n)}function XY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qi(t,e){return t.get(Fd(t,e))}function hd(t,e,n){return t.set(Fd(t,e),n),n}function Fd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vl=new WeakMap,J_=new WeakMap,Jg=new WeakMap,$1=new WeakMap,F1=new WeakMap,em=new WeakMap,tm=new WeakSet;class che{constructor(e){let{countRows:n,countColumns:i,rowsLimit:r,columnsLimit:s,countColumnHeaders:a}=e;uhe(this,tm),cd(this,Vl,void 0),cd(this,J_,void 0),cd(this,Jg,void 0),cd(this,$1,void 0),cd(this,F1,void 0),cd(this,em,void 0),hd(J_,this,n),hd(Jg,this,i),hd($1,this,r),hd(F1,this,s),hd(em,this,a)}setSelectedRange(e){hd(Vl,this,e)}getCellsRange(){if(qi(J_,this).call(this)===0||qi(Jg,this).call(this)===0)return null;const{row:e,col:n}=qi(Vl,this).getTopStartCorner(),{row:i,col:r}=qi(Vl,this).getBottomEndCorner(),s=Fd(tm,this,hhe).call(this,e,i),a=Fd(tm,this,eM).call(this,n,r);return{isRangeTrimmed:i!==s||r!==a,startRow:e,startCol:n,endRow:s,endCol:a}}getMostBottomColumnHeadersRange(){if(qi(Jg,this).call(this)===0||qi(em,this).call(this)===0)return null;const{col:e}=qi(Vl,this).getTopStartCorner(),{col:n}=qi(Vl,this).getBottomEndCorner(),i=Fd(tm,this,eM).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(qi(Jg,this).call(this)===0||qi(em,this).call(this)===0)return null;const{col:e}=qi(Vl,this).getTopStartCorner(),{col:n}=qi(Vl,this).getBottomEndCorner(),i=Fd(tm,this,eM).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-qi(em,this).call(this),startCol:e,endRow:-1,endCol:i}}}function eM(t,e){return Math.min(e,Math.max(t+qi(F1,this).call(this)-1,t))}function hhe(t,e){return Math.min(e,Math.max(t+qi($1,this).call(this)-1,t))}function ZY(t){const e=[],n=[];return W(t,i=>{const r=Math.min(i.startRow,i.endRow),s=Math.max(i.startRow,i.endRow);ke(r,s,h=>{e.indexOf(h)===-1&&e.push(h)});const a=Math.min(i.startCol,i.endCol),u=Math.max(i.startCol,i.endCol);ke(a,u,h=>{n.indexOf(h)===-1&&n.push(h)})}),{rows:e,columns:n}}function dhe(t,e){QY(t,e),e.add(t)}function $l(t,e,n){QY(t,e),e.set(t,n)}function QY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nm(t,e,n){return(e=fhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fhe(t){var e=ghe(t,"string");return typeof e=="symbol"?e:e+""}function ghe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mr(t,e){return t.get(pr(t,e))}function Fs(t,e,n){return t.set(pr(t,e),n),n}function pr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("afterCopyLimit");Ae.getSingleton().register("modifyCopyableRange");Ae.getSingleton().register("beforeCut");Ae.getSingleton().register("afterCut");Ae.getSingleton().register("beforePaste");Ae.getSingleton().register("afterPaste");Ae.getSingleton().register("beforeCopy");Ae.getSingleton().register("afterCopy");const tM="copyPaste",mhe=80,phe=["fragmentSelection"],YB=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var B1=new WeakMap,W1=new WeakMap,U1=new WeakMap,dd=new WeakMap,Zw=new WeakMap,Qw=new WeakMap,fd=new WeakMap,IC=new WeakMap,kr=new WeakSet;class vhe extends Ht{constructor(){super(...arguments),dhe(this,kr),nm(this,"columnsLimit",1/0),nm(this,"rowsLimit",1/0),nm(this,"pasteMode","overwrite"),nm(this,"uiContainer",this.hot.rootDocument.body),$l(this,B1,!1),$l(this,W1,!1),$l(this,U1,!1),$l(this,dd,"cells-only"),$l(this,Zw,!1),$l(this,Qw,!1),$l(this,fd,new che({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),$l(this,IC,!1),nm(this,"copyableRanges",[])}static get PLUGIN_KEY(){return tM}static get SETTING_KEYS(){return[tM,...phe]}static get PLUGIN_PRIORITY(){return mhe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[tM]}enablePlugin(){var e,n,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Fs(B1,this,this.getSetting("copyColumnHeaders")),Fs(W1,this,this.getSetting("copyColumnGroupHeaders")),Fs(U1,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",r=>pr(kr,this,Che).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return pr(kr,i,She).call(i,...s)}),this.addHook("afterSelectionEnd",()=>pr(kr,this,bhe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),R2()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return pr(kr,i,Rhe).call(i,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return pr(kr,i,Ehe).call(i,...s)}),this.addHook("afterSelection",()=>pr(kr,this,The).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Fs(dd,this,e),Fs(Zw,this,!0),pr(kr,this,GB).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Fs(Qw,this,!0),pr(kr,this,GB).call(this,"cut")}getRangedCopyableData(e){return Nm(this.getRangedData(e))}getRangedData(e){const n=[],{rows:i,columns:r}=ZY(e);return W(i,s=>{const a=[];W(r,u=>{s<0?a.push(this.hot.getColHeader(u,s)):a.push(this.hot.getCopyableData(s,u))}),n.push(a)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const i=new lhe;e&&i.clipboardData.setData("text/plain",e),n&&i.clipboardData.setData("text/html",n),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}mr(fd,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);mr(dd,this)==="column-headers-only"?n.set("headers",mr(fd,this).getMostBottomColumnHeadersRange()):(mr(dd,this)==="with-column-headers"?n.set("headers",mr(fd,this).getMostBottomColumnHeadersRange()):mr(dd,this)==="with-column-group-headers"&&n.set("headers",mr(fd,this).getAllColumnHeadersRange()),n.set("cells",mr(fd,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>r!==null).map(r=>{let{startRow:s,startCol:a,endRow:u,endCol:h}=r;return{startRow:s,startCol:a,endRow:u,endCol:h}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=n.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:s,endRow:a,endCol:u}=i;this.hot.runHooks("afterCopyLimit",a-r+1,u-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,r=e[0].length,s=[],{row:a,col:u}=n.getTopStartCorner(),{row:h,col:d}=n.getBottomEndCorner();let g=a,p=u,w=a,y=u;for(;s.length<i||g<=h;){const{skipRowOnPaste:S,visualRow:_}=this.hot.getCellMeta(g,u);if(g=_+1,S===!0)continue;w=_,p=u;const E=[],H=s.length%i;for(;E.length<r||p<=d;){const{skipColumnOnPaste:x,visualCol:D}=this.hot.getCellMeta(a,p);if(p=D+1,x===!0)continue;y=D;const $=E.length%r;E.push(e[H][$])}s.push(E)}return Fs(IC,this,!0),this.hot.populateFromArray(a,u,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,u,w,y]}onCopy(e){var n,i;const r=this.hot.getFocusManager().getRefocusElement(),s=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input"),a=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight,u=a?this.hot.getCell(a.row,a.col,!0):null;if(!this.hot.isListening()&&!mr(Zw,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==r||!s&&e.target!==this.hot.rootDocument.body&&u!==e.target))return;e.preventDefault(),this.setCopyableText(),Fs(Zw,this,!1);const h=this.getRangedData(this.copyableRanges),d=pr(kr,this,whe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",h,this.copyableRanges,d)){const p=Nm(h);if(e&&e.clipboardData){const w=$$(h,this.hot.rootDocument);e.clipboardData.setData("text/plain",p),e.clipboardData.setData("text/html",[YB,w].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",p);this.hot.runHooks("afterCopy",h,this.copyableRanges,d)}Fs(dd,this,"cells-only")}onCut(e){var n,i;const r=this.hot.getFocusManager().getRefocusElement(),s=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input"),a=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight,u=a?this.hot.getCell(a.row,a.col,!0):null;if(!this.hot.isListening()&&!mr(Qw,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==r||!s&&e.target!==this.hot.rootDocument.body&&u!==e.target))return;e.preventDefault(),this.setCopyableText(),Fs(Qw,this,!1);const h=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",h,this.copyableRanges)){const g=Nm(h);if(e&&e.clipboardData){const p=$$(h,this.hot.rootDocument);e.clipboardData.setData("text/plain",g),e.clipboardData.setData("text/html",[YB,p].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",g);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",h,this.copyableRanges)}}onPaste(e){var n,i;const r=this.hot.getFocusManager().getRefocusElement(),s=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input"),a=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight,u=a?this.hot.getCell(a.row,a.col,!0):null;if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(s&&e.target!==r||!s&&e.target!==this.hot.rootDocument.body&&u!==e.target))return;e.preventDefault();let h;if(e&&typeof e.clipboardData<"u"){const y=BO(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});y&&/(<table)|(<TABLE)/g.test(y)?h=iZ(y,this.hot.rootDocument).data:h=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(h=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof h=="string"&&(h=zte(h)),h===void 0||h&&h.length===0||this.hot.runHooks("beforePaste",h,this.copyableRanges)===!1)return;const[d,g,p,w]=this.populateValues(h);this.hot.selectCell(d,g,Math.min(this.hot.countRows()-1,p),Math.min(this.hot.countCols()-1,w)),this.hot.runHooks("afterPaste",h,this.copyableRanges)}destroy(){super.destroy()}}function GB(t){if(R2()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:i}=e.highlight,r=this.hot.getCell(n,i,!0);r&&tX(r,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function whe(t){const{rows:e}=ZY(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function yhe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&w2(i)}}}function JY(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i!=null&&i.hasAttribute("contenteditable")&&y2(i)}}}function Che(t){t.items.push({name:"---------"},nhe(this)),mr(B1,this)&&t.items.push(she(this)),mr(W1,this)&&t.items.push(rhe(this)),mr(U1,this)&&t.items.push(ihe(this)),t.items.push(ohe(this))}function She(t,e,n,i,r){mr(IC,this)&&(r.value=!0),Fs(IC,this,!1)}function bhe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Rhe(){pr(kr,this,JY).call(this)}function Ehe(){pr(kr,this,yhe).call(this)}function The(){pr(kr,this,JY).call(this)}function eG(t,e){return`border_row${t}col${e}`}function Om(){return{width:1,color:"#000"}}function qa(){return{hide:!0}}function _he(){return{width:1,color:"#000",cornerVisible:!1}}function nM(t){if(Pe(t.start)||Pe(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(Pe(t.end)||Pe(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function im(t){return Pe(t.start)&&(t.left=t.start),Pe(t.end)&&(t.right=t.end),t}function iM(t,e){return{id:eG(t,e),border:_he(),row:t,col:e,top:qa(),bottom:qa(),start:qa(),end:qa()}}function Mhe(t,e){return ei(e,"border")&&e.border&&(t.border=e.border),ei(e,"top")&&Pe(e.top)&&(e.top?(ht(e.top)||(e.top=Om()),t.top=e.top):(e.top=qa(),t.top=e.top)),ei(e,"bottom")&&Pe(e.bottom)&&(e.bottom?(ht(e.bottom)||(e.bottom=Om()),t.bottom=e.bottom):(e.bottom=qa(),t.bottom=e.bottom)),ei(e,"start")&&Pe(e.start)&&(e.start?(ht(e.start)||(e.start=Om()),t.start=e.start):(e.start=qa(),t.start=e.start)),ei(e,"end")&&Pe(e.end)&&(e.end?(ht(e.end)||(e.end=Om()),t.end=e.end):(e.end=qa(),t.end=e.end)),t}function nl(t,e){let n=!1;return W(t.getSelectedRange(),i=>{i.forAll((r,s)=>{if(r<0||s<0)return;const a=t.getCellMeta(r,s).borders;if(a)if(e){if(!ei(a[e],"hide")||a[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function GS(t){return`<span class="selected">✓</span>${t}`}function Ohe(t){return t.some(e=>Pe(e.left)||Pe(e.right))}function Ahe(t){return t.some(e=>Pe(e.start)||Pe(e.end))}const xhe=new Map([["left","start"],["right","end"]]);function Hhe(t){var e;return(e=xhe.get(t))!==null&&e!==void 0?e:t}function Phe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(rx);return nl(this,"bottom")&&(e=GS(e)),e},callback(e,n){const i=nl(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function Ihe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(sx);return nl(this,e)&&(n=GS(n)),n},callback(n,i){const r=nl(this,e);t.prepareBorder(i,e,r)}}}function Nhe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(ox)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!nl(this)}}}function Dhe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(ix);return nl(this,e)&&(n=GS(n)),n},callback(n,i){const r=nl(this,e);t.prepareBorder(i,e,r)}}}function Lhe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(nx);return nl(this,"top")&&(e=GS(e)),e},callback(e,n){const i=nl(this,"top");t.prepareBorder(n,"top",i)}}}function khe(t,e){Vhe(t,e),e.add(t)}function Vhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $he(t,e,n){return(e=Fhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fhe(t){var e=Bhe(t,"string");return typeof e=="symbol"?e:e+""}function Bhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jy="customBorders",Whe=90;var rM=new WeakSet;class Uhe extends Ht{constructor(){super(...arguments),khe(this,rM),$he(this,"savedBorders",[])}static get PLUGIN_KEY(){return Jy}static get PLUGIN_PRIORITY(){return Whe}isEnabled(){return!!this.hot.getSettings()[Jy]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>qB(rM,this,jhe).call(this,e)),this.addHook("init",()=>qB(rM,this,zhe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let i=["top","bottom","start","end"],r=null;n&&(this.checkSettingsCohesion([n]),i=Object.keys(n),r=nM(n));const s=nf(e),a=ip(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});W(e,u=>{a(u).forAll((h,d)=>{W(i,g=>{this.prepareBorderFromCustomAdded(h,d,r,Hhe(g))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=nf(e),i=ip(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return W(e,s=>{i(s).forAll((a,u)=>{W(this.savedBorders,h=>{h.row===a&&h.col===u&&r.push(im(h))})})}),r}clearBorders(e){e?this.setBorders(e):(W(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,n,i,r){const s=this.hot.countRows(),a=this.hot.countCols();if(e>=s||n>=a)return;let u=iM(e,n);i&&(u=Mhe(u,i),W(this.hot.selection.highlight.customSelections,h=>{if(u.id===h.settings.id)return Object.assign(h.settings,i),u.id=h.settings.id,u.top=h.settings.top,u.bottom=h.settings.bottom,u.start=h.settings.start,u.end=h.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",im(u)),this.insertBorderIntoSettings(u,r)}prepareBorderFromCustomAddedRange(e,n){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);ke(e.from.row,i,s=>{ke(e.from.col,r,a=>{const u=iM(s,a);let h=0;s===e.from.row&&ei(n,"top")&&(h+=1,u.top=n.top),s===e.to.row&&ei(n,"bottom")&&(h+=1,u.bottom=n.bottom),a===e.from.col&&ei(n,"start")&&(h+=1,u.start=n.start),a===e.to.col&&ei(n,"end")&&(h+=1,u.end=n.end),h>0&&(this.hot.setCellMeta(s,a,"borders",im(u)),this.insertBorderIntoSettings(u))})})}removeAllBorders(e,n){const i=eG(e,n);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,i,r){let s=this.hot.getCellMeta(e,n).borders;!s||s.border===void 0?s=iM(e,n):s=nM(s),r?(s[i]=qa(),this.countHide(s)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(s,i,r)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",im(s)))):(s[i]=Om(),this.checkCustomSelectionsFromContextMenu(s,i,r)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",im(s)))}prepareBorder(e,n,i){W(e,r=>{let{start:s,end:a}=r;if(s.row===a.row&&s.col===a.col)n==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,n,i);else switch(n){case"noBorders":ke(s.col,a.col,u=>{ke(s.row,a.row,h=>{this.removeAllBorders(h,u)})});break;case"top":ke(s.col,a.col,u=>{this.setBorder(s.row,u,n,i)});break;case"bottom":ke(s.col,a.col,u=>{this.setBorder(a.row,u,n,i)});break;case"start":ke(s.row,a.row,u=>{this.setBorder(u,s.col,n,i)});break;case"end":ke(s.row,a.row,u=>{this.setBorder(u,a.col,n,i)});break}})}createCustomBorders(e){W(e,n=>{const i=nM(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,i):this.prepareBorderFromCustomAdded(n.row,n.col,i)})}countHide(e){const{top:n,bottom:i,start:r,end:s}=e;return Sr([n,i,r,s],(u,h)=>{let d=u;return h&&h.hide&&(d+=1),d},0)}clearBordersFromSelectionSettings(e){const n=Rt(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){W(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){W(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Rt(this.savedBorders,i=>i.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):W(this.savedBorders,(r,s)=>{if(e.id===r.id)return this.savedBorders[s]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,i){let r=!1;return W(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);return W(a,u=>{u.toggleHiddenClass(n,i)}),r=!0,!1}}),r}checkCustomSelections(e,n,i){const r=this.countHide(e);let s=!1;return r===4?(this.removeAllBorders(e.row,e.col),s=!0):W(this.hot.selection.highlight.customSelections,a=>{if(e.id===a.settings.id){if(a.visualCellRange=n,a.commit(),i){const u=this.hot.view._wt.selectionManager.getBorderInstances(a);W(u,h=>{h.changeBorderStyle(i,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[Jy];if(Array.isArray(e)){const n=tr(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Ohe(e),i=Ahe(e);if(n&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function jhe(t){this.hot.getSettings()[Jy]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(tx)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Lhe(this),Dhe(this),Phe(this),Ihe(this),Nhe(this)]}})}function zhe(){this.changeBorderSettings()}function Yhe(t,e){Ghe(t,e),e.add(t)}function Ghe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sM(t,e,n){return(e=qhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qhe(t){var e=Khe(t,"string");return typeof e=="symbol"?e:e+""}function Khe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KB(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const XB="dragToScroll",Xhe=100;var oM=new WeakSet;class Zhe extends Ht{constructor(){super(...arguments),Yhe(this,oM),sM(this,"boundaries",null),sM(this,"callback",null),sM(this,"listening",!1)}static get PLUGIN_KEY(){return XB}static get PLUGIN_PRIORITY(){return Xhe}isEnabled(){return!!this.hot.getSettings()[XB]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>KB(oM,this,ZB).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>KB(oM,this,ZB).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let i=0,r=0;n<this.boundaries.top?r=n-this.boundaries.top:n>this.boundaries.bottom&&(r=n-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",i=>this.onMouseMove(i)),n=Qd(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function ZB(t){if(Yc(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,i)=>{var r,s;const a=(r=e.scrollLeft)!==null&&r!==void 0?r:e.scrollX,u=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(a+Math.sign(n)*50,u+Math.sign(i)*20)}),this.listen()}function Qhe(t,e){tG(t,e),e.add(t)}function Jhe(t,e,n){tG(t,e),e.set(t,n)}function tG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aM(t,e,n){return(e=ede(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ede(t){var e=tde(t,"string");return typeof e=="symbol"?e:e+""}function tde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nde(t,e){return t.get(ms(t,e))}function nG(t,e,n){return t.set(ms(t,e),n),n}function ms(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("afterDropdownMenuDefaultOptions");Ae.getSingleton().register("beforeDropdownMenuShow");Ae.getSingleton().register("afterDropdownMenuShow");Ae.getSingleton().register("afterDropdownMenuHide");Ae.getSingleton().register("afterDropdownMenuExecute");const eC="dropdownMenu",ide=230,ap="changeType",lM=eC;var qS=new WeakMap,Us=new WeakSet;class KS extends Ht{static get PLUGIN_KEY(){return eC}static get PLUGIN_PRIORITY(){return ide}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Lp,kp,ut,$p,ut,$S,ut,Vp,ut,gs]}constructor(e){super(e),Qhe(this,Us),aM(this,"commandExecutor",new UY(this.hot)),aM(this,"itemsFactory",null),aM(this,"menu",null),Jhe(this,qS,!1),this.hot.addHook("afterGetColHeader",(n,i)=>ms(Us,this,sde).call(this,n,i))}isEnabled(){return this.hot.getSettings()[eC]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new jY(this.hot,KS.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return ms(Us,e,hde).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return ms(Us,e,cde).call(e,...s)});const n=this.hot.getSettings()[eC],i={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new bf(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>ms(Us,this,ode).call(this)),this.menu.addLocalHook("afterOpen",()=>ms(Us,this,ade).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>ms(Us,this,lde).call(this,s)),this.menu.addLocalHook("afterClose",()=>ms(Us,this,ude).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];return e.executeCommand.call(e,...a)}),W(r,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:r}=this.hot.getSelectedRangeLast(),s=VS(this.menu.container,this.hot.rootDocument),a=this.hot.getCell(-1,r.col,!0).querySelector(`.${ap}`),u=a.getBoundingClientRect();this.open({left:u.left+s.left,top:u.top+a.offsetHeight+s.top},{left:u.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:lM},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isCell()&&!this.menu.isOpened()},group:lM}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lM)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ms(Us,this,rde).call(this,e))}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),dt(i,(r,s)=>{this.menu.setOffset(s,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function iG(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function rde(t){if(ze(t.target,ap)){const e=VS(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),nG(qS,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function sde(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,r=Array.prototype.indexOf.call(i,n);if(t<0||r!==i.length-1)return;const s=e.querySelector(`.${ap}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const a=this.hot.rootDocument.createElement("button");a.className=ap,a.type="button",a.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ge(a,[vu(),fC(" ")]),Ge(e,[s2("menu")])),a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}function ode(){this.hot.runHooks("beforeDropdownMenuShow",this)}function ade(){this.hot.runHooks("afterDropdownMenuShow",this),ms(Us,this,iG).call(this,this.menu)}function lde(t){ms(Us,this,iG).call(this,t)}function ude(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function cde(t){return nde(qS,this)?null:t}function hde(t){ze(t.target,ap)&&nG(qS,this,!0)}KS.SEPARATOR={name:ut};function QB(t,e,n){return(e=dde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dde(t){var e=fde(t,"string");return typeof e=="symbol"?e:e+""}function fde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gde{constructor(e){QB(this,"hot",void 0),QB(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:i,endCol:r}=this._getDataRange(),s=this.options,a=[];return ke(e,i,u=>{const h=[];!s.exportHiddenRows&&this._isHiddenRow(u)||(ke(n,r,d=>{!s.exportHiddenColumns&&this._isHiddenColumn(d)||h.push(this.hot.getDataAtCell(u,d))}),a.push(h))}),a}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();ke(n,i,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(r[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();ke(n,i,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(r[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[i=0,r=0,s=n,a=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),s=Math.min(s,n),a=Math.min(a,e),{startRow:i,startCol:r,endRow:s,endCol:a}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function JB(t,e,n){return(e=mde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mde(t){var e=pde(t,"string");return typeof e=="symbol"?e:e+""}function pde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wH{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){JB(this,"dataProvider",void 0),JB(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=qo(this.constructor.DEFAULT_OPTIONS);const i=new Date;return n=ti(qo(wH.DEFAULT_OPTIONS),n),n=ti(n,e),n.filename=n2(n.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),n}}const vde="\r",wde='"',yde=`
`;class Cde extends wH{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,s=this.dataProvider.getRowHeaders(),a=s.length>0;let u=e.bom?"\uFEFF":"";return r&&(i=Rt(i,h=>this._escapeCell(h,!0)),a&&(u+=e.columnDelimiter),u+=i.join(e.columnDelimiter),u+=e.rowDelimiter),W(n,(h,d)=>{d>0&&(u+=e.rowDelimiter),a&&(u+=this._escapeCell(s[d])+e.columnDelimiter),u+=h.map(g=>this._escapeCell(g)).join(e.columnDelimiter)}),u}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=zn(e);return i!==""&&(n||i.indexOf(vde)>=0||i.indexOf(wde)>=0||i.indexOf(yde)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`),i}}const Sde="csv",j1={[Sde]:Cde};function bde(t,e,n){return typeof j1[t]=="function"?new j1[t](e,n):null}const Rde="exportFile",Ede=240;class Tde extends Ht{static get PLUGIN_KEY(){return Rde}static get PLUGIN_PRIORITY(){return Ede}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,s=this._createTypeFormatter(e,n),a=this._createBlob(s),u=r.URL||r.webkitURL,h=i.createElement("a"),d=`${s.options.filename}.${s.options.fileExtension}`;if(h.download!==void 0){const g=u.createObjectURL(a);h.style.display="none",h.setAttribute("href",g),h.setAttribute("download",d),i.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),i.body.removeChild(h),setTimeout(()=>{u.revokeObjectURL(g)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,d)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!j1[e])throw new Error(`Export format type "${e}" is not supported.`);return bde(e,new gde(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function gd(t,e,n){return(e=_de(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _de(t){var e=Mde(t,"string");return typeof e=="symbol"?e:e+""}function Mde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fp{constructor(e,n){let{id:i,stateless:r=!0}=n;gd(this,"hot",void 0),gd(this,"id",void 0),gd(this,"elements",[]),gd(this,"hidden",!1),gd(this,"stateId",""),gd(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new AS)}getElements(){return this.elements}reset(){W(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),W(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Yt(Fp,Ai);const lp={};function fu(t,e){if(!lp[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=lp[t];let r=e;return i.inputValuesDecorator&&(r=i.inputValuesDecorator(r)),function(s){return n.apply(s.meta.instance,[].concat([s],[r]))}}function Vc(t){if(!lp[t])throw Error(`Filter condition "${t}" does not exist.`);return lp[t].descriptor}function Gn(t,e,n){n.key=t,lp[t]={condition:e,descriptor:n}}const yi="none";function Ode(){return!0}Gn(yi,Ode,{name:xS,inputsCount:0,showOperators:!1});const km="empty";function Ade(t){return Vn(t.value)}Gn(km,Ade,{name:fx,inputsCount:0,showOperators:!0});const tC="not_empty";function xde(t,e){return!fu(km,e)(t)}Gn(tC,xde,{name:gx,inputsCount:0,showOperators:!0});const Vm="eq";function Hde(t,e){let[n]=e;return zn(t.value).toLocaleLowerCase(t.meta.locale)===zn(n)}Gn(Vm,Hde,{name:mx,inputsCount:1,showOperators:!0});const nC="neq";function Pde(t,e){return!fu(Vm,e)(t)}Gn(nC,Pde,{name:px,inputsCount:1,showOperators:!0});const rG="gt";function Ide(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}Gn(rG,Ide,{name:Sx,inputsCount:1,showOperators:!0});const sG="gte";function Nde(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}Gn(sG,Nde,{name:bx,inputsCount:1,showOperators:!0});const oG="lt";function Dde(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}Gn(oG,Dde,{name:Rx,inputsCount:1,showOperators:!0});const aG="lte";function Lde(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}Gn(aG,Lde,{name:Ex,inputsCount:1,showOperators:!0});const yH="date_after";function kde(t,e){let[n]=e;const i=pe(t.value,t.meta.dateFormat),r=pe(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)>=0}Gn(yH,kde,{name:Mx,inputsCount:1,showOperators:!0});const CH="date_before";function Vde(t,e){let[n]=e;const i=pe(t.value,t.meta.dateFormat),r=pe(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)<=0}Gn(CH,Vde,{name:Ox,inputsCount:1,showOperators:!0});const NC="between";function $de(t,e){let[n,i]=e,r=n,s=i;if(t.meta.type==="numeric"){const a=parseFloat(r,10),u=parseFloat(s,10);r=Math.min(a,u),s=Math.max(a,u)}else if(t.meta.type==="date"){const a=fu(CH,[s]),u=fu(yH,[r]);return a(t)&&u(t)}return t.value>=r&&t.value<=s}Gn(NC,$de,{name:Tx,inputsCount:2,showOperators:!0});const lG="not_between";function Fde(t,e){return!fu(NC,e)(t)}Gn(lG,Fde,{name:_x,inputsCount:2,showOperators:!0});const uG="begins_with";function Bde(t,e){let[n]=e;return zn(t.value).toLocaleLowerCase(t.meta.locale).startsWith(zn(n))}Gn(uG,Bde,{name:vx,inputsCount:1,showOperators:!0});const cG="ends_with";function Wde(t,e){let[n]=e;return zn(t.value).toLocaleLowerCase(t.meta.locale).endsWith(zn(n))}Gn(cG,Wde,{name:wx,inputsCount:1,showOperators:!0});const SH="contains";function Ude(t,e){let[n]=e;return zn(t.value).toLocaleLowerCase(t.meta.locale).indexOf(zn(n))>=0}Gn(SH,Ude,{name:yx,inputsCount:1,showOperators:!0});const hG="not_contains";function jde(t,e){return!fu(SH,e)(t)}Gn(hG,jde,{name:Cx,inputsCount:1,showOperators:!0});const dG="date_tomorrow";function zde(t){const e=pe(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(pe().subtract(-1,"days").startOf("day"),"d"):!1}Gn(dG,zde,{name:xx,inputsCount:0});const fG="date_today";function Yde(t){const e=pe(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(pe().startOf("day"),"d"):!1}Gn(fG,Yde,{name:Ax,inputsCount:0});const gG="date_yesterday";function Gde(t){const e=pe(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(pe().subtract(1,"days").startOf("day"),"d"):!1}Gn(gG,Gde,{name:Hx,inputsCount:0});lX();function qde(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Bp(t){const e=new Set(t);return function(n){return e.has(n)}}function bH(t){return t??""}function z1(t){return Array.from(new Set(t)).map(e=>bH(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function eW(t,e,n,i){const r=[],s=t===e;let a;return s||(a=Bp(e)),t.forEach(u=>{let h=!1;(s||a(u))&&(h=!0);const d={checked:h,value:u,visualValue:qde(u,n)};i&&i(d),r.push(d)}),r}const $c="by_value";function Kde(t,e){let[n]=e;return n(t.value)}Gn($c,Kde,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Bp(e)]},showOperators:!1});const up={};function Xde(t){if(!up[t])throw Error(`Operation with id "${t}" does not exist.`);const e=up[t].func;return function(n,i){return e(n,i)}}function Zde(t){return up[t].name}function RH(t,e,n){up[t]={name:e,func:n}}const hu="conjunction",Qde=Nx;function Jde(t,e){return t.every(n=>n.func(e))}RH(hu,Qde,Jde);const DC="disjunction",efe=HS;function tfe(t,e){return t.some(n=>n.func(e))}RH(DC,efe,tfe);const EH="disjunctionWithExtraCondition",nfe=HS;function ife(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}RH(EH,nfe,ife);const rfe="numeric",mG="text",sfe="date",tW={[rfe]:[yi,ut,km,tC,ut,Vm,nC,ut,rG,sG,oG,aG,NC,lG],[mG]:[yi,ut,km,tC,ut,Vm,nC,ut,uG,cG,ut,SH,hG],[sfe]:[yi,ut,km,tC,ut,Vm,nC,ut,CH,yH,NC,ut,dG,fG,gG]};function ofe(t){const e=[];let n=t;return tW[n]||(n=mG),W(tW[n],i=>{let r;i===ut?r={name:ut}:r=qo(Vc(i)),e.push(r)}),e}function rm(t,e,n){return(e=afe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function afe(t){var e=lfe(t,"string");return typeof e=="symbol"?e:e+""}function lfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uM="built",cM="building",nW=["click","input","keydown","keypress","keyup","focus","blur","change"];let Zs=class pG{static get DEFAULTS(){return qo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){rm(this,"hot",void 0),rm(this,"eventManager",new to(this)),rm(this,"options",void 0),rm(this,"_element",void 0),rm(this,"buildState",void 0),this.hot=e,this.options=ti(pG.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===cM?this._element:this.buildState===uM?(this.update(),this._element):(this.buildState=cM,this.build(),this.buildState=uM,this._element)}isBuilt(){return this.buildState===uM}translateIfPossible(e){return typeof e=="string"&&e.startsWith(nr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,i)=>{this.eventManager.addEventListener(n,i,r=>this.runLocalHooks(i,r,this))};if(this.buildState||(this.buildState=cM),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&fe(this._element,this.options.className),this.options.children.length)W(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),dt(this.options,(i,r)=>{n[r]!==void 0&&r!=="className"&&r!=="tagName"&&r!=="children"&&(n[r]=this.translateIfPossible(i))}),this._element.appendChild(n),W(nW,i=>e(n,i))}else W(nW,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Yt(Zs,Ai);function ufe(t,e){vG(t,e),e.add(t)}function cfe(t,e,n){vG(t,e),e.set(t,n)}function vG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jw(t,e){return t.get(TH(t,e))}function hfe(t,e,n){return t.set(TH(t,e),n),n}function TH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var md=new WeakMap,iW=new WeakSet;class du extends Zs{static get DEFAULTS(){return qo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,ti(du.DEFAULTS,n)),ufe(this,iW),cfe(this,md,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>TH(iW,this,dfe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");hfe(md,this,this._element.firstChild),fe(this._element,"htUIInput"),fe(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Jw(md,this).type=this.options.type,Jw(md,this).placeholder=this.translateIfPossible(this.options.placeholder),Jw(md,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Jw(md,this).focus()}}function dfe(t){this.options.value=t.target.value}function ffe(t,e){wG(t,e),e.add(t)}function sm(t,e,n){wG(t,e),e.set(t,n)}function wG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pd(t,e,n){return t.set($m(t,e),n),n}function Sn(t,e){return t.get($m(t,e))}function $m(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ai=new WeakMap,ey=new WeakMap,ty=new WeakMap,hM=new WeakMap,ny=new WeakMap,iy=new WeakSet;class cp extends Zs{static get DEFAULTS(){return qo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,ti(cp.DEFAULTS,n)),ffe(this,iy),sm(this,ai,null),sm(this,ey,[]),sm(this,ty,void 0),sm(this,hM,void 0),sm(this,ny,void 0),this.registerHooks()}getMenu(){return Sn(ai,this)}registerHooks(){this.addLocalHook("click",()=>$m(iy,this,pfe).call(this))}setItems(e){pd(ey,this,this.translateNames(e)),Sn(ai,this)&&Sn(ai,this).setMenuItems(Sn(ey,this))}translateNames(e){return W(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),pd(ai,this,new bf(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Sn(ai,this).setMenuItems(Sn(ey,this));const e=new Zs(this.hot,{className:"htUISelectCaption"}),n=new Zs(this.hot,{className:"htUISelectDropdown"});pd(ty,this,e),pd(hM,this,e.element),pd(ny,this,n),this.hot.getSettings().ariaTags&&(Ge(n.element,[vu()]),Ge(this._element,[r2()])),W([e,n],i=>this._element.appendChild(i.element)),Sn(ai,this).addLocalHook("select",i=>$m(iy,this,gfe).call(this,i)),Sn(ai,this).addLocalHook("afterClose",()=>$m(iy,this,mfe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Sn(ai,this).hot.getTranslatedPhrase(xS),Sn(hM,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Sn(ai,this)&&(Sn(ai,this).open(),Sn(ai,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Sn(ai,this).getNavigator().toFirstItem(),Sn(ai,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Sn(ai,this)&&Sn(ai,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Sn(ai,this)&&(Sn(ai,this).destroy(),pd(ai,this,null)),Sn(ty,this)&&Sn(ty,this).destroy(),Sn(ny,this)&&Sn(ny,this).destroy(),super.destroy()}}function gfe(t){t.name!==ut&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function mfe(){this.runLocalHooks("afterClose")}function pfe(){this.openOptions()}function vfe(t,e){wfe(t,e),e.add(t)}function wfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rW(t,e,n){return(e=yfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yfe(t){var e=Cfe(t,"string");return typeof e=="symbol"?e:e+""}function Cfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dM=new WeakSet;class Y1 extends Fp{constructor(e,n){super(e,{id:n.id,stateless:!1}),vfe(this,dM),rW(this,"name",""),rW(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new cp(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new du(this.hot,{placeholder:Fx})),this.elements.push(new du(this.hot,{placeholder:Bx})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>sW(dM,this,Sfe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),W(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>sW(dM,this,bfe).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=qo(e.command);n.name.startsWith(On)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),W(e.args,(i,r)=>{if(r>n.inputsCount-1)return!1;const s=this.getInputElement(r);s.setValue(i),s[n.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Vc(yi),n=[];return W(this.getInputElements(),(i,r)=>{e.inputsCount>r&&n.push(i.getValue())}),{command:e,args:n}}updateState(e,n){const i=Vc(e?e.name:yi);this.state.setValueAtIndex(n,{command:i,args:e?e.args:[]}),e||W(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof cp)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof du)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,s,a)=>{fe(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&fe(n.parentNode,"border");const u=this.hot.rootDocument.createElement("div");return fe(u,"htFiltersMenuLabel"),u.textContent=a,n.appendChild(u),n.parentElement.hasAttribute("ghost-table")||W(this.elements,h=>n.appendChild(h.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Vc(yi)];if(e!==null){const{visualIndex:i}=e;n=ofe(this.hot.getDataType(0,i,this.hot.countRows(),i))}W(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Sfe(t){W(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function bfe(t){Mp(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),so(t))}function oW(t,e,n){Rfe(t,e),e.set(t,n)}function Rfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function om(t,e){return t.get(yG(t,e))}function aW(t,e,n){return t.set(yG(t,e),n),n}function yG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vd=new WeakMap,fM=new WeakMap;class LC extends Zs{static get DEFAULTS(){return qo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,ti(LC.DEFAULTS,n)),oW(this,vd,void 0),oW(this,fM,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),aW(fM,this,e),aW(vd,this,this._element.firstChild),om(vd,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(om(fM,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?om(vd,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(om(vd,this).checked=e)}focus(){this.isBuilt()&&om(vd,this).focus()}}function Efe(t,e){Tfe(t,e),e.add(t)}function Tfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _fe(t,e,n){return(e=Mfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mfe(t){var e=Ofe(t,"string");return typeof e=="symbol"?e:e+""}function Ofe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Afe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lW=0;var uW=new WeakSet;class xfe extends Fp{constructor(e,n){super(e,{id:n.id,stateless:!1}),Efe(this,uW),_fe(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(fe(n.parentNode,"htFiltersMenuOperators"),W(this.elements,i=>n.appendChild(i.element)),n)}}buildOperatorsElement(){const e=[hu,DC];W(e,n=>{const i=new LC(this.hot,{name:"operator",label:{htmlFor:n,textContent:Zde(n)},value:n,checked:n===e[lW],id:n});i.addLocalHook("change",r=>Afe(uW,this,Hfe).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error($t`Radio button with index ${e} doesn't exist.`);W(this.elements,(n,i)=>{n.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof LC&&n.isChecked());return e?e.getValue():hu}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&W(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hu,n=arguments.length>1?arguments[1]:void 0,i=e;i===EH&&(i=DC),this.state.setValueAtIndex(n,i)}reset(){this.setChecked(lW)}}function Hfe(t){this.setState(t.target.value)}function Pfe(t,e,n){Ife(t,e),e.set(t,n)}function Ife(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gM(t,e){return t.get(CG(t,e))}function Nfe(t,e,n){return t.set(CG(t,e),n),n}function CG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var am=new WeakMap;class hp extends Zs{static get DEFAULTS(){return qo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,ti(hp.DEFAULTS,n)),Pfe(this,am,void 0)}build(){super.build(),Nfe(am,this,this._element.firstChild)}update(){this.isBuilt()&&(gM(am,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&gM(am,this).focus()}activate(){gM(am,this).click()}}function Dfe(t,e){SG(t,e),e.add(t)}function wd(t,e,n){SG(t,e),e.set(t,n)}function SG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nt(t,e){return t.get(Bd(t,e))}function Ds(t,e,n){return t.set(Bd(t,e),n),n}function Bd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cW="multipleSelect.itemBox";var js=new WeakMap,Dn=new WeakMap,mM=new WeakMap,Aa=new WeakMap,Fl=new WeakMap,Bl=new WeakMap,lm=new WeakSet;class dp extends Zs{static get DEFAULTS(){return qo({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,ti(dp.DEFAULTS,n)),Dfe(this,lm),wd(this,js,[]),wd(this,Dn,void 0),wd(this,mM,void 0),wd(this,Aa,void 0),wd(this,Fl,void 0),wd(this,Bl,void 0),Ds(Aa,this,new du(this.hot,{placeholder:$x,className:"htUIMultipleSelectSearch"})),Ds(Fl,this,new hp(this.hot,{textContent:Dx,className:"htUISelectAll"})),Ds(Bl,this,new hp(this.hot,{textContent:Lx,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return nt(Dn,this)}registerHooks(){nt(Aa,this).addLocalHook("keydown",e=>Bd(lm,this,kfe).call(this,e)),nt(Aa,this).addLocalHook("input",e=>Bd(lm,this,Lfe).call(this,e)),nt(Fl,this).addLocalHook("click",e=>Bd(lm,this,Vfe).call(this,e)),nt(Bl,this).addLocalHook("click",e=>Bd(lm,this,$fe).call(this,e))}setItems(e){var n;Ds(js,this,e),(n=nt(Dn,this))===null||n===void 0||n.loadData(nt(js,this))}setLocale(e){Ds(mM,this,e)}getLocale(){return nt(mM,this)}getItems(){return[...nt(js,this)]}getValue(){return Bfe(nt(js,this))}getSearchInputElement(){return nt(Aa,this)}getSelectAllElement(){return nt(Fl,this)}getClearAllElement(){return nt(Bl,this)}isSelectedAllValues(){return nt(js,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),i=new Zs(this.hot,{className:"htUISelectionControls",children:[nt(Fl,this),nt(Bl,this)]});this._element.appendChild(nt(Aa,this).element),this._element.appendChild(i.element),this._element.appendChild(n);const r=s=>{var a;if(!this._element)return;(a=nt(Dn,this))===null||a===void 0||a.destroy(),fe(s,"htUIMultipleSelectHot"),Ds(Dn,this,new this.hot.constructor(s,{data:nt(js,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(d,g,p,w,y,S)=>{d.title=S.instance.getDataAtRowProp(g,S.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{nt(Dn,this).listen()},colWidths:()=>nt(Dn,this).container.scrollWidth-Mi(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),nt(Dn,this).init(),this.hot.addHook("afterSetTheme",(d,g)=>{g||nt(Dn,this).useTheme(d)});const h=nt(Dn,this).getShortcutManager().getContext("grid");h.removeShortcutsByKeys(["Tab"]),h.removeShortcutsByKeys(["Shift","Tab"]),h.addShortcut({keys:[["Escape"]],callback:d=>{this.runLocalHooks("keydown",d,this)},group:cW}),h.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:d=>{nt(Dn,this).deselectCell(),this.runLocalHooks("keydown",d,this),this.runLocalHooks("listTabKeydown",d,this)},group:cW})};r(n),this.hot._registerTimeout(()=>r(n),100)}focus(){this.isBuilt()&&nt(Dn,this).listen()}reset(){nt(Aa,this).reset(),nt(Fl,this).reset(),nt(Bl,this).reset()}update(){this.isBuilt()&&(nt(Dn,this).loadData(Ffe(nt(js,this),this.options.value)),super.update())}destroy(){var e;(e=nt(Dn,this))===null||e===void 0||e.destroy(),nt(Aa,this).destroy(),nt(Bl,this).destroy(),nt(Fl,this).destroy(),Ds(Aa,this,null),Ds(Bl,this,null),Ds(Fl,this,null),Ds(Dn,this,null),Ds(js,this,null),super.destroy()}}function Lfe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...nt(js,this)]:n=nt(js,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),nt(Dn,this).loadData(n)}function kfe(t){this.runLocalHooks("keydown",t,this),C2(Mp,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),so(t),nt(Dn,this).listen(),nt(Dn,this).selectCell(0,0))}function Vfe(t){const e=[];t.preventDefault(),nt(Dn,this).getSourceData().forEach((n,i)=>{n.checked=!0,e.push(sz(n,i)[0])}),nt(Dn,this).setSourceDataAtCell(e)}function $fe(t){const e=[];t.preventDefault(),nt(Dn,this).getSourceData().forEach((n,i)=>{n.checked=!1,e.push(sz(n,i)[0])}),nt(Dn,this).setSourceDataAtCell(e)}function Ffe(t,e){const n=Bp(e);return t.map(i=>(i.checked=n(i.value),i))}function Bfe(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Wfe(t,e){Ufe(t,e),e.add(t)}function Ufe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jfe(t,e,n){return(e=zfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zfe(t){var e=Yfe(t,"string");return typeof e=="symbol"?e:e+""}function Yfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ry(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var um=new WeakSet;class Gfe extends Fp{constructor(e,n){super(e,{id:n.id,stateless:!1}),Wfe(this,um),jfe(this,"name",""),this.name=n.name,this.elements.push(new dp(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>ry(um,this,qfe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>ry(um,this,Kfe).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===$c){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?yi:$c},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(i,r,s,a,u)=>{const[h]=Uc(r,p=>p.name===$c),d={},g=this.hot.getTranslatedPhrase(SC);if(h){const p=a(i,u),w=Rt(p,x=>x.value),y=new Map(p.map(x=>[x.value,this.hot.getCellMeta(x.meta.visualRow,x.meta.visualCol)])),S=z1(w);s&&(h.args[0]=s);const _=[],E=eW(S,h.args[0],g,x=>{x.checked&&_.push(x.value),ry(um,this,hW).call(this,x,y)}),H=e.editedConditionStack.column;d.locale=this.hot.getCellMeta(0,H).locale,d.args=[_],d.command=Vc($c),d.itemsSnapshot=E}else d.args=[],d.command=Vc(yi);this.state.setValueAtIndex(i,d)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof dp)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,s,a)=>{fe(n.parentNode,"htFiltersMenuValue");const u=this.hot.rootDocument.createElement("div");return fe(u,"htFiltersMenuLabel"),u.textContent=a,n.appendChild(u),n.parentElement.hasAttribute("ghost-table")||W(this.elements,h=>n.appendChild(h.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(SC),n=this._getColumnVisibleValues(),i=n.map(h=>h.value),r=new Map(n.map(h=>[h.value,h.meta])),s=z1(i),a=eW(s,s,e,h=>{ry(um,this,hW).call(this,h,r)});this.getMultipleSelectElement().setItems(a),super.reset(),this.getMultipleSelectElement().setValue(s);const u=this.hot.getPlugin("filters").getSelectedColumn();u!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,u.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Rt(this.hot.getDataAtCol(e.visualIndex),(n,i)=>({value:bH(n),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function qfe(t){Mp(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),so(t))}function hW(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Kfe(t,e){switch(e.type){case"numeric":return fY(t,e);default:return t}}var bG;function Xfe(t,e){Zfe(t,e),e.add(t)}function Zfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qfe(t,e,n){return(e=Jfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jfe(t){var e=ege(t,"string");return typeof e=="symbol"?e:e+""}function ege(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tge(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dW=new WeakSet;class fp extends Fp{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Xfe(this,dW),Qfe(this,"name",""),this.name=n.name,this.elements.push(new du(this.hot,{type:"button",value:kx,className:"htUIButton htUIButtonOK",identifier:fp.BUTTON_OK})),this.elements.push(new du(this.hot,{type:"button",value:Vx,className:"htUIButton htUIButtonCancel",identifier:fp.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){W(this.elements,e=>{e.addLocalHook("click",(n,i)=>tge(dW,this,nge).call(this,n,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(fe(n.parentNode,"htFiltersMenuActionBar"),W(this.elements,i=>n.appendChild(i.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}bG=fp;function nge(t,e){e.options.identifier===bG.BUTTON_OK?this.accept():this.cancel()}function sy(t,e,n){return(e=ige(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ige(t){var e=rge(t,"string");return typeof e=="symbol"?e:e+""}function rge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const fW="ConditionCollection.filteringStates";class _H{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;sy(this,"hot",void 0),sy(this,"isMapRegistrable",void 0),sy(this,"filteringStates",new AS),sy(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(fW,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var i;const r=this.filteringStates.getValueAtIndex(n),s=(i=r==null?void 0:r.conditions)!==null&&i!==void 0?i:[],a=r==null?void 0:r.operation;return this.isMatchInConditions(s,e,a)}isMatchInConditions(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hu;return e.length?Xde(i)(e,n):!0}addCondition(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hu,r=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,a=n.args.map(g=>typeof g=="string"?g.toLocaleLowerCase(s):g),u=n.name||n.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const h=this.getOperation(e);if(h){if(h!==i)throw Error($t`The column of index ${e} has been already applied with a \`${h}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(vn(up[i]))throw new Error($t`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const d=this.getConditions(e);d.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:u,args:a,func:fu(u,a)}]},r):d.push({name:u,args:a,func:fu(u,a)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[i,{operation:r,conditions:s}]=n;return e.push({column:i,operation:r,conditions:s.map(a=>{let{name:u,args:h}=a;return{name:u,args:[...h]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(i=>this.addCondition(n.column,i))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const i=this.getConditions(e);return n?i.some(r=>r.name===n):i.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(fW),this.filteringStates=null,this.clearLocalHooks()}}Yt(_H,Ai);function gW(t,e,n){return(e=sge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sge(t){var e=oge(t,"string");return typeof e=="symbol"?e:e+""}function oge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RG{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];gW(this,"conditionCollection",void 0),gW(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return W(this.conditionCollection.getFilteredColumns(),(n,i)=>{let r=this.columnDataFactory(n);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(n,r)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return W(n,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,n){const i=[];return W(n,r=>{const s=r.meta.visualRow;e[s]!==void 0&&(i[s]=e[s])}),i}}function age(t,e){lge(t,e),e.add(t)}function lge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cc(t,e,n){return(e=uge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uge(t){var e=cge(t,"string");return typeof e=="symbol"?e:e+""}function cge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oy=new WeakSet;class EG{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];age(this,oy),cc(this,"hot",void 0),cc(this,"conditionCollection",void 0),cc(this,"columnDataFactory",void 0),cc(this,"changes",[]),cc(this,"grouping",!1),cc(this,"latestEditedColumnPosition",-1),cc(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>pM(oy,this,hge).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>pM(oy,this,dge).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>pM(oy,this,fge).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,W(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const a=r.slice(0,s),u=r.slice(s);u.length&&u[0].column===e&&u.shift();const h=nX(function(g,p){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const y=new _H(i.hot,!1),S=[].concat(g,w);y.importAllConditions(S);const _=i.columnDataFactory(p);let E;y.isEmpty()?E=_:E=new RG(y,x=>i.columnDataFactory(x)).filter(),E=Rt(E,x=>x.meta.visualRow);const H=Bp(E);return y.destroy(),Uc(_,x=>H(x.meta.visualRow))})(a),d=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:d},dependentConditionStacks:u,filteredRowsFactory:h,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),dt(this,(e,n)=>{this[n]=null})}}function hge(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function dge(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function fge(){W(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}Yt(EG,Ai);function gge(t){return YY({initialPage:0,size:()=>t.length,onItemSelect:(n,i)=>{const r=t[n];if(r instanceof dp)return i;if(r.element&&!Jd(r.element))return!1;r.focus()}})}const cm="filters";function mge(t,e){let n=-1,i;const r=gge(e),s=p=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(cm),r.setCurrentPage(e.indexOf(p))};e.forEach(p=>{p instanceof Zs&&(p.addLocalHook("click",s(p)),p.addLocalHook("focus",s(p)),p.addLocalHook("afterClose",s(p)))}),h(t);function a(p){const w=i.getKeyboardShortcutsCtrl(),y=p.getKeyboardShortcutsCtrl();r.clear(),y.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:w.getContext(cm),callback:()=>{p.isSubMenu()&&p.close(),w.listen(cm)}}]),!p.isSubMenu()&&w.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:S=>{const _=i.getNavigator();_.getCurrentPage()>-1&&(n=_.getCurrentPage()),_.clear(),S.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:S=>{const _=e[r.getCurrentPage()];_ instanceof cp&&(_.openOptions(),S.preventDefault()),_ instanceof hp&&(_.activate(),S.preventDefault()),_ instanceof Zs||S.preventDefault()}}],cm)}function u(){i.focus(),i.getKeyboardShortcutsCtrl().listen(cm)}function h(p){p.addLocalHook("afterSelectionChange",w=>{w.key.startsWith("filter_")||r.clear()}),p.addLocalHook("afterSubmenuOpen",a),p.addLocalHook("afterOpen",a),i=p}function d(){return i}function g(){return n}return{...r,listen:u,setMenu:h,getMenu:d,getLastMenuPage:g}}function pge(t,e){TG(t,e),e.add(t)}function mW(t,e,n){TG(t,e),e.set(t,n)}function TG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hm(t,e,n){return(e=vge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vge(t){var e=wge(t,"string");return typeof e=="symbol"?e:e+""}function wge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yge(t,e,n){return t.set(dr(t,e),n),n}function Wa(t,e){return t.get(dr(t,e))}function dr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const G1="filters",Cge=250,pW=G1;var Da=new WeakMap,q1=new WeakMap,xr=new WeakSet;class Sge extends Ht{static get PLUGIN_KEY(){return G1}static get PLUGIN_PRIORITY(){return Cge}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,pge(this,xr),hm(this,"dropdownMenuPlugin",null),hm(this,"conditionCollection",null),hm(this,"conditionUpdateObserver",null),hm(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),hm(this,"filtersRowsMap",null),mW(this,Da,void 0),mW(this,q1,new WeakSet),this.hot.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return dr(xr,n,Oge).call(n,...r)})}isEnabled(){return!!this.hot.getSettings()[G1]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Hp),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,i=n&&n.uiContainer||this.hot.rootDocument.body,r=u=>(u.addLocalHook("accept",()=>dr(xr,this,vW).call(this,"accept")),u.addLocalHook("cancel",()=>dr(xr,this,vW).call(this,"cancel")),u.addLocalHook("change",h=>dr(xr,this,Mge).call(this,u,h)),u),s=()=>`${this.hot.getTranslatedPhrase(Px)}:`,a=()=>`${this.hot.getTranslatedPhrase(Ix)}:`;if(!this.components.get("filter_by_condition")){const u=new Y1(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:i});u.addLocalHook("afterClose",()=>dr(xr,this,wW).call(this)),this.components.set("filter_by_condition",r(u))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new xfe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const u=new Y1(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});u.addLocalHook("afterClose",()=>dr(xr,this,wW).call(this)),this.components.set("filter_by_condition2",r(u))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Gfe(this.hot,{id:"filter_by_value",name:a}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new fp(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new _H(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new EG(this.hot,this.conditionCollection,u=>this.getDataMapAtColumn(u)),this.conditionUpdateObserver.addLocalHook("update",u=>dr(xr,this,Age).call(this,u))),this.components.forEach(u=>u.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return dr(xr,e,_ge).call(e,...h)}),this.addHook("beforeDropdownMenuShow",()=>dr(xr,this,Tge).call(this)),this.addHook("afterDropdownMenuShow",()=>dr(xr,this,Rge).call(this)),this.addHook("afterDropdownMenuHide",()=>dr(xr,this,Ege).call(this)),this.addHook("afterChange",u=>dr(xr,this,bge).call(this,u)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Wa(Da,this)&&this.dropdownMenuPlugin.enabled){const u=[{focus:()=>{const d=Wa(Da,this).getMenu(),g=d.getNavigator(),p=Wa(Da,this).getLastMenuPage();d.focus(),p>0?g.setCurrentPage(p):g.toFirstItem()}},...Array.from(this.components).map(d=>{let[,g]=d;return g.getElements()}).flat()];yge(Da,this,mge(this.dropdownMenuPlugin.menu,u));const h=d=>{Wa(Da,this).listen(),d.preventDefault(),Mp(d.keyCode,"TAB")&&(d.shiftKey?Wa(Da,this).toPreviousItem():Wa(Da,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",h),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",h)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,i)=>{n.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:pW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pW)}addCondition(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:hu;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:n},args:i},r)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s,this.conditionCollection.previousConditionStack)!==!1)if(i){const u=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=Rt(n.filter(),d=>d.meta.visualRow);const h=Bp(r);ke(this.hot.countSourceRows()-1,d=>{h(d)||u.push(d)}),W(u,d=>{this.filtersRowsMap.setValueAtIndex(d,!0)})},!0),!e&&!r.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),i=[];return W(this.hot.getSourceDataAtCol(n),(r,s)=>{var a;const{row:u,col:h,visualCol:d,visualRow:g,type:p,instance:w,dateFormat:y,locale:S}=this.hot.getCellMeta(s,n),_=(a=this.hot.getDataAtCell(this.hot.toVisualRow(s),n))!==null&&a!==void 0?a:r;i.push({meta:{row:u,col:h,visualCol:d,visualRow:g,type:p,instance:w,dateFormat:y,locale:S},value:bH(_)})}),i}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),i=z1(n);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var n;const i=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,i,r){let s=e;return s===DC&&n.command.key!==yi&&i.command.key!==yi&&r.command.key!==yi?s=EH:r.command.key!==yi&&(n.command.key===yi||i.command.key===yi)&&(s=hu),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new RG(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return W(r,a=>{W(n.menuItems,(u,h)=>{u.key===a.getMenuItemDescriptor().key&&e.push(h)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];const h=this.getIndexesOfComponents(...a);e?r.showRows(h):r.hideRows(h),i.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function bge(t){t&&W(t,e=>{const[,n]=e,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function Rge(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Ege(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Tge(){const t=this.dropdownMenuPlugin.menu;Wa(q1,this).has(t)||Wa(Da,this).setMenu(t),Wa(q1,this).add(t)}function _ge(t){t.items.push({name:ut}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function vW(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:r}=i,s=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),u=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,a,u);this.conditionUpdateObserver.groupChanges();let d=this.conditionCollection.getColumnStackPosition(r);d===-1&&(d=void 0),this.conditionCollection.removeConditions(r),s.command.key!==yi&&(this.conditionCollection.addCondition(r,s,h,d),a.command.key!==yi&&this.conditionCollection.addCondition(r,a,h,d)),u.command.key!==yi&&this.conditionCollection.addCondition(r,u,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(g=>g.saveState(r)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Mge(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===Y1&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function wW(){this.setListeningDropdownMenu()}function Oge(t,e,n){const i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)&&n===this.hot.view.getColumnHeadersCount()-1?fe(e,"htFiltersActive"):je(e,"htFiltersActive")}function Age(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:i}}=t,r=n.filter(a=>a.name===$c),s=n.filter(a=>a.name!==$c);if(r.length>=2||s.length>=3)Nt($t`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(s[0],i),this.components.get("filter_by_condition2").updateState(s[1],i),this.components.get("filter_operators").updateState(a,i),this.components.get("filter_by_value").updateState(t)}}const _G="internal-use-in-handsontable",K1={licenseKey:_G,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function MG(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Vi])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function OG(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function xge(t){var e;const n=t[Vi],i=OG(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=MG(t);return{...K1,...i,...r}}function Hge(t){var e;const n=t[Vi],i=OG(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=MG(t);return{...i,...r}}function Pge(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function XS(){const t="engine_relationship",e=oo(Vi);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function MH(){const t="shared_engine_usage",e=oo(Vi);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Ige(t){const e=t.getSettings(),n=e[Vi],i=n==null?void 0:n.engine;if(n===!0||vn(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var r;return Nge((r=i.hyperformula)!==null&&r!==void 0?r:i,e,t)}else if(typeof i=="object"&&vn(i.hyperformula)){const s=XS(),a=MH().get(i);return s.has(i)||s.set(i,[]),s.get(i).push(t),a&&a.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:_G}),(i.getConfig().leapYear1900!==K1.leapYear1900||qO(i.getConfig().nullDate,K1.nullDate)===!1)&&Nt($t`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function Nge(t,e,n){const i=e[Vi],r=xge(e),s=XS(),a=MH();Dge(t,i.functions),Lge(t,i.language);const u=t.buildEmpty(r);return s.set(u,[n]),a.set(u,[n.guid]),kge(u,i.namedExpressions),u.on("sheetAdded",()=>{u.rebuildAndRecalculate()}),u.on("sheetRemoved",()=>{u.rebuildAndRecalculate()}),u}function yW(t){var e;const n=XS(),i=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(r=>[r.getPlugin("formulas").sheetId,r]))}function CW(t,e){if(t){const n=XS(),i=n.get(t),r=MH(),s=r.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&n.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(r.delete(t),t.destroy()))}}function Dge(t,e){e&&e.forEach(n=>{const{name:i,plugin:r,translations:s}=n;try{t.registerFunction(i,r,s)}catch(a){Nt(a.message)}})}function Lge(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(i){Nt(i.message)}}}function kge(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:i,expression:r,scope:s,options:a}=n;try{t.addNamedExpression(i,r,s,a)}catch(u){Nt(u.message)}}),t.resumeEvaluation())}function Vge(t,e){return(vn(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const AG="DD/MM/YYYY";function xG(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function $ge(t){return xG(t)?t.substr(1):t}function Fge(t){return typeof t=="string"&&t.startsWith("=")}function OH(t,e){return typeof t=="string"&&e==="date"}function HG(t,e){return pe(t,e,!0).isValid()}function PG(t,e){return pe(t,e,!0).format(AG)}function Bge(t,e){return pe(t,AG,!0).format(e)}function IG(t,e){const i=new Date(Date.UTC(0,0,t+-1));return pe(i).format(e)}function Wge(t,e,n){const i=Array.from(Array(n).keys()).filter(s=>t.includes(s)===!1);if(e===0){var r;return(r=i[e])!==null&&r!==void 0?r:0}return i[e-1]+1}function Uge(t,e){const n=[];return t.forEach(i=>{const r={from:i,to:e};n.forEach(s=>{const a=s.from>s.to,u=s.to<=r.from;s.from>r.from&&u&&a&&(r.from+=1)}),r.from>=e&&(e+=1),n.push(r)}),n}function jge(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(r=>{const s=r.from<r.to;r.from>e.from&&s&&(r.from-=1)})}),t}function AH(t,e,n){const i=Uge(t,Wge(t,e,n));return jge(i)}function hc(t,e,n){zge(t,e),e.set(t,n)}function zge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ln(t,e){return t.get(NG(t,e))}function Wl(t,e,n){return t.set(NG(t,e),n),n}function NG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dm=new WeakMap,Ul=new WeakMap,Hr=new WeakMap,ay=new WeakMap,vM=new WeakMap,wM=new WeakMap,ly=new WeakMap;class SW{constructor(e,n,i){hc(this,dm,void 0),hc(this,Ul,void 0),hc(this,Hr,void 0),hc(this,ay,[]),hc(this,vM,[]),hc(this,wM,void 0),hc(this,ly,[]),Wl(dm,this,e),Wl(Ul,this,n),Wl(Hr,this,i)}setRemovedHfIndexes(e){return Wl(ly,this,e.map(n=>{const i=ln(Ul,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(i)})),ln(ly,this)}getRemovedHfIndexes(){return ln(ly,this)}getHfIndexFromVisualIndex(e){const n=ln(Ul,this).getIndexesSequence(),i=ln(Ul,this).getNotTrimmedIndexes();return n.indexOf(i[e])}syncMoves(e){const i=`move${eo(ln(dm,this))}s`;ln(Hr,this).getEngine().batch(()=>{e.forEach(r=>{const s=r.from!==r.to,a=r.from+1!==r.to;s&&a&&ln(Hr,this).getEngine()[i](ln(Hr,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,n,i){i!==!1&&(Wl(vM,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),Wl(wM,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(ln(Hr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const i=AH(ln(vM,this),ln(wM,this),ln(Ul,this).getNumberOfIndexes());ln(Hr,this).getSheetId()===null?ln(Hr,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${eo(ln(dm,this))}Order`;return n=>{if(ln(Hr,this).isPerformingUndoRedo())return;const i=ln(Ul,this).getIndexesSequence();if(n==="update"&&i.length>0){const r=ln(ay,this).map(h=>i.indexOf(h)),s=ln(Hr,this).getEngine().getSheetDimensions(ln(Hr,this).getSheetId());let a;ln(dm,this)==="row"?a=s.height:a=s.width;const u=r.length;for(let h=u;h<a;h+=1)r.push(h);ln(Hr,this).getEngine()[e](ln(Hr,this).getSheetId(),r)}Wl(ay,this,i)}}init(){Wl(ay,this,ln(Ul,this).getIndexesSequence())}}function dc(t,e,n){Yge(t,e),e.set(t,n)}function Yge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xa(t,e){return t.get(DG(t,e))}function fc(t,e,n){return t.set(DG(t,e),n),n}function DG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uy=new WeakMap,cy=new WeakMap,yM=new WeakMap,CM=new WeakMap,SM=new WeakMap,bM=new WeakMap,RM=new WeakMap;class Gge{constructor(e,n,i){dc(this,uy,void 0),dc(this,cy,void 0),dc(this,yM,void 0),dc(this,CM,!1),dc(this,SM,!1),dc(this,bM,null),dc(this,RM,null),fc(uy,this,new SW("row",e,this)),fc(cy,this,new SW("column",n,this)),fc(yM,this,i)}getForAxis(e){return e==="row"?xa(uy,this):xa(cy,this)}setPerformUndo(e){fc(CM,this,e)}setPerformRedo(e){fc(SM,this,e)}isPerformingUndoRedo(){return xa(CM,this)||xa(SM,this)}getSheetId(){return xa(RM,this)}getEngine(){return xa(bM,this)}getPostponeAction(){return xa(yM,this)}setupSyncEndpoint(e,n){fc(bM,this,e),fc(RM,this,n),xa(uy,this).init(),xa(cy,this).init()}}function qge(t,e){LG(t,e),e.add(t)}function yd(t,e,n){return(e=Kge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kge(t){var e=Xge(t,"string");return typeof e=="symbol"?e:e+""}function Xge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EM(t,e,n){LG(t,e),e.set(t,n)}function LG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gu(t,e,n){return t.set(jt(t,e),n),n}function Kd(t,e){return t.get(jt(t,e))}function jt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vi="formulas",Zge=["maxRows","maxColumns","language"],Qge=260;Ae.getSingleton().register("afterNamedExpressionAdded");Ae.getSingleton().register("afterNamedExpressionRemoved");Ae.getSingleton().register("afterSheetAdded");Ae.getSingleton().register("afterSheetRemoved");Ae.getSingleton().register("afterSheetRenamed");Ae.getSingleton().register("afterFormulasValuesUpdate");const Rf=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var il=new WeakMap,xH=new WeakMap,fm=new WeakMap,Kt=new WeakSet;class Jge extends Ht{constructor(){var e;super(...arguments),e=this,qge(this,Kt),EM(this,il,!1),EM(this,xH,!1),EM(this,fm,[["valuesUpdated",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jt(Kt,e,mme).call(e,...i)}],["namedExpressionAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jt(Kt,e,pme).call(e,...i)}],["namedExpressionRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jt(Kt,e,vme).call(e,...i)}],["sheetAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jt(Kt,e,wme).call(e,...i)}],["sheetRenamed",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jt(Kt,e,yme).call(e,...i)}],["sheetRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jt(Kt,e,Cme).call(e,...i)}]]),yd(this,"staticRegister",oo("formulas")),yd(this,"engine",null),yd(this,"sheetName",null),yd(this,"indexSyncer",null),yd(this,"rowAxisSyncer",null),yd(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Vi}static get PLUGIN_PRIORITY(){return Qge}static get SETTING_KEYS(){return[Vi,...Zge]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Vi]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Ige(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Nt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,bW).call(n,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,RW).call(n,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,bW).call(n,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,RW).call(n,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,ime).call(n,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,rme).call(n,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,eme).call(n,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,sme).call(n,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,EW).call(n,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,EW).call(n,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,ome).call(n,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,ame).call(n,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,cme).call(n,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,hme).call(n,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,lme).call(n,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,ume).call(n,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,dme).call(n,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,fme).call(n,...r)}),this.indexSyncer=new Gge(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,s,a)=>{this.rowAxisSyncer.storeMovesInformation(i,r,a)}),this.hot.addHook("beforeColumnMove",(i,r,s,a)=>{this.columnAxisSyncer.storeMovesInformation(i,r,a)}),this.hot.addHook("afterRowMove",(i,r,s,a,u)=>{this.rowAxisSyncer.calculateAndSyncMoves(a,u)}),this.hot.addHook("afterColumnMove",(i,r,s,a,u)=>{this.columnAxisSyncer.calculateAndSyncMoves(a,u)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,nme).call(n,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,gme).call(n,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return jt(Kt,n,tme).call(n,...r)}),Kd(fm,this).forEach(i=>{let[r,s]=i;return this.engine.on(r,s)}),super.enablePlugin()}}disablePlugin(){Kd(fm,this).forEach(e=>{let[n,i]=e;return this.engine.off(n,i)}),CW(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Hge(this.hot.getSettings());Pge(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const i=this.hot.getSettings()[Vi];if(Pe(i)&&Pe(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[Vi].sheetName;r&&this.engine.doesSheetExist(r)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(r??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Kd(fm,this).forEach(e=>{var n;let[i,r]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(i,r)}),gu(fm,this,null),CW(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(Pe(n)&&!xee(n))return Nt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Nt("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(i),n),i}catch(i){return Nt(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){ZO(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${eo(Vi)}.switchSheet`)}getCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(n);return r!==null&&s!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var s;const a=r==null||(s=r.address)===null||s===void 0?void 0:s.sheet;a!==void 0&&(i.has(a)||i.add(a))}),yW(this.engine).forEach((r,s)=>{if((n||s!==this.sheetId)&&i.has(s)){var a;r.render(),(a=r.view)===null||a===void 0||a.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=s=>{var a;const{row:u,col:h,sheet:d}=(a=s==null?void 0:s.address)!==null&&a!==void 0?a:{};return Pe(d)?`${d}:${u}x${h}`:""},r=new Set(n.map(s=>i(s)));e.forEach(s=>{var a,u;const{row:h,col:d}=(a=s.address)!==null&&a!==void 0?a:{};if(Pe(h)===!1||Pe(d)===!1||h>=this.hot.countRows()||d>=this.hot.countCols())return;const g=s==null||(u=s.address)===null||u===void 0?void 0:u.sheet,p=i(s);if(g!==void 0&&!r.has(p)){const w=yW(this.engine).get(g);if(!w)return;w.validateCell(w.getDataAtCell(h,d),w.getCellMeta(h,d),()=>{})}})}syncChangeWithEngine(e,n,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){Nt(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const s=this.hot.getCellMeta(e,n);return OH(i,s.type)&&(HG(i,s.dateFormat)?i=PG(i,s.dateFormat):Fge(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}}function eme(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},s=this.hot.getCellMeta(e,i);let a=this.engine.getCellValue(r);return s.type==="date"&&Qi(a)&&(a=IG(a,s.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return t}function tme(t,e,n){const{row:i,col:r}=e.getTopStartCorner(),{row:s,col:a}=e.getBottomEndCorner(),{row:u,col:h}=n.getTopStartCorner(),{row:d,col:g}=n.getBottomEndCorner(),p={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},w={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(w)===!1)return!1;const y=this.engine.getFillRangeData(p,w),{row:S,col:_}=p.start,{row:E,col:H}=p.end,x=E-S+1,D=H-_+1;for(let $=0;$<y.length;$+=1)for(let V=0;V<y[$].length;V+=1){const L=y[$][V],U=S+$%x,re=_+V%D,se=this.hot.getCellMeta(U,re);OH(L,se.type)&&(L.startsWith("'")?y[$][V]=L.slice(1):this.isFormulaCellType(U,re,this.sheetId)===!1&&(y[$][V]=Bge(L,se.dateFormat)))}return y}function bW(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(eo(Vi))||gu(xH,this,vn(this.hot.getSettings().data))}function nme(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,i)=>{n.forEach((r,s)=>{const a=this.hot.getCellMeta(i,s),u=a.dateFormat;OH(r,a.type)&&(e=!0,HG(r,u)?t[i][s]=PG(r,u):this.isFormulaCellType(i,s)===!1&&(t[i][s]=`'${r}`))})}),e===!0&&(gu(il,this,!0),this.engine.setSheetContent(this.sheetId,t),gu(il,this,!1))}function RW(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(eo(Vi)))if(this.sheetName=Vge(this.engine,this.hot.getSettings()[Vi].sheetName),Kd(xH,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){gu(il,this,!0);const r=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(r),gu(il,this,!1)}}}function ime(t,e,n,i){if(i!=="get"||Kd(il,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t);if(r===null||e===null)return;if(!this.isFormulaCellType(r,e)&&this.getCellType(r,e)!=="ARRAY"){xG(n.value)&&(n.value=$ge(n.value));return}const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let u=this.engine.getCellValue(a),h=this.hot.getCellsMeta().find(g=>g.visualRow===r&&g.visualCol===e);h===void 0&&(h={}),h.type==="date"&&Qi(u)&&(u=IG(u,h.dateFormat));const d=typeof u=="object"&&u!==null?u.value:u;n.value=d}function rme(t,e,n,i){if(i!=="get"||Kd(il,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(r===null||s===null||!this.isFormulaCellType(r,s)&&this.getCellType(r,s)!=="ARRAY")return;const u=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(u.width===0&&u.height===0)return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};n.value=this.engine.getCellSerialized(h)}function EW(t,e){if(Rf(e))return;const n=[],i=[],r=this.engine.batch(()=>{t.forEach(s=>{let[a,u,,h]=s;const d=this.hot.propToCol(u),g=this.hot.toPhysicalRow(a),p=this.hot.toPhysicalColumn(d),w={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId};g!==null&&p!==null?this.syncChangeWithEngine(a,d,h):n.push([a,d,h]),i.push({address:w})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{n.forEach(a=>{let[u,h,d]=a;this.syncChangeWithEngine(u,h,d)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function sme(t,e){if(Rf(e))return;const n=[],i=[];t.forEach(r=>{let[s,a,,u]=r;const h=this.hot.propToCol(a);if(!Qi(h))return;const d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(d)){Nt(`Not possible to set source cell data at ${JSON.stringify(d)}`);return}i.push({address:d}),n.push(...this.engine.setCellContents(d,u))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function ome(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function ame(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function lme(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function ume(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function cme(t,e,n){if(Rf(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function hme(t,e,n){if(Rf(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function dme(t,e,n,i){if(Rf(i))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort((a,u)=>u-a),s=this.engine.batch(()=>{r.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(s)}function fme(t,e,n,i){if(Rf(i))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort((a,u)=>u-a),s=this.engine.batch(()=>{r.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(s)}function gme(t,e,n){var i;gu(il,this,!0);const r=this.hot.getSourceDataArray(n,0,n+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());gu(il,this,!1),r.forEach((s,a)=>{s.forEach((u,h)=>{this.engine.setCellContents({col:h,row:n+a,sheet:this.sheetId},[[u]])})})}function mme(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function pme(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function vme(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function wme(t){this.hot.runHooks("afterSheetAdded",t)}function yme(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function Cme(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Sme(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(ux,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,n.col),0),r=Math.max(e.col,n.col),s=[];for(let h=i;h<=r;h+=1)s.push(h);t.hideColumns(s);const a=s[s.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function bme(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(cx,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],s=e[e.length-1];r=(n=this.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,s=(i=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-r+1===this.countCols()||this.selectColumns(r,s)},disabled:!1,hidden(){const n=Rt(t.getHiddenColumns(),p=>this.toPhysicalColumn(p));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().col,s=i.getBottomEndCorner().col,a=this.columnIndexMapper,u=a.getRenderableFromVisualIndex(r),h=a.getRenderableFromVisualIndex(s),d=a.getNotTrimmedIndexes(),g=[];if(r!==s){const p=s-r+1,w=h-u+1;if(p>w){const y=d.slice(r,s+1);g.push(...y.filter(S=>n.includes(S)))}}else if(u===0&&u<r)g.push(...d.slice(0,r));else if(u===null)g.push(...d.slice(0,this.countCols()));else{const p=this.countCols()-1,w=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(p,-1));h===w&&p>s&&g.push(...d.slice(s+1))}return W(g,p=>{e.push(this.toVisualColumn(p))}),e.length===0}}}function Rme(t,e){kG(t,e),e.add(t)}function Eme(t,e,n){kG(t,e),e.set(t,n)}function kG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gc(t,e){return t.get(Xl(t,e))}function TW(t,e,n){return t.set(Xl(t,e),n),n}function Xl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeHideColumns");Ae.getSingleton().register("afterHideColumns");Ae.getSingleton().register("beforeUnhideColumns");Ae.getSingleton().register("afterUnhideColumns");const _W="hiddenColumns",Tme=310;var bo=new WeakMap,mc=new WeakSet;class _me extends Ht{constructor(){super(...arguments),Rme(this,mc),Eme(this,bo,null)}static get PLUGIN_KEY(){return _W}static get PLUGIN_PRIORITY(){return Tme}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[_W]}enablePlugin(){var e=this;this.enabled||(TW(bo,this,new OS),gc(bo,this).addLocalHook("init",()=>Xl(mc,this,Pme).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,gc(bo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Xl(mc,e,Hme).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>Xl(mc,this,Ome).call(this,n,i,r)),this.addHook("modifyColWidth",(n,i)=>Xl(mc,this,Mme).call(this,n,i),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Xl(mc,e,xme).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Xl(mc,this,Ame).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;const s=gc(bo,this).getValues().slice(),a=e.length>0;if(i&&a){const h=e.map(d=>this.hot.toPhysicalColumn(d));W(h,d=>{s[d]=!1}),r=Sr(s,(d,g,p)=>(g&&d.push(this.hot.toVisualColumn(p)),d),[])}this.hot.runHooks("beforeUnhideColumns",n,r,i&&a)!==!1&&(i&&a&&gc(bo,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,i&&a,i&&r.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{W(e,a=>{gc(bo,this).setValueAtIndex(this.hot.toPhysicalColumn(a),!0)})},!0),this.hot.runHooks("afterHideColumns",n,r,i,i&&r.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideColumns(n)}getHiddenColumns(){return Rt(gc(bo,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return gc(bo,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){W(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){TW(bo,this,null),super.destroy()}}function Mme(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Ome(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenColumn");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Ame(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,s,a)=>{e.push({startRow:i,endRow:r,startCol:s,endCol:a})};return W(t,i=>{let r=!0,s=0;ke(i.startCol,i.endCol,a=>{this.isHidden(a)?(r||n(i.startRow,i.endRow,s,a-1),r=!0):(r&&(s=a),a===i.endCol&&n(i.startRow,i.endRow,s,a),r=!1)})}),e}function xme(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),fe(e,n)}function Hme(t){t.items.push({name:ut},Sme(this),bme(this))}function Pme(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Ime(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(hx,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,n.row),0),r=Math.max(e.row,n.row),s=[];for(let h=i;h<=r;h+=1)s.push(h);t.hideRows(s);const a=s[s.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Nme(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(dx,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],s=e[e.length-1];r=(n=this.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,s=(i=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-r+1===this.countRows()||this.selectRows(r,s)},disabled:!1,hidden(){const n=Rt(t.getHiddenRows(),p=>this.toPhysicalRow(p));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().row,s=i.getBottomEndCorner().row,a=this.rowIndexMapper,u=a.getRenderableFromVisualIndex(r),h=a.getRenderableFromVisualIndex(s),d=a.getNotTrimmedIndexes(),g=[];if(r!==s){const p=s-r+1,w=h-u+1;if(p>w){const y=d.slice(r,s+1);g.push(...y.filter(S=>n.includes(S)))}}else if(u===0&&u<r)g.push(...d.slice(0,r));else if(u===null)g.push(...d.slice(0,this.countRows()));else{const p=this.countRows()-1,w=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(p,-1));h===w&&p>s&&g.push(...d.slice(s+1))}return W(g,p=>{e.push(this.toVisualRow(p))}),e.length===0}}}function Dme(t,e){VG(t,e),e.add(t)}function Lme(t,e,n){VG(t,e),e.set(t,n)}function VG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pc(t,e){return t.get(Zl(t,e))}function MW(t,e,n){return t.set(Zl(t,e),n),n}function Zl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeHideRows");Ae.getSingleton().register("afterHideRows");Ae.getSingleton().register("beforeUnhideRows");Ae.getSingleton().register("afterUnhideRows");const OW="hiddenRows",kme=320;var Ro=new WeakMap,vc=new WeakSet;class Vme extends Ht{constructor(){super(...arguments),Dme(this,vc),Lme(this,Ro,null)}static get PLUGIN_KEY(){return OW}static get PLUGIN_PRIORITY(){return kme}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[OW]}enablePlugin(){var e=this;this.enabled||(MW(Ro,this,new OS),pc(Ro,this).addLocalHook("init",()=>Zl(vc,this,jme).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,pc(Ro,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Zl(vc,e,Ume).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>Zl(vc,this,Fme).call(this,n,i,r)),this.addHook("modifyRowHeight",(n,i)=>Zl(vc,this,$me).call(this,n,i)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Zl(vc,e,Wme).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Zl(vc,this,Bme).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;const s=pc(Ro,this).getValues().slice(),a=e.length>0;if(i&&a){const h=e.map(d=>this.hot.toPhysicalRow(d));W(h,d=>{s[d]=!1}),r=Sr(s,(d,g,p)=>(g&&d.push(this.hot.toVisualRow(p)),d),[])}this.hot.runHooks("beforeUnhideRows",n,r,i&&a)!==!1&&(i&&a&&pc(Ro,this).setValues(s),this.hot.runHooks("afterUnhideRows",n,r,i&&a,i&&r.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{W(e,a=>{pc(Ro,this).setValueAtIndex(this.hot.toPhysicalRow(a),!0)})},!0),this.hot.runHooks("afterHideRows",n,r,i,i&&r.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideRows(n)}getHiddenRows(){return Rt(pc(Ro,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return pc(Ro,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){W(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){MW(Ro,this,null),super.destroy()}}function $me(t,e){return this.isHidden(e)?0:t}function Fme(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenRow");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Bme(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,s,a)=>{e.push({startRow:i,endRow:r,startCol:s,endCol:a})};return W(t,i=>{let r=!0,s=0;ke(i.startRow,i.endRow,a=>{this.isHidden(a)?(r||n(s,a-1,i.startCol,i.endCol),r=!0):(r&&(s=a),a===i.endRow&&n(s,a,i.startCol,i.endCol),r=!1)})}),e}function Wme(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),fe(e,n)}function Ume(t){t.items.push({name:ut},Ime(this),Nme(this))}function jme(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function zme(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase($A)},callback(e,n){const[{start:{col:i}}]=n;t.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Yme(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(FA)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Gme(t,e){$G(t,e),e.add(t)}function qme(t,e,n){$G(t,e),e.set(t,n)}function $G(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function X1(t,e){return t.get(kC(t,e))}function TM(t,e,n){return t.set(kC(t,e),n),n}function kC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeColumnFreeze");Ae.getSingleton().register("afterColumnFreeze");Ae.getSingleton().register("beforeColumnUnfreeze");Ae.getSingleton().register("afterColumnUnfreeze");const AW="manualColumnFreeze",Kme=110;var Hc=new WeakMap,_M=new WeakSet;class Xme extends Ht{constructor(){super(...arguments),Gme(this,_M),qme(this,Hc,!1)}static get PLUGIN_KEY(){return AW}static get PLUGIN_PRIORITY(){return Kme}isEnabled(){return!!this.hot.getSettings()[AW]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>kC(_M,this,Zme).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>kC(_M,this,Qme).call(this,e,n)),super.enablePlugin())}disablePlugin(){TM(Hc,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;X1(Hc,this)||TM(Hc,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;X1(Hc,this)||TM(Hc,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function Zme(t){t.items.push({name:"---------"},zme(this),Yme(this))}function Qme(t,e){if(X1(Hc,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(i=>i<n))return!1}}function hy(t,e,n){return(e=Jme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jme(t){var e=epe(t,"string");return typeof e=="symbol"?e:e+""}function epe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const MM=0,xW=1,HW=2,Cd="px";let FG=class{constructor(e){hy(this,"hot",void 0),hy(this,"_element",null),hy(this,"state",MM),hy(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=HW}build(){this.state===MM&&(this._element=this.hot.rootDocument.createElement("div"),this.state=xW)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=MM}isAppended(){return this.state===HW}isBuilt(){return this.state>=xW}setPosition(e,n){Qi(e)&&(this._element.style.top=e+Cd),Qi(n)&&(this._element.style[this.inlineProperty]=n+Cd)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Qi(e)&&(this._element.style.width=e+Cd),Qi(n)&&(this._element.style.height=n+Cd)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Qi(e)&&(this._element.style.marginTop=e+Cd),Qi(n)&&(this._element.style[`margin${eo(this.inlineProperty)}`]=n+Cd)}getOffset(){const e=this._element.style,n=`margin${eo(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const tpe="ht__manualColumnMove--backlight";let npe=class extends FG{build(){super.build(),fe(this._element,tpe)}};const ipe="ht__manualColumnMove--guideline";let rpe=class extends FG{build(){super.build(),fe(this._element,ipe)}};function spe(t,e){BG(t,e),e.add(t)}function Ls(t,e,n){BG(t,e),e.set(t,n)}function BG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vr(t,e,n){return t.set(Ql(t,e),n),n}function De(t,e){return t.get(Ql(t,e))}function Ql(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeColumnMove");Ae.getSingleton().register("afterColumnMove");const OM="manualColumnMove",ope=120,PW="ht__manualColumnMove",VC="show-ui",Z1="on-moving--columns",Q1="after-selection--columns";var Xi=new WeakMap,eu=new WeakMap,Ka=new WeakMap,iC=new WeakMap,au=new WeakMap,Ki=new WeakMap,dy=new WeakMap,ds=new WeakMap,Dd=new WeakMap,$C=new WeakMap,Fm=new WeakMap,wc=new WeakSet;class ape extends Ht{constructor(){super(...arguments),spe(this,wc),Ls(this,Xi,new npe(this.hot)),Ls(this,eu,new rpe(this.hot)),Ls(this,Ka,[]),Ls(this,iC,0),Ls(this,au,!1),Ls(this,Ki,{}),Ls(this,dy,void 0),Ls(this,ds,void 0),Ls(this,Dd,void 0),Ls(this,$C,void 0),Ls(this,Fm,void 0)}static get PLUGIN_KEY(){return OM}static get PLUGIN_PRIORITY(){return ope}isEnabled(){return!!this.hot.getSettings()[OM]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ql(wc,e,lpe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ql(wc,e,cpe).call(e,...i)}),this.addHook("afterScrollVertically",()=>Ql(wc,this,dpe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ql(wc,e,fpe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),fe(this.hot.rootElement,PW),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){je(this.hot.rootElement,PW),this.unregisterEvents(),De(Xi,this).destroy(),De(eu,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const i=De(dy,this),r=this.isMovePossible(e,n),s=this.hot.runHooks("beforeColumnMove",e,n,i,r);if(vr(dy,this,void 0),s===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,n);const a=r&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,i,r,a),a}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const i=this.countFinalIndex(e,n);return vr(dy,this,n),this.moveColumns(e,i)}isMovePossible(e,n){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,s=n<0,a=e.some(h=>h<0),u=e.some(h=>h>=i);return!(r||s||a||u)}isColumnOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=Sr(e,(r,s)=>(s<n&&(r+=1),r),0);return n-i}getColumnsWidth(e,n){const i=this.hot.columnIndexMapper;let r=0;for(let s=e;s<=n;s+=1){const a=i.getRenderableFromVisualIndex(s);s<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:a!==null&&(r+=this.hot.view._wt.wtTable.getColumnWidth(a)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[OM];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const i=[];return ke(e,n,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(De(ds,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,De(ds,this)-1);const a=n.hider.offsetWidth,u=n.TBODY.offsetLeft,h=De(Xi,this).getOffset().start,d=De(Xi,this).getSize().width;let g=0,p=0;if(this.hot.isRtl()){const S=this.hot.rootWindow,_=jn(this.hot.rootElement),E=S.innerWidth-De(Dd,this)-_;p=S.innerWidth-De(Ki,this).eventPageX-E-(i.scrollX===void 0?r:0)}else p=De(Ki,this).eventPageX-(De(Dd,this)-(i.scrollX===void 0?r:0));if(De($C,this)&&(g=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(De(ds,this))&&(s+=r),s+=g,De(ds,this)<0)De(Fm,this)>0?De(Ki,this).col=0:De(Ki,this).col=e>0?e-1:e;else if(De(Ki,this).TD.offsetWidth/2+s<=p){const S=De(ds,this)>=De(iC,this)?De(iC,this)-1:De(ds,this);De(Ki,this).col=S+1,s+=De(Ki,this).TD.offsetWidth}else De(Ki,this).col=De(ds,this);let w=p,y=s;p+d+h>=a?w=a-d-h:p+h<u+g&&(w=u+g+Math.abs(h)),s>=a-1?y=a-1:y===0?y=1:i.scrollX!==void 0&&De(ds,this)<De(Fm,this)&&(y-=De(Dd,this)<=i.scrollX?De(Dd,this):0),De(Xi,this).setPosition(null,w),De(eu,this).setPosition(null,y)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ql(wc,this,upe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ql(wc,this,hpe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){De(Xi,this).build(),De(eu,this).build()}destroy(){De(Xi,this).destroy(),De(eu,this).destroy(),super.destroy()}}function lpe(t,e,n,i){const r=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),u=ze(t.target,"sortAction");if(!a||!s||De(au,this)||t.button!==0||u){vr(au,this,!1),De(Ka,this).length=0,je(this.hot.rootElement,[Z1,VC]);return}const h=De(eu,this).isBuilt()&&!De(eu,this).isAppended(),d=De(Xi,this).isBuilt()&&!De(Xi,this).isAppended();h&&d&&(De(eu,this).appendTo(r.hider),De(Xi,this).appendTo(r.hider));const{from:g,to:p}=a,w=Math.min(g.col,p.col),y=Math.max(g.col,p.col);if(e.row<0&&e.col>=w&&e.col<=y){i.column=!0,vr(au,this,!0);const S=n.firstChild?wX(t,n.firstChild).x:t.offsetX;De(Ki,this).eventPageX=t.pageX,vr(ds,this,e.col),De(Ki,this).TD=n,De(Ki,this).col=e.col,vr(Ka,this,this.prepareColumnsToMoving(w,y)),vr($C,this,!!this.hot.getSettings().rowHeaders),vr(iC,this,this.hot.countCols()),vr(Fm,this,this.hot.getSettings().fixedColumnsStart),vr(Dd,this,Ci(this.hot.rootElement).left);const _=De($C,this)?-1:0,E=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,H=e.col<De(Fm,this),x=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),D=Math.abs(S-(this.hot.isRtl()?n.offsetWidth:0)),$=this.getColumnsWidth(w,e.col-1)+D,V=this.getColumnsWidth(_,w-1)+(H?x:0)+$;De(Xi,this).setPosition(E,V),De(Xi,this).setSize(this.getColumnsWidth(w,y),r.hider.offsetHeight-E),De(Xi,this).setOffset(null,-$),fe(this.hot.rootElement,Z1)}else je(this.hot.rootElement,Q1),vr(au,this,!1),De(Ka,this).length=0}function upe(t){De(au,this)&&(De(Ki,this).eventPageX=t.pageX,this.refreshPositions())}function cpe(t,e,n,i){!this.hot.getSelectedRangeLast()||!De(au,this)||(De(Ka,this).indexOf(e.col)>-1?je(this.hot.rootElement,VC):fe(this.hot.rootElement,VC),i.row=!0,i.column=!0,i.cell=!0,vr(ds,this,e.col),De(Ki,this).TD=n)}function hpe(){const t=De(Ki,this).col,e=De(Ka,this).length;if(vr(ds,this,void 0),vr(au,this,!1),je(this.hot.rootElement,[Z1,VC,Q1]),this.hot.selection.isSelectedByColumnHeader()&&fe(this.hot.rootElement,Q1),e<1||t===void 0)return;const n=De(Ka,this)[0],i=this.hot.toPhysicalColumn(n),r=this.dragColumns(De(Ka,this),t);if(De(Ka,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(i),a=s+e-1;this.hot.selectColumns(s,a)}}function dpe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,i=e+n;De(Xi,this).setPosition(i),De(Xi,this).setSize(null,t.hider.offsetHeight-i)}function fpe(){this.moveBySettingsOrLoad()}function gpe(t,e){WG(t,e),e.add(t)}function Ii(t,e,n){WG(t,e),e.set(t,n)}function WG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kn(t,e,n){return t.set(zs(t,e),n),n}function Oe(t,e){return t.get(zs(t,e))}function zs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const FC="manualColumnResize",mpe=130,IW="manualColumnWidths";var Fa=new WeakMap,fy=new WeakMap,$r=new WeakMap,BC=new WeakMap,Wo=new WeakMap,ppe=new WeakMap,Xd=new WeakMap,gy=new WeakMap,hr=new WeakMap,La=new WeakMap,Zc=new WeakMap,WC=new WeakMap,Bm=new WeakMap,Wm=new WeakMap,Br=new WeakMap,Um=new WeakMap,Eo=new WeakSet;class vpe extends Ht{static get PLUGIN_KEY(){return FC}static get PLUGIN_PRIORITY(){return mpe}constructor(e){super(e),gpe(this,Eo),Ii(this,Fa,null),Ii(this,fy,null),Ii(this,$r,[]),Ii(this,BC,null),Ii(this,Wo,null),Ii(this,ppe,null),Ii(this,Xd,null),Ii(this,gy,null),Ii(this,hr,this.hot.rootDocument.createElement("DIV")),Ii(this,La,this.hot.rootDocument.createElement("DIV")),Ii(this,Zc,null),Ii(this,WC,!1),Ii(this,Bm,0),Ii(this,Wm,null),Ii(this,Br,void 0),Ii(this,Um,void 0),fe(Oe(hr,this),"manualColumnResizer"),fe(Oe(La,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[FC]}enablePlugin(){var e=this;this.enabled||(kn(Br,this,new yu),Oe(Br,this).addLocalHook("init",()=>zs(Eo,this,wpe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Oe(Br,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return zs(Eo,e,Epe).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return zs(Eo,e,Tpe).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return zs(Eo,e,_pe).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){kn(Um,this,Oe(Br,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",IW,Oe(Br,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",IW,e),e.value}setManualSize(e,n){const i=Math.max(n,20),r=this.hot.toPhysicalColumn(e);return Oe(Br,this).setValueAtIndex(r,i),i}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);Oe(Br,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;kn(Fa,this,e);const{_wt:n}=this.hot.view,i=n.wtTable.getCoords(Oe(Fa,this)),r=i.col;if(r<0)return;const s=$n(Oe(Fa,this)),a=Oe(Fa,this).getBoundingClientRect(),u=r<n.getSetting("fixedColumnsStart");let h;u&&(h=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Oe(Fa,this),i.row,i.col)),h||(h=n.wtOverlays.topOverlay.getRelativeCellPosition(Oe(Fa,this),i.row,i.col)),kn(fy,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),kn($r,this,[]);const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){const g=this.hot.getSelectedRange();W(g,p=>{const w=p.getTopStartCorner().col,y=p.getBottomEndCorner().col;ke(w,y,S=>{Oe($r,this).includes(S)||Oe($r,this).push(S)})})}Oe($r,this).includes(Oe(fy,this))||kn($r,this,[Oe(fy,this)]),kn(gy,this,h.start-6),kn(Xd,this,parseInt(a.width,10)),Oe(hr,this).style.top=`${h.top}px`,Oe(hr,this).style[this.inlineDir]=`${Oe(gy,this)+Oe(Xd,this)}px`,Oe(hr,this).style.height=`${s}px`,this.hot.rootElement.appendChild(Oe(hr,this))}refreshHandlePosition(){Oe(hr,this).style[this.inlineDir]=`${Oe(gy,this)+Oe(BC,this)}px`}setupGuidePosition(){const e=parseInt($n(Oe(hr,this)),10),n=parseInt(Oe(hr,this).style.top,10)+e,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);fe(Oe(hr,this),"active"),fe(Oe(La,this),"active"),Oe(La,this).style.top=`${n}px`,this.refreshGuidePosition(),Oe(La,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(Oe(La,this))}refreshGuidePosition(){Oe(La,this).style[this.inlineDir]=Oe(hr,this).style[this.inlineDir]}hideHandleAndGuide(){je(Oe(hr,this),"active"),je(Oe(La,this),"active")}checkIfColumnHeader(e){const n=jc(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const s=this.hot.runHooks("beforeColumnResize",Oe(Wo,this),i,!0);s!==void 0&&kn(Wo,this,s),this.setManualSize(i,Oe(Wo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Oe(Wo,this),i,!0),r&&e()};Oe(Bm,this)>=2&&(Oe($r,this).length>1?(W(Oe($r,this),r=>{n(r)}),e()):W(Oe($r,this),r=>{n(r,!0)})),kn(Bm,this,0),kn(Wm,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",i=>zs(Eo,this,ype).call(this,i)),this.eventManager.addEventListener(n,"mousedown",i=>zs(Eo,this,Cpe).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>zs(Eo,this,Spe).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>zs(Eo,this,bpe).call(this)),this.eventManager.addEventListener(Oe(hr,this),"contextmenu",()=>zs(Eo,this,Rpe).call(this))}destroy(){super.destroy()}}function wpe(){const t=this.hot.getSettings()[FC],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,i)=>{Oe(Br,this).setValueAtIndex(i,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,i)=>{Oe(Br,this).setValueAtIndex(i,n)})},!0),kn(Um,this,t)):t===!0&&Array.isArray(Oe(Um,this))&&this.hot.batchExecution(()=>{Oe(Um,this).forEach((n,i)=>{Oe(Br,this).setValueAtIndex(i,n)})},!0)}function ype(t){if(!v2(t.target)&&Oe(WC,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(Oe(Zc,this)||this.setupHandlePosition(e))}}function Cpe(t){t.target.parentNode===this.hot.rootElement&&ze(t.target,"manualColumnResizer")&&(this.setupHandlePosition(Oe(Fa,this)),this.setupGuidePosition(),kn(Zc,this,!0),Oe(Wm,this)===null&&(kn(Wm,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Oe(Wm,this))),kn(Bm,this,Oe(Bm,this)+1),this.startX=t.pageX,kn(Wo,this,Oe(Xd,this)))}function Spe(t){if(Oe(Zc,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();kn(BC,this,Oe(Xd,this)+e),W(Oe($r,this),n=>{kn(Wo,this,this.setManualSize(n,Oe(BC,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function bpe(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeColumnResize",Oe(Wo,this),n,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Oe(Wo,this),n,!1)};Oe(Zc,this)&&(this.hideHandleAndGuide(),kn(Zc,this,!1),Oe(Wo,this)!==Oe(Xd,this)&&(Oe($r,this).length>1?(W(Oe($r,this),i=>{e(i)}),t()):W(Oe($r,this),i=>{e(i,!0)})),this.setupHandlePosition(Oe(Fa,this)))}function Rpe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Oe(hr,this)),this.hot.rootElement.removeChild(Oe(La,this)),kn(Zc,this,!1),kn(WC,this,!0),this.hot._registerImmediate(()=>{kn(WC,this,!1)})}function Epe(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),r=Oe(Br,this).getValueAtIndex(i);this.hot.getSettings()[FC]&&r&&(n=r)}return n}function Tpe(t,e){const n=Oe(Br,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function _pe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function AM(t,e,n){return(e=Mpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mpe(t){var e=Ope(t,"string");return typeof e=="symbol"?e:e+""}function Ope(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xM=0,NW=1,DW=2,Sd="px";let UG=class{constructor(e){AM(this,"hot",void 0),AM(this,"_element",null),AM(this,"state",xM),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=DW}build(){this.state===xM&&(this._element=this.hot.rootDocument.createElement("div"),this.state=NW)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=xM}isAppended(){return this.state===DW}isBuilt(){return this.state>=NW}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Sd),n!==void 0&&(this._element.style.left=n+Sd)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Sd),n&&(this._element.style.height=n+Sd)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Sd),n&&(this._element.style.marginLeft=n+Sd)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Ape="ht__manualRowMove--backlight";class xpe extends UG{build(){super.build(),fe(this._element,Ape)}}const Hpe="ht__manualRowMove--guideline";class Ppe extends UG{build(){super.build(),fe(this._element,Hpe)}}function Ipe(t,e){jG(t,e),e.add(t)}function bd(t,e,n){jG(t,e),e.set(t,n)}function jG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fc(t,e,n){return t.set(Jl(t,e),n),n}function et(t,e){return t.get(Jl(t,e))}function Jl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeRowMove");Ae.getSingleton().register("afterRowMove");const HM="manualRowMove",Npe=140,LW="ht__manualRowMove",UC="show-ui",J1="on-moving--rows",eO="after-selection--rows";var Zi=new WeakMap,tu=new WeakMap,Xa=new WeakMap,lu=new WeakMap,wr=new WeakMap,my=new WeakMap,yc=new WeakSet;class Dpe extends Ht{constructor(){super(...arguments),Ipe(this,yc),bd(this,Zi,new xpe(this.hot)),bd(this,tu,new Ppe(this.hot)),bd(this,Xa,[]),bd(this,lu,void 0),bd(this,wr,{}),bd(this,my,void 0)}static get PLUGIN_KEY(){return HM}static get PLUGIN_PRIORITY(){return Npe}isEnabled(){return!!this.hot.getSettings()[HM]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Jl(yc,e,Lpe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Jl(yc,e,Vpe).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>Jl(yc,this,Fpe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Jl(yc,e,Bpe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),fe(this.hot.rootElement,LW),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){je(this.hot.rootElement,LW),this.unregisterEvents(),et(Zi,this).destroy(),et(tu,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const i=et(my,this),r=this.isMovePossible(e,n),s=this.hot.runHooks("beforeRowMove",e,n,i,r);if(Fc(my,this,void 0),s===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,n);const a=r&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,i,r,a),a}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const i=this.countFinalIndex(e,n);return Fc(my,this,n),this.moveRows(e,i)}isMovePossible(e,n){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,s=n<0,a=e.some(h=>h<0),u=e.some(h=>h>=i);return!(r||s||a||u)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=Sr(e,(r,s)=>(s<n&&(r+=1),r),0);return n-i}getRowsHeight(e,n){const i=this.hot.rowIndexMapper;let r=0;for(let s=e;s<=n;s++){const a=i.getRenderableFromVisualIndex(s);a!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(a)||this.hot.view.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[HM];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:i,to:r}=e,s=Math.min(i.row,r.row),a=Math.max(i.row,r.row);return ke(s,a,u=>{n.push(u)}),n}refreshPositions(){const e=et(wr,this).coords,n=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,a=et(wr,this).TD,u=this.hot.rootElement,h=Ci(u),d=ef(u),g=s.holder.scrollTop,p=this.hot.rootWindow!==d?d.scrollTop:0,w=h.top-p,y=et(wr,this).eventPageY-w+g,S=s.hider.offsetHeight,_=s.TBODY.offsetTop,E=et(Zi,this).getOffset().top,H=et(Zi,this).getSize().height,x=a.offsetHeight/2,D=a.offsetHeight;let $=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const V=y>=$+x;this.isFixedRowTop(e.row)&&($+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?et(wr,this).row=n>0?n-1:n:V?(et(wr,this).row=e.row+1,$+=e.row===0?D-1:D):et(wr,this).row=e.row;let L=y,U=$;y+H+E>=S?L=S-H-E:y+E<_&&(L=_+Math.abs(E)),$>=S-1&&(U=S-1),et(Zi,this).setPosition(L),et(tu,this).setPosition(U)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Jl(yc,this,kpe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Jl(yc,this,$pe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){et(Zi,this).build(),et(tu,this).build()}destroy(){et(Zi,this).destroy(),et(tu,this).destroy(),super.destroy()}}function Lpe(t,e,n,i){const{wtTable:r,wtViewport:s}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),u=this.hot.getSelectedRangeLast();if(!u||!a||et(lu,this)||t.button!==0){Fc(lu,this,!1),et(Xa,this).length=0,je(this.hot.rootElement,[J1,UC]);return}const h=et(tu,this).isBuilt()&&!et(tu,this).isAppended(),d=et(Zi,this).isBuilt()&&!et(Zi,this).isAppended();h&&d&&(et(tu,this).appendTo(r.hider),et(Zi,this).appendTo(r.hider));const{from:g,to:p}=u,w=Math.min(g.row,p.row),y=Math.max(g.row,p.row);if(e.col<0&&e.row>=w&&e.row<=y){i.row=!0,Fc(lu,this,!0),et(wr,this).eventPageY=t.pageY,et(wr,this).coords=e,et(wr,this).TD=n,Fc(Xa,this,this.prepareRowsToMoving());const S=r.holder.scrollLeft+s.getRowHeaderWidth(),_=this.getRowsHeight(w,e.row-1)+(t.clientY-n.getBoundingClientRect().top);et(Zi,this).setPosition(null,S),et(Zi,this).setSize(r.hider.offsetWidth-S,this.getRowsHeight(w,y)),et(Zi,this).setOffset(-_,null),fe(this.hot.rootElement,J1),this.refreshPositions()}else je(this.hot.rootElement,eO),Fc(lu,this,!1),et(Xa,this).length=0}function kpe(t){et(lu,this)&&(et(wr,this).eventPageY=t.pageY,this.refreshPositions())}function Vpe(t,e,n,i){!this.hot.getSelectedRangeLast()||!et(lu,this)||(et(Xa,this).indexOf(e.row)>-1?je(this.hot.rootElement,UC):fe(this.hot.rootElement,UC),i.row=!0,i.column=!0,i.cell=!0,et(wr,this).coords=e,et(wr,this).TD=n)}function $pe(){const t=et(wr,this).row,e=et(Xa,this).length;if(Fc(lu,this,!1),je(this.hot.rootElement,[J1,UC,eO]),this.hot.selection.isSelectedByRowHeader()&&fe(this.hot.rootElement,eO),e<1||t===void 0)return;const n=et(Xa,this)[0],i=this.hot.toPhysicalRow(n),r=this.dragRows(et(Xa,this),t);if(et(Xa,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(i),a=s+e-1;this.hot.selectRows(s,a)}}function Fpe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,i=e+n;et(Zi,this).setPosition(null,i),et(Zi,this).setSize(t.hider.offsetWidth-i)}function Bpe(){this.moveBySettingsOrLoad()}function Wpe(t,e){zG(t,e),e.add(t)}function Ni(t,e,n){zG(t,e),e.set(t,n)}function zG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tn(t,e,n){return t.set(Ba(t,e),n),n}function Me(t,e){return t.get(Ba(t,e))}function Ba(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jC="manualRowResize",Upe=30,kW="manualRowHeights";var Do=new WeakMap,py=new WeakMap,Fr=new WeakMap,jm=new WeakMap,nu=new WeakMap,HH=new WeakMap,Zd=new WeakMap,vy=new WeakMap,Gi=new WeakMap,Po=new WeakMap,Qc=new WeakMap,zC=new WeakMap,zm=new WeakMap,Ym=new WeakMap,qs=new WeakMap,Gm=new WeakMap,jl=new WeakSet;class jpe extends Ht{static get PLUGIN_KEY(){return jC}static get PLUGIN_PRIORITY(){return Upe}constructor(e){super(e),Wpe(this,jl),Ni(this,Do,null),Ni(this,py,null),Ni(this,Fr,[]),Ni(this,jm,null),Ni(this,nu,null),Ni(this,HH,null),Ni(this,Zd,null),Ni(this,vy,null),Ni(this,Gi,this.hot.rootDocument.createElement("DIV")),Ni(this,Po,this.hot.rootDocument.createElement("DIV")),Ni(this,Qc,!1),Ni(this,zC,!1),Ni(this,zm,0),Ni(this,Ym,null),Ni(this,qs,void 0),Ni(this,Gm,void 0),fe(Me(Gi,this),"manualRowResizer"),fe(Me(Po,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[jC]}enablePlugin(){this.enabled||(Tn(qs,this,new yu),Me(qs,this).addLocalHook("init",()=>Ba(jl,this,Zpe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Me(qs,this)),this.addHook("modifyRowHeight",(e,n)=>Ba(jl,this,Xpe).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Tn(Gm,this,Me(qs,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",kW,Me(qs,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",kW,e),e.value}setManualSize(e,n){const i=this.hot.toPhysicalRow(e),r=Math.max(n,this.hot.view.getDefaultRowHeight());return Me(qs,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return Me(jm,this)}setupHandlePosition(e){Tn(Do,this,e);const{view:n}=this.hot,{_wt:i}=n,r=i.wtTable.getCoords(Me(Do,this)),s=r.row;if(s<0)return;const a=jn(Me(Do,this)),u=Me(Do,this).getBoundingClientRect(),h=s<i.getSetting("fixedRowsTop"),d=s>=n.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let g;h?g=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Me(Do,this),r.row,r.col):d&&(g=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Me(Do,this),r.row,r.col)),g||(g=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Me(Do,this),r.row,r.col)),Tn(py,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Tn(Fr,this,[]);const p=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&p){const w=this.hot.getSelectedRange();W(w,y=>{const S=y.getTopStartCorner().row,_=y.getBottomStartCorner().row;ke(S,_,E=>{Me(Fr,this).includes(E)||Me(Fr,this).push(E)})})}Me(Fr,this).includes(Me(py,this))||Tn(Fr,this,[Me(py,this)]),Tn(vy,this,g.top-6),Tn(Zd,this,parseInt(u.height,10)),Me(Gi,this).style.top=`${Me(vy,this)+Me(Zd,this)}px`,Me(Gi,this).style[this.inlineDir]=`${g.start}px`,Me(Gi,this).style.width=`${a}px`,this.hot.rootElement.appendChild(Me(Gi,this))}refreshHandlePosition(){Me(Gi,this).style.top=`${Me(vy,this)+Me(jm,this)}px`}setupGuidePosition(){const e=parseInt(jn(Me(Gi,this)),10),n=parseInt(Me(Gi,this).style[this.inlineDir],10)+e,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);fe(Me(Gi,this),"active"),fe(Me(Po,this),"active"),Me(Po,this).style.top=Me(Gi,this).style.top,Me(Po,this).style[this.inlineDir]=`${n}px`,Me(Po,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(Me(Po,this))}refreshGuidePosition(){Me(Po,this).style.top=Me(Gi,this).style.top}hideHandleAndGuide(){je(Me(Gi,this),"active"),je(Me(Po,this),"active")}checkIfRowHeader(e){const n=jc(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&Me(nu,this)<n?n:Me(nu,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);s!==void 0&&Tn(nu,this,s),this.setManualSize(i,Me(nu,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};Me(zm,this)>=2&&(Me(Fr,this).length>1?(W(Me(Fr,this),r=>{n(r)}),e()):W(Me(Fr,this),r=>{n(r,!0)})),Tn(zm,this,0),Tn(Ym,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>Ba(jl,this,zpe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Ba(jl,this,Ype).call(this,i)),this.eventManager.addEventListener(n,"mousemove",i=>Ba(jl,this,Gpe).call(this,i)),this.eventManager.addEventListener(n,"mouseup",()=>Ba(jl,this,qpe).call(this)),this.eventManager.addEventListener(Me(Gi,this),"contextmenu",()=>Ba(jl,this,Kpe).call(this))}destroy(){super.destroy()}}function zpe(t){if(!v2(t.target)&&Me(zC,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(Me(Qc,this)||this.setupHandlePosition(e))}}function Ype(t){ze(t.target,"manualRowResizer")&&(this.setupHandlePosition(Me(Do,this)),this.setupGuidePosition(),Tn(Qc,this,!0),Me(Ym,this)===null&&(Tn(Ym,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Me(Ym,this))),Tn(zm,this,Me(zm,this)+1),Tn(HH,this,t.pageY),Tn(nu,this,Me(Zd,this)))}function Gpe(t){Me(Qc,this)&&(Tn(jm,this,Me(Zd,this)+(t.pageY-Me(HH,this))),W(Me(Fr,this),e=>{Tn(nu,this,this.setManualSize(e,Me(jm,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function qpe(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};Me(Qc,this)&&(this.hideHandleAndGuide(),Tn(Qc,this,!1),Me(nu,this)!==Me(Zd,this)&&(Me(Fr,this).length>1?(W(Me(Fr,this),i=>{e(i)}),t()):W(Me(Fr,this),i=>{e(i,!0)})),this.setupHandlePosition(Me(Do,this)))}function Kpe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Me(Gi,this)),this.hot.rootElement.removeChild(Me(Po,this)),Tn(Qc,this,!1),Tn(zC,this,!0),this.hot._registerImmediate(()=>{Tn(zC,this,!1)})}function Xpe(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),r=Me(qs,this).getValueAtIndex(i);this.hot.getSettings()[jC]&&r&&(n=r)}return n}function Zpe(){const t=this.hot.getSettings()[jC],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,i)=>{Me(qs,this).setValueAtIndex(i,n)}):Array.isArray(t)?(t.forEach((n,i)=>{Me(qs,this).setValueAtIndex(i,n)}),Tn(Gm,this,t)):t===!0&&Array.isArray(Me(Gm,this))&&Me(Gm,this).forEach((n,i)=>{Me(qs,this).setValueAtIndex(i,n)})},!0)}var VW={},$W;function Qpe(){if($W)return VW;$W=1;var t=ES();return t("flatMap"),VW}Qpe();var FW={},BW={},PM,WW;function Jpe(){if(WW)return PM;WW=1;var t=Fi(),e=ii(),n=Xo(),i=vO();return PM=function(r,s){(!s||typeof r!="string")&&e(r);var a=i(r);return n(e(a!==void 0?t(a,r):r))},PM}var UW;function eve(){if(UW)return BW;UW=1;var t=en(),e=Fi(),n=Cr(),i=ii(),r=Xo(),s=Jpe(),a=pO(),u=hf(),h=mu(),d=a(function(){for(var g=this.iterator,p=this.mapper,w,y;;){if(y=this.inner)try{if(w=i(e(y.next,y.iterator)),!w.done)return w.value;this.inner=null}catch(S){u(g,"throw",S)}if(w=i(e(this.next,g)),this.done=!!w.done)return;try{this.inner=s(p(w.value,this.counter++),!1)}catch(S){u(g,"throw",S)}}});return t({target:"Iterator",proto:!0,real:!0,forced:h},{flatMap:function(p){return i(this),n(p),new d(r(this),{mapper:p,inner:null})}}),BW}var jW;function tve(){return jW||(jW=1,eve()),FW}tve();function nve(t,e,n){ive(t,e),e.set(t,n)}function ive(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cc(t,e,n){return(e=rve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rve(t){var e=sve(t,"string");return typeof e=="symbol"?e:e+""}function sve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zW(t,e){return t.get(YG(t,e))}function wy(t,e,n){return t.set(YG(t,e),n),n}function YG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sc=new WeakMap;class Lo{constructor(e,n,i,r,s,a){Cc(this,"row",void 0),Cc(this,"col",void 0),Cc(this,"rowspan",void 0),Cc(this,"colspan",void 0),Cc(this,"removed",!1),Cc(this,"cellCoordsFactory",void 0),Cc(this,"cellRangeFactory",void 0),nve(this,Sc,null),this.row=e,this.col=n,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=s,this.cellRangeFactory=a}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:i,rowspan:r,colspan:s}=e;return $t`The merged cell declared with {row: ${n}, col: ${i},\x20
      rowspan: ${r}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:i}=e;return $t`The merged cell declared at [${n}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:i}=e;return $t`The merged cell declared at [${n}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:i}=e;return $t`The merged cell declared at [${n}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:i,rowspan:r,colspan:s}=e;return n<0||i<0||r<0||s<0}static isSingleCell(e){let{rowspan:n,colspan:i}=e;return i===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:i}=e;return i===0||n===0}static isOutOfBounds(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),wy(Sc,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const i=e[0]||e[1],r=n+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",a=e[0]?"col":"row",u=Math.min(n,r),h=Math.max(n,r),d=this[a],g=this[a]+this[s]-1;if(d>=n&&(this[a]+=i),i>0)n<=g&&n>d&&(this[s]+=i);else if(i<0){if(u<=d&&h>=g)return this.removed=!0,wy(Sc,this,null),!1;if(d>=u&&d<=h){const p=h-d+1,w=Math.abs(i)-p;this[a]-=w+i,this[s]-=p}else if(d<=u&&g>=h)this[s]+=i;else if(d<=u&&g>=u&&g<h){const p=g-u+1;this[s]-=p}}return wy(Sc,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return zW(Sc,this)||wy(Sc,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),zW(Sc,this)}}function ove(t,e){ave(t,e),e.add(t)}function ave(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yy(t,e,n){return(e=lve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lve(t){var e=uve(t,"string");return typeof e=="symbol"?e:e+""}function uve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zl=new WeakSet;class YC{constructor(e){ove(this,zl),yy(this,"plugin",void 0),yy(this,"mergedCells",[]),yy(this,"mergedCellsMatrix",new Map),yy(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:i}=e;return $t`The merged cell declared at [${n}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(n))!==null&&i!==void 0?i:!1}getByRange(e){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),a=this.mergedCells.length;let u=!1;for(let h=0;h<a;h++){const d=this.mergedCells[h],{row:g,col:p,rowspan:w,colspan:y}=d;if(g>=n&&g+w-1<=r&&p>=i&&p+y-1<=s){u=d;break}}return u}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(r=>{const{row:s,col:a,colspan:u,rowspan:h}=r;for(let d=s;d<s+h;d++)for(let g=a;g<a+u;g++)n.add(`r${d},c${g}`)}),e.filter(r=>{const{row:s,col:a,colspan:u,rowspan:h}=r,d=new Set;let g=!1;for(let p=s;p<s+h;p++){for(let w=a;w<a+u;w++){const y=`r${p},c${w}`;if(n.has(y)){Nt(YC.IS_OVERLAPPING_WARNING(r)),g=!0;break}d.add(y)}if(g)break}return g||n.add(...d),!g})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:r}=e.getTopStartCorner(),{row:s,col:a}=e.getBottomEndCorner(),u=[];for(let h=i;h<=s;h++)for(let d=r;d<=a;d++){const g=this.get(h,d);g&&(n||!n&&g.row===h&&g.col===d)&&u.push(g)}return u}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,r=e.col,s=e.rowspan,a=e.colspan,u=new Lo(i,r,s,a,this.hot._createCellCoords,this.hot._createCellRange),h=this.get(i,r),d=n?!1:this.isOverlapping(u);return!h&&!d?(this.hot&&u.normalize(this.hot),this.mergedCells.push(u),bc(zl,this,YW).call(this,u),u):(d&&Nt(YC.IS_OVERLAPPING_WARNING(u)),!1)}remove(e,n){const i=this.get(e,n),r=i?this.mergedCells.indexOf(i):-1;return i&&r!==-1?(this.mergedCells.splice(r,1),bc(zl,this,cve).call(this,i),i):!1}clear(){W(this.mergedCells,e=>{let{row:n,col:i,rowspan:r,colspan:s}=e;ke(n,n+r,a=>{ke(i,i+s,u=>{const h=this.hot.getCell(a,u);h&&(h.removeAttribute("rowspan"),h.removeAttribute("colspan"),h.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const i=this.get(e,n);if(!i)return!1;const{row:r,col:s,rowspan:a,colspan:u}=i,h=this.hot.view.getActiveOverlayName(),d=["top","top_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleRow(),g=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleColumn(),p=_t(d,r,r+a-1),w=_t(g,s,s+u-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(p,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(w,1)===n}getFirstRenderableCoords(e,n){const i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,s)}getStartMostColumnIndex(e,n){const i=bc(zl,this,Cy).call(this,e,"col",-1);let r=n;for(let s=0;s<i.length;s++)if(i[s]<=n){r=i[s];break}return r}getEndMostColumnIndex(e,n){const i=bc(zl,this,Cy).call(this,e,"col",1);let r=n;for(let s=0;s<i.length;s++)if(i[s]>=n){r=i[s];break}return r}getTopMostRowIndex(e,n){const i=bc(zl,this,Cy).call(this,e,"row",-1);let r=n;for(let s=0;s<i.length;s++)if(i[s]<=n){r=i[s];break}return r}getBottomMostRowIndex(e,n){const i=bc(zl,this,Cy).call(this,e,"row",1);let r=n;for(let s=0;s<i.length;s++)if(i[s]>=n){r=i[s];break}return r}shiftCollections(e,n,i){const r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i;break}const s=[];this.mergedCells.forEach(a=>{a.shift(r,n),a.removed&&s.push(a)}),s.forEach(a=>{this.mergedCells.splice(this.mergedCells.indexOf(a),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(a=>{bc(zl,this,YW).call(this,a)})}}function Cy(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,r=n===1?t.getTopStartCorner():t.getBottomEndCorner(),s=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let a=r.row;n===1?a<=s.row:a>=s.row;a+=n)for(let u=r.col;n===1?u<=s.col:u>=s.col;u+=n){const h=e==="row"?a:u,d=this.get(a,u);let g=h;d&&(g=n===1?d[e]+d[`${e}span`]-1:d[e]),i.has(h)||i.set(h,new Set),i.get(h).add(g)}return Array.from(new Set(Array.from(i.entries()).filter(a=>{let[,u]=a;return u.size===1}).flatMap(a=>{let[,u]=a;return Array.from(u)})))}function YW(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function cve(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function IM(t,e,n){return(e=hve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hve(t){var e=dve(t,"string");return typeof e=="symbol"?e:e+""}function dve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fve{constructor(e){IM(this,"plugin",void 0),IM(this,"mergedCellsCollection",void 0),IM(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}snapDragArea(e,n,i,r){const s=n.slice(0),a=this.getAutofillSize(e,n,i),[u,h,d,g]=e,w=["up","down"].indexOf(i)>-1?d-u+1:g-h+1,y=Math.floor(a/w)*w,S=a-y,_=this.getFarthestCollection(e,n,i,r);if(_){if(i==="down"){const E=_.row+_.rowspan-u-S;s[2]+E>=this.plugin.hot.countRows()?s[2]-=S:s[2]+=S?E:0}else if(i==="right"){const E=_.col+_.colspan-h-S;s[3]+E>=this.plugin.hot.countCols()?s[3]-=S:s[3]+=S?E:0}else if(i==="up"){const E=d-S-_.row+1;s[0]+E<0?s[0]+=S:s[0]-=S?E:0}else if(i==="left"){const E=g-S-_.col+1;s[1]+E<0?s[1]+=S:s[1]-=S?E:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:a,dragArea:s,cycleLength:w}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),ti(this.currentFillData,e)}getAutofillSize(e,n,i){const[r,s,a,u]=e,[h,d,g,p]=n;switch(i){case"up":return r-h;case"down":return g-a;case"left":return s-d;case"right":return p-u;default:return null}}getDragArea(e,n,i){const[r,s,a,u]=e,[h,d,g,p]=n;switch(i){case"up":return[h,d,r-1,u];case"down":{const w=this.mergedCellsCollection.get(g,u),y=w?w.rowspan-1:0;return[a+1,s,g+y,u]}case"left":return[h,d,a,s-1];case"right":{const w=this.mergedCellsCollection.get(g,u),y=w?w.colspan-1:0;return[r,u+y,g,p]}default:return null}}getFarthestCollection(e,n,i,r){const[s,a,u,h]=e,d=["up","down"].indexOf(i)>-1,g=d?u:h,p=d?s:a,w=this.getAutofillSize(e,n,i),y=d?u-s+1:h-a+1,S=Math.floor(w/y)*y,_=w-S;let E=null,H=null,x=null;switch(i){case"up":E="includesVertically",x=g-_+1;break;case"left":E="includesHorizontally",x=g-_+1;break;case"down":E="includesVertically",x=p+_-1;break;case"right":E="includesHorizontally",x=p+_-1;break}return W(r,D=>{D[E](x)&&D.isFarther(H,i)&&(H=D)}),H}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,s=(d,g)=>{switch(r){case"up":return d.row-g>=n.from.row;case"down":return d.row+d.rowspan-1+g<=n.to.row;case"left":return d.col-g>=n.from.column;case"right":return d.col+d.colspan-1+g<=n.to.column;default:return null}};let a=0,u=null,h=1;do for(let d=0;d<i.length;d+=1){if(u=i[d],a=h*this.currentFillData.cycleLength,s(u,a))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:u.row-a,rowspan:u.rowspan,col:u.col,colspan:u.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:u.row+a,rowspan:u.rowspan,col:u.col,colspan:u.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:u.row,rowspan:u.rowspan,col:u.col-a,colspan:u.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:u.row,rowspan:u.rowspan,col:u.col+a,colspan:u.colspan},!0);break}d===i.length-1&&(h+=1)}while(s(u,a));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},i={min:null,max:null};return W(e,r=>{const s=r[0],a=this.plugin.hot.propToCol(r[1]);(n.min===null||s<n.min)&&(n.min=s),(n.max===null||s>n.max)&&(n.max=s),(i.min===null||a<i.min)&&(i.min=a),(i.max===null||a>i.max)&&(i.max=a)}),{from:{row:n.min,column:i.min},to:{row:n.max,column:i.max}}}dragAreaOverlapsCollections(e,n,i){const r=this.getDragArea(e,n,i),[s,a,u,h]=r,d=this.plugin.hot._createCellCoords(s,a),g=this.plugin.hot._createCellCoords(u,h),p=this.plugin.hot._createCellRange(d,d,g);if(this.mergedCellsCollection.getWithinRange(p,!0).length===0)return!1;const y=this.mergedCellsCollection.getWithinRange(p,!1);return y.length===0?!0:i==="up"||i==="down"?!y.every(S=>{let{colspan:_}=S;return _===p.getWidth()}):!y.every(S=>{let{rowspan:_}=S;return _===p.getHeight()})}}function NM(t,e,n){return(e=gve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gve(t){var e=mve(t,"string");return typeof e=="symbol"?e:e+""}function mve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pve{constructor(e){NM(this,"plugin",void 0),NM(this,"hot",void 0),NM(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,i,r){const s=Math.min(i[0],i[2]),a=Math.min(i[1],i[3]),u=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const g=this.plugin.mergedCellsCollection.get(e,n);if(!g)return;const p=g.getLastRow(),w=g.getLastColumn();if(s<=g.row&&a<=g.col&&u>=p&&h>=w)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(g,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const i=[];if(!n||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let s=0;s<e.colspan;s+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+s));for(let r=0;r<i.length;r+=1){const s=[];for(let a=0;a<n.length;a+=1)s[a]=n[a].includes(i[r]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function vve(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(WA)}return this.getTranslatedPhrase(BA)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?Lo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function qm(t,e,n){return(e=wve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wve(t){var e=yve(t,"string");return typeof e=="symbol"?e:e+""}function yve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GW{constructor(e){qm(this,"data",void 0),qm(this,"next",null),qm(this,"prev",null),this.data=e}}class Sy{constructor(){qm(this,"first",null),qm(this,"last",null)}push(e){const n=new GW(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.last;this.last=n,n.prev=i,i.next=n}return n}unshift(e){const n=new GW(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.first;this.first=n,n.next=i,i.prev=n}}inorder(e){let n=this.first;for(;n;){const i=e(n);if(n===this.last||i===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,i,r;for(;n;){if(n.data===e)return i=n.next,r=n.prev,i&&(i.prev=r),r&&(r.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){r&&(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,i;for(;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}function Cve(t,e){GG(t,e),e.add(t)}function Rc(t,e,n){GG(t,e),e.set(t,n)}function GG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){return t.get(GC(t,e))}function Pr(t,e,n){return t.set(GC(t,e),n),n}function GC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var To=new WeakMap,_o=new WeakMap,Mo=new WeakMap,Oo=new WeakMap,tO=new WeakMap,by=new WeakMap,Ry=new WeakMap,DM=new WeakSet;class Sve{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:i,columnIndexMapper:r}=e;Cve(this,DM),Rc(this,To,new Sy),Rc(this,_o,new Sy),Rc(this,Mo,null),Rc(this,Oo,null),Rc(this,tO,null),Rc(this,by,null),Rc(this,Ry,null),Pr(tO,this,n),Pr(by,this,i),Pr(Ry,this,r)}getCurrentVerticalNode(){return kt(Oo,this).data}getFirstVerticalNode(){return kt(_o,this).first.data}getNextVerticalNode(){return kt(Oo,this).next.data}getPrevVerticalNode(){return kt(Oo,this).prev.data}getCurrentHorizontalNode(){return kt(Mo,this).data}getFirstHorizontalNode(){return kt(To,this).first.data}getNextHorizontalNode(){return kt(Mo,this).next.data}getPrevHorizontalNode(){return kt(Mo,this).prev.data}setPrevNodeAsActive(){Pr(Oo,this,kt(Oo,this).prev),Pr(Mo,this,kt(Mo,this).prev)}setNextNodeAsActive(){Pr(Oo,this,kt(Oo,this).next),Pr(Mo,this,kt(Mo,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),i=e.getBottomEndCorner(),r=new WeakSet;Pr(To,this,new Sy);for(let a=n.row;a<=i.row;a++)if(!kt(by,this).isHidden(a))for(let u=n.col;u<=i.col;u++){if(kt(Ry,this).isHidden(u))continue;const h=GC(DM,this,qW).call(this,e,kt(To,this),r,a,u);h&&Pr(Mo,this,h)}kt(To,this).first&&(kt(To,this).first.prev=kt(To,this).last,kt(To,this).last.next=kt(To,this).first);const s=new WeakSet;Pr(_o,this,new Sy);for(let a=n.col;a<=i.col;a++)if(!kt(Ry,this).isHidden(a))for(let u=n.row;u<=i.row;u++){if(kt(by,this).isHidden(u))continue;const h=GC(DM,this,qW).call(this,e,kt(_o,this),s,u,a);h&&Pr(Oo,this,h)}kt(_o,this).first&&(kt(_o,this).first.prev=kt(_o,this).last,kt(_o,this).last.next=kt(_o,this).first)}setActiveNode(e,n){return kt(To,this).inorder(i=>{const{rowStart:r,rowEnd:s,colStart:a,colEnd:u}=i.data;if(e>=r&&e<=s&&n>=a&&n<=u)return Pr(Mo,this,i),!1}),kt(_o,this).inorder(i=>{const{rowStart:r,rowEnd:s,colStart:a,colEnd:u}=i.data;if(e>=r&&e<=s&&n>=a&&n<=u)return Pr(Oo,this,i),!1}),this}}function qW(t,e,n,i,r){const s=t.getTopStartCorner(),a=t.getBottomEndCorner(),u=t.highlight.clone().normalize(),h=kt(tO,this).call(this,i,r);if(h&&n.has(h))return null;const d={colStart:r,colEnd:r,rowStart:i,rowEnd:i};if(h){if(n.add(h),h.row<s.row||h.row+h.rowspan-1>a.row||h.col<s.col||h.col+h.colspan-1>a.col)return null;d.colStart=h.col,d.colEnd=h.col+h.colspan-1,d.rowStart=h.row,d.rowEnd=h.row+h.rowspan-1}const g=e.push(d);return i===u.row&&r===u.col||h&&u.row>=h.row&&u.row<=h.row+h.rowspan-1&&u.col>=h.col&&u.col<=h.col+h.colspan-1?g:null}function bve(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e;function r(){}function s(a,u,h){const d=t.mergedCellsCollection.get(u,h);if(!ht(d)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="";return}const{row:g,col:p,colspan:w,rowspan:y}=d,[S,_]=t.translateMergedCellToRenderable(g,y,p,w),E=t.getSetting("virtualized"),H=n.getRenderableFromVisualIndex(u),x=i.getRenderableFromVisualIndex(h),D=S-H+1,$=_-x+1;let V=n.getNearestNotHiddenIndex(g,1),L=i.getNearestNotHiddenIndex(p,1);if(E){const se=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(se)||(V=Math.max(V,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(se)||(L=Math.max(L,e.getFirstRenderedVisibleColumn()))}const U=Math.min(y,D),re=Math.min(w,$);V===u&&L===h?(a.setAttribute("rowspan",U),a.setAttribute("colspan",re)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:r,after:s}}function Rve(t,e){qG(t,e),e.add(t)}function Ey(t,e,n){qG(t,e),e.set(t,n)}function qG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LM(t,e,n){return(e=Eve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eve(t){var e=Tve(t,"string");return typeof e=="symbol"?e:e+""}function Tve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gp(t,e,n){return t.set(Vt(t,e),n),n}function Jt(t,e){return t.get(Vt(t,e))}function Vt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Ae.getSingleton().register("beforeMergeCells");Ae.getSingleton().register("afterMergeCells");Ae.getSingleton().register("beforeUnmergeCells");Ae.getSingleton().register("afterUnmergeCells");const nO="mergeCells",_ve=150,KW=nO;var ws=new WeakMap,ys=new WeakMap,Uo=new WeakMap,XW=new WeakMap,Bt=new WeakSet;class Mve extends Ht{constructor(){super(...arguments),Rve(this,Bt),LM(this,"mergedCellsCollection",null),LM(this,"autofillCalculations",null),LM(this,"selectionCalculations",null),Ey(this,ws,null),Ey(this,ys,{row:0,col:0}),Ey(this,Uo,new Sve({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Ey(this,XW,bve(this))}static get PLUGIN_KEY(){return nO}static get PLUGIN_PRIORITY(){return _ve}static get DEFAULT_SETTINGS(){return{[vY]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[nO]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new YC(this),this.autofillCalculations=new fve(this),this.selectionCalculations=new pve(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Ove).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,xve).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Hve).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Pve).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Ive).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,QW).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,QW).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Dve).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Lve).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,kve).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,ZW).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,ZW).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Ave).call(e,...i)}),this.addHook("afterRenderer",function(){return Jt(XW,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Nve).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Vve).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,$ve).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Fve).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Bve).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Wve).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Uve).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,jve).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,zve).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Yve).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Gve).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,qve).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Kve).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Xve).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Vt(Bt,e,Zve).call(e,...i)}),this.addHook("beforeUndoStackChange",(n,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!b2())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:s}=i;for(let a=r+1;a<r+s;a++)n.push(a)}),n=[...new Set(n)],n.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const a=s.getRow(r);a&&(a.style.background=mC(a,"backgroundColor").replace(")",", 0.99)"),e.push(a))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{i.style.background=mC(i,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?Lo.containsNegativeValues(e)?(Nt(Lo.NEGATIVE_VALUES_WARNING(e)),!1):Lo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Nt(Lo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Lo.isSingleCell(e)?(Nt(Lo.IS_SINGLE_CELL(e)),!1):Lo.containsZeroSpan(e)?(Nt(Lo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(r=>this.validateSetting(r)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];n.forEach(r=>{const{row:s,col:a,rowspan:u,colspan:h}=r,d=this.hot._createCellCoords(s,a),g=this.hot._createCellCoords(s+u-1,a+h-1),p=this.hot._createCellRange(d,d,g);this.mergeRange(p,!0,!0);for(let w=s;w<s+u;w++)for(let y=a;y<a+h;y++)(w!==s||y!==a)&&i.push([w,y,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),s=e.getBottomEndCorner(),a={row:r.row,col:r.col,rowspan:s.row-r.row+1,colspan:s.col-r.col+1},u=[];let h=null;return this.canMergeRange(a,n)?(this.hot.runHooks("beforeMergeCells",e,n),ke(0,a.rowspan-1,g=>{ke(0,a.colspan-1,p=>{let w=null;u[g]||(u[g]=[]),g===0&&p===0?w=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a.row),this.hot.toPhysicalColumn(a.col)):this.hot.setCellMeta(a.row+g,a.col+p,"hidden",!0),u[g][p]=w})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),this.mergedCellsCollection.add(a,n)?(i?h=[a.row,a.col,u]:this.hot.populateFromArray(a.row,a.col,u,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,a,n),h):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),W(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),ke(0,r.rowspan-1,s=>{ke(0,r.colspan-1,a=>{this.hot.removeCellMeta(r.row+s,r.col+a,"hidden"),this.hot.removeCellMeta(r.row+s,r.col+a,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,i,r){const s=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(s,s,a))}unmerge(e,n,i,r){const s=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(s,s,a))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:KW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(KW)}modifyViewportRowStart(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<n;s+=1){const a=this.mergedCellsCollection.get(r,s);if(ht(a)){const u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a.row,1));if(u<e.startRow){e.startRow=u,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<n;s+=1){const a=this.mergedCellsCollection.get(r,s);if(ht(a)){const u=a.row+a.rowspan-1,h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(u,-1));if(h>e.endRow){e.endRow=h,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<n;s+=1){const a=this.mergedCellsCollection.get(s,r);if(ht(a)){const u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a.col,1));if(u<e.startColumn){e.startColumn=u,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<n;s+=1){const a=this.mergedCellsCollection.get(s,r);if(ht(a)){const u=a.col+a.colspan-1,h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(u,-1));if(h>e.endColumn){e.endColumn=h,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,i,r){const{rowIndexMapper:s,columnIndexMapper:a}=this.hot;let u,h;n===0?u=s.getNearestNotHiddenIndex(e,1):u=s.getNearestNotHiddenIndex(e+n-1,-1),r===0?h=a.getNearestNotHiddenIndex(i,1):h=a.getNearestNotHiddenIndex(i+r-1,-1);const d=e>=0?s.getRenderableFromVisualIndex(u):e,g=i>=0?a.getRenderableFromVisualIndex(h):i;return[d,g]}}function Ove(){this.generateFromSettings(),this.hot.render()}function Ave(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),i=n.getTopStartCorner(),r=n.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(i.row===e[s].row&&i.col===e[s].col&&r.row===e[s].row+e[s].rowspan-1&&r.col===e[s].col+e[s].colspan-1)return!1}return t}function xve(t){Jt(ys,this).row=t.row,Jt(ys,this).col=t.col}function Hve(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot;Jt(ws,this)&&(r.getRenderableFromVisualIndex(Jt(ws,this).row)!==null&&(n.row=Jt(ws,this).row),i.getRenderableFromVisualIndex(Jt(ws,this).col)!==null&&(n.col=Jt(ws,this).col),gp(ws,this,null));const s=this.mergedCellsCollection.get(n.row,n.col);if(!s)return;const a=s.col,u=s.col+s.colspan-1;if(t.col<0){const g=n.col>=a&&n.col<=u?a-1:u,p=i.getNearestNotHiddenIndex(g,-1);p===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(p,n.col)-1,1)}else if(t.col>0){const g=n.col>=a&&n.col<=u?u+1:a,p=i.getNearestNotHiddenIndex(g,1);p===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,p)-1,1)}const h=s.row,d=s.row+s.rowspan-1;if(t.row<0){const g=n.row>=h&&n.row<=d?h-1:d,p=r.getNearestNotHiddenIndex(g,-1);p===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(p,n.row)-1,1)}else if(t.row>0){const g=n.row>=h&&n.row<=d?d+1:h,p=r.getNearestNotHiddenIndex(g,1);p===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,p)-1,1)}}function Pve(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:i}=e,{columnIndexMapper:r,rowIndexMapper:s}=this.hot,a=(u,h)=>{n.expand(this.hot._createCellCoords(u,h));for(let d=0;d<this.mergedCellsCollection.mergedCells.length;d+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[d].getRange())};if(t.col<0){let u=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;a(i.row,u),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(u=n.getTopStartCorner().col);const h=r.getNearestNotHiddenIndex(u,1);h!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,i.col)-1,1))}else if(t.col>0){let u=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;a(i.row,u),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(u=n.getBottomEndCorner().col);const h=r.getNearestNotHiddenIndex(u,-1);h!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,h)-1,1))}if(t.row<0){let u=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;a(u,i.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(u=n.getTopStartCorner().row);const h=s.getNearestNotHiddenIndex(u,1);h!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,i.row)-1,1))}else if(t.row>0){let u=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;a(u,i.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(u=n.getBottomStartCorner().row);const h=s.getNearestNotHiddenIndex(u,-1);h!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,h)-1,1))}}function Ive(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){gp(ws,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);gp(ws,this,e.clone()),n&&e.assign(n)}function ZW(t,e,n,i){if(t<0||e<0)return;const r=this.mergedCellsCollection.get(t,e);if(!r)return;const{row:s,col:a,colspan:u,rowspan:h}=r,d=s,g=a,p=s+h-1,w=a+u-1;if(i==="render"&&this.getSetting("virtualized")){const y=this.hot.view.getActiveOverlayName(),S=["top","top_inline_start_corner"].includes(y)?0:this.hot.getFirstRenderedVisibleRow(),_=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(y)?0:this.hot.getFirstRenderedVisibleColumn();return[_t(S,d,p),_t(_,g,w),_t(this.hot.getLastRenderedVisibleRow(),d,p),_t(this.hot.getLastRenderedVisibleColumn(),g,w)]}return[d,g,p,w]}function Nve(t){t.items.push({name:"---------"},vve(this))}function QW(){gp(ws,this,null)}function Dve(){if(Jt(ws,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=Jt(ws,this).clone().normalize();Jt(Uo,this).setActiveNode(i.row,i.col),Jt(ys,this).row>0||Jt(ys,this).col>0?Jt(Uo,this).setPrevNodeAsActive():(n==="E-W"&&Jt(ys,this).col<0||e==="S-N"&&Jt(ys,this).row<0)&&Jt(Uo,this).setNextNodeAsActive()}function Lve(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:r}=this.hot;let s=null,a=null;if(Jt(ys,this).col<0){const{rowEnd:u,colEnd:h}=Jt(Uo,this).getPrevHorizontalNode();a=i.getNearestNotHiddenIndex(h,-1),s=r.getNearestNotHiddenIndex(u,-1)}else if(Jt(ys,this).col>0){const{rowStart:u,colStart:h}=Jt(Uo,this).getNextHorizontalNode();a=i.getNearestNotHiddenIndex(h,1),s=r.getNearestNotHiddenIndex(u,1)}else if(Jt(ys,this).row<0){const{rowEnd:u,colEnd:h}=Jt(Uo,this).getPrevVerticalNode();a=i.getNearestNotHiddenIndex(h,-1),s=r.getNearestNotHiddenIndex(u,-1)}else if(Jt(ys,this).row>0){const{rowStart:u,colStart:h}=Jt(Uo,this).getNextVerticalNode();a=i.getNearestNotHiddenIndex(h,1),s=r.getNearestNotHiddenIndex(u,1)}if(s!==null||a!==null){const u=this.hot._createCellCoords(s,a),h=this.mergedCellsCollection.get(u.row,u.col),d=this.hot.selection.highlight.getFocus();t=u.row,e=u.col,h?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(h.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(h.col,1)}):n.highlight.assign(u),d.clear(),d.add(u).commit()}Jt(Uo,this).setActiveNode(t,e),gp(ys,this,{row:0,col:0})}function kve(){this.hot.getSelectedRangeLast().isHeader()||Jt(Uo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Vve(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function $ve(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Fve(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Bve(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const i=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(i,i,r),a=this.mergedCellsCollection.getWithinRange(s);return a.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,a)}function Wve(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Uve(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function jve(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function zve(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Yve(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Gve(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(n);W(i,r=>{n.getBottomEndCorner().row===r.getLastRow()&&n.getBottomEndCorner().col===r.getLastColumn()&&(t[2]=r.row,t[3]=r.col)})}}function qve(t,e,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function Kve(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Xve(t,e,n,i){if(!(i instanceof MouseEvent))return;const r=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(r);if(!s)return;const a=this.hot._createCellCoords(s.row,s.col),u=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&r.isEqual(this.hot._createCellRange(a,a,u))}function Zve(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let i,r;if(n==="master")i=this.hot.getFirstRenderedVisibleColumn(),r=this.hot.getLastRenderedVisibleColumn();else{const w=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(w.clone.wtTable.getFirstRenderedColumn()),r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(w.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const a=this.hot._createCellCoords(e,i),u=this.hot._createCellCoords(e,r),h=this.hot._createCellRange(a,a,u),d=this.mergedCellsCollection.getWithinRange(h,!0),g=d.reduce((w,y)=>{let{rowspan:S}=y;return Math.max(w,S)},1);let p=0;return d.length>1&&d[0].rowspan<g&&(p=g-d[0].rowspan),d.forEach(w=>{let{rowspan:y}=w,S=0;n==="top"||n==="top_inline_start_corner"?S=Math.min(g,this.hot.view.countNotHiddenFixedRowsTop()-e):S=y-p,t=Math.max(t??0,Vt(Bt,this,Qve).call(this,e,S))}),t}function Qve(t,e){const n=this.hot.view.getStylesHandler(),i=this.hot.view.getDefaultRowHeight(),r=this.hot.getPlugin("autoRowSize");let s=0;for(let u=t;u<t+e;u++)if(!this.hot.rowIndexMapper.isHidden(u)){var a;s+=(a=r==null?void 0:r.getRowHeight(u))!==null&&a!==void 0?a:i,u===0&&!n.isClassicTheme()&&(s+=1)}return s}function Jve(t,e){return function(n,i){const[,...r]=n,[,...s]=i;return function a(u){const h=t[u],d=e[u],g=r[u],p=s[u],w=d.multiColumnSorting,S=(w.compareFunctionFactory?w.compareFunctionFactory:TY(d.type))(h,d,w)(g,p);if(S===zo){const _=u+1;if(typeof e[_]<"u")return a(_)}return S}(0)}}function JW(){Nt($t`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const KG="sort";function ewe(t,e,n){const i=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${KG}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function twe(t){const e=t.className.split(" "),n=new RegExp(`^${KG}-[0-9]{1,2}$`);return e.filter(i=>n.test(i))}function nwe(t,e,n){return(e=iwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iwe(t){var e=rwe(t,"string");return typeof e=="symbol"?e:e+""}function rwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qC="multiColumnSorting",swe=170,kM="columnSorting",eU=qC;EY(qC,Jve);class owe extends NY{constructor(){super(...arguments),nwe(this,"pluginKey",qC)}static get PLUGIN_KEY(){return qC}static get PLUGIN_PRIORITY(){return swe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[kM]&&(JW(),this.hot.getPlugin(kM).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,AC)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:Cu,position:"before",group:eU})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eU)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),je(e,twe(e)),this.enabled!==!1&&fe(e,ewe(...i))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[kM]&&JW(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){pH(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,AC))):this.sort(this.getColumnNextConfig(n.col)))}}function tU(t,e,n){return(e=awe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function awe(t){var e=lwe(t,"string");return typeof e=="symbol"?e:e+""}function lwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uwe="multipleSelectionHandles",cwe=160;class hwe extends Ht{constructor(){super(...arguments),tU(this,"dragged",[]),tU(this,"lastSetCell",null)}static get PLUGIN_KEY(){return uwe}static get PLUGIN_PRIORITY(){return cwe}isEnabled(){return Ga()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(r);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",r=>{let s;if(ze(r.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},r.preventDefault(),!1;if(ze(r.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",r=>{if(ze(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(ze(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",r=>{const{rootDocument:s}=this.hot;let a,u,h,d,g,p;if(e.dragged.length===0)return;const w=s.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!w||w===e.lastSetCell||((w.nodeName==="TD"||w.nodeName==="TH")&&(a=e.hot.getCoords(w),a.col===-1&&(a.col=0),u=e.hot.getSelectedRangeLast(),h=u.getWidth(),d=u.getHeight(),g=u.getDirection(),h===1&&d===1&&e.hot.selection.setRangeEnd(a),p=e.getCurrentRangeCoords(u,a,e.touchStartRange.direction,g,e.dragged[0]),p.start!==null&&e.hot.selection.setRangeStart(p.start),e.hot.selection.setRangeEnd(p.end),e.lastSetCell=w),r.preventDefault())})}getCurrentRangeCoords(e,n,i,r,s){const a=e.getTopStartCorner(),u=e.getBottomEndCorner(),h=e.getBottomStartCorner(),d=e.getTopEndCorner();let g={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":s==="top"?g={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(h.row,n.col)}:g={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SE-NW":s==="bottom"&&(g={start:this.hot._createCellCoords(u.row,n.col),end:this.hot._createCellCoords(n.row,a.col)});break}break;case"NW-SE":switch(r){case"NE-SW":s==="top"?g={start:n,end:h}:g.end=n;break;case"NW-SE":s==="top"?g={start:n,end:u}:g.end=n;break;case"SE-NW":s==="top"?g={start:n,end:a}:g.end=n;break;case"SW-NE":s==="top"?g={start:n,end:d}:g.end=n;break}break;case"SW-NE":switch(r){case"NW-SE":s==="bottom"?g={start:this.hot._createCellCoords(n.row,a.col),end:this.hot._createCellCoords(h.row,n.col)}:g={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,u.col)};break;case"SW-NE":s==="top"?g={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,u.col)}:g={start:this.hot._createCellCoords(n.row,a.col),end:this.hot._createCellCoords(a.row,n.col)};break;case"SE-NW":s==="bottom"?g={start:this.hot._createCellCoords(n.row,d.col),end:this.hot._createCellCoords(a.row,n.col)}:s==="top"&&(g={start:h,end:n});break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(g.end=n);break;case"SE-NW":s==="top"?g.end=n:g={start:n,end:a};break}break}return g}isDragged(){return this.dragged.length>0}}function iO(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:r=[],isCollapsed:s=!1,isHidden:a=!1,isRoot:u=!1,isPlaceholder:h=!1,headerClassNames:d=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:s,crossHiddenColumns:r,isHidden:a,isRoot:u,isPlaceholder:h,headerClassNames:d}}function XG(){return{label:"",isPlaceholder:!0}}function dwe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;W(t,r=>{const s=[];let a=0;n.push(s),W(r,u=>{const h=iO();if(ht(u)){const{label:g,colspan:p,headerClassName:w}=u;h.label=zn(g),typeof p=="number"&&p>1&&(h.colspan=p,h.origColspan=p),typeof w=="string"&&(h.headerClassNames=[...w.split(" ")])}else h.label=zn(u);a+=h.origColspan;let d=!1;if(a>=e&&(h.colspan=h.origColspan-(a-e),h.origColspan=h.colspan,d=!0),s.push(h),h.colspan>1)for(let g=0;g<h.colspan-1;g++)s.push(XG());return!d})});const i=Math.max(...Rt(n,r=>r.length));return W(n,r=>{if(r.length<i){const s=Rt(new Array(i-r.length),()=>iO());r.splice(r.length,0,...s)}}),n}function VM(t,e,n){fwe(t,e),e.set(t,n)}function fwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ks(t,e){return t.get(ZG(t,e))}function gm(t,e,n){return t.set(ZG(t,e),n),n}function ZG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nU=["label","collapsible"];var Ha=new WeakMap,Ec=new WeakMap,$M=new WeakMap;class gwe{constructor(){VM(this,Ha,[]),VM(this,Ec,0),VM(this,$M,1/0)}setColumnsLimit(e){gm($M,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];gm(Ha,this,dwe(e,ks($M,this))),gm(Ec,this,ks(Ha,this).length)}getData(){return ks(Ha,this)}mergeWith(e){W(e,n=>{let{row:i,col:r,...s}=n;const a=this.getHeaderSettings(i,r);a!==null&&ti(a,s,nU)})}map(e){W(ks(Ha,this),n=>{W(n,i=>{const r=e({...i});ht(r)&&ti(i,r,nU)})})}getHeaderSettings(e,n){var i;if(e>=ks(Ec,this)||e<0)return null;const r=ks(Ha,this)[e];return Array.isArray(r)===!1||n>=r.length?null:(i=r[n])!==null&&i!==void 0?i:null}getHeadersSettings(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=ks(Ec,this)||e<0)return r;const s=ks(Ha,this)[e];let a=0;for(let u=n;u<s.length;u++){const h=s[u];if(h.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=h.colspan,r.push(h),h.colspan>1&&(u+=h.colspan-1),a===i)break;if(a>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return ks(Ec,this)}getColumnsCount(){return ks(Ec,this)>0?ks(Ha,this)[0].length:0}clear(){gm(Ha,this,[]),gm(Ec,this,0)}}function FM(t,e,n){return(e=mwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mwe(t){var e=pwe(t,"string");return typeof e=="symbol"?e:e+""}function pwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const QG="DF-pre-order";function JG(t,e){let n=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(n===!1)return!1;n=JG.call(this.childs[i],t,e)}return n}const vwe="DF-post-order";function eq(t,e){for(let n=0;n<this.childs.length;n++)if(eq.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const tq="BF";function wwe(t,e){const n=[this];function i(){if(n.length===0)return;const r=n.shift();n.push(...r.childs),t.call(e,r)!==!1&&i()}i()}const ywe=tq,iU=new Map([[QG,JG],[vwe,eq],[tq,wwe]]);class KC{constructor(e){FM(this,"data",{}),FM(this,"parent",null),FM(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new KC({...e.data});for(let i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ywe;if(!iU.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);iU.get(n).call(this,e,this)}walkUp(e){const n=this,i=r=>{e.call(n,r)!==!1&&r.parent!==null&&i(r.parent)};i(this)}}function BM(t,e,n){Cwe(t,e),e.set(t,n)}function Cwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yi(t,e){return t.get(nq(t,e))}function Swe(t,e,n){return t.set(nq(t,e),n),n}function nq(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rd=new WeakMap,Tc=new WeakMap,Ed=new WeakMap;class bwe{constructor(e){BM(this,Rd,new Map),BM(this,Tc,new Map),BM(this,Ed,null),Swe(Ed,this,e)}getRoots(){return Array.from(Yi(Rd,this).values())}getRootByColumn(e){let n;return Yi(Tc,this).has(e)&&(n=Yi(Rd,this).get(Yi(Tc,this).get(e))),n}getNode(e,n){const i=this.getRootByColumn(n);if(!i)return;const r=n-Yi(Tc,this).get(n);let s=0,a;return i.walkDown(u=>{const{data:{origColspan:h,headerLevel:d}}=u;if(e===d){if(r>=s&&r<=s+h-1)return a=u,a.data.isRoot=n===a.data.columnIndex,!1;s+=h}}),a}rebuildTreeIndex(){let e=0;Yi(Tc,this).clear(),W(Yi(Rd,this),n=>{let[,{data:{colspan:i}}]=n;for(let r=e;r<e+i;r++)Yi(Tc,this).set(r,e);e+=i})}buildTree(){this.clear();const e=Yi(Ed,this).getColumnsCount();let n=0;for(;n<e;){const i=Yi(Ed,this).getHeaderSettings(0,n),r=new KC;Yi(Rd,this).set(n,r),this.buildLeaves(r,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Yi(Ed,this).getHeadersSettings(i,n,r);i+=1,W(s,a=>{const u={...a,headerLevel:i-1,columnIndex:n};let h;i===1?(e.data=u,h=e):(h=new KC(u),e.addChild(h)),i<Yi(Ed,this).getLayersCount()&&this.buildLeaves(h,n,i,a.origColspan),n+=a.origColspan})}clear(){Yi(Rd,this).clear(),Yi(Tc,this).clear()}}function iq(t,e){t.walkDown(n=>{let{data:i,childs:r}=n;if(!i.isHidden&&(e(i.columnIndex),r.length===0))for(let s=1;s<i.colspan;s++)e(i.columnIndex+s)})}function XC(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function ZC(t){return XC(t,"origColspan")===t.data.origColspan}function PH(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(ZC(t))return PH(n[0]);e.isCollapsed=!1;const r=n.slice(1),s=new Set;let a=0;if(r.length>0)W(r,u=>{u.replaceTreeWith(u.data.clonedTree),u.data.clonedTree=null;const h=u.data;a+=h.colspan,iq(u,d=>{s.add(d)})});else{const{colspan:u,origColspan:h,columnIndex:d}=e;a=h-u;for(let g=1;g<h;g++)s.add(d+g)}return t.walkUp(u=>{const{data:h}=u;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):ZC(u)&&(h.isCollapsed=XC(u,"isCollapsed"))}),{rollbackModification:()=>IH(t),affectedColumns:Array.from(s),colspanCompensation:a}}function IH(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(ZC(t))return IH(i[0]);n.isCollapsed=!0;const s=i.slice(1),a=new Set;if(s.length>0)W(s,h=>{iq(h,d=>{a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(d=>{let{data:g}=d;g.isHidden=!0})});else{const{origColspan:h,columnIndex:d}=n;for(let g=1;g<h;g++){const p=d+g;a.add(p)}}const u=n.colspan-((e=XC(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(h=>{const{data:d}=h;d.colspan-=u,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):ZC(h)&&(d.isCollapsed=XC(h,"isCollapsed"))}),{rollbackModification:()=>PH(t),affectedColumns:Array.from(a),colspanCompensation:u}}function Rwe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error($t`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:s}}=r;if(s)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:s}=r;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function Ewe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error($t`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:s}}=r;if(s)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:s}=r;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const rU=new Map([["collapse",IH],["expand",PH],["hide-column",Rwe],["show-column",Ewe]]);function Twe(t,e,n){if(!rU.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return rU.get(t)(e,n)}function Ty(t){const e=[];return W(t,n=>{n.walkDown(i=>{const r=i.data,{origColspan:s,columnIndex:a,headerLevel:u,crossHiddenColumns:h}=r,d=Mwe(e,u);let g=!1;for(let p=a;p<a+s;p++)if(h.includes(p)||g)d.push(XG());else{const y=_we(r);y.isRoot=!0,d.push(y),g=!0}})}),e}function _we(t){const{crossHiddenColumns:e,...n}=iO(t);return n}function Mwe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function WM(t,e,n){Owe(t,e),e.set(t,n)}function Owe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mm(t,e,n){return t.set(rq(t,e),n),n}function bn(t,e){return t.get(rq(t,e))}function rq(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ao=new WeakMap,cr=new WeakMap,_c=new WeakMap;class Awe{constructor(){WM(this,Ao,new gwe),WM(this,cr,new bwe(bn(Ao,this))),WM(this,_c,[[]])}setState(e){bn(Ao,this).setData(e);let n=!1;try{bn(cr,this).buildTree()}catch{bn(cr,this).clear(),bn(Ao,this).clear(),n=!0}return mm(_c,this,Ty(bn(cr,this).getRoots())),n}setColumnsLimit(e){bn(Ao,this).setColumnsLimit(e)}mergeStateWith(e){const n=Rt(e,i=>{let{row:r,...s}=i;return{row:r<0?this.rowCoordsToLevel(r):r,...s}});bn(Ao,this).mergeWith(n),bn(cr,this).buildTree(),mm(_c,this,Ty(bn(cr,this).getRoots()))}mapState(e){bn(Ao,this).map(e),bn(cr,this).buildTree(),mm(_c,this,Ty(bn(cr,this).getRoots()))}mapNodes(e){return Sr(bn(cr,this).getRoots(),(n,i)=>(i.walkDown(r=>{const s=e(r.data);s!==void 0&&n.push(s)}),n),[])}triggerNodeModification(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));const r=bn(cr,this).getNode(n,i);let s;return r&&(s=Twe(e,r,i),mm(_c,this,Ty(bn(cr,this).getRoots()))),s}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=bn(_c,this)[e])===null||r===void 0?void 0:r[n])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,n){const i=this.getHeaderTreeNode(e,n);return i?{...i.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=bn(cr,this).getNode(e,n);return i||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let r=!1,s=null;for(let a=e;a<=n;a++){const u=bn(cr,this).getRootByColumn(a);if(!u)break;r=!0,u.walkDown(h=>{const{columnIndex:d,headerLevel:g,origColspan:p,isHidden:w}=h.data;w||p<=i&&d>=e&&d+p-1<=n&&(s===null||g<s)&&(s=g)},QG)}return r&&s===null?-1:this.levelToRowCoords(s??0)}findLeftMostColumnIndex(e,n){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0};if(r)return n;let s=n-1;for(;s>=0;){var a;const{isRoot:u}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(u)break;s-=1}return s}findRightMostColumnIndex(e,n){var i;const{isRoot:r,origColspan:s}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return n+s-1;let a=n+1;for(;a<this.getColumnsCount();){var u;const{isRoot:h}=(u=this.getHeaderSettings(e,a))!==null&&u!==void 0?u:{isRoot:!0};if(h)break;a+=1}return a-1}getLayersCount(){return bn(Ao,this).getLayersCount()}getColumnsCount(){return bn(Ao,this).getColumnsCount()}clear(){mm(_c,this,[]),bn(Ao,this).clear(),bn(cr,this).clear()}}function pm(t,e,n){return(e=xwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xwe(t){var e=Hwe(t,"string");return typeof e=="symbol"?e:e+""}function Hwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pwe{constructor(e,n){pm(this,"hot",void 0),pm(this,"nestedHeaderSettingsGetter",void 0),pm(this,"layersCount",0),pm(this,"container",void 0),pm(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),i=n.length;this.widthsMap.clear();for(let r=0;r<i;r++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),a=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(a,n[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:i}=this.hot,r=n.createDocumentFragment(),s=n.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength();for(let h=0;h<this.layersCount;h++){const d=n.createElement("tr");for(let g=0;g<u;g++){let p=i.getVisualFromRenderableIndex(g);p===null&&(p=g);const w=n.createElement("th"),y=this.nestedHeaderSettingsGetter(h,p);if(y&&(!y.isPlaceholder||y.isHidden)){let S=y.label;a&&(S+='<button class="changeType"></button>'),wf(w,S),w.colSpan=y.colspan,d.appendChild(w)}}s.appendChild(d)}r.appendChild(s),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}function Iwe(t,e){sq(t,e),e.add(t)}function sU(t,e,n){return(e=Nwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nwe(t){var e=Dwe(t,"string");return typeof e=="symbol"?e:e+""}function Dwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vm(t,e,n){sq(t,e),e.set(t,n)}function sq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Za(t,e,n){return t.set(Rn(t,e),n),n}function bt(t,e){return t.get(Rn(t,e))}function Rn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const oU="nestedHeaders",Lwe=280;var zt=new WeakMap,Yl=new WeakMap,Km=new WeakMap,ZS=new WeakMap,QC=new WeakMap,In=new WeakSet;class kwe extends Ht{constructor(){super(...arguments),Iwe(this,In),vm(this,zt,new Awe),vm(this,Yl,null),vm(this,Km,null),vm(this,ZS,!1),vm(this,QC,null),sU(this,"ghostTable",new Pwe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),sU(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return oU}static get PLUGIN_PRIORITY(){return Lwe}isEnabled(){return!!this.hot.getSettings()[oU]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Nt($t`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Rn(In,this,Jwe).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,eye).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,Bwe).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,Wwe).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,Uwe).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,jwe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,zwe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,Ywe).call(e,...r)}),this.addHook("afterSelection",()=>Rn(In,this,_y).call(this)),this.addHook("afterSelectionFocusSet",()=>Rn(In,this,_y).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,Vwe).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>Rn(In,this,qwe).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,Xwe).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,Zwe).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,$we).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,Fwe).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,Gwe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,Kwe).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Rn(In,e,Qwe).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Rn(In,this,_y).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Rn(In,this,_y).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();bt(zt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=bt(zt,this).setState(e)),this.detectedOverlappedHeaders&&Nt($t`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,i)=>{const r=n===!0?"hide-column":"show-column";bt(zt,this).triggerColumnModification(r,i)}),!bt(Yl,this)&&this.enabled&&Za(Yl,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(i=>{let{op:r,index:s,newValue:a}=i;if(r==="replace"){const u=a===!0?"hide-column":"show-column";bt(zt,this).triggerColumnModification(u,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),bt(zt,this).clear(),bt(Yl,this).unsubscribe(),Za(Yl,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return bt(zt,this)}getLayersCount(){return bt(zt,this).getLayersCount()}getHeaderSettings(e,n){return bt(zt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let a=0;a<n;a++){const u=i.childNodes[a];if(!u)break;const h=r.childNodes[a],d=s?s.childNodes[a]:null;for(let g=0,p=u.childNodes.length;g<p;g++)u.childNodes[g].removeAttribute("colspan"),je(u.childNodes[g],"hiddenHeader"),h&&h.childNodes[g]&&(h.childNodes[g].removeAttribute("colspan"),je(h.childNodes[g],"hiddenHeader")),s&&d&&d.childNodes[g]&&(d.childNodes[g].removeAttribute("colspan"),je(d.childNodes[g],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,s)=>{var a;const{columnIndexMapper:u,view:h}=this.hot;let d=u.getVisualFromRenderableIndex(r);d===null&&(d=r),s.removeAttribute("colspan"),je(s,"hiddenHeader"),je(s,"hiddenHeaderText");const{colspan:g,isHidden:p,isPlaceholder:w,headerClassNames:y}=(a=bt(zt,this).getHeaderSettings(e,d))!==null&&a!==void 0?a:{};if(w||p)fe(s,"hiddenHeader");else if(g>1){var S,_,E;const{wtOverlays:H}=h._wt,x=(S=H.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),D=(_=H.inlineStartOverlay)===null||_===void 0?void 0:_.clone.wtTable.THEAD.contains(s);((E=H.topOverlay)===null||E===void 0?void 0:E.clone.wtTable.THEAD.contains(s))&&d<i&&fe(s,"hiddenHeaderText");const V=x||D?Math.min(g,i-r):g;V>1&&s.setAttribute("colspan",V)}if(this.hot.view.appendColHeader(d,s,function(){return n.getColumnHeaderValue(...arguments)},e),!w&&!p){const H=s.querySelector("div.relative");H&&y&&y.length>0&&(je(H,this.hot.getColumnMeta(d).headerClassName),fe(H,y))}}}getColumnHeaderValue(e,n){var i;const{isHidden:r,isPlaceholder:s}=(i=bt(zt,this).getHeaderSettings(n,e))!==null&&i!==void 0?i:{};return s||r?"":this.hot.getColHeader(e,n)}destroy(){Za(zt,this,null),bt(Yl,this)!==null&&(bt(Yl,this).unsubscribe(),Za(Yl,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return bt(zt,this).getHeaderTreeNodeData(e.row,e.col)}}function _y(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const r=bt(zt,this).findLeftMostColumnIndex(n.row,n.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=r,s.visualCellRange.from.col=r,s.visualCellRange.to.col=r,s.commit()}}function Vwe(t,e){var n;const i=this.hot.getSelectedRangeLast();if(!i)return t;const{highlight:r}=i,{navigableHeaders:s}=this.hot.getSettings(),a=this.hot.selection.isSelectedByColumnHeader(),u=s?r.row:(n=bt(QC,this))===null||n===void 0?void 0:n.row,h=a?t:r.col,d=u<0&&h>=0;if(Za(QC,this,null),!d)return t;const g=this.hot.getFirstFullyVisibleColumn(),p=this.hot.getLastFullyVisibleColumn(),w=p-g+1,y=bt(zt,this).findLeftMostColumnIndex(u,h),S=bt(zt,this).findRightMostColumnIndex(u,h),_=S-y+1;if(y<g&&S>p)return y;if(a){let E=null;return y>=g&&S>p?_>w?(e.value="start",E=y):(e.value="end",E=S):y<g&&S<=p&&(_>w?(e.value="end",E=S):(e.value="start",E=y)),E}return y<=g?y:S}function $we(t,e,n){const i=bt(zt,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:r,selectionType:s,selectionWidth:a}=n,{isRoot:u,colspan:h}=bt(zt,this).getHeaderSettings(e,t);if(s===aA){if(!u)return i.columnIndex}else if(s===X2&&(h>a-r||!u))return null;return t}function Fwe(t,e,n){let{columnHeadersCount:i}=n;if(i!==0)for(let s=0;s<e.length;s++){const{startRow:a,startCol:u,endRow:h,endCol:d}=e[s],g=h-a+1,p=u-d+1;if(a>=0||p===1)break;for(let w=u;w<=d;w++)for(let y=a;y<=h;y++){var r;const S=g+y,_=w-u;if(_===0)continue;((r=bt(zt,this).getHeaderTreeNodeData(y,w))===null||r===void 0?void 0:r.isRoot)===!1&&(t[S][_]="")}}}function Bwe(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function Wwe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Za(Km,this,e.clone()),Za(ZS,this,!0);const{selection:i}=this.hot,r=i.isSelected()?i.getSelectedRange().current():null,s=[],{columnIndex:a,origColspan:u}=n,h=!i.inInSelection(e);t.shiftKey&&r?e.col<r.from.col?s.push(r.getTopEndCorner().col,a,e.row):e.col>r.from.col?s.push(r.getTopStartCorner().col,a+u-1,e.row):s.push(a,a+u-1,e.row):(XO(t)||Yc(t)&&h||vX(t))&&s.push(a,a+u-1,e.row),i.selectColumns(...s)}function Uwe(t,e,n,i){if(!this.hot.view.isMouseDown()||i.column)return;const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;const{columnIndex:s,origColspan:a}=r,u=this.hot.getSelectedRangeLast(),h=u.getTopStartCorner(),d=u.getBottomEndCorner(),{from:g}=u;i.column=!0,i.cell=!0;const p=[],w=_t(e.row,-1/0,-1);e.col<g.col?p.push(d.col,s,w):e.col>g.col?p.push(h.col,s+a-1,w):p.push(s,s+a-1,w),this.hot.selection.selectColumns(...p)}function jwe(){Za(ZS,this,!1)}function zwe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!bt(ZS,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:r,origColspan:s}=bt(zt,this).getHeaderTreeNodeData(bt(Km,this).row,bt(Km,this).col);if(e.setHighlight(bt(Km,this)),s>e.getWidth()||r<n||r+s-1>i){const a=bt(zt,this).findTopMostEntireHeaderLevel(_t(n,r,r+s-1),_t(i,r,r+s-1));e.highlight.row=a,e.highlight.col=e.from.col}}function Ywe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const r=bt(zt,this).findLeftMostColumnIndex(n.row,n.col),s=bt(zt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const a=e.col>=r&&e.col<=s?r-1:s,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,-1);u===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(u,e.col)-1,1)}else if(t.col>0){const a=e.col>=r&&e.col<=s?s+1:r,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,1);u===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,u)-1,1)}}function Gwe(t,e,n){const i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),s=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});Za(QC,this,n.clone()),e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function qwe(t){t.length=0;for(let e=0;e<bt(zt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Kwe(t){const e=bt(zt,this).getLayersCount();let n=t.startColumn,i=!!e;for(let r=0;r<e;r++){const s=bt(zt,this).findLeftMostColumnIndex(r,t.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(i=!1),Qi(a)&&a<t.startColumn){n=a;break}}t.startColumn=i?bt(zt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function Xwe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Zwe(t,e,n){var i;const{label:r}=(i=bt(zt,this).getHeaderTreeNodeData(n,e))!==null&&i!==void 0?i:{label:""};return r}function Qwe(t,e){if(t<0)return this.hot.getCell(t,bt(zt,this).findLeftMostColumnIndex(t,e),!0)}function Jwe(){this.updatePlugin()}function eye(t,e){e||this.updatePlugin()}function wm(t,e,n){return(e=tye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tye(t){var e=nye(t,"string");return typeof e=="symbol"?e:e+""}function nye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iye{constructor(e,n){wm(this,"hot",void 0),wm(this,"data",null),wm(this,"plugin",void 0),wm(this,"parentReference",new WeakMap),wm(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ke(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,i){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&W(e.__children,r=>{this.cacheNode(r,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,i,r){let s=!1,a=n;if(isNaN(a)&&a.end)return a;let u=e;return u||(u={__children:this.data},s=!0,a-=1),i!=null&&a===i?{result:u,end:!0}:r!=null&&u===r?{result:a,end:!0}:(a+=1,u.__children&&W(u.__children,h=>{if(this.parentReference.set(h,s?null:u),a=this.readTreeNodes(h,a,i,r),isNaN(a)&&a.end)return!1}),a)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return dt(this.data[0],(n,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(W(i.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let i=n;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),i||(i=this.mockNode()),s.__children.push(i),this.rewriteCache();const a=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,n,i){let r=i,s;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,n),e){const u=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",u,1),e.__children.splice(n,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(u,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",u,1),s=u}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[n]);r=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,r,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),s=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(r,s+1,null);break;case"above":this.addChildAtIndex(r,s,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(ke(e[0],e[2],w=>{const y=this.translateTrimmedRow(w);r.push(this.getDataObject(y))}),ke(0,r.length-2,w=>{this.detachFromParent(r[w],!1)}),i=r[r.length-1]):i=e;const s=this.getRowIndex(i),a=this.countChildren(i),u=this.getRowIndexWithinParent(i),h=this.getRowParent(i),d=this.getRowParent(h),g=this.getRowIndex(d);let p=null;if(this.hot.runHooks("beforeDetachChild",h,i),u!=null){const w=Array.from(new Array(s+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",s,a+1,w,this.plugin.pluginName),h.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,a+1,w,this.plugin.pluginName),d){p=g+this.countChildren(d);const y=this.getChild(d,this.countChildren(d)-1),S=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",S+1,a+1,this.plugin.pluginName),d.__children.push(i)}else p=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",p-2,a+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",p-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",h,i,this.getRowIndex(i)),n&&this.hot.render()}filterData(e,n,i){const r=[];W(i,s=>{r.push(this.getDataObject(s))}),W(r,s=>{const a=this.getRowIndexWithinParent(s),u=this.getRowParent(s);u===null?this.data.splice(a,1):u.__children.splice(a,1)}),this.rewriteCache()}spliceData(e,n,i){const r=this.getDataObject(e-1);let s=null,a=e;r&&r.__children&&r.__children.length===0?(s=r,a=0):e<this.countAllRows()&&(s=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),s?i?s.__children.splice(a,n,...i):s.__children.splice(a,n):i?this.data.splice(a,n,...i):this.data.splice(a,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,i,r){const s=n===this.hot.countRows(),a=this.getRowParent(e),u=this.getRowIndexWithinParent(e),h=a.__children.slice(u,u+1),d=e>n;let g=s?this.getRowParent(n-1):this.getRowParent(n);g==null&&(g=this.getRowParent(n-1)),g==null&&(g=this.getDataObject(n-1)),g?g.__children||(g.__children=[]):(g=this.getDataObject(n),g.__children=[]);const p=s||i||r?g.__children.length:this.getRowIndexWithinParent(n),w=a===g;g.__children.splice(p,0,h[0]),a.__children.splice(u+(d&&w?1:0),1),this.syncRowWithRawSource(a),w||this.syncRowWithRawSource(g)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function aU(t,e,n){return(e=rye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rye(t){var e=sye(t,"string");return typeof e=="symbol"?e:e+""}function sye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NH{constructor(e,n){aU(this,"hot",void 0),aU(this,"plugin",void 0),this.hot=n,this.plugin=e}}class $o extends NH{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const i=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(i),s=this.dataManager.getDataObject(i),a=n.getElementsByTagName("DIV")[0],u=a.querySelector("span.rowHeader"),h=a.querySelectorAll('[class^="ht_nesting"]'),d=this.hot.getSettings().ariaTags;if(W(h,g=>{g&&a.removeChild(g)}),fe(n,$o.CSS_CLASSES.indicatorContainer),r){const{rootDocument:g}=this.hot,p=u.cloneNode(!0);a.innerHTML="",ke(0,r-1,()=>{const w=g.createElement("SPAN");fe(w,$o.CSS_CLASSES.emptyIndicator),a.appendChild(w)}),a.appendChild(p)}if(this.dataManager.hasChildren(s)){const g=this.hot.rootDocument.createElement("DIV");d&&Ge(g,[vu()]),fe(n,$o.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(fe(g,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.expandButton}`),d&&Ge(n,[Cs(!1)])):(fe(g,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.collapseButton}`),d&&Ge(n,[Cs(!0)])),a.appendChild(g)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const i=this.hot.view.getStylesHandler();let r=11;i.isClassicTheme()||(r=i.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}class oye extends NH{constructor(e,n){var i;super(e,n),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,s){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),W(i.lastCollapsedRows,(u,h)=>{u>=r&&u<s&&(i.lastCollapsedRows[h]=u+a)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,s)=>{ke(r,r+s-1,a=>{const u=this.lastCollapsedRows.indexOf(a);u>-1&&this.lastCollapsedRows.splice(u,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let s=null,a=null,u=null;return isNaN(e)?(s=e,a=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(s)&&W(s.__children,h=>{r.push(this.dataManager.getRowIndex(h))}),u=this.collapseRows(r,!0,!1),i&&this.trimRows(u),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(a)===-1&&this.collapsedRows.push(a),u}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];W(e,s=>{r.push(...this.collapseChildren(s,!1,!1))}),i&&this.trimRows(r),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return W(e,s=>{r.push(s),n&&this.collapseChildRows(s,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);W(r.__children,s=>{const a=this.dataManager.getRowIndex(s);n.push(a),this.collapseChildRows(a,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return W(e,s=>{r.push(s),n&&this.expandChildRows(s,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);W(r.__children,s=>{if(!this.isAnyParentCollapsed(s)){const a=this.dataManager.getRowIndex(s);n.push(a),this.expandChildRows(a,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let s=null,a=null,u=null;return isNaN(e)?(s=e,a=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(s)&&W(s.__children,h=>{const d=this.dataManager.getRowIndex(h);r.push(d)}),u=this.expandRows(r,!0,!1),i&&this.untrimRows(u),n&&this.renderAndAdjust(),u}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];W(e,s=>{r.push(...this.expandChildren(s,!1,!1))}),i&&this.untrimRows(r),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];W(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];W(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{W(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{W(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&W(n.__children,r=>{const s=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return i=!1,!1}),i}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const i=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const i=this.translateTrimmedRow(n.row);ze(e.target,$o.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),so(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function aye(t,e,n){lye(t,e),e.set(t,n)}function lye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uye(t,e,n){return(e=cye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cye(t){var e=hye(t,"string");return typeof e=="symbol"?e:e+""}function hye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dye(t,e){return t.get(fye(t,e))}function fye(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lU=new WeakMap;class gye extends NH{constructor(){super(...arguments),uye(this,"dataManager",this.plugin.dataManager),aye(this,lU,{row_above:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(ax)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(lx)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ke(0,e.items.length-1,i=>{if(i===0)return W(n,(r,s)=>{e.items.splice(i+s,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return ke(0,e.items.length-1,n=>{const i=dye(lU,this)[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}function My(t,e,n){return(e=mye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mye(t){var e=pye(t,"string");return typeof e=="symbol"?e:e+""}function pye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vye{constructor(e){My(this,"plugin",void 0),My(this,"hot",void 0),My(this,"dataManager",void 0),My(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const a=i===this.hot.countRows(),u=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let h=!0;const d=e.map(S=>{if(!h)return!1;const _=this.dataManager.translateTrimmedRow(S);return h=this.shouldAllowMoving(_,u),_}),g=d.indexOf(u)===-1;if(!h||!g)return!1;const p=this.getBaseParent(d),w=this.getTargetParent(a,u),y=p===w;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(w),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(d,u,y),this.moveRows(d,u,w),this.dataManager.rewriteCache(),this.moveCellsMeta(d,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,r,r&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:i,dropIndex:r,movePossible:s}=e;let a=!1;return vn(r)&&(Nt($t`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,i,r,s,!1),a=!0),a}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}shiftCollapsibleParentsLocations(e,n,i){i||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,i){const r=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,n,this.movedToCollapsed,r)})})}moveCellsMeta(e,n){const i=[],r=Math.max(...e)<n;e.forEach(s=>{i.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(r?i.length:0),0,...i)}selectCells(e,n){const i=e.length;let r=0,s=0;if(this.movedToCollapsed){let a=null;e[i-1]<n?a=this.dataManager.translateTrimmedRow(n-i):a=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(a===null?this.hot.countSourceRows()-1:a-1),h=this.dataManager.getRowIndex(u);r=this.dataManager.untranslateTrimmedRow(h),s=r}else e[i-1]<n?(s=n-1,r=s-i+1):(r=n,s=r+i-1);this.hot.selectCells([[r,0,s,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}}function wye(t,e){oq(t,e),e.add(t)}function uU(t,e,n){oq(t,e),e.set(t,n)}function oq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UM(t,e,n){return(e=yye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yye(t){var e=Cye(t,"string");return typeof e=="symbol"?e:e+""}function Cye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rC(t,e){return t.get(ui(t,e))}function JC(t,e,n){return t.set(ui(t,e),n),n}function ui(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eS="nestedRows",Sye=300,cU=eS,bye="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var QS=new WeakMap,Td=new WeakMap,vi=new WeakSet;class Rye extends Ht{constructor(){super(...arguments),wye(this,vi),UM(this,"dataManager",null),UM(this,"headersUI",null),UM(this,"collapsedRowsMap",null),uU(this,QS,!1),uU(this,Td,!1)}static get PLUGIN_KEY(){return eS}static get PLUGIN_PRIORITY(){return Sye}isEnabled(){return!!this.hot.getSettings()[eS]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Hp),this.dataManager=new iye(this,this.hot),this.collapsingUI=new oye(this,this.hot),this.headersUI=new $o(this,this.hot),this.contextMenuUI=new gye(this,this.hot),this.rowMoveController=new vye(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,kye).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Vye).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,_ye).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Mye).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Oye).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Tye).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Hye).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,xye).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Pye).call(e,...i)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Iye).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Nye).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Dye).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Aye).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Lye).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ui(vi,e,Eye).call(e,...i)}),this.addHook("beforeLoadData",n=>ui(vi,this,hU).call(this,n)),this.addHook("beforeUpdateData",n=>ui(vi,this,hU).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:cU,relativeToGroup:Cu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cU)}disableCoreAPIModifiers(){JC(Td,this,!0)}enableCoreAPIModifiers(){JC(Td,this,!1)}onModifyRowData(e){if(!rC(Td,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!rC(Td,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,i){return rC(Td,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,i),!1)}destroy(){super.destroy()}}function Eye(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function Tye(t,e,n){this.collapsingUI.toggleState(t,e,n)}function _ye(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),JC(QS,this,!0),this.dataManager.getData().slice()}function Mye(t){return this.contextMenuUI.appendOptions(t)}function Oye(t,e){this.headersUI.appendLevelIndicators(t,e)}function Aye(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function xye(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{JC(QS,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Hye(t,e,n){const i=Array.from(n.reduce((r,s)=>{if(this.dataManager.isParent(s)){const a=this.dataManager.getDataObject(s).__children;return r.add(s),Array.isArray(a)&&a.forEach(u=>r.add(this.dataManager.getRowIndex(u))),r}return r.add(s)},new Set));n.length=0,n.push(...i)}function Pye(){this.collapsingUI.collapsedRowsStash.stash()}function Iye(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Nye(){this.collapsingUI.collapsedRowsStash.stash()}function Dye(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Lye(){this.dataManager.rewriteCache()}function kye(){this.headersUI.updateRowHeaderWidth()}function Vye(t,e){rC(QS,this)&&(e.skipRender=!0)}function hU(t){if(!Hee(t)){ZO(bye),this.hot.getSettings()[eS]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function jM(t,e,n){return(e=$ye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ye(t){var e=Fye(t,"string");return typeof e=="symbol"?e:e+""}function Fye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bye{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;jM(this,"rootWindow",void 0),jM(this,"prefix",void 0),jM(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const i=typeof e>"u"?n:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){W(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Wye(t,e,n){return(e=Uye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uye(t){var e=jye(t,"string");return typeof e=="symbol"?e:e+""}function jye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Ae.getSingleton().register("persistentStateSave");Ae.getSingleton().register("persistentStateLoad");Ae.getSingleton().register("persistentStateReset");const dU="persistentState",zye=0;class Yye extends Ht{constructor(){super(...arguments),Wye(this,"storage",void 0)}static get PLUGIN_KEY(){return dU}static get PLUGIN_PRIORITY(){return zye}isEnabled(){return!!this.hot.getSettings()[dU]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Bye(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Gye(t,e){qye(t,e),e.add(t)}function qye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zM(t,e,n){return(e=Kye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kye(t){var e=Xye(t,"string");return typeof e=="symbol"?e:e+""}function Xye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fU(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const YM="search",Zye=190,Qye="htSearchResult",Jye=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},eCe=function(t,e,n){return vn(t)||t===null||!t.toLocaleLowerCase||t.length===0||vn(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var GM=new WeakSet;class tCe extends Ht{constructor(){super(...arguments),Gye(this,GM),zM(this,"callback",Jye),zM(this,"queryMethod",eCe),zM(this,"searchResultClass",Qye)}static get PLUGIN_KEY(){return YM}static get PLUGIN_PRIORITY(){return Zye}isEnabled(){return this.hot.getSettings()[YM]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[YM];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return fU(GM,e,gU).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return fU(GM,e,gU).call(e,...r)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),s=this.hot.countCols(),a=[],u=this.hot;return ke(0,r-1,h=>{ke(0,s-1,d=>{const g=this.hot.getDataAtCell(h,d),p=this.hot.getCellMeta(h,d),w=p.search.callback||n,S=(p.search.queryMethod||i)(e,g,p);if(S){const _={row:h,col:d,data:g};a.push(_)}w&&w(u,h,d,g,S)})}),a}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){ht(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function gU(t,e,n,i,r,s){const a=s.className||[];let u=[];typeof a=="string"?u=a.split(" "):u.push(...a),this.isEnabled()&&s.isSearchResult?u.includes(this.searchResultClass)||u.push(`${this.searchResultClass}`):u.includes(this.searchResultClass)&&u.splice(u.indexOf(this.searchResultClass),1),s.className=u.join(" ")}function Oy(t,e,n){return(e=nCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nCe(t){var e=iCe(t,"string");return typeof e=="symbol"?e:e+""}function iCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aq{constructor(e){Oy(this,"viewportWidth",void 0),Oy(this,"overwriteColumnWidthFn",void 0),Oy(this,"baseWidths",new Map),Oy(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class rCe extends aq{calculate(){const e=Array.from(this.baseWidths).reduce((p,w)=>{let[,y]=w;return p+y},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,r=[],s=[];let a=this.viewportWidth,u=0;if(this.baseWidths.forEach((p,w)=>{const y=Math.round(p*i),S=this.overwriteColumnWidthFn(y,w);y===S&&y>=tf?(r.push([w,S]),u+=S):y!==S&&(r.push([w,S]),s.push(w),a-=S)}),a<=tf){this.stretchedWidths.clear();return}const h=a/u;let d=-1,g=0;r.forEach((p,w)=>{let[y,S]=p,_=S;s.includes(y)||(_=Math.round(S*h)),this.stretchedWidths.set(y,_),d=y,w<r.length-1&&(g+=_)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(d,Math.round(this.viewportWidth-g))}}function mU(t,e,n){sCe(t,e),e.set(t,n)}function sCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qM(t,e){return t.get(lq(t,e))}function Ay(t,e,n){return t.set(lq(t,e),n),n}function lq(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xy=new WeakMap,ym=new WeakMap;class oCe extends aq{constructor(){super(...arguments),mU(this,xy,0),mU(this,ym,-1)}prepare(e){super.prepare(e),Ay(xy,this,0),Ay(ym,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),Ay(ym,this,e),Ay(xy,this,n)}calculate(){if(qM(ym,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,r)=>{let[,s]=r;return i+s},0),n=Math.max(this.viewportWidth-e+qM(xy,this),0);this.stretchedWidths.set(qM(ym,this),n)}}function aCe(t,e){uq(t,e),e.add(t)}function Hy(t,e,n){uq(t,e),e.set(t,n)}function uq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nn(t,e){return t.get(Wd(t,e))}function KM(t,e,n){return t.set(Wd(t,e),n),n}function Wd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lCe="stretchColumns";var ki=new WeakMap,_d=new WeakMap,XM=new WeakMap,Py=new WeakMap,Cm=new WeakSet;class uCe{constructor(e){aCe(this,Cm),Hy(this,ki,void 0),Hy(this,_d,void 0),Hy(this,XM,new Map([["all",new rCe(Wd(Cm,this,pU).bind(this))],["last",new oCe(Wd(Cm,this,pU).bind(this))]])),Hy(this,Py,"none"),KM(ki,this,e),KM(_d,this,Nn(ki,this).columnIndexMapper.createAndRegisterIndexMap(lCe,"physicalIndexToValue"))}useStrategy(e){KM(Py,this,Nn(XM,this).has(e)?e:"none")}refreshStretching(){if(Nn(Py,this)==="none"){Nn(_d,this).clear();return}Nn(ki,this).batchExecution(()=>{Nn(_d,this).clear();const e=Nn(XM,this).get(Nn(Py,this));let i=Nn(ki,this).view.getViewportWidth();Wd(Cm,this,cCe).call(this)&&(i-=Mi(Nn(ki,this).rootDocument)),e.prepare({viewportWidth:i});for(let r=0;r<Nn(ki,this).countCols();r++)Nn(ki,this).columnIndexMapper.isHidden(Nn(ki,this).toPhysicalColumn(r))||e.setColumnBaseWidth(r,Wd(Cm,this,hCe).call(this,r));e.calculate(),e.getWidths().forEach(r=>{let[s,a]=r;Nn(_d,this).setValueAtIndex(Nn(ki,this).toPhysicalColumn(s),a)})},!0)}getStretchedWidth(e){return Nn(_d,this).getValueAtIndex(Nn(ki,this).toPhysicalColumn(e))}}function cCe(){const{view:t}=Nn(ki,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=Nn(ki,this).countRows(),i=t.getStylesHandler().getDefaultRowHeight();let r=0,s=!1;for(let u=0;u<n;u++){var a;if(r+=((a=Nn(ki,this).getRowHeight(u))!==null&&a!==void 0?a:i)+(u===0?1:0),r>e){s=!0;break}}return s}function hCe(t){var e;return(e=Nn(ki,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:tf}function pU(t,e){return Nn(ki,this).runHooks("beforeStretchingColumnWidth",t,e)}function dCe(t,e){cq(t,e),e.add(t)}function ZM(t,e,n){cq(t,e),e.set(t,n)}function cq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QM(t,e,n){return t.set(tS(t,e),n),n}function ka(t,e){return t.get(tS(t,e))}function tS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fCe="stretchColumns",gCe=155;var Ld=new WeakMap,Iy=new WeakMap,Sm=new WeakMap,JM=new WeakSet;class mCe extends Ht{constructor(){super(...arguments),dCe(this,JM),ZM(this,Ld,new uCe(this.hot)),ZM(this,Iy,null),ZM(this,Sm,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:r}=i;ka(Iy,this)!==null&&ka(Iy,this)!==r.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),QM(Iy,this,r.width)})})}))}static get PLUGIN_KEY(){return fCe}static get PLUGIN_PRIORITY(){return gCe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(ka(Ld,this).useStrategy(this.hot.getSettings().stretchH),ka(Sm,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return tS(JM,e,vCe).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return tS(JM,e,pCe).call(e,...i)},10),super.enablePlugin())}updatePlugin(){ka(Ld,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),ka(Sm,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return ka(Ld,this).getStretchedWidth(e)}destroy(){ka(Sm,this).disconnect(),QM(Sm,this,null),QM(Ld,this,null),super.destroy()}}function pCe(t,e,n){if(n===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function vCe(t){t&&ka(Ld,this).refreshStretching()}function wCe(t,e){yCe(t,e),e.add(t)}function yCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ny(t,e,n){return(e=CCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CCe(t){var e=SCe(t,"string");return typeof e=="symbol"?e:e+""}function SCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function e1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bCe="touchScroll",RCe=200;var Dy=new WeakSet;class ECe extends Ht{constructor(){super(...arguments),wCe(this,Dy),Ny(this,"scrollbars",[]),Ny(this,"clones",[]),Ny(this,"lockedCollection",!1),Ny(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return bCe}static get PLUGIN_PRIORITY(){return RCe}static get SETTING_KEYS(){return!0}isEnabled(){return S2()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>e1(Dy,this,TCe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>e1(Dy,this,_Ce).call(this)),this.addHook("afterMomentumScroll",()=>e1(Dy,this,MCe).call(this))}}function TCe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}function _Ce(){this.freezeOverlays=!0,W(this.clones,t=>{fe(t,"hide-tween")})}function MCe(){this.freezeOverlays=!1,W(this.clones,t=>{je(t,"hide-tween"),fe(t,"show-tween")}),this.hot._registerTimeout(()=>{W(this.clones,t=>{je(t,"show-tween")})},400),W(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function OCe(t,e){ACe(t,e),e.add(t)}function ACe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xCe(t,e,n){return(e=HCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HCe(t){var e=PCe(t,"string");return typeof e=="symbol"?e:e+""}function PCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ICe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sC="trimRows",NCe=330;var vU=new WeakSet;class DCe extends Ht{constructor(){super(...arguments),OCe(this,vU),xCe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return sC}static get PLUGIN_PRIORITY(){return NCe}isEnabled(){return!!this.hot.getSettings()[sC]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Hp),this.trimmedRowsMap.addLocalHook("init",()=>ICe(vU,this,LCe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[sC];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),W(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{W(e,a=>{this.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),this.hot.runHooks("afterTrimRow",n,r,i,i&&r.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;const s=this.trimmedRowsMap.getValues().slice(),a=e.length>0;i&&a&&(W(e,h=>{s[h]=!1}),r=Sr(s,(h,d,g)=>(d&&h.push(g),h),[])),this.hot.runHooks("beforeUntrimRow",n,r,i&&a)!==!1&&(i&&a&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",n,r,i&&a,i&&r.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<n)}destroy(){super.destroy()}}function LCe(){const t=this.hot.getSettings()[sC];Array.isArray(t)&&this.hot.batchExecution(()=>{W(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}class _s{undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Ly(t,e,n){return(e=kCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kCe(t){var e=VCe(t,"string");return typeof e=="symbol"?e:e+""}function VCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DH extends _s{constructor(e){let{stateBefore:n,range:i,type:r,alignment:s}=e;super(),Ly(this,"stateBefore",void 0),Ly(this,"range",void 0),Ly(this,"type",void 0),Ly(this,"alignment",void 0),this.stateBefore=n,this.range=i,this.type=r,this.alignment=s}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(i,r,s,a)=>{n.done(()=>new DH({stateBefore:i,range:r,type:s,alignment:a}))})}undo(e,n){W(this.range,i=>{i.forAll((r,s)=>{r>=0&&s>=0&&e.setCellMeta(r,s,"className",this.stateBefore[r][s]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){ql(this.range,this.type,this.alignment,(i,r)=>e.getCellMeta(i,r),(i,r,s,a)=>e.setCellMeta(i,r,s,a)),e.addHookOnce("afterViewRender",n),e.render()}}function wU(t,e,n){return(e=$Ce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Ce(t){var e=FCe(t,"string");return typeof e=="symbol"?e:e+""}function FCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LH extends _s{constructor(e){let{columns:n,finalIndex:i}=e;super(),wU(this,"columns",void 0),wU(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(i,r)=>{i!==!1&&n.done(()=>new LH({columns:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),AH(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:a,to:u}=s;a<u&&(u-=1),i.moveColumn(u,a)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function yU(t,e,n){return(e=BCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BCe(t){var e=WCe(t,"string");return typeof e=="symbol"?e:e+""}function WCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kH extends _s{constructor(e){let{currentSortState:n,newSortState:i}=e;super(),yU(this,"previousSortState",void 0),yU(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(i,r,s)=>{s&&n.done(()=>new kH({currentSortState:i,newSortState:r}))})}undo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),s=r.isEnabled()?r:i;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),n()}redo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),n()}}function CU(t,e,n){return(e=UCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UCe(t){var e=jCe(t,"string");return typeof e=="symbol"?e:e+""}function jCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VH extends _s{constructor(e){let{index:n,amount:i}=e;super(),CU(this,"index",void 0),CU(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(i,r,s)=>{n.done(()=>new VH({index:i,amount:r}),s)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function SU(t,e,n){return(e=zCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zCe(t){var e=YCe(t,"string");return typeof e=="symbol"?e:e+""}function YCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $H extends _s{constructor(e){let{index:n,amount:i}=e;super(),SU(this,"index",void 0),SU(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(i,r,s)=>{n.done(()=>new $H({index:i,amount:r}),s)})}undo(e,n){const i=e.countRows(),r=e.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function ky(t,e,n){return(e=GCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GCe(t){var e=qCe(t,"string");return typeof e=="symbol"?e:e+""}function qCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FH extends _s{constructor(e){let{changes:n,selected:i,countCols:r,countRows:s}=e;super(),ky(this,"changes",void 0),ky(this,"selected",void 0),ky(this,"countCols",void 0),ky(this,"countRows",void 0),this.changes=n,this.selected=i,this.countCols=r,this.countRows=s}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(i,r){const s=i&&i.length;if(!s||!i.find(h=>{const[,,d,g]=h;return d!==g}))return;const u=()=>{const h=i.reduce((g,p)=>(g.push([...p]),g),[]);h.forEach(g=>{g[1]=e.propToCol(g[1])});const d=s>1?this.getSelected():[[h[0][0],h[0][1]]];return new FH({changes:h,selected:d,countCols:e.countCols(),countRows:e.countRows()})};n.done(u,r)})}undo(e,n){const i=tr(this.changes);for(let a=0,u=i.length;a<u;a++)i[a].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(i,null,null,"UndoRedo.undo");const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const s=e.countCols()-this.countCols;s>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,s,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const i=tr(this.changes);for(let r=0,s=i.length;r<s;r++)i[r].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function bU(t,e,n){return(e=KCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KCe(t){var e=XCe(t,"string");return typeof e=="symbol"?e:e+""}function XCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BH extends _s{constructor(e){let{conditionsStack:n,previousConditionsStack:i}=e;super(),bU(this,"conditionsStack",void 0),bU(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=i}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(i,r)=>{n.done(()=>new BH({conditionsStack:i,previousConditionsStack:r}))})}undo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.conditionCollection.importAllConditions(this.previousConditionsStack),i.filter()}redo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.conditionCollection.importAllConditions(this.conditionsStack),i.filter()}}function ZCe(t,e,n){return(e=QCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QCe(t){var e=JCe(t,"string");return typeof e=="symbol"?e:e+""}function JCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WH extends _s{constructor(e){let{data:n,cellRange:i}=e;super(),ZCe(this,"cellRange",void 0),this.cellRange=i,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(i,r)=>{if(r)return;const s=i.getTopStartCorner(),a=i.getBottomEndCorner(),u=e.getData(s.row,s.col,a.row,a.col);n.done(()=>new WH({data:u,cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange)}}var RU={},EU;function eSe(){if(EU)return RU;EU=1;var t=en(),e=df(),n=KU();return t({target:"Object",stat:!0},{fromEntries:function(r){var s={};return e(r,function(a,u){n(s,a,u)},{AS_ENTRIES:!0}),s}}),RU}eSe();function hq(t,e,n,i,r){const s=["visualRow","visualCol","row","col","prop"],a=s.length,u=[];return ke(i,r,h=>{ke(e,n,d=>{const g=t.getCellMeta(d,h);if(Object.keys(g).length!==a){const p=Object.fromEntries(Object.entries(g).filter(w=>{let[y]=w;return s.includes(y)===!1}));u.push([g.visualRow,g.visualCol,p])}})}),u}function Pa(t,e,n){return(e=tSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tSe(t){var e=nSe(t,"string");return typeof e=="symbol"?e:e+""}function nSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UH extends _s{constructor(e){let{index:n,indexes:i,data:r,headers:s,columnPositions:a,rowPositions:u,fixedColumnsStart:h,removedCellMetas:d}=e;super(),Pa(this,"index",void 0),Pa(this,"indexes",void 0),Pa(this,"data",void 0),Pa(this,"amount",void 0),Pa(this,"headers",void 0),Pa(this,"columnPositions",void 0),Pa(this,"rowPositions",void 0),Pa(this,"fixedColumnsStart",void 0),Pa(this,"removedCellMetas",void 0),this.index=n,this.indexes=i,this.data=r,this.amount=this.data[0].length,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=u.slice(0),this.fixedColumnsStart=h,this.removedCellMetas=d}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(i,r,s,a)=>{const u=()=>{const h=e.getSourceDataArray(),d=(e.countCols()+i)%e.countCols(),g=d+r-1,p=[],w=[],y=[];ke(h.length-1,E=>{const H=[],x=h[E];ke(d,g,D=>{H.push(x[e.toPhysicalColumn(D)])}),p.push(H)}),ke(r-1,E=>{y.push(e.toPhysicalColumn(d+E))}),Array.isArray(e.getSettings().colHeaders)&&ke(r-1,E=>{w.push(e.getSettings().colHeaders[e.toPhysicalColumn(d+E)]||null)});const S=e.columnIndexMapper.getIndexesSequence(),_=e.rowIndexMapper.getIndexesSequence();return new UH({index:d,indexes:y,data:p,headers:w,columnPositions:S,rowPositions:_,fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:hq(e,0,e.countRows(),d,g)})};n.done(u,a)})}undo(e,n){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),s=(g,p,w)=>w[this.indexes.indexOf(r[p])],a=this.data.length,u=[];for(let g=0;g<a;g++)u.push(Rt(this.data[g],s));const h=Rt(this.headers,s),d=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),W(e.getSourceDataArray(),(g,p)=>{W(r,(w,y)=>{g[w]=u[p][y],d.push([p,w,g[w]])})}),e.setSourceDataAtCell(d,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&W(h,(g,p)=>{e.getSettings().colHeaders[r[p]]=g}),this.removedCellMetas.forEach(g=>{let[p,w,y]=g;e.setCellMetaObject(p,w,y)}),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Md(t,e,n){return(e=iSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iSe(t){var e=rSe(t,"string");return typeof e=="symbol"?e:e+""}function rSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jH extends _s{constructor(e){let{index:n,data:i,fixedRowsBottom:r,fixedRowsTop:s,rowIndexesSequence:a,removedCellMetas:u}=e;super(),Md(this,"index",void 0),Md(this,"data",void 0),Md(this,"fixedRowsBottom",void 0),Md(this,"fixedRowsTop",void 0),Md(this,"rowIndexesSequence",void 0),Md(this,"removedCellMetas",void 0),this.index=n,this.data=i,this.fixedRowsBottom=r,this.fixedRowsTop=s,this.rowIndexesSequence=a,this.removedCellMetas=u}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(i,r,s,a)=>{const u=()=>{const h=e.toPhysicalRow(i),d=h+r-1,g=tr(e.getSourceData(h,0,h+r-1,e.countSourceCols()-1));return new jH({index:h,data:g,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:hq(e,h,d,0,e.countCols()-1)})};n.done(u,a)})}undo(e,n){const i=e.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,a)=>{Object.keys(s).forEach(u=>{const h=parseInt(u,10);r.push([this.index+a,isNaN(h)?u:h,s[u]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(s=>{let[a,u,h]=s;e.setCellMetaObject(a,u,h)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")}}function TU(t,e,n){return(e=sSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sSe(t){var e=oSe(t,"string");return typeof e=="symbol"?e:e+""}function oSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zH extends _s{constructor(e){let{rows:n,finalIndex:i}=e;super(),TU(this,"rows",void 0),TU(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(i,r)=>{i!==!1&&n.done(()=>new zH({rows:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),AH(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:a,to:u}=s;a<u&&(u-=1),i.moveRow(u,a)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function aSe(t,e,n){return(e=lSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lSe(t){var e=uSe(t,"string");return typeof e=="symbol"?e:e+""}function uSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YH extends _s{constructor(e){let{cellRange:n}=e;super(),aSe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(i,r)=>{r||n.done(()=>new YH({cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange,!0)}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0),e.render()}}function cSe(t,e){[DH,LH,kH,VH,$H,FH,BH,WH,UH,jH,zH,YH].forEach(n=>n.startRegisteringEvents(t,e))}function hSe(t,e){dSe(t,e),e.add(t)}function dSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t1(t,e,n){return(e=fSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fSe(t){var e=gSe(t,"string");return typeof e=="symbol"?e:e+""}function gSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function n1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _U="undoRedo",mSe="undoRedo",pSe=1e3;Ae.getSingleton().register("beforeUndo");Ae.getSingleton().register("afterUndo");Ae.getSingleton().register("beforeRedo");Ae.getSingleton().register("afterRedo");const MU=new Set;var Vy=new WeakSet;class vSe extends Ht{static get PLUGIN_KEY(){return mSe}static get PLUGIN_PRIORITY(){return pSe}static get SETTING_KEYS(){return!0}constructor(e){super(e),hSe(this,Vy),t1(this,"doneActions",[]),t1(this,"undoneActions",[]),t1(this,"ignoreNewActions",!1),cSe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return n1(Vy,e,wSe).call(e,...i)}),this.registerShortcuts(),n1(Vy,this,ySe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),n1(Vy,this,CSe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),r={runOnlyIf:s=>!s.altKey,group:_U};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_U)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const r=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",r,n)===!1)return;const a=e(),u=this.undoneActions.slice();this.doneActions.push(a),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",u),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",u,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=tr(n);if(this.hot.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const s=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",s),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=tr(n);if(this.hot.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const s=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",s),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function wSe(t,e){e==="loadData"&&this.clear()}function ySe(){const t=e=>{MU.has(e)||(Nt($t`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),MU.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function CSe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function SSe(){Ot(Dm),Ot(Wae),Ot(Lm),Ot(Sle),Ot(Ale),Ot(NY),Ot(Rue),Ot(ace),Ot(YS),Ot(vhe),Ot(Uhe),Ot(Zhe),Ot(KS),Ot(Tde),Ot(Sge),Ot(Jge),Ot(_me),Ot(Vme),Ot(Xme),Ot(ape),Ot(vpe),Ot(Dpe),Ot(jpe),Ot(Mve),Ot(owe),Ot(hwe),Ot(kwe),Ot(Rye),Ot(Yye),Ot(tCe),Ot(mCe),Ot(ECe),Ot(DCe),Ot(vSe)}function bSe(){dse(),Doe(),joe(),cae(),SSe()}const Qe={width:1,color:"black"},RSe=[{row:1,col:17,bottom:Qe},{row:2,col:17,bottom:Qe},{row:1,col:27,bottom:Qe},{row:2,col:27,bottom:Qe},{row:4,col:24,bottom:Qe},{row:5,col:24,bottom:Qe},{row:6,col:24,bottom:Qe},{row:7,col:24,bottom:Qe},{row:8,col:24,bottom:Qe},{row:9,col:26,bottom:Qe},{row:9,col:36,bottom:Qe},{row:10,col:26,bottom:Qe},{row:10,col:36,bottom:Qe},{row:11,col:24,bottom:Qe},{row:12,col:24,bottom:Qe},{row:13,col:24,bottom:Qe},{row:14,col:24,bottom:Qe},{row:15,col:24,bottom:Qe},{row:27,col:25,bottom:Qe},{row:27,col:32,bottom:Qe},{row:27,col:63,bottom:Qe},{row:27,col:72,bottom:Qe},{row:28,col:0,bottom:Qe},{row:29,col:25,bottom:Qe},{row:29,col:32,bottom:Qe},{row:29,col:63,bottom:Qe},{row:32,col:22,bottom:Qe},{row:34,col:16,bottom:Qe},{row:37,col:0,bottom:Qe},{row:37,col:14,bottom:Qe},{row:37,col:25,bottom:Qe},{row:37,col:43,bottom:Qe},{row:37,col:57,bottom:Qe},{row:37,col:69,bottom:Qe},{row:39,col:16,bottom:Qe},{row:39,col:19,bottom:Qe},{row:39,col:27,bottom:Qe},{row:39,col:57,bottom:Qe},{row:39,col:63,bottom:Qe},{row:39,col:75,bottom:Qe},{row:41,col:0,bottom:Qe},{row:41,col:72,bottom:Qe},{row:44,col:0,bottom:Qe},{row:44,col:14,bottom:Qe},{row:44,col:25,bottom:Qe},{row:44,col:43,bottom:Qe},{row:44,col:57,bottom:Qe},{row:44,col:69,bottom:Qe},{row:47,col:0,bottom:Qe},{row:47,col:72,bottom:Qe},{range:{from:{row:1,col:8},to:{row:30,col:83}},top:{width:2,color:"black"},left:{width:2,color:"black"},bottom:{width:2,color:"black"},right:{width:2,color:"black"}}],dq=[];for(let t=17;t<=25;t+=1)for(let e=0;e<=80;e+=1)dq.push({row:t,col:e,top:{width:1,color:"black"},right:{width:1,color:"black"}});const ESe=[...RSe,...dq],TSe=async t=>{const e=await fetch(t),{rows:n,merges:i}=await e.json(),r=n.reduce((s,a)=>Math.max(s,a.length),0);return{rows:n,merges:i,width:r}},_Se={1:{17:{name:"SchetFacturaN",value:""},26:{name:"SchetFacturaFrom",value:""}},2:{17:{name:"IspravlenyeN",value:""},26:{name:"IspravlenyeFrom",value:""}},4:{24:{name:"Prodavec",value:""}},5:{24:{name:"Adres",value:""}},6:{24:{name:"INNProdavca",value:""}},7:{24:{name:"Gruzootprav",value:""}},8:{24:{name:"Gruzopoluch",value:""}},9:{26:{name:"KDocumentuN",value:""},36:{name:"KDocumentuFrom",value:""}},10:{26:{name:"DocumentN",value:""},36:{name:"DocumentFrom",value:""}},11:{24:{name:"Pokupatel",value:""}},12:{24:{name:"PokupatelAdres",value:""}},13:{24:{name:"INNPokupatel",value:""}},14:{24:{name:"Valuta",value:""}},15:{24:{name:"Identifikator",value:""}}},MSe=t=>{const e={};for(const[n,i]of Object.entries(_Se)){e[n]={};for(const[r,s]of Object.entries(i))e[n][r]={...s,value:t[n][r]}}return e};bSe();function OSe(){const[t,e]=Xe.useState(null),[n,i]=Xe.useState(0),[r,s]=Xe.useState([]),[a,u]=Xe.useState(!0),[h,d]=Xe.useState(null);Xe.useEffect(()=>{TSe("/data.json").then(({rows:y,merges:S,width:_})=>{e(y.slice(0,16)),i(_),s(S)}).then(()=>{u(!1)}).catch(y=>{console.log(y)})},[]),Xe.useEffect(()=>{t!==null&&d(MSe(t))},[t]);const g=new Array(n).fill(null),p=(y,S)=>{if(!(S=="loadData"||S=="MergeCells")&&S=="edit"){const[_,E,H,x]=y[0];h[_]&&h[_][E]&&(d(D=>({...D,[_]:{[E]:{name:D[_][E].name,value:x}}})),console.log(h[_][E]))}},w=()=>{let y="";Object.values(h).forEach(H=>{Object.values(H).forEach(x=>{y+=`<${x.name}>${x.value===null?"":x.value}</${x.name}>
`})});const S=new Blob([y],{type:"application/xml"}),_=URL.createObjectURL(S),E=document.createElement("a");E.href=_,E.download="document.xml",E.click(),URL.revokeObjectURL(_)};return Mc.jsx("div",{className:"ht-theme-main",children:!a&&Mc.jsxs(Mc.Fragment,{children:[Mc.jsx(Xz,{data:t,headerClassName:"htLeft",colHeaders:!0,rowHeaders:!0,licenseKey:"non-commercial-and-evaluation",renderAllRows:!1,mergeCells:r,customBorders:ESe,afterChange:p,children:g.map((y,S)=>Mc.jsx(Gx,{width:20},S))}),Mc.jsx("button",{className:"export-btn",onClick:w,children:"Export XML"})]})})}O4.createRoot(document.getElementById("root")).render(Mc.jsx(OSe,{}))});export default ASe();
